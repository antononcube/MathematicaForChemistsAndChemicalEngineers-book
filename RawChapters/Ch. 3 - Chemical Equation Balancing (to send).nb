(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    246678,       6642]
NotebookOptionsPosition[    212011,       6094]
NotebookOutlinePosition[    212534,       6113]
CellTagsIndexPosition[    212491,       6110]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Chemical Equation Balancing", "Title",
 CellChangeTimes->{{3.441484301148834*^9, 3.441484328702744*^9}, {
  3.441484387080965*^9, 3.4414843950954037`*^9}, {3.460916213295959*^9, 
  3.460916216250139*^9}, {3.4728595615922403`*^9, 3.4728595779679317`*^9}, {
  3.488069501708211*^9, 3.488069519569338*^9}, {3.4880695792795467`*^9, 
  3.488069587618034*^9}, {3.490191124085116*^9, 3.490191126597048*^9}, {
  3.494367726326689*^9, 
  3.494367735432961*^9}},ExpressionUUID->"3f8fc1b9-1a00-4b54-ad4f-\
62e8a36910b8"],

Cell["Anton Antonov", "Author",
 CellChangeTimes->{{3.4449300945702057`*^9, 
  3.444930101932673*^9}},ExpressionUUID->"3b000d43-6cc7-4779-a718-\
bd2bf054df77"],

Cell["book for Wiley 2009-2010", "Institution",
 CellChangeTimes->{{3.44493010505249*^9, 3.444930142250931*^9}, {
  3.460320667598672*^9, 
  3.460320702010445*^9}},ExpressionUUID->"1f08a81d-87a3-4a0d-af43-\
d52c6736370a"],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.494366379538574*^9, 3.49436638329675*^9}, 
   3.49512615785741*^9},ExpressionUUID->"54389376-0cd3-4789-a933-\
fd83c884a3c9"],

Cell["\<\
In the previous chapter we outlined a method and procedure for parsing a \
chemical equation and the chemicals within it.  The goal of this chapter is \
to take an unbalanced equation which is of limited use, and find the \
coefficients that allow the number of each type of atoms to be the same for \
the reactants as it is for the products.\
\>", "Text",
 CellChangeTimes->{{3.494366922719599*^9, 3.4943670454655848`*^9}, {
   3.494367142634097*^9, 3.494367224369272*^9}, {3.4946354860913563`*^9, 
   3.4946354895205708`*^9}, {3.494636058907886*^9, 3.494636091022848*^9}, {
   3.494637124249434*^9, 3.49463721000806*^9}, {3.4946408175125723`*^9, 
   3.494640868901783*^9}, 
   3.495126157857689*^9},ExpressionUUID->"51efb276-c86d-4ccc-bfc0-\
fd2ebe75de07"],

Cell["\<\
When balancing chemical equations, the stoichiometric coefficients w,x,y, and \
z are the variables and the chemicals are the constants; therefore, the \
chemical formulas should not change.  Chemists usually approach equation \
balancing using a trial and error method.  For the following example:\
\>", "Text",
 CellChangeTimes->{{3.494366922719599*^9, 3.4943670454655848`*^9}, {
   3.494367142634097*^9, 3.494367224369272*^9}, {3.4946354860913563`*^9, 
   3.4946354895205708`*^9}, {3.494636058907886*^9, 3.494636091022848*^9}, {
   3.494637124249434*^9, 3.49463721000806*^9}, {3.4946408175125723`*^9, 
   3.494640868901783*^9}, {3.4946410082034807`*^9, 3.4946411075896053`*^9}, {
   3.494641249103856*^9, 3.494641260813241*^9}, 
   3.495126157857945*^9},ExpressionUUID->"6241d38a-44c4-43ef-9a79-\
28ef7e8473cf"],

Cell["w C3H8 + x O2 \[RightArrow] y CO2 + z H2O", "Text",
 CellChangeTimes->{{3.494640959536353*^9, 3.494640981301178*^9}, 
   3.495126157858205*^9},ExpressionUUID->"17845732-a4f9-4b17-bd2f-\
509873dd3c96"],

Cell["\<\
a typical approach would be view that there is 3 carbons in the reactants, \
and only 1 in the product and that therefore try setting: w = 1, y = 3.  If w \
= 1 then there are 8 hydrogens in the reactants, and therefore z = 4 makes 8 \
hydrogens in the products.  Finally, with y = 3 and z = 4 there are ten total \
hydrogens in the product, making x = 5.  This makes the stoichiometric \
coefficients {w,x,y,z} = {1,5,3,4}, therefore the balanced equation is:\
\>", "Text",
 CellChangeTimes->{{3.494641265876691*^9, 3.4946412769160423`*^9}, {
   3.494641310378405*^9, 3.4946415704450903`*^9}, {3.494641629673675*^9, 
   3.4946416650066977`*^9}, 
   3.495126157858425*^9},ExpressionUUID->"969f8141-0494-4b6e-90cd-\
2f3848c5664c"],

Cell["1 C3H8 + 5 O2 \[RightArrow] 3 CO2 + 4 H2O", "Text",
 CellChangeTimes->{{3.494641577909767*^9, 3.4946415875427933`*^9}, 
   3.495126157858646*^9},ExpressionUUID->"5040502a-015d-43ce-a86a-\
47dae58b3da3"],

Cell["\<\
With checking, we confirm that on both the left-hand side and the right-hand \
side of the reaction that element tally is {{\"C\", 3}, {\"H\", 8}, {\"O\", \
10}}.\
\>", "Text",
 CellChangeTimes->{{3.494641609593668*^9, 3.4946416138411016`*^9}, {
   3.494641672645954*^9, 3.494641754217581*^9}, 
   3.495126157858865*^9},ExpressionUUID->"1823f382-9760-4ef2-a281-\
792d79c32871"],

Cell["\<\
The trial and error method of equation balancing employed by chemists is time \
consuming, and can be more reliably solved if the equations are treated as a \
system of linear equations.  First, we can define an equation that \
corresponds to each element that is present.  Referring to our initial \
unbalanced equation we can see that for propane, oxygen, carbon dioxide, and \
water, there are respectively 3,0,1,0 carbons present for each molecule.  If \
we consider the equation \"C3H8 + O2 = CO2 + H2O\" then \"C3H8 + O2 - CO2 - \
H2O = 0\", making the equation become: 3,0,-1,0.   If we repeat this for \
hydrogen and oxygen we obtain the following matrix:\
\>", "Text",
 CellChangeTimes->{{3.494641609593668*^9, 3.4946416138411016`*^9}, {
   3.494641672645954*^9, 3.494641754217581*^9}, {3.49464182849549*^9, 
   3.494641892725944*^9}, {3.494642036476159*^9, 3.494642052472892*^9}, {
   3.494642117247903*^9, 3.494642212679941*^9}, {3.494642370344585*^9, 
   3.494642440147743*^9}, 3.4951261578591347`*^9, {3.495126555285227*^9, 
   3.4951265793379517`*^9}},ExpressionUUID->"cf29634a-91ee-4bda-9812-\
f9c7b40622fe"],

Cell[BoxData[
 RowBox[{"(", GridBox[{
    {"\"\<w\>\"", "\"\<x\>\"", "\"\<y\>\"", "\"\<z\>\""},
    {"3", "0", 
     RowBox[{"-", "1"}], "0"},
    {"8", "0", "0", 
     RowBox[{"-", "2"}]},
    {"0", "2", 
     RowBox[{"-", "2"}], 
     RowBox[{"-", "1"}]}
   }], ")"}]], "Input",
 CellChangeTimes->{{3.4946426951594963`*^9, 3.494642718084166*^9}, 
   3.495126157860796*^9},ExpressionUUID->"7d3001a2-b5b9-4e8d-89c2-\
72097cc05f5c"],

Cell[CellGroupData[{

Cell["Continuation by Anton", "Subsubsection",
 CellChangeTimes->{{3.495326178248753*^9, 3.4953261812618713`*^9}, {
  3.495326509364358*^9, 
  3.495326514525958*^9}},ExpressionUUID->"f3488825-84d7-45b0-94ee-\
3ecf43798a83"],

Cell[TextData[{
 "We have ",
 Cell[BoxData[
  FormBox["118", TraditionalForm]],ExpressionUUID->
  "d05f8abb-a51b-4a38-8ee8-39729d71f354"],
 " chemical elements with each element is associated an integer that is \
element's place in the Periodic table. (That coincides with its atomic \
number.) "
}], "Text",
 CellChangeTimes->{{3.497130958951172*^9, 3.497131027928117*^9}, {
  3.497131096856406*^9, 3.497131175975904*^9}, {3.497131226761054*^9, 
  3.497131255151965*^9}, {3.497131319410468*^9, 3.497131324992296*^9}, {
  3.497131465364436*^9, 3.4971315008484507`*^9}, {3.497131955040616*^9, 
  3.497131978937792*^9}, {3.497132053362199*^9, 3.497132150600257*^9}, {
  3.4971321862188*^9, 3.497132228943673*^9}, {3.49713235028511*^9, 
  3.497132370135668*^9}, {3.497132940812098*^9, 3.497133029183675*^9}, {
  3.497133231896028*^9, 
  3.497133237609159*^9}},ExpressionUUID->"90a265ff-a186-46ee-be5b-\
6cda4d686d65"],

Cell[TextData[{
 "Consider a linear vector space of dimension ",
 Cell[BoxData[
  FormBox["118", TraditionalForm]],ExpressionUUID->
  "35111ad5-0927-4f9c-b04d-154988867067"],
 " denoted as ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckCapitalR]", "118"], TraditionalForm]],
  ExpressionUUID->"8e04586a-a2fc-403f-a005-0389cff4769d"],
 ". With each element we associate a coordinate (or axis) in that vector \
space. With ",
 Cell[BoxData[
  FormBox[
   StyleBox["H",
    FontSlant->"Plain"], TraditionalForm]],ExpressionUUID->
  "64ebdfbd-bf84-4938-90bf-b084f22163f3"],
 " we associate the first coordinate, with ",
 Cell[BoxData[
  FormBox["He", TraditionalForm]],ExpressionUUID->
  "fa96cd69-c7c2-4b43-80fb-509d1f5ea37e"],
 " we associate the second, and so forth. We can say that the atomic number \
of the element ",
 Cell[BoxData[
  FormBox[
   StyleBox["el",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "1cf886db-4532-4545-be61-12b827362723"],
 " is the coordinate or axis to which ",
 Cell[BoxData[
  FormBox[
   StyleBox["el",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "0ecb21df-d65e-4ae4-856c-714fb116c21d"],
 " corresponds to."
}], "Text",
 CellChangeTimes->{{3.497133269968709*^9, 3.497133271199779*^9}, {
  3.497133335875113*^9, 3.497133367777815*^9}, {3.49713487300422*^9, 
  3.497134949312367*^9}, {3.497135512203601*^9, 3.497135521473041*^9}, {
  3.4971366570589*^9, 3.497136692520506*^9}, {3.497138109110694*^9, 
  3.4971381783153753`*^9}, {3.497138218827734*^9, 3.497138219865973*^9}, {
  3.497138252305688*^9, 3.497138410144906*^9}, {3.497138648763513*^9, 
  3.497138651658527*^9}, {3.497138714517292*^9, 3.497138716999054*^9}, {
  3.4971422271648397`*^9, 3.4971422420462723`*^9}, {3.497143563316724*^9, 
  3.49714356530619*^9}, {3.497143631338211*^9, 
  3.497143633353945*^9}},ExpressionUUID->"f738cd17-1566-400b-8cd7-\
78d82d320ae1"],

Cell[TextData[{
 "Each chemical compound ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],ExpressionUUID->
  "75b2b9f4-0ac6-4ec6-a7f7-78189a0ad04b"],
 " can be represented as a vector in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckCapitalR]", "118"], TraditionalForm]],
  ExpressionUUID->"be004676-2261-4885-8008-77e659f39a9c"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"v", "(", "c", ")"}], "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "118"]}], TraditionalForm]],
  ExpressionUUID->"2cf1a660-4c7f-43ae-a3e8-c8a06e9b3298"],
 ". If the compound has ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "i"], TraditionalForm]],ExpressionUUID->
  "4a91f9d1-420b-4c94-9685-08a48c6bff28"],
 " atoms of the ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "df84d396-0cbb-4bdc-a8f4-4d73a29c20f4"],
 "-th element (in the Periodic Table) then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"v", "(", "c", ")"}], "i"], "=", 
    SubscriptBox["n", "i"]}], TraditionalForm]],ExpressionUUID->
  "b7b5afb3-07f2-48fe-9aa9-cd6adda3daae"],
 ". For example, for the chemical compound ",
 Cell[BoxData[
  FormBox["C3H8O", TraditionalForm]],ExpressionUUID->
  "815904fa-b3c6-4173-9653-932a6d1a4d67"],
 " we have"
}], "Text",
 CellChangeTimes->{{3.49713843666825*^9, 3.497138440760583*^9}, {
  3.4971385357953978`*^9, 3.497138539073388*^9}, {3.497138722389475*^9, 
  3.497138743129739*^9}, {3.497139788294282*^9, 3.497139857308668*^9}, {
  3.497139895038623*^9, 3.497139963346484*^9}, {3.4971401399473133`*^9, 
  3.497140195042799*^9}, {3.497143570150659*^9, 
  3.4971435836673822`*^9}},ExpressionUUID->"9d526787-58fe-4f72-b348-\
eca0863dee1b"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"v", "(", "C3H8O", ")"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "8", ",", "0", ",", "0", ",", "0", ",", "0", ",", "3", ",", "0", ",", 
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "."}]}],
   TraditionalForm]], "Equation",
 CellChangeTimes->{{3.497140199034391*^9, 3.497140214267293*^9}, 
   3.4971403844292192`*^9, 
   3.4971405088647738`*^9},ExpressionUUID->"da3fe8dc-3865-4d09-87fd-\
21f53cfc34f0"],

Cell[TextData[{
 "In this example, we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"v", "(", "C3H8O", ")"}], "1"], "=", "8"}], TraditionalForm]],
  ExpressionUUID->"0bdf0c78-1fee-4215-ae1a-4d68662c6366"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"v", "(", "C3H8O", ")"}], "6"], "=", "3"}], TraditionalForm]],
  ExpressionUUID->"18d11ee5-077c-493c-8bfe-5f697a148e61"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"v", "(", "C3H8O", ")"}], "8"], "=", "1"}], TraditionalForm]],
  ExpressionUUID->"43a03d4e-7485-48a9-8cb5-94e086de2078"],
 ", because ",
 Cell[BoxData[
  FormBox[
   StyleBox["H",
    FontSlant->"Plain"], TraditionalForm]],ExpressionUUID->
  "1ed54fe6-9af8-489e-adab-5fed2979a6ce"],
 ", ",
 Cell[BoxData[
  FormBox[
   StyleBox["C",
    FontSlant->"Plain"], TraditionalForm]],ExpressionUUID->
  "6fcfa440-0a4b-4aab-810e-509f0bb491a1"],
 ", and ",
 Cell[BoxData[
  FormBox[
   StyleBox["O",
    FontSlant->"Plain"], TraditionalForm]],ExpressionUUID->
  "343c5e21-9ddd-49cc-9178-254d2fa20c51"],
 ", have the atomic numbers ",
 Cell[BoxData[
  FormBox["1", TraditionalForm]],ExpressionUUID->
  "df123ad5-45d9-436c-919d-ffb4a5ae86ff"],
 ", ",
 Cell[BoxData[
  FormBox["6", TraditionalForm]],ExpressionUUID->
  "2a522f36-d2c5-47ea-afb1-5f3ad44affdf"],
 ", and ",
 Cell[BoxData[
  FormBox["8", TraditionalForm]],ExpressionUUID->
  "59769caa-1b90-44c2-a0bb-163fd45dbd48"],
 " respectively. Note that if with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["e", "i"], "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "118"]}], TraditionalForm]],
  ExpressionUUID->"f2a17449-1905-4d6a-8865-9179fb6a82b5"],
 " we denote the unit basis vector along the ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "935e3172-a80f-4c80-b34e-36e4159a2e01"],
 "-th axis, then we can write ",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "(", "C3H8O", ")"}], TraditionalForm]],ExpressionUUID->
  "a05225a8-9d3e-43ba-b709-c2b7b77f8b54"],
 " as"
}], "Text",
 CellChangeTimes->{{3.497140544384528*^9, 3.497140707994096*^9}, 
   3.4971417742685757`*^9, {3.4971422149431963`*^9, 3.497142219233316*^9}, {
   3.497142263305715*^9, 3.4971423142335777`*^9}, {3.497142378146089*^9, 
   3.497142512850546*^9}, {3.497143091482328*^9, 3.4971430982366467`*^9}, {
   3.497143589076404*^9, 3.497143592949728*^9}, {3.497143786895542*^9, 
   3.497143788116037*^9}},ExpressionUUID->"91634801-143a-4b20-97e0-\
bfb5b0fbd885"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"v", "(", "C3H8O", ")"}], "=", 
   RowBox[{
    RowBox[{"8", " ", 
     SuperscriptBox["e", "1"]}], "+", 
    RowBox[{"3", 
     SuperscriptBox["e", "6"]}], "+", 
    RowBox[{"1", 
     RowBox[{
      SuperscriptBox["e", "8"], "."}]}]}]}], TraditionalForm]], "Equation",
 CellChangeTimes->{{3.497142471337797*^9, 3.497142488227069*^9}, {
  3.4971425211100903`*^9, 3.4971425660177813`*^9}, {3.497143101157228*^9, 
  3.497143113006188*^9}},ExpressionUUID->"5abe04af-8da0-46cd-9a21-\
2a7fc8db678c"],

Cell["\<\
As we can see from the example above, while balancing a chemical equation \
instead of using all chemical elements from the Periodic Table, we can use \
only the elements in that are present in the compounds forming the equation.\
\>", "Text",
 CellChangeTimes->{{3.49714072793427*^9, 3.497140738120974*^9}, {
   3.4971417632709417`*^9, 3.497141858433888*^9}, {3.4971419093166103`*^9, 
   3.4971419560894423`*^9}, {3.497142611558799*^9, 3.4971426350014*^9}, {
   3.4971435198061447`*^9, 3.497143554057231*^9}, 3.4971435977784643`*^9, 
   3.497143638693918*^9},ExpressionUUID->"6acbef31-62fb-4ac8-bb40-\
f2e4ecc216ba"],

Cell["Let use return to the equation ", "Text",
 CellChangeTimes->{{3.497141991881383*^9, 
  3.49714201323202*^9}},ExpressionUUID->"07b4ed6a-1871-4f00-b9fa-\
4754be988364"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"C3H8", " ", "+", " ", "O2"}], " ", "\[Rule]", " ", 
   RowBox[{"CO2", " ", "+", " ", 
    RowBox[{"H2O", "."}]}]}], TraditionalForm]], "Equation",
 CellChangeTimes->{{3.497141991881383*^9, 3.497142022253069*^9}, 
   3.497142588218602*^9},ExpressionUUID->"68149ee0-f3a1-46a7-98d4-\
ed50c6926d1d"],

Cell[TextData[{
 "Since this equation has three chemical elements, H, C, and O we can \
consider each term to be a vector in a linear vector space of dimension \
three, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckCapitalR]", "3"], TraditionalForm]],
  ExpressionUUID->"979d0e06-19ee-4c2e-94fc-4d05fbdf6377"],
 ", with basis vectors {1,0,0}, {0,1,0}, and {0,0,1} that correspond to H, C, \
and O respectively. Then the balancing problem is cast as:"
}], "Text",
 CellChangeTimes->{{3.495325090897067*^9, 3.4953252643414717`*^9}, {
   3.495325419445272*^9, 3.495325432445828*^9}, 3.495326754815296*^9, {
   3.497130951192706*^9, 3.497130954058371*^9}, {3.497142045694476*^9, 
   3.4971420957565603`*^9}, {3.4971431503337917`*^9, 
   3.497143170525758*^9}},ExpressionUUID->"c30b9616-757f-456c-a2f5-\
d9fc5e2c769c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"8"},
       {"3"},
       {"0"}
      }], "\[NoBreak]", ")"}]}], "+", 
   RowBox[{"x", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0"},
       {"0"},
       {"2"}
      }], "\[NoBreak]", ")"}]}]}], "=", 
  RowBox[{
   RowBox[{"y", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0"},
       {"1"},
       {"2"}
      }], "\[NoBreak]", ")"}]}], "+", 
   RowBox[{"z", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"2"},
       {"0"},
       {"1"}
      }], "\[NoBreak]", ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.4953246601108828`*^9, 3.4953248797126293`*^9}, 
   3.495325311421082*^9, {3.495326767473687*^9, 3.4953267723135157`*^9}, {
   3.49714210169489*^9, 
   3.497142120783032*^9}},ExpressionUUID->"6f26e688-2e4c-4ece-b393-\
7869332f189c"],

Cell["This equation can be also written in a matrix form:", "Text",
 CellChangeTimes->{{3.495325413330495*^9, 
  3.495325458157693*^9}},ExpressionUUID->"78d48388-3320-4b2f-8aec-\
1b80340fe111"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"8", "0", "0", 
        RowBox[{"-", "2"}]},
       {"3", "0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "2", 
        RowBox[{"-", "2"}], 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ".", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"w"},
       {"x"},
       {"y"},
       {"z"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], "==", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.4953246601108828`*^9, 3.4953248797126293`*^9}, {
   3.495324916508263*^9, 3.495325015023622*^9}, {3.495325586522521*^9, 
   3.495325587680881*^9}, {3.497142133327902*^9, 3.497142153063178*^9}, 
   3.497142185802884*^9},ExpressionUUID->"807a2ad0-430e-4632-940d-\
0a4a0177d649"],

Cell["\<\
There are several ways to solve that system of equations. First, because it \
is homogeneous we can just find the kernel (null space) of the matrix:\
\>", "Text",
 CellChangeTimes->{{3.495325486861349*^9, 3.4953254968771544`*^9}, {
  3.4953256275975657`*^9, 3.495325745989265*^9}, {3.495326219721349*^9, 
  3.4953262197234173`*^9}, {3.495326261717825*^9, 3.495326264845932*^9}, {
  3.495349991067896*^9, 3.495349991518626*^9}, {3.829576154741685*^9, 
  3.829576162358512*^9}},ExpressionUUID->"44ee6c0b-673f-4f45-864b-\
bfc24b2eb9d4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NullSpace", "[", 
  FormBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"8", "0", "0", 
       RowBox[{"-", "2"}]},
      {"3", "0", 
       RowBox[{"-", "1"}], "0"},
      {"0", "2", 
       RowBox[{"-", "2"}], 
       RowBox[{"-", "1"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   TraditionalForm], "]"}]], "Input",
 CellChangeTimes->{{3.495326221462964*^9, 3.4953262341100273`*^9}, {
  3.4971421650140057`*^9, 
  3.497142189312501*^9}},ExpressionUUID->"c9053bed-8e4a-4332-85b4-\
3a92e80ea6a5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1", ",", "5", ",", "3", ",", "4"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.495326235104903*^9, {3.497142168844062*^9, 3.497142189778921*^9}, 
   3.4971429781819677`*^9},ExpressionUUID->"edbd3796-b277-4fc2-b23c-\
c59b710bdc4e"]
}, Open  ]],

Cell["\<\
The kernel is of dimension one (it has only one basis vector). From this \
vector we get the solutions {x \[Rule] 5 w, y \[Rule] 3 w, z \[Rule] 4 w}.\
\>", "Text",
 CellChangeTimes->{{3.495326254280451*^9, 3.4953263262377157`*^9}, {
  3.4953263848506613`*^9, 
  3.495326388894285*^9}},ExpressionUUID->"6da7edc9-82b5-41f8-89aa-\
d55838c40816"],

Cell["Second, we can evaluate the equation symbolically and get", "Text",
 CellChangeTimes->{{3.495325486861349*^9, 3.4953254968771544`*^9}, {
   3.4953256275975657`*^9, 3.495325745989265*^9}, 3.495326219721349*^9, {
   3.495326779988635*^9, 3.495326780717699*^9}, {3.49532689371049*^9, 
   3.495326899982443*^9}},ExpressionUUID->"83ccca75-641f-4007-950e-\
e7d8eb01d60b"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{
        RowBox[{"8", " ", "w"}], "-", 
        RowBox[{"2", " ", "z"}]}]},
      {
       RowBox[{
        RowBox[{"3", " ", "w"}], "-", "y"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", 
        RowBox[{"2", " ", "y"}], "-", "z"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], "==", 
  FormBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   TraditionalForm]}]], "Input",
 CellChangeTimes->{{3.495325540364162*^9, 3.4953255927038*^9}, {
  3.497142867733725*^9, 
  3.497142881233199*^9}},ExpressionUUID->"8eedbb30-1e8d-4bf8-88cd-\
fbdd821ff0c2"],

Cell["The last expression if evaluated gives", "Text",
 CellChangeTimes->{{3.495325908797804*^9, 3.495325954901062*^9}, 
   3.829576440423321*^9},ExpressionUUID->"3815f431-efbd-413e-99c2-\
ecc0b23f1101"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"8", " ", "w"}], "-", 
      RowBox[{"2", " ", "z"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"3", " ", "w"}], "-", "y"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", " ", "x"}], "-", 
      RowBox[{"2", " ", "y"}], "-", "z"}], "}"}]}], "}"}], "\[Equal]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{
  3.497143033501067*^9},ExpressionUUID->"1f80c839-4d27-42c6-b98c-\
0c11fdadfb84"],

Cell[TextData[{
 "So we convert it to a proper system of equations using ",
 StyleBox["Thread", "Program"],
 " (",
 StyleBox["Flatten", "Program"],
 " is used to convert the matrices into vectors)."
}], "Text",
 CellChangeTimes->{{3.495325965024308*^9, 3.4953259825172157`*^9}, {
  3.496641531627426*^9, 3.49664159092841*^9}, {3.4966418540276814`*^9, 
  3.496641879576789*^9}},ExpressionUUID->"961052ac-5d54-47b0-a01b-\
b935cc67ce89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          RowBox[{"8", " ", "w"}], "-", 
          RowBox[{"2", " ", "z"}]}]},
        {
         RowBox[{
          RowBox[{"3", " ", "w"}], "-", "y"}]},
        {
         RowBox[{
          RowBox[{"2", " ", "x"}], "-", 
          RowBox[{"2", " ", "y"}], "-", "z"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], "]"}], "\[Equal]", 
   RowBox[{"Flatten", "[", 
    FormBox[
     RowBox[{"(", GridBox[{
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
     TraditionalForm], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.495325540364162*^9, 3.4953255927038*^9}, {
  3.4953257562692327`*^9, 3.495325901378994*^9}, {3.496641597043796*^9, 
  3.4966416053479633`*^9}, {3.4966416602312803`*^9, 3.496641702818591*^9}, {
  3.496641745924656*^9, 3.496641824164082*^9}, {3.497142895646418*^9, 
  3.497142901403607*^9}},ExpressionUUID->"3f0b0ed5-1766-4098-80e9-\
47d697516a1d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"8", " ", "w"}], "-", 
     RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "x"}], "-", 
     RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.496641824765815*^9, 
  3.497142901935061*^9},ExpressionUUID->"58100cfc-fc58-4f38-b1bf-\
785508e71cac"]
}, Open  ]],

Cell[TextData[{
 "The last system of equations can be solved using ",
 StyleBox["Solve", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.4953259887200413`*^9, 3.495326014598872*^9}, {
  3.495326082074316*^9, 
  3.495326086158249*^9}},ExpressionUUID->"d9ccdce8-a619-460e-a384-\
dca58c12ca35"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"8", " ", "w"}], "-", 
       RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "x"}], "-", 
       RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.495326024673387*^9, 3.495326048063389*^9}, {
  3.495326377457944*^9, 3.4953263935860167`*^9}, {3.4971429071780157`*^9, 
  3.49714291766374*^9}},ExpressionUUID->"ac50a8e7-834b-4b98-bf1d-\
5d4d5d5a2070"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"w", "\[Rule]", 
     FractionBox["z", "4"]}], ",", 
    RowBox[{"x", "\[Rule]", 
     FractionBox[
      RowBox[{"5", " ", "z"}], "4"]}], ",", 
    RowBox[{"y", "\[Rule]", 
     FractionBox[
      RowBox[{"3", " ", "z"}], "4"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.495326049354782*^9, {3.4953263783576107`*^9, 3.495326394425035*^9}, 
   3.4971429183772306`*^9},ExpressionUUID->"a9c32add-9a1e-4020-94f4-\
69c1073f7847"]
}, Open  ]],

Cell[TextData[{
 "or ",
 StyleBox["Reduce", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.4953260946926937`*^9, 
  3.495326100180023*^9}},ExpressionUUID->"20e3d37a-4369-4290-8842-\
f030ed3f11be"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"8", " ", "w"}], "-", 
       RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "x"}], "-", 
       RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.495326024673387*^9, 3.495326037823812*^9}, 
   3.496641502027357*^9, 3.4966419038756533`*^9, {3.4971429243844233`*^9, 
   3.497142925669776*^9}},ExpressionUUID->"40362be2-050b-467c-82b6-\
632f6138a566"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "\[Equal]", 
   RowBox[{"5", " ", "w"}]}], "&&", 
  RowBox[{"y", "\[Equal]", 
   RowBox[{"3", " ", "w"}]}], "&&", 
  RowBox[{"z", "\[Equal]", 
   RowBox[{"4", " ", "w"}]}]}]], "Output",
 CellChangeTimes->{{3.4953260317113953`*^9, 3.495326038389226*^9}, 
   3.496641502448237*^9, 3.496641904931367*^9, 
   3.497142926315628*^9},ExpressionUUID->"743df37f-730f-4bc7-9926-\
d3661a08d185"]
}, Open  ]],

Cell[TextData[{
 "Note that we want positive solutions, so ",
 StyleBox["Reduce", "Program"],
 " should be also given the inequalities"
}], "Text",
 CellChangeTimes->{{3.495326530922511*^9, 
  3.495326574301208*^9}},ExpressionUUID->"6369998a-ed3d-427f-9d50-\
895a71a5ebdd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"w", ">", "0"}], ",", 
   RowBox[{"x", ">", "0"}], ",", 
   RowBox[{"y", ">", "0"}], ",", 
   RowBox[{"z", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4953265924538307`*^9},ExpressionUUID->"c1c9be5a-bc67-48dd-950f-\
2646eb7d57b3"],

Cell["\<\
and that the solutions needed have to be integer, or in other words\
\>", "Text",
 CellChangeTimes->{{3.495326604430015*^9, 3.495326609669177*^9}, {
  3.496641248340918*^9, 3.496641272192546*^9}, {3.496641315161943*^9, 
  3.49664131750465*^9}},ExpressionUUID->"b1796a7c-a99f-41d2-a5dd-\
2c43634be4f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"8", " ", "w"}], "-", 
       RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "x"}], "-", 
       RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}], ",", 
     RowBox[{"w", " ", ">", " ", "0"}], ",", " ", 
     RowBox[{"x", " ", ">", " ", "0"}], ",", " ", 
     RowBox[{"y", " ", ">", " ", "0"}], ",", " ", 
     RowBox[{"z", " ", ">", " ", "0"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"w", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], "}"}], ",", 
   "Integers"}], "]"}]], "Input",
 CellChangeTimes->{{3.495326614687698*^9, 3.495326620325989*^9}, {
   3.496641274911212*^9, 3.4966412927592363`*^9}, 3.496641461248152*^9, {
   3.496641911380865*^9, 3.496641914128729*^9}, {3.49714293474622*^9, 
   3.497142939860717*^9}},ExpressionUUID->"9052ee31-bc36-494f-bf9b-\
05b2bec96a65"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}], "&&", 
  RowBox[{
   RowBox[{"C", "[", "1", "]"}], "\[GreaterEqual]", "1"}], "&&", 
  RowBox[{"w", "\[Equal]", 
   RowBox[{"C", "[", "1", "]"}]}], "&&", 
  RowBox[{"x", "\[Equal]", 
   RowBox[{"5", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}], "&&", 
  RowBox[{"y", "\[Equal]", 
   RowBox[{"3", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}], "&&", 
  RowBox[{"z", "\[Equal]", 
   RowBox[{"4", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}]}]], "Output",
 CellChangeTimes->{3.49664191564799*^9, 3.496641998809461*^9, 
  3.4971429413533983`*^9},ExpressionUUID->"fa195db5-046b-47c1-98c9-\
d8e966447dab"]
}, Open  ]],

Cell[TextData[{
 "We can format the last result into a more familiar outlook using the \
function ",
 StyleBox["TraditionalForm", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.496641922703821*^9, 
  3.496641992600595*^9}},ExpressionUUID->"c97a2b95-9855-40c6-9e27-\
79bc75d5a706"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.495326614687698*^9, 3.495326620325989*^9}, {
   3.496641274911212*^9, 3.4966412927592363`*^9}, 3.496641461248152*^9, {
   3.496641911380865*^9, 
   3.496641914128729*^9}},ExpressionUUID->"7a395717-b443-4d90-aaa7-\
b6b4d65a10dd"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TagBox["c",
      C], "1"], "\[Element]", 
    TagBox["\[DoubleStruckCapitalZ]",
     Function[{}, Integers]]}], "\[And]", 
   RowBox[{
    SubscriptBox[
     TagBox["c",
      C], "1"], "\[GreaterEqual]", "1"}], "\[And]", 
   RowBox[{"w", "\[LongEqual]", 
    SubscriptBox[
     TagBox["c",
      C], "1"]}], "\[And]", 
   RowBox[{"x", "\[LongEqual]", 
    RowBox[{"5", " ", 
     SubscriptBox[
      TagBox["c",
       C], "1"]}]}], "\[And]", 
   RowBox[{"y", "\[LongEqual]", 
    RowBox[{"3", " ", 
     SubscriptBox[
      TagBox["c",
       C], "1"]}]}], "\[And]", 
   RowBox[{"z", "\[LongEqual]", 
    RowBox[{"4", " ", 
     SubscriptBox[
      TagBox["c",
       C], "1"]}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.495326624160018*^9, {3.496641278733273*^9, 3.496641293064848*^9}, 
   3.496641461633294*^9, 3.496642000047843*^9, 
   3.497142945783224*^9},ExpressionUUID->"03d8f3f1-cf7e-4f9c-8a62-\
e469cbc9c150"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kristen version...", "Subsubsection",
 CellChangeTimes->{{3.495326188350217*^9, 
  3.495326197485298*^9}},ExpressionUUID->"9806ec4c-5f9e-4c81-bea5-\
896ad0b12918"],

Cell[TextData[{
 "We can make these equations more algebraically manageable by using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "'s RowReduce function to perform a Gauss-Jordan elimination:"
}], "Text",
 CellChangeTimes->{{3.4946425878292913`*^9, 3.494642658663433*^9}, 
   3.4951261578610687`*^9, {3.495126588871801*^9, 
   3.495126642206653*^9}},ExpressionUUID->"718766da-8163-4053-84fe-\
44ff9d2484f7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RowReduce", "[", "\.0b", "]"}], "//", "TraditionalForm"}]], "Input",\

 CellChangeTimes->{{3.494642100201024*^9, 3.4946421032492647`*^9}, {
   3.4946422267469587`*^9, 3.494642306747559*^9}, {3.4946424995089912`*^9, 
   3.494642509433515*^9}, {3.4946428997959642`*^9, 3.494642904684875*^9}, 
   3.495126157861597*^9, 
   3.495754909016815*^9},ExpressionUUID->"51943819-ea37-4151-9263-\
cd26114b5bcb"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "4"]}]},
     {"0", "1", "0", 
      RowBox[{"-", 
       FractionBox["5", "4"]}]},
     {"0", "0", "1", 
      RowBox[{"-", 
       FractionBox["3", "4"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.49464250235445*^9, 3.494642510546797*^9}, 
   3.494642905556234*^9, 
   3.495126157862254*^9},ExpressionUUID->"15aaab94-269e-46ab-ba64-\
db3706df0dd1"]
}, Open  ]],

Cell["Which we may also view as:", "Text",
 CellChangeTimes->{{3.49464280388708*^9, 3.494642807190391*^9}, 
   3.495126157875854*^9},ExpressionUUID->"c612fd56-ae51-4e19-85f2-\
9b9ebd6eec44"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"w", "0", "0", 
      FractionBox[
       RowBox[{"-", "z"}], "4"]},
     {"0", "x", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "5"}], "z"}], "4"]},
     {"0", "0", 
      RowBox[{"-", "y"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", "z"}], "4"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.4946428108935013`*^9, 3.494642851430152*^9}, {
   3.494642909092525*^9, 3.4946429194840384`*^9}, 
   3.495126157876498*^9},ExpressionUUID->"6293363c-fe0b-4213-a13d-\
a9f9123a5761"],

Cell["and obtain the following equations:", "Text",
 CellChangeTimes->{{3.494642741479595*^9, 3.494642780701583*^9}, {
   3.4946428570608883`*^9, 3.4946428733466873`*^9}, {3.494642970373604*^9, 
   3.4946429744932957`*^9}, 
   3.495126157876748*^9},ExpressionUUID->"5d5d53a7-ed78-4c53-b3e9-\
92d52b0d9e88"],

Cell[TextData[{
 "w = ",
 Cell[BoxData[
  FormBox[
   FractionBox["z", "4"], TraditionalForm]], "Input",
  CellChangeTimes->{{3.4946428108935013`*^9, 3.494642851430152*^9}, {
   3.494642909092525*^9, 3.4946429194840384`*^9}},ExpressionUUID->
  "8262386b-0903-4d5b-b785-0c5d56b3c063"],
 "; x = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"5", "z"}], "4"], ";", " ", 
    RowBox[{"y", " ", "=", " ", 
     FractionBox[
      RowBox[{"3", "z"}], "4"]}]}], TraditionalForm]],ExpressionUUID->
  "440405d2-7d17-4333-8b74-80708dfe7eff"],
 ";"
}], "Text",
 CellChangeTimes->{{3.494642980071198*^9, 3.494643094975648*^9}, 
   3.49512615787878*^9},ExpressionUUID->"0e64f84b-4395-470a-855f-\
2aed2fbcd4ff"],

Cell["\<\
Since the common denominator for all equations is 4, we set z = 4 and obtain \
1,5,3,4 as the stoichiometric coefficients.\
\>", "Text",
 CellChangeTimes->{{3.494643103445891*^9, 3.4946431591307907`*^9}, 
   3.495126157879467*^9},ExpressionUUID->"43929cf1-8261-40f6-a26c-\
a147988dc6f3"],

Cell[TextData[{
 "These equations can be solved in a single step using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " functions FindInstance or NullSpace:"
}], "Text",
 CellChangeTimes->{{3.495126708695456*^9, 
  3.495126734668157*^9}},ExpressionUUID->"956b9a05-b3ba-477b-b4dc-\
e59b45ae04d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindInstance", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "*", "3"}], "\[Equal]", "c"}], ",", 
     RowBox[{
      RowBox[{"a", "*", "8"}], "\[Equal]", 
      RowBox[{"d", "*", "2"}]}], ",", 
     RowBox[{
      RowBox[{"b", "*", "2"}], "\[Equal]", 
      RowBox[{
       RowBox[{"c", "*", "2"}], "+", "d"}]}], ",", 
     RowBox[{"a", ">", "0"}], ",", 
     RowBox[{"b", ">", "0"}], ",", 
     RowBox[{"c", ">", "0"}], ",", 
     RowBox[{"d", ">", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}]], "Input",Expr\
essionUUID->"d81070cd-33bf-4ed8-8237-8ca5b28a1efb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", "\[Rule]", "1"}], ",", 
    RowBox[{"b", "\[Rule]", "5"}], ",", 
    RowBox[{"c", "\[Rule]", "3"}], ",", 
    RowBox[{"d", "\[Rule]", "4"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.495126449645589*^9, 
  3.495126739876889*^9},ExpressionUUID->"9bc610af-11e0-46ba-965b-\
4c0e0e99d49c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NullSpace", "[", 
  RowBox[{"(", GridBox[{
     {"3", "0", 
      RowBox[{"-", "1"}], "0"},
     {"8", "0", "0", 
      RowBox[{"-", "2"}]},
     {"0", "2", 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "1"}]}
    }], ")"}], "]"}]], "Input",
 CellChangeTimes->{{3.495126755062339*^9, 
  3.4951267575904818`*^9}},ExpressionUUID->"734391a3-8378-431e-be9e-\
972c3e68734c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1", ",", "5", ",", "3", ",", "4"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.495126758457727*^9},ExpressionUUID->"781e4969-5f52-4c7f-9c55-\
451ab8d74b30"]
}, Open  ]],

Cell["\<\
Of course, prior to applying these functions we first must manipulate the \
data-structure of our parsed chemical equations to obtain either the \
appropriate matrix or system of linear equations.\
\>", "Text",
 CellChangeTimes->{{3.495126802613165*^9, 
  3.495126856353319*^9}},ExpressionUUID->"7258fb80-28fb-4595-8511-\
4225b64139fb"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Code",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.4971404770049877`*^9, 
  3.497140477544924*^9}},ExpressionUUID->"f69bcce8-ccb3-45b6-8d99-\
eff9075c24fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"elems", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ElementData", "[", 
      RowBox[{"#", ",", "\"\<Abbreviation\>\""}], "]"}], "&"}], "/@", 
    RowBox[{"ElementData", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemRules", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"elems", "\[Rule]", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "elems", "]"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.497130915986203*^9, 3.497130940649234*^9}, {
  3.49713136240198*^9, 3.497131386937686*^9}, {3.497132375621529*^9, 
  3.497132377060907*^9}, {3.497140221757139*^9, 
  3.497140256736519*^9}},ExpressionUUID->"db04f306-deb0-47e5-a704-\
1f2760ec9419"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReplacePart", "[", 
  RowBox[{
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "118"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\"\<C\>\"", "/.", "elemRules"}], ")"}], "\[Rule]", "3"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\"\<H\>\"", "/.", "elemRules"}], ")"}], "\[Rule]", "8"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\"\<O\>\"", "/.", "elemRules"}], ")"}], "\[Rule]", "1"}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.497140268951386*^9, 
  3.497140375852819*^9}},ExpressionUUID->"fcca520d-54bd-4732-98c1-\
9c08d40a6cea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "8", ",", "0", ",", "0", ",", "0", ",", "0", ",", "3", ",", "0", ",", "1", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.497140285974786*^9, 
  3.497140376378643*^9},ExpressionUUID->"a0c84e6c-f33a-4e3f-885b-\
f1d93303693e"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"First", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"8", "0", "0", 
           RowBox[{"-", "2"}]},
          {"3", "0", 
           RowBox[{"-", "1"}], "0"},
          {"0", "2", 
           RowBox[{"-", "2"}], 
           RowBox[{"-", "1"}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ".", 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"w"},
          {"x"},
          {"y"},
          {"z"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
      ")"}]}], "\[Equal]", 
    RowBox[{"First", "/@", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
   "]"}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.49714267817132*^9, 3.497142711811309*^9}, {
  3.497142786757299*^9, 
  3.4971428069689827`*^9}},ExpressionUUID->"18256079-05d4-484f-a6d6-\
ba76d11b84e7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"List", "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"8", " ", "w"}], "-", 
       RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "x"}], "-", 
       RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.497142838369095*^9, 
  3.4971428527489853`*^9}},ExpressionUUID->"5002538e-7b49-4087-9f68-\
26d88c6a0bcb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"8", " ", "w"}], "-", 
        RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", 
        RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.497142853277583*^9},ExpressionUUID->"b3bb0cea-c481-4dd7-a28c-\
fab1d653e12b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["From chemical equations to Diophantine equations", "Section",
 CellChangeTimes->{{3.495405212390325*^9, 3.495405250279579*^9}, 
   3.495421108175516*^9, 
   3.4958380602681847`*^9},ExpressionUUID->"82a1586e-4338-4376-81ae-\
b3b41b6f4bb0"],

Cell["\<\
In the previous chapter we developed a parser for chemical equations. \
\>", "Text",
 CellChangeTimes->{{3.49541672694154*^9, 3.495416744961958*^9}, {
   3.495416806969865*^9, 3.495416818386238*^9}, 
   3.690037648264978*^9},ExpressionUUID->"455b8702-2e2f-4cee-afca-\
9658a9c90bc6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", 
  RowBox[{"First", "@", 
   RowBox[{
   "ChemicalEquationParser", "[", "\"\<C3H8 + O2 \[Rule] CO2 + H2O\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495416835640905*^9, 3.495416853883771*^9}, {
  3.495417234462421*^9, 3.495417241388398*^9}, {3.495418132839121*^9, 
  3.495418145148471*^9}},ExpressionUUID->"354ef40d-910c-4fdc-8f02-\
2b7ea5bb172b"],

Cell[BoxData[
 RowBox[{"Equation", "[", 
  RowBox[{
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"C\"\>", ",", "3"}], "]"}], ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "8"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"O\"\>", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"C\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "2"}], "]"}], ",", "\<\"O\"\>"}], "]"}]}], 
    "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.4954168551199217`*^9, 3.4954171455810833`*^9, {3.495417236783175*^9, 
   3.495417241751844*^9}, 3.495417407147848*^9, 3.495418145782239*^9, 
   3.496095034742488*^9, 3.49659957115958*^9, 
   3.496600407227724*^9},ExpressionUUID->"f4432d65-be43-487a-9a1e-\
ea0ed46ab66d"]
}, Open  ]],

Cell[TextData[{
 "We also explained a function called ",
 StyleBox["MoleculeToAtoms", "Program"],
 " that gives the number of atoms for each element in a molecule. Using these \
functions we are going to construct symbolically the equations that have to \
be satisfied in order the law of conservation of  mass to be satisfied. "
}], "Text",
 CellChangeTimes->{{3.4954177212441874`*^9, 3.495417738810566*^9}, {
   3.495417874910048*^9, 3.495417940289591*^9}, {3.495417994641822*^9, 
   3.4954180002584133`*^9}, {3.495418044810351*^9, 3.495418106938589*^9}, 
   3.6900376527670527`*^9},ExpressionUUID->"3ad6fe09-81f8-4dd7-b62c-\
ec580f8b57c1"],

Cell["\<\
First, let us find (symbolically) all elements in the equation:\
\>", "Text",
 CellChangeTimes->{{3.495418110056603*^9, 3.4954181559622803`*^9}, {
  3.495418193725607*^9, 
  3.49541819856999*^9}},ExpressionUUID->"7419064b-c612-4769-af20-\
e5ed9f5dc284"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqElements", "=", 
  RowBox[{"Union", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{"eq", ",", "_String", ",", "\[Infinity]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.4954181576079817`*^9, 
  3.495418183196916*^9}},ExpressionUUID->"e38c40b0-a1b7-49e4-af2e-\
4b847a48a7b9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"O\"\>"}], "}"}]], "Output",\

 CellChangeTimes->{{3.495418178065284*^9, 3.4954181837656307`*^9}, 
   3.4960950366467133`*^9, 3.4965995726027327`*^9, 
   3.496600407423726*^9},ExpressionUUID->"9d625373-6090-4b69-83be-\
a7cdf5573a5a"]
}, Open  ]],

Cell[TextData[{
 "Now using the function ",
 StyleBox["MoleculeToAtoms", "Program"],
 " we can find the element break-down of each molecule on each side of the \
equation."
}], "Text",
 CellChangeTimes->{{3.49541821425664*^9, 3.4954182398422823`*^9}, {
  3.495418467004652*^9, 
  3.4954185012502537`*^9}},ExpressionUUID->"ddbe24a6-1045-4002-ac8a-\
1ea597ce440b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsElements", "=", 
  RowBox[{"MoleculeToAtoms", "/@", 
   RowBox[{"Apply", "[", 
    RowBox[{"List", ",", 
     RowBox[{"eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495418305948895*^9, 3.495418357323029*^9}, {
  3.495420630293433*^9, 
  3.495420635996826*^9}},ExpressionUUID->"091219aa-981d-4b9f-90ff-\
aab9e78e1398"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", "8"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"O\"\>", ",", "2"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.49541832918228*^9, 3.495418336451461*^9}, 
   3.495418369984632*^9, 3.4954206364679537`*^9, 3.495420977583152*^9, 
   3.496095037764824*^9, 3.496599575105858*^9, 
   3.496600407470512*^9},ExpressionUUID->"c02c2d4e-f3fd-4ba5-aa27-\
4e8e38760617"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhsElements", "=", 
  RowBox[{"MoleculeToAtoms", "/@", 
   RowBox[{"Apply", "[", 
    RowBox[{"List", ",", 
     RowBox[{"eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495418305948895*^9, 3.495418385869486*^9}, {
  3.495420643514264*^9, 
  3.4954206493823147`*^9}},ExpressionUUID->"35f773ff-8bf9-4412-8ce2-\
a236d13e3009"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.495418386033373*^9, 3.495420649799245*^9, 
  3.495420979083603*^9, 3.4960950395198708`*^9, 3.496599576693963*^9, 
  3.496600407520109*^9},ExpressionUUID->"9371766a-6497-4d3c-b3d6-\
8f4afe5852c6"]
}, Open  ]],

Cell[TextData[{
 "Now to/with each molecule-to-atoms break-down we associate an unknown \
coefficient. With the molecules on the LHS we associates ",
 StyleBox["x", "Program"],
 " variables, with the molecules on the RHS we associate ",
 StyleBox["y", "Program"],
 " variables."
}], "Text",
 CellChangeTimes->{{3.495418439757112*^9, 3.495418458634206*^9}, {
  3.4954185088963337`*^9, 3.4954185769216337`*^9}, {3.4954196830723553`*^9, 
  3.495419776266054*^9}},ExpressionUUID->"bc479e8a-339d-4ad1-982d-\
658d3f13601e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsVars", " ", "=", " ", 
  RowBox[{"ToExpression", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\"\<x\>\"", "<>", 
      RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", 
      RowBox[{"eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495419823361812*^9, 3.495419857821168*^9}, {
  3.495420116673645*^9, 3.4954201170148993`*^9}, {3.496600342580851*^9, 
  3.496600376139502*^9}},ExpressionUUID->"c32bae53-07aa-4b56-900b-\
d3f000ea126c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "x2"}], "}"}]], "Output",
 CellChangeTimes->{{3.4954198347826242`*^9, 3.495419859049403*^9}, 
   3.4954201178997993`*^9, {3.495420969085347*^9, 3.4954209802490883`*^9}, 
   3.496095040773307*^9, 3.496599579516121*^9, {3.496600367442556*^9, 
   3.4966003766634398`*^9}, 
   3.496600407587208*^9},ExpressionUUID->"2ecc3dcd-91ed-44bc-a2da-\
79f2431551c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhsVars", " ", "=", " ", 
  RowBox[{"ToExpression", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\"\<y\>\"", "<>", 
      RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", 
      RowBox[{"eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495419823361812*^9, 3.495419857821168*^9}, {
  3.495420116673645*^9, 3.4954201170148993`*^9}, {3.496600342580851*^9, 
  3.4966003986771603`*^9}},ExpressionUUID->"c497c9a9-9e7a-4da0-ab9a-\
a404134d74d9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"y1", ",", "y2"}], "}"}]], "Output",
 CellChangeTimes->{{3.496600388987144*^9, 
  3.496600407671636*^9}},ExpressionUUID->"35789e44-bb96-4f5a-aa37-\
18edc0b728b6"]
}, Open  ]],

Cell["\<\
Using these variable we multiply the number of atoms in the molecules on each \
side:\
\>", "Text",
 CellChangeTimes->{{3.495420416907255*^9, 
  3.495420463633919*^9}},ExpressionUUID->"3b16c327-e9c6-46ae-978e-\
45722892a15c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsElements", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "*", "#2"}]}],
        "}"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"lhsElements", ",", "lhsVars"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495420465545752*^9, 3.495420469873938*^9}, {
  3.49542051679699*^9, 3.49542062047856*^9}, {3.495420731021122*^9, 
  3.495420731414871*^9}, {3.495420765297761*^9, 
  3.4954207655593863`*^9}},ExpressionUUID->"e15f5315-f8ef-4bfb-ad34-\
7323ee726c7b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", 
       RowBox[{"3", " ", "x1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", 
       RowBox[{"8", " ", "x1"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"O\"\>", ",", 
      RowBox[{"2", " ", "x2"}]}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.495420593577929*^9, 3.495420621249489*^9}, 
   3.4954206530504293`*^9, 3.495420735866302*^9, {3.4954209620188017`*^9, 
   3.4954209826026373`*^9}, 3.496095043713204*^9, 3.496599583982019*^9, 
   3.49660040774734*^9},ExpressionUUID->"ed0c6cad-3588-4f01-a220-\
2ee674489034"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhsElements", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "*", "#2"}]}],
        "}"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"rhsElements", ",", "rhsVars"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495420465545752*^9, 3.495420469873938*^9}, {
   3.49542051679699*^9, 3.49542062047856*^9}, {3.495420655093485*^9, 
   3.4954206612306347`*^9}, 3.495420734183166*^9, {3.495420768512493*^9, 
   3.4954207717801323`*^9}},ExpressionUUID->"14a53998-e5c4-4032-bbd3-\
56a577fb7ba3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "y1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", 
       RowBox[{"2", " ", "y1"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", 
       RowBox[{"2", " ", "y2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", "y2"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.495420661685028*^9, 3.495420735150128*^9, 3.495420771999271*^9, {
   3.495420963084959*^9, 3.495420983849923*^9}, 3.496095044595851*^9, 
   3.496599585159093*^9, 
   3.496600407827383*^9},ExpressionUUID->"c3009d18-a6ed-4330-b53e-\
4c5cae416612"]
}, Open  ]],

Cell["\<\
Because of the law of conservation of mass for each element the number of \
atoms on LHS equals the number of atoms on the RHS. This means that\
\>", "Text",
 CellChangeTimes->{{3.49542027013306*^9, 3.49542030697044*^9}, {
  3.495420355258182*^9, 
  3.4954203857946672`*^9}},ExpressionUUID->"3177adf0-9d42-4423-bd6e-\
168be83d4966"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"massConservationEquations", "=", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Plus", ",", 
       RowBox[{"Cases", "[", 
        RowBox[{"lhsElements", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e", ",", "n_"}], "}"}], "\[RuleDelayed]", "n"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "==", 
     RowBox[{"Apply", "[", 
      RowBox[{"Plus", ",", 
       RowBox[{"Cases", "[", 
        RowBox[{"rhsElements", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e", ",", "n_"}], "}"}], "\[RuleDelayed]", "n"}], ",", 
         "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"e", ",", "eqElements"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495420778754594*^9, 3.495420868187973*^9}, {
  3.495420902647745*^9, 3.4954209585341463`*^9}, {3.495420996874688*^9, 
  3.4954210822627583`*^9}, {3.4954211283121023`*^9, 
  3.495421142836052*^9}},ExpressionUUID->"8a417056-9ec1-452b-8be7-\
553dc7a3e0da"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"3", " ", "x1"}], "\[Equal]", "y1"}], ",", 
   RowBox[{
    RowBox[{"8", " ", "x1"}], "\[Equal]", 
    RowBox[{"2", " ", "y2"}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x2"}], "\[Equal]", 
    RowBox[{
     RowBox[{"2", " ", "y1"}], "+", "y2"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.495420868601994*^9, {3.4954209157677927`*^9, 3.495421083015793*^9}, {
   3.4954211407353573`*^9, 3.495421143486823*^9}, 3.496095046100089*^9, 
   3.496599587579749*^9, 
   3.496600407913197*^9},ExpressionUUID->"6093e7f0-5a49-4218-ae50-\
16c11070a06b"]
}, Open  ]],

Cell["\<\
To these equations we add the requiredment the variables on to be greater \
than zero:\
\>", "Text",
 CellChangeTimes->{{3.495421147640998*^9, 
  3.4954211902346287`*^9}},ExpressionUUID->"f8d9af8e-7730-41f8-b8bf-\
b66ec2489c4a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"positivityOfMass", "=", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", ">", "0"}], "&"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{"lhsVars", ",", "rhsVars"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4954212017581453`*^9, 3.495421248285624*^9}, {
  3.4965999430613213`*^9, 3.49659994848275*^9}, {3.496600164014103*^9, 
  3.4966001679310083`*^9}},ExpressionUUID->"4b493439-dc75-429d-968b-\
a8118c8e9fb7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x1", ">", "0"}], ",", 
   RowBox[{"x2", ">", "0"}], ",", 
   RowBox[{"y1", ">", "0"}], ",", 
   RowBox[{"y2", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.495421225216002*^9, 3.495421249416527*^9}, 
   3.4960950476043663`*^9, 3.496599589602054*^9, 3.49660017031991*^9, 
   3.496600407990089*^9},ExpressionUUID->"5e954f5f-de5e-473e-a465-\
ad141a88fd02"]
}, Open  ]],

Cell["Finaly, we add the requirement the variables to be integer:", "Text",
 CellChangeTimes->{{3.496599960537601*^9, 
  3.4965999972733383`*^9}},ExpressionUUID->"8c48e19d-b2d0-4da4-9329-\
5b1671e49383"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integersNeeded", "=", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Element]", "Integers"}], "&"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{"lhsVars", ",", "rhsVars"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.496600004780957*^9, 3.496600050773039*^9}, {
  3.496600095282174*^9, 
  3.496600149963078*^9}},ExpressionUUID->"865e328a-9832-4f28-825c-\
8c7c23bb37a9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x1", "\[Element]", "Integers"}], ",", 
   RowBox[{"x2", "\[Element]", "Integers"}], ",", 
   RowBox[{"y1", "\[Element]", "Integers"}], ",", 
   RowBox[{"y2", "\[Element]", "Integers"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4966000523681107`*^9, {3.496600136218194*^9, 3.496600150676168*^9}, 
   3.4966004080636177`*^9},ExpressionUUID->"239b52a3-987c-4616-b533-\
ed77566828fc"]
}, Open  ]],

Cell["We have the system of linear Diophantine equations:", "Text",
 CellChangeTimes->{{3.4954212620076303`*^9, 3.495421285858735*^9}, {
   3.4965995205056477`*^9, 3.496599562233697*^9}, 3.4965997700902576`*^9, {
   3.496640827573894*^9, 
   3.496640852288423*^9}},ExpressionUUID->"9d507af3-3daf-4047-9779-\
779294e7f18c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Column", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
    "massConservationEquations", ",", "positivityOfMass", ",", " ", 
     "integersNeeded"}], "]"}], "]"}], "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.4966002138922777`*^9, 3.496600218578376*^9}, {
  3.496600435115163*^9, 3.496600705395866*^9}, {3.496600754418243*^9, 
  3.496600856260215*^9}},ExpressionUUID->"4d8ec97e-2347-4fdd-b206-\
34ddea0be799"],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"3", " ", "x1"}], "\[LongEqual]", "y1"}]},
     {
      RowBox[{
       RowBox[{"8", " ", "x1"}], "\[LongEqual]", 
       RowBox[{"2", " ", "y2"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "x2"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"2", " ", "y1"}], "+", "y2"}]}]},
     {
      RowBox[{"x1", ">", "0"}]},
     {
      RowBox[{"x2", ">", "0"}]},
     {
      RowBox[{"y1", ">", "0"}]},
     {
      RowBox[{"y2", ">", "0"}]},
     {
      RowBox[{"x1", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"x2", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"y1", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"y2", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{
  3.496600857454558*^9},ExpressionUUID->"c0007ab6-3636-4172-9174-\
e056f45e3449"],

Cell[TextData[{
 "We can solve that system using ",
 StyleBox["Reduce", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.49659977391887*^9, 3.496599791201297*^9}, {
  3.496599845809026*^9, 3.496599847417221*^9}, {3.496640713056571*^9, 
  3.4966407134648867`*^9}, {3.496640863348989*^9, 
  3.4966408692327147`*^9}},ExpressionUUID->"d14e1237-1eb4-430f-9d11-\
81e02b548c4a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
    "massConservationEquations", ",", "positivityOfMass", ",", 
     "integersNeeded"}], "]"}], ",", 
   RowBox[{"Join", "[", 
    RowBox[{"lhsVars", ",", "rhsVars"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.495421292787361*^9, 3.4954213290455217`*^9}, {
  3.496599762332799*^9, 3.496599765491088*^9}, {3.496600183592149*^9, 
  3.4966001931561213`*^9}},ExpressionUUID->"a5be5c1a-2067-4d57-af32-\
751e0d03dd38"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}], "&&", 
  RowBox[{
   RowBox[{"C", "[", "1", "]"}], "\[GreaterEqual]", "1"}], "&&", 
  RowBox[{"x1", "\[Equal]", 
   RowBox[{"C", "[", "1", "]"}]}], "&&", 
  RowBox[{"x2", "\[Equal]", 
   RowBox[{"5", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}], "&&", 
  RowBox[{"y1", "\[Equal]", 
   RowBox[{"3", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}], "&&", 
  RowBox[{"y2", "\[Equal]", 
   RowBox[{"4", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.495421329862859*^9, 3.496095050020131*^9, 3.496599594195408*^9, 
   3.49659979893467*^9, {3.4966001903509407`*^9, 3.4966001940754957`*^9}, 
   3.496600408209393*^9},ExpressionUUID->"7d753f38-eb67-48e9-a3ce-\
dbb3fca728d6"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Reduce", "Program"],
 " would return not one but a family of solutions, that is why we can use ",
 StyleBox["FindInstance", "Program"],
 " which will produce only one solution."
}], "Text",
 CellChangeTimes->{{3.495421346324171*^9, 3.495421404658679*^9}, {
  3.4965998823134537`*^9, 
  3.4965998860608473`*^9}},ExpressionUUID->"93027a4d-a60d-4aeb-8607-\
cc8b74769573"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"First", "@", 
   RowBox[{"FindInstance", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"massConservationEquations", ",", "positivityOfMass"}], "]"}], 
     ",", 
     RowBox[{"Join", "[", 
      RowBox[{"lhsVars", ",", "rhsVars"}], "]"}], ",", "Integers"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495421292787361*^9, 3.4954213290455217`*^9}, {
  3.495421406998412*^9, 3.495421414501018*^9}, {3.495421533057827*^9, 
  3.495421535949613*^9}, {3.496599813549547*^9, 
  3.496599861308826*^9}},ExpressionUUID->"c330e482-d311-4721-b1d1-\
def7291a4edc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x1", "\[Rule]", "2"}], ",", 
   RowBox[{"x2", "\[Rule]", "10"}], ",", 
   RowBox[{"y1", "\[Rule]", "6"}], ",", 
   RowBox[{"y2", "\[Rule]", "8"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.495421415572214*^9, 3.495421536466007*^9, 3.496095050850281*^9, {
   3.496599817403079*^9, 3.496599830449354*^9}, 3.496599862165299*^9, 
   3.496600408408493*^9},ExpressionUUID->"f1775fb5-bd44-41fb-a558-\
32281ff7b1f3"]
}, Open  ]],

Cell["\<\
Now we need to place the balancing coefficients found in the original \
equation.\
\>", "Text",
 CellChangeTimes->{{3.495421482139614*^9, 
  3.495421522396523*^9}},ExpressionUUID->"fe6ef834-9ee1-4ac7-ba04-\
c23d5f690a6a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "@", 
  RowBox[{"Riffle", "[", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "#1", "]"}], "<>", 
        RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lhsVars", "/.", "sol"}], ",", 
        RowBox[{"List", "@@", 
         RowBox[{
         "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
       "}"}]}], "]"}], ",", "\"\<+\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495421581052917*^9, 
  3.495421738837151*^9}},ExpressionUUID->"d5b94b18-3bdf-4a03-9d7d-\
28615b90e386"],

Cell[BoxData["\<\"2C3H8+10O2\"\>"], "Output",
 CellChangeTimes->{{3.495421586418426*^9, 3.4954216373687468`*^9}, 
   3.495421703718257*^9, 3.495421739935006*^9, 3.49609505306262*^9, 
   3.496599864884748*^9, 
   3.496600408477839*^9},ExpressionUUID->"58ce1fed-acd7-45a3-97e7-\
c7bc00f935c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "@", 
  RowBox[{"Riffle", "[", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "#1", "]"}], "<>", 
        RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rhsVars", "/.", "sol"}], ",", 
        RowBox[{"List", "@@", 
         RowBox[{
         "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       "}"}]}], "]"}], ",", "\"\<+\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495421581052917*^9, 
  3.495421749700992*^9}},ExpressionUUID->"3f254165-d4ba-42a9-8d2a-\
82b6c2a79a8b"],

Cell[BoxData["\<\"6CO2+8H2O\"\>"], "Output",
 CellChangeTimes->{3.495421749899062*^9, 3.496095053899395*^9, 
  3.496599865722805*^9, 
  3.49660040855505*^9},ExpressionUUID->"e6152984-ecd4-4dd8-a4a0-6ac0005f3b63"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "[", 
  RowBox[{"%%", ",", "\"\<->\>\"", ",", "%"}], "]"}]], "Input",
 CellChangeTimes->{{3.4954217575577583`*^9, 
  3.495421775180483*^9}},ExpressionUUID->"0b5c6253-3e94-41cc-ade4-\
f55e091e417d"],

Cell[BoxData["\<\"2C3H8+10O2->6CO2+8H2O\"\>"], "Output",
 CellChangeTimes->{3.495421775734027*^9, 3.496095055193503*^9, 
  3.496599866337627*^9, 
  3.496600408649581*^9},ExpressionUUID->"99fca75f-e437-4ef2-8e6c-\
8dc65e23ff82"]
}, Open  ]],

Cell["\<\
In the following sub-section we are going to encapsulate the steps above into \
a equation balancing function.\
\>", "Text",
 CellChangeTimes->{{3.495421949557976*^9, 
  3.495421990954748*^9}},ExpressionUUID->"591ca1d0-0ff6-489e-9b4b-\
4a160c6f671e"],

Cell[CellGroupData[{

Cell["Definition of BalanceEquation", "Subsection",
 CellChangeTimes->{{3.495495325467733*^9, 
  3.495495365471527*^9}},ExpressionUUID->"7a0b4b81-9fd6-46fc-9433-\
aab742ba1d44"],

Cell["\<\
In this definition if the non-integer solutions are turned into integer ones \
by finding the Least Common Multiplier (LCM) of the denominators of the \
coefficients found.\
\>", "Text",
 CellChangeTimes->{{3.495422036567007*^9, 3.4954220860194197`*^9}, {
  3.496097432800542*^9, 3.496097451667461*^9}, {3.496097532045644*^9, 
  3.496097553939334*^9}, {3.496097960727977*^9, 3.496097976291526*^9}, {
  3.496098159191964*^9, 3.496098249643773*^9}, {3.4960982861280518`*^9, 
  3.496098305339786*^9}},ExpressionUUID->"1a23ecb5-e484-41a3-b7e0-\
7767f7952f01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "FormBalancedEquation", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormBalancedEquation", "[", 
    RowBox[{"eq_", ",", "solRules_", ",", "lhsVars_", ",", "rhsVars_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t1", ",", "t2"}], "}"}], ",", 
     RowBox[{
      RowBox[{"t1", "=", 
       RowBox[{"StringJoin", "@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#1", "\[Equal]", "1"}], ",", "\"\<\>\"", ",", 
                RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
              RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"lhsVars", "/.", "solRules"}], ",", 
              RowBox[{"List", "@@", 
               RowBox[{
               "eq", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
          "\"\< + \>\""}], "]"}]}]}], ";", 
      RowBox[{"t2", "=", 
       RowBox[{"StringJoin", "@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#1", "==", "1"}], ",", "\"\<\>\"", ",", 
                RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
              RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"rhsVars", "/.", "solRules"}], ",", 
              RowBox[{"List", "@@", 
               RowBox[{
               "eq", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
          "\"\< + \>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"t1", ",", "\"\< \[Rule] \>\"", ",", "t2"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4989357345957003`*^9, 3.498935820581505*^9}, {
  3.4989359782568617`*^9, 
  3.4989359876537943`*^9}},ExpressionUUID->"2b3d8228-dc14-4880-9f14-\
9a3711d2ea2b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "BalanceEquation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BalanceEquation", "[", 
    RowBox[{"eqStr_String", ",", 
     RowBox[{"nInstances_Integer", ":", "1"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eq", ",", "eqElements", ",", "lhsElements", ",", "rhsElements", ",", 
       "lhsVars", ",", "rhsVars", ",", "x", ",", "y", ",", 
       "massConservationEquations", ",", "positivityOfMass", ",", "sol", ",", 
       "t1", ",", "t2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eq", "=", 
       RowBox[{"First", "@", 
        RowBox[{"ChemicalEquationParser", "[", "eqStr", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eqElements", "=", 
       RowBox[{"Union", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"eq", ",", "_String", ",", "\[Infinity]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lhsElements", "=", 
       RowBox[{"MoleculeToAtoms", "/@", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], ";", 
      RowBox[{"rhsElements", "=", 
       RowBox[{"MoleculeToAtoms", "/@", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lhsVars", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Length", "[", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhsVars", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{"y", ",", " ", 
         RowBox[{"Length", "[", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lhsElements", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#1", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"#1", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
              "#2"}]}], "}"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"lhsElements", ",", "lhsVars"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rhsElements", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#1", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"#1", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
              "#2"}]}], "}"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"rhsElements", ",", "rhsVars"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"massConservationEquations", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Plus", ",", 
            RowBox[{"Cases", "[", 
             RowBox[{"lhsElements", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"e", ",", "n_"}], "}"}], "\[RuleDelayed]", "n"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "==", 
          RowBox[{"Apply", "[", 
           RowBox[{"Plus", ",", 
            RowBox[{"Cases", "[", 
             RowBox[{"rhsElements", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"e", ",", "n_"}], "}"}], "\[RuleDelayed]", "n"}], ",",
               "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"e", ",", "eqElements"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"positivityOfMass", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"lhsVars", ">", "0"}], "]"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"rhsVars", ">", "0"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"FindInstance", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"massConservationEquations", ",", "positivityOfMass"}], 
          "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{"lhsVars", ",", "rhsVars"}], "]"}], ",", "nInstances"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sol", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LCM", "@@", 
            RowBox[{"Denominator", "/@", 
             RowBox[{"sol", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "All", ",", "2"}], 
              "\[RightDoubleBracket]"}]}]}], ")"}], "*", 
          RowBox[{"sol", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}]}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "sol", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FormBalancedEquation", "[", 
         RowBox[{"eq", ",", "#", ",", "lhsVars", ",", "rhsVars"}], "]"}], 
        "&"}], "/@", "sol"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4960954824045773`*^9, 3.496095508795272*^9}, {
   3.496095807549089*^9, 3.49609583649327*^9}, {3.496095960941073*^9, 
   3.496095979918174*^9}, {3.496096021168044*^9, 3.496096040670946*^9}, {
   3.496096312090186*^9, 3.496096419911319*^9}, {3.496096527069859*^9, 
   3.496096592005118*^9}, {3.496096829587666*^9, 3.496096834630939*^9}, {
   3.496097010650621*^9, 3.496097076056238*^9}, {3.496097131115601*^9, 
   3.496097203827115*^9}, {3.496097803574456*^9, 3.496097810833424*^9}, {
   3.49893557494065*^9, 3.49893571338476*^9}, 3.498935767494238*^9, {
   3.498935835672823*^9, 3.4989358582630568`*^9}, {3.4989359006404743`*^9, 
   3.4989359169240437`*^9}, 3.498935961423913*^9, {3.49893612764958*^9, 
   3.498936174304598*^9}},ExpressionUUID->"a1fb691c-22b1-44d6-8977-\
2c2c5e4c27a9"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.496096467103195*^9, 
  3.496096474419446*^9}},ExpressionUUID->"45270eff-3809-4935-ad52-\
c909424f0a23"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<C3H8 + O2 \[Rule] CO2 + H2O\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 
  3.496096503821725*^9}},ExpressionUUID->"3d2c5e9e-1114-47d4-8d00-\
ffbff0c8400c"],

Cell[BoxData["\<\"C3H8 + 5O2 \[Rule] 3CO2 + 4H2O\"\>"], "Output",
 CellChangeTimes->{
  3.49609650457718*^9, {3.49609658022738*^9, 3.496096597096369*^9}, 
   3.4960967656115503`*^9, 3.496097209372184*^9, 3.4960978150947237`*^9, 
   3.4966004087752542`*^9, 
   3.498142730221587*^9},ExpressionUUID->"0693e4e7-c4d0-4212-851c-\
4eb33cf86940"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<HCl + CaCO3 \[Rule] CaCl2 + H2CO3\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}, 
   3.496096622809504*^9, {3.496096691320332*^9, 
   3.496096733869132*^9}},ExpressionUUID->"cef793ee-9e50-4a25-a73a-\
bdfe84668688"],

Cell[BoxData["\<\"2HCl + CaCO3 \[Rule] CaCl2 + H2CO3\"\>"], "Output",
 CellChangeTimes->{{3.4960967383914843`*^9, 3.4960967667158537`*^9}, 
   3.4960968373514767`*^9, 3.496097080250703*^9, 3.4960971262343597`*^9, 
   3.496097205579286*^9, 3.4960978139305573`*^9, 
   3.496600408838656*^9},ExpressionUUID->"745d3128-9ba0-4087-91be-\
3947420c4c06"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<C6H12O6 \[Rule] CO2 + C2H5OH\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}, 
   3.496096622809504*^9, {3.496096691320332*^9, 3.496096733869132*^9}, 
   3.4960976497132607`*^9, {3.4960976909062147`*^9, 
   3.496097728677278*^9}},ExpressionUUID->"954fc7f1-03a1-4c04-86c0-\
d4b7acc56d84"],

Cell[BoxData["\<\"C6H12O6 \[Rule] 2CO2 + 2C2H5OH\"\>"], "Output",
 CellChangeTimes->{3.496097729128039*^9, 3.496097816853401*^9, 
  3.4966004089049587`*^9},ExpressionUUID->"1a8a16a7-c6c5-4f3b-82aa-\
9d8b0fc04711"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix method", "Section",
 CellChangeTimes->{{3.494366504100418*^9, 
  3.494366516252037*^9}},ExpressionUUID->"9072534a-8e4b-49f8-ba0a-\
925be6525c12"],

Cell["\<\
We are going to repeat some of derivations in the previous section.\
\>", "Text",
 CellChangeTimes->{{3.495421576838735*^9, 3.495421578340529*^9}, {
  3.495494672419786*^9, 3.495494693898367*^9}, {3.495495302034006*^9, 
  3.495495312614584*^9}},ExpressionUUID->"cbf0fef4-8d80-4755-a488-\
29a950f3bc10"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", 
  RowBox[{"First", "@", 
   RowBox[{
   "ChemicalEquationParser", "[", "\"\<C3H8 + O2 \[Rule] CO2 + H2O\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495416835640905*^9, 3.495416853883771*^9}, {
  3.495417234462421*^9, 3.495417241388398*^9}, {3.495418132839121*^9, 
  3.495418145148471*^9}},ExpressionUUID->"2f5582f8-e5f1-4202-8fb3-\
f90e091a8810"],

Cell[BoxData[
 RowBox[{"Equation", "[", 
  RowBox[{
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"C\"\>", ",", "3"}], "]"}], ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "8"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"O\"\>", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"C\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "2"}], "]"}], ",", "\<\"O\"\>"}], "]"}]}], 
    "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.4954168551199217`*^9, 3.4954171455810833`*^9, {3.495417236783175*^9, 
   3.495417241751844*^9}, 3.495417407147848*^9, 3.495418145782239*^9, 
   3.495495396797106*^9, 3.4965649667750263`*^9, 
   3.498142788071718*^9},ExpressionUUID->"b513076d-6ce1-4bae-974f-\
ec44499abda5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", 
  RowBox[{"First", "@", 
   RowBox[{
   "ChemicalEquationParser", "[", "\"\<H20+C2O4+MnO4=MnO2+CO2+OH\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.498129160468346*^9},ExpressionUUID->"2853b0fe-b33d-4f6b-b894-\
cfaa9b0b95db"],

Cell[BoxData[
 RowBox[{"Equation", "[", 
  RowBox[{
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"H\"\>", ",", "20"}], "]"}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"C\"\>", ",", "2"}], "]"}], ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "4"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Mn\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "4"}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Mn\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"C\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"O\"\>", ",", "\<\"H\"\>"}], "]"}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.498129161020534*^9},ExpressionUUID->"2036ac1a-c67c-48d8-a851-\
ccccfe97f3c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", 
  RowBox[{"First", "@", 
   RowBox[{
   "ChemicalEquationParser", "[", "\"\<SiH4 + O2 + H2 -> SiO2 + H2O\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.498140298449381*^9, 
  3.49814030115057*^9}},ExpressionUUID->"36dc80cb-06df-4c83-85d8-\
35fe09b46477"],

Cell[BoxData[
 RowBox[{"Equation", "[", 
  RowBox[{
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Si\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "4"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"O\"\>", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"H\"\>", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Si\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "2"}], "]"}], ",", "\<\"O\"\>"}], "]"}]}], 
    "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.498140301639464*^9},ExpressionUUID->"b31494bf-101b-44f1-b59e-\
342813e0485d"]
}, Open  ]],

Cell[TextData[{
 "We also explained a function called ",
 StyleBox["MoleculeToAtoms", "Program"],
 " that gives the number of atoms for each element in a molecule. Using these \
functions we are going to construct symbolically the equations that have to \
be satisfied in order the law of conservation of  mass to be satisfiied. "
}], "Text",
 CellChangeTimes->{{3.4954177212441874`*^9, 3.495417738810566*^9}, {
  3.495417874910048*^9, 3.495417940289591*^9}, {3.495417994641822*^9, 
  3.4954180002584133`*^9}, {3.495418044810351*^9, 
  3.495418106938589*^9}},ExpressionUUID->"c6adc263-c786-4492-bc54-\
7d4fc787e02f"],

Cell["\<\
First, let us find (symbolically) all elements in the equation:\
\>", "Text",
 CellChangeTimes->{{3.495418110056603*^9, 3.4954181559622803`*^9}, {
  3.495418193725607*^9, 
  3.49541819856999*^9}},ExpressionUUID->"684b5f06-ab72-4f14-861e-\
12bf8dc6662c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqElements", "=", 
  RowBox[{"Union", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{"eq", ",", "_String", ",", "\[Infinity]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.4954181576079817`*^9, 
  3.495418183196916*^9}},ExpressionUUID->"1c1eb402-307b-4f32-b38b-\
b12964e6d843"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"O\"\>"}], "}"}]], "Output",\

 CellChangeTimes->{{3.495418178065284*^9, 3.4954181837656307`*^9}, 
   3.498129163732888*^9, 3.498140303710039*^9, 
   3.4981427904007483`*^9},ExpressionUUID->"ea5ea387-2054-435b-b08e-\
4dade1a8e332"]
}, Open  ]],

Cell[TextData[{
 "Now using the function ",
 StyleBox["MoleculeToAtoms", "Program"],
 " we can find the element break-down of each molecule on each side of the \
equation."
}], "Text",
 CellChangeTimes->{{3.49541821425664*^9, 3.4954182398422823`*^9}, {
  3.495418467004652*^9, 
  3.4954185012502537`*^9}},ExpressionUUID->"f3dcf319-610a-471c-9327-\
7b04ba6429a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsElements", "=", 
  RowBox[{"MoleculeToAtoms", "/@", 
   RowBox[{"Apply", "[", 
    RowBox[{"List", ",", 
     RowBox[{"eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495418305948895*^9, 3.495418357323029*^9}, {
  3.495420630293433*^9, 
  3.495420635996826*^9}},ExpressionUUID->"56f622b3-ac83-4865-8796-\
17f9835e2285"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", "8"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"O\"\>", ",", "2"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.49541832918228*^9, 3.495418336451461*^9}, 
   3.495418369984632*^9, 3.4954206364679537`*^9, 3.495420977583152*^9, 
   3.49549561056009*^9, 3.498129166082026*^9, 3.498140305516716*^9, {
   3.4981427638643627`*^9, 
   3.498142791583263*^9}},ExpressionUUID->"8c37788e-f490-4105-b617-\
4c7b5ea48259"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhsElements", "=", 
  RowBox[{"MoleculeToAtoms", "/@", 
   RowBox[{"Apply", "[", 
    RowBox[{"List", ",", 
     RowBox[{"eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.4954954786335793`*^9, 
  3.495495484329453*^9}},ExpressionUUID->"a8a20d2a-0560-42ac-95bf-\
d53e0ca11ac2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.495495484644*^9, 3.4954956118798447`*^9, 
  3.498129166734185*^9, 3.498140307697613*^9, 
  3.4981427925343513`*^9},ExpressionUUID->"2e0e24d1-688f-4d7c-b063-\
178036cd3b9b"]
}, Open  ]],

Cell["Let us convert the sides ", "Text",
 CellChangeTimes->{{3.495495500167162*^9, 
  3.495495511158165*^9}},ExpressionUUID->"9bcf6369-c804-49d5-abb1-\
125c1d6c2feb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsElements", "=", 
  RowBox[{"lhsElements", "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"eqElements", "\[Rule]", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495495551276478*^9, 3.4954956054388237`*^9}, {
  3.495495724641716*^9, 
  3.495495725017829*^9}},ExpressionUUID->"e4f4a1f1-9162-4ce5-8777-\
7c04c3e0628e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "8"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.495495606351377*^9, 3.495495613192547*^9}, 
   3.4954957263214083`*^9, 3.498129168196216*^9, 3.4981403096512136`*^9, {
   3.498142777582094*^9, 
   3.4981427946145887`*^9}},ExpressionUUID->"9df9917e-4461-408c-9ebc-\
226933efcc1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhsElements", "=", 
  RowBox[{"rhsElements", "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"eqElements", "\[Rule]", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495495551276478*^9, 3.4954956054388237`*^9}, {
  3.495495724641716*^9, 3.495495725017829*^9}, {3.495495866775941*^9, 
  3.4954958727428083`*^9}},ExpressionUUID->"6c895885-8775-41fb-8285-\
821df7efc89f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.495495877329627*^9, 3.498129169296269*^9, 3.4981403109319057`*^9, {
   3.498142778231637*^9, 
   3.498142795598016*^9}},ExpressionUUID->"b7eff859-bd94-4866-ab9a-\
3c7f42a414c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"zeroVector", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"lhsMat", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"zeroVector", ",", 
       RowBox[{"Rule", "@@@", "#"}]}], "]"}], "&"}], ",", "lhsElements"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rhsMat", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"zeroVector", ",", 
       RowBox[{"Rule", "@@@", "#"}]}], "]"}], "&"}], ",", "rhsElements"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.495495676473526*^9, 3.495495818849799*^9}, {
  3.495495849017317*^9, 
  3.495495864505928*^9}},ExpressionUUID->"93b8738b-6f25-47be-b026-\
2143ecba0479"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4954957140729218`*^9, 3.495495728002872*^9}, 
   3.495495821992504*^9, 3.495495878959988*^9, 3.4981291706682367`*^9, 
   3.498140312400374*^9, {3.498142778817659*^9, 
   3.498142797023776*^9}},ExpressionUUID->"631f6531-93e6-4cc0-8dbc-\
6d6be27e5f56"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4954957140729218`*^9, 3.495495728002872*^9}, 
   3.495495821992504*^9, 3.495495878959988*^9, 3.4981291706682367`*^9, 
   3.498140312400374*^9, {3.498142778817659*^9, 
   3.498142797028288*^9}},ExpressionUUID->"a5c5c033-4657-444e-998d-\
b22a424ef344"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"lhsMat", ",", 
      RowBox[{"-", "rhsMat"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.495495922019548*^9, 
  3.495495964608276*^9}},ExpressionUUID->"0a09124a-bc58-42a4-a960-\
552db1c77c1b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3", "0", 
      RowBox[{"-", "1"}], "0"},
     {"8", "0", "0", 
      RowBox[{"-", "2"}]},
     {"0", "2", 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.49549594370861*^9, 3.4954959652290077`*^9}, 
   3.498129174650301*^9, 3.4981403134342937`*^9, 
   3.498142798400269*^9},ExpressionUUID->"b2209815-50d1-46df-a1fb-\
e430b2e96d0e"]
}, Open  ]],

Cell[TextData[{
 "We can obtain the space of solutions using ",
 StyleBox["NullSpace", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.495496108151918*^9, 
  3.495496161203802*^9}},ExpressionUUID->"84a36b22-22e0-4c5b-9ddb-\
ee71ce1748c8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sols", "=", 
  RowBox[{"NullSpace", "[", "mat", "]"}]}]], "Input",
 CellChangeTimes->{{3.4954959707532587`*^9, 3.495495974545376*^9}, {
  3.495496272503681*^9, 
  3.4954962761218767`*^9}},ExpressionUUID->"73fd8777-9078-48b0-8803-\
c830983508d6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1", ",", "5", ",", "3", ",", "4"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.49549597486364*^9, 3.495496277859447*^9, {3.4981291775886307`*^9, 
   3.498129200213973*^9}, 3.498140316016857*^9, 3.498141799633803*^9, 
   3.498142799882223*^9},ExpressionUUID->"4d6f53b4-b5d9-4c0d-a792-\
2a08f6833ac3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ToString", "[", "#1", "]"}], "<>", 
     RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        ",", 
       RowBox[{"Length", "[", 
        RowBox[{"eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], "]"}], ",", 
     RowBox[{"List", "@@", 
      RowBox[{
      "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.495496285648231*^9, 3.495496452800445*^9}, {
  3.498129272687306*^9, 
  3.498129274139357*^9}},ExpressionUUID->"a28f59d2-5e09-4f57-a4bd-\
0f9c871511a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"1H20\"\>", ",", "\<\"0C2O4\"\>", ",", "\<\"10MnO4\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.495496308874506*^9, 3.495496376680428*^9}, 
   3.495496453387167*^9, 3.4981291870160217`*^9, 3.4981292325805073`*^9, 
   3.498129274865857*^9},ExpressionUUID->"39ce559f-b197-4562-9dd5-\
80d8a0bf0296"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.495496531326077*^9, 3.4954965388795443`*^9}, {
  3.498129251476913*^9, 
  3.498129255201706*^9}},ExpressionUUID->"ff2ea78b-c7c9-4e75-a531-\
d1a6ceec01c7"],

Cell[BoxData[
 RowBox[{"Mixture", "[", 
  RowBox[{
   RowBox[{"Molecule", "[", 
    RowBox[{"Replicated", "[", 
     RowBox[{"\<\"H\"\>", ",", "20"}], "]"}], "]"}], ",", 
   RowBox[{"Molecule", "[", 
    RowBox[{
     RowBox[{"Replicated", "[", 
      RowBox[{"\<\"C\"\>", ",", "2"}], "]"}], ",", 
     RowBox[{"Replicated", "[", 
      RowBox[{"\<\"O\"\>", ",", "4"}], "]"}]}], "]"}], ",", 
   RowBox[{"Molecule", "[", 
    RowBox[{"\<\"Mn\"\>", ",", 
     RowBox[{"Replicated", "[", 
      RowBox[{"\<\"O\"\>", ",", "4"}], "]"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.495496531733202*^9, 3.495496539412776*^9}, {
  3.498129229957087*^9, 
  3.498129278013998*^9}},ExpressionUUID->"23b36ee9-bc89-4efa-8e25-\
66f9693cd862"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "@", 
  RowBox[{"Riffle", "[", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#1", "\[Equal]", "1"}], ",", "\"\<\>\"", ",", 
          RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
        RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{
          "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"List", "@@", 
         RowBox[{
         "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
       "}"}]}], "]"}], ",", "\"\<+\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495496475686346*^9, 3.495496509073731*^9}, {
  3.495496544484913*^9, 3.495496564796657*^9}, {3.495496624255774*^9, 
  3.495496674948168*^9}},ExpressionUUID->"2bfc14f2-b013-4782-a894-\
d428d1798a83"],

Cell[BoxData["\<\"0SiH4+O2+2H2\"\>"], "Output",
 CellChangeTimes->{{3.495496479734684*^9, 3.4954965111397057`*^9}, {
   3.4954965465099993`*^9, 3.495496565845693*^9}, 3.4954966485100527`*^9, 
   3.49549667929247*^9, 3.498129280656152*^9, 
   3.498142606316839*^9},ExpressionUUID->"65d7fadd-9359-4d9f-ba41-\
8ffc82a7eed6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "@", 
  RowBox[{"Riffle", "[", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#1", "\[Equal]", "1"}], ",", "\"\<\>\"", ",", 
          RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
        RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{
          "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Length", "[", 
            RowBox[{
            "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}]}]}], "]"}], ",", 
        RowBox[{"List", "@@", 
         RowBox[{
         "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       "}"}]}], "]"}], ",", "\"\<+\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495496475686346*^9, 3.495496509073731*^9}, {
   3.495496544484913*^9, 3.495496589873445*^9}, 3.495496646271204*^9, 
   3.495496686309737*^9},ExpressionUUID->"0a228595-38da-4b45-906f-\
d79452c18b9d"],

Cell[BoxData["\<\"0SiO2+2H2O\"\>"], "Output",
 CellChangeTimes->{3.4954965904594088`*^9, 3.495496646675235*^9, 
  3.495496686726308*^9, 
  3.498142607270081*^9},ExpressionUUID->"6603d60a-e406-45eb-b97e-\
1146f316ff05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%%", "<>", "\"\<->\>\"", "<>", "%"}]], "Input",
 CellChangeTimes->{{3.495496593717875*^9, 
  3.4954966167117023`*^9}},ExpressionUUID->"4d3bd42c-d14f-45d4-9c44-\
97ad2523c59c"],

Cell[BoxData["\<\"0SiH4+O2+2H2->0SiO2+2H2O\"\>"], "Output",
 CellChangeTimes->{3.495496617293756*^9, 3.49549665024536*^9, 
  3.495496689044094*^9, 
  3.498142609318158*^9},ExpressionUUID->"0ab7f6ef-335d-422a-91a0-\
89c43b05bd29"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition of BalanceEquation", "Subsection",
 CellChangeTimes->{{3.498141545749675*^9, 
  3.498141580953578*^9}},ExpressionUUID->"b5626e53-f263-4a34-bb28-\
34188507c412"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "FormBalancedEquation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormBalancedEquation", "[", 
    RowBox[{
     RowBox[{"solArg_", "?", "VectorQ"}], ",", "eq_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t1", ",", "t2", ",", 
       RowBox[{"sol", "=", "solArg"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"sol", ",", 
           RowBox[{"{", 
            RowBox[{"_Integer", "..."}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LCM", "@@", 
            RowBox[{"Denominator", "/@", "sol"}]}], ")"}], "*", "sol"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"StringJoin", "@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#1", "\[Equal]", "1"}], ",", "\"\<\>\"", ",", 
                RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
              RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"sol", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "]"}]}], "]"}], ",", 
              RowBox[{"List", "@@", 
               RowBox[{
               "eq", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
          "\"\<+\>\""}], "]"}]}]}], ";", 
      RowBox[{"t2", "=", 
       RowBox[{"StringJoin", "@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#1", "\[Equal]", "1"}], ",", "\"\<\>\"", ",", 
                RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
              RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"sol", ",", 
                RowBox[{"-", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                  "eq", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"List", "@@", 
               RowBox[{
               "eq", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
          "\"\<+\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"t1", ",", "\"\< \[Rule] \>\"", ",", "t2"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.498143490656204*^9, 3.498143552813102*^9}, {
  3.498143588892838*^9, 3.498143638142383*^9}, {3.498159516461771*^9, 
  3.498159554743582*^9}, {3.4981596226164913`*^9, 3.498159651649144*^9}, {
  3.498161561745451*^9, 3.498161606986003*^9}, {3.498161685939777*^9, 
  3.49816176379178*^9}},ExpressionUUID->"44d93344-7d28-453d-a5b8-\
3919be4b30c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BalanceEquation", "[", "eqStr_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eq", ",", "eqElements", ",", "lhsElements", ",", "rhsElements", ",", 
       "zeroVector", ",", "lhsMat", ",", "rhsMat", ",", "mat", ",", "sols", 
       ",", "goodSols", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eq", "=", 
       RowBox[{"ChemicalEquationParser", "[", "eqStr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"eq", "===", "$Failed"}], ",", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eq", "=", 
       RowBox[{"First", "[", "eq", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eqElements", "=", 
       RowBox[{"Union", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"eq", ",", "_String", ",", "\[Infinity]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lhsElements", "=", 
       RowBox[{"MoleculeToAtoms", "/@", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhsElements", "=", 
       RowBox[{"MoleculeToAtoms", "/@", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lhsElements", "=", 
       RowBox[{"lhsElements", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"eqElements", "\[Rule]", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"rhsElements", "=", 
       RowBox[{"rhsElements", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"eqElements", "\[Rule]", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"zeroVector", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lhsMat", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{"zeroVector", ",", 
            RowBox[{"Rule", "@@@", "#"}]}], "]"}], "&"}], ",", 
         "lhsElements"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhsMat", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{"zeroVector", ",", 
            RowBox[{"Rule", "@@@", "#"}]}], "]"}], "&"}], ",", 
         "rhsElements"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mat", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Join", "[", 
         RowBox[{"lhsMat", ",", 
          RowBox[{"-", "rhsMat"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"PRINT", "[", 
       RowBox[{"MatrixForm", "[", "mat", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sols", "=", 
       RowBox[{"NullSpace", "[", "mat", "]"}]}], ";", 
      RowBox[{"PRINT", "[", "sols", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sols", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Length", "[", "sols", "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"FormBalancedEquation", "[", 
          RowBox[{
           RowBox[{
           "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "eq"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sols", "]"}], ">", "1"}], "&&", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"sols", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"_", "?", "Negative"}], "|", "0"}], ")"}]}], "]"}]}], 
        ",", 
        RowBox[{
         RowBox[{
          RowBox[{"FormBalancedEquation", "[", 
           RowBox[{"#", ",", "eq"}], "]"}], "&"}], "/@", "sols"}], ",", 
        "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"goodSols", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"sols", ",", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"#", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"_", "?", "Negative"}], "|", "0"}], ")"}]}], "]"}], 
             "&"}]}], "]"}]}], ";", 
         RowBox[{"PRINT", "[", 
          RowBox[{"\"\<goodSols=\>\"", ",", "goodSols"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"goodSols", "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"res", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"FormBalancedEquation", "[", 
               RowBox[{"#", ",", "eq"}], "]"}], "&"}], "/@", "goodSols"}]}], 
           ",", 
           RowBox[{"res", "=", 
            RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"sols", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"sols", ",", "goodSols"}], "]"}]}], ";", 
         RowBox[{"PRINT", "[", 
          RowBox[{"\"\<sols=\>\"", ",", "sols"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "sols", "]"}], "\[Equal]", "1"}], "&&", 
            RowBox[{
             RowBox[{"Length", "[", "goodSols", "]"}], ">", "0"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sols", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"sols", ",", 
               RowBox[{"First", "[", "goodSols", "]"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"mat", "=", 
          RowBox[{"Transpose", "[", "sols", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sols", "=", 
          RowBox[{"LinearProgramming", "[", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
               "mat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}]}], "]"}], ",", "mat", ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "mat", "]"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"VectorQ", "[", 
            RowBox[{"sols", ",", "NumberQ"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sols", "=", 
             RowBox[{"mat", ".", "sols"}]}], ";", 
            RowBox[{"PRINT", "[", "sols", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Join", "[", 
             RowBox[{"res", ",", 
              RowBox[{"{", 
               RowBox[{"FormBalancedEquation", "[", 
                RowBox[{"sols", ",", "eq"}], "]"}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzFsoQwEAxvGzIastKXkaskmMbDSkqCVtI6RYKYTdXGaRS2E5am1ta2Ei
2h5MWi4lkkmStTwoDzqmvIiNtlJbyCUlpZzvPHz9+l7+As1Iq55NEEQuPdj0
2fQo5yVqI2OeKMxb+khV4F+6uFCencOH+2oyG3p7N4VQN5WZD6koWwltIlIF
G2qiavgqIgxQRB3a4XapygFjNyovPLoyb0GWX7sHTydNx/BTPcZS0g7udrDh
vqpdXZJO9/vrxuFZZ2Aa8icCJGyZHFiE1LCT8ZJjcsNy/fMaNCR67uGcdTYC
L4rMCfgi0bzAeNvdFzT/3hJi2mi8y1JBK1bybLD+pnkHTq1I/XDhN0jBrsbQ
NXTLZHHI1xnfYCRDklJJezJk5MNVAacA/vmoZviw/N0BdSFTNzR0T+sgR7De
BwsLw0NwhxckYZK92gK17jQrlPqTHbD0553RNlrsgjFnmQfOeLhr8CCWyzjv
9G3AmuswY9aTRlhFe67QF8B/3Wnb7w==
  
  "],ExpressionUUID->"94f58834-12c6-4339-bdd1-2bec1cfb8c9d"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.496096467103195*^9, 
  3.496096474419446*^9}},ExpressionUUID->"f8631c2b-fedf-4c67-b9c2-\
01fba2942d23"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<C3H8 + O2 \[Rule] CO2 + H2O\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 
  3.496096503821725*^9}},ExpressionUUID->"3c96347b-4f84-4e46-8c68-\
92af190b3551"],

Cell[BoxData[
 RowBox[{"{", "\<\"C3H8+5O2 \[Rule] 3CO2+4H2O\"\>", "}"}]], "Output",
 CellChangeTimes->{
  3.49609650457718*^9, {3.49609658022738*^9, 3.496096597096369*^9}, 
   3.4960967656115503`*^9, 3.496097209372184*^9, 3.4960978150947237`*^9, 
   3.4966004087752542`*^9, {3.4981426505606937`*^9, 3.49814270430914*^9}, {
   3.498142855882194*^9, 3.498142856933053*^9}, 3.498142961508222*^9, 
   3.4981437525429707`*^9, 3.498159307680107*^9, 3.4981596559037647`*^9, 
   3.498161791786298*^9, 
   3.4981645422256393`*^9},ExpressionUUID->"49dc2772-e9c6-4619-9662-\
77aab169d6a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<HCl + CaCO3 \[Rule] CaCl2 + H2CO3\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}, 
   3.496096622809504*^9, {3.496096691320332*^9, 
   3.496096733869132*^9}},ExpressionUUID->"b2b75ebd-91bd-4f8d-b01b-\
a90f6df8ec5c"],

Cell[BoxData[
 RowBox[{"{", "\<\"2HCl+CaCO3 \[Rule] CaCl2+H2CO3\"\>", "}"}]], "Output",
 CellChangeTimes->{{3.4960967383914843`*^9, 3.4960967667158537`*^9}, 
   3.4960968373514767`*^9, 3.496097080250703*^9, 3.4960971262343597`*^9, 
   3.496097205579286*^9, 3.4960978139305573`*^9, 3.496600408838656*^9, 
   3.498142657131517*^9, {3.498142687137664*^9, 3.498142711615987*^9}, 
   3.498142969981493*^9, 3.4981437546126547`*^9, 3.498159311363941*^9, 
   3.4981617898341007`*^9, 
   3.498164543171371*^9},ExpressionUUID->"ee7aae4c-90ca-4954-b8b6-\
31508448e0e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<C6H12O6 \[Rule] CO2 + C2H5OH\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}, 
   3.496096622809504*^9, {3.496096691320332*^9, 3.496096733869132*^9}, 
   3.4960976497132607`*^9, {3.4960976909062147`*^9, 
   3.496097728677278*^9}},ExpressionUUID->"d01249ed-5aa0-4137-b719-\
246bc0bef18a"],

Cell[BoxData[
 RowBox[{"{", "\<\"C6H12O6 \[Rule] 2CO2+2C2H5OH\"\>", "}"}]], "Output",
 CellChangeTimes->{3.496097729128039*^9, 3.496097816853401*^9, 
  3.4966004089049587`*^9, 3.4981429722106123`*^9, 3.4981437564749823`*^9, 
  3.498161787419167*^9, 
  3.498164544103986*^9},ExpressionUUID->"238cab62-0ee7-43d1-b107-\
6e36c95e9ac0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hard cases", "Subsubsection",
 CellChangeTimes->{{3.4981625780292892`*^9, 
  3.49816258214249*^9}},ExpressionUUID->"9b4fac3a-6ad5-4f68-8a99-\
f332ff67857f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<H20+C2O4+MnO4=MnO2+CO2+OH\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}, 
   3.496096622809504*^9, {3.496096691320332*^9, 3.496096733869132*^9}, 
   3.4960976497132607`*^9, {3.4960976909062147`*^9, 3.496097728677278*^9}, {
   3.498143767197516*^9, 3.498143770100554*^9}, {3.498161362379715*^9, 
   3.4981613697969646`*^9}, {3.498161811457151*^9, 
   3.498161812072095*^9}},ExpressionUUID->"e06cb9cc-6f6a-401e-963e-\
358cdbc2a1d3"],

Cell[BoxData[
 RowBox[{"{", "\<\"H20+C2O4+10MnO4 \[Rule] 10MnO2+2CO2+20OH\"\>", 
  "}"}]], "Output",
 CellChangeTimes->{
  3.498160953810936*^9, {3.498160999163237*^9, 3.498161025164032*^9}, {
   3.498161070905033*^9, 3.498161188354484*^9}, 3.498161219458918*^9, {
   3.498161275948311*^9, 3.498161316687622*^9}, {3.498161370471265*^9, 
   3.498161452728449*^9}, 3.498161782257071*^9, 3.4981645492699966`*^9, 
   3.498169965607924*^9},ExpressionUUID->"6a4bc210-7fa0-40b6-8fae-\
56a7416ab992"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<SiH4 + O2 + H2 -> SiO2 + H2O\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.498144044655321*^9, 3.498144047217968*^9}, {
   3.498161470796812*^9, 3.498161473897534*^9}, 3.498161665201048*^9, {
   3.498161808876973*^9, 
   3.498161809567862*^9}},ExpressionUUID->"531308eb-3374-4ba5-8007-\
98a46b6d41dd"],

Cell[BoxData[
 RowBox[{"{", "\<\"2SiH4+5O2+2H2 \[Rule] 2SiO2+6H2O\"\>", "}"}]], "Output",
 CellChangeTimes->{
  3.498144049660124*^9, 3.49815974708882*^9, {3.49816145533838*^9, 
   3.4981614767819242`*^9}, 3.498161539619947*^9, {3.498161585200551*^9, 
   3.4981616309200077`*^9}, {3.4981616663410797`*^9, 3.49816172494141*^9}, {
   3.498161768271109*^9, 3.498161781266062*^9}, 3.498164551074449*^9, 
   3.49816996684765*^9},ExpressionUUID->"e77996fa-4586-4fd1-9a11-\
cc2d3f77e758"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PRINT", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BalanceEquation", "[", 
  "\"\<NH4ClO4 + HNO3 + HCl + H2O \[Rule] HClO4(H2O)2 + N2O + NO + NO2 + \
Cl2\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.498144044655321*^9, 3.498144047217968*^9}, {
   3.498161470796812*^9, 3.498161473897534*^9}, 3.498161665201048*^9, {
   3.498161808876973*^9, 3.498161809567862*^9}, {3.498162598774983*^9, 
   3.49816261463238*^9}, {3.498162681606461*^9, 3.4981628017498493`*^9}, {
   3.498163227991818*^9, 3.498163263584175*^9}, {3.498163564889286*^9, 
   3.498163578731469*^9}, {3.498164585536808*^9, 3.498164585911869*^9}, {
   3.498164937547517*^9, 3.498164966680049*^9}, 
   3.498169963738401*^9},ExpressionUUID->"f22bf656-137d-4db2-8e96-\
0d7512ffc6a1"],

Cell[BoxData[
 RowBox[{"{", "\<\"NH4ClO4+13HNO3+6HCl+H2O \[Rule] \
5HClO4(H2O)2+N2O+11NO+NO2+Cl2\"\>", "}"}]], "Output",
 CellChangeTimes->{{3.49816356887569*^9, 3.498163579174758*^9}, 
   3.498164546926746*^9, 3.498164586873268*^9, {3.498164935666191*^9, 
   3.49816493845019*^9}, 3.498164969809935*^9, {3.4981699641607513`*^9, 
   3.4981699681504097`*^9}},ExpressionUUID->"9224d2f2-713a-47c6-acd5-\
d48b4a900878"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Study", "Subsubsection",
 CellChangeTimes->{{3.498162591206856*^9, 
  3.49816259310996*^9}},ExpressionUUID->"71af0258-760b-4f44-a1a1-\
eb4c5753d9dd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmat", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", " ", "1", ",", " ", "2", ",", " ", "0", ",", " ", "2"}], 
       "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "1", ",", " ", 
        RowBox[{"-", "2"}], ",", " ", "1", ",", " ", "0"}], "}"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"nmat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.498144290873225*^9, 3.498144315363865*^9}, {
  3.4981443869344053`*^9, 
  3.4981443876767597`*^9}},ExpressionUUID->"24fb89ac-2b32-4d5a-96e3-\
0437c565217c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {"1", "1"},
     {"2", 
      RowBox[{"-", "2"}]},
     {"0", "1"},
     {"2", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.498144307650197*^9, 3.498144315926877*^9}, 
   3.498144387987173*^9},ExpressionUUID->"1de85240-936d-4e4c-bc26-\
9db1f473f671"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nsol", "=", 
   RowBox[{"LinearProgramming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", "nmat", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "nmat", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nmat", ".", "nsol"}]}], "Input",
 CellChangeTimes->{{3.498143863100519*^9, 3.498143869602264*^9}, {
  3.4981442866231833`*^9, 3.498144286747237*^9}, {3.498144333814322*^9, 
  3.49814442578743*^9}},ExpressionUUID->"3027f3ce-eb3a-4afe-be89-\
e07d80cb025c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["5", "2"], ",", "1", ",", "1", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.4981443536027317`*^9, 
  3.498144426216858*^9}},ExpressionUUID->"d3635bce-c4aa-4fe6-bc54-\
2ffbe0d7140e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "10", ",", "10", ",", "0", ",", "20"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "2", ",", "0"}], 
      "}"}]}], "}"}], "]"}], ".", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.4981439761924477`*^9, 
  3.498144010435668*^9}},ExpressionUUID->"aa38c354-8d58-4779-bc21-\
752e485eeece"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", "y", ",", 
   RowBox[{"10", " ", "x"}], ",", 
   RowBox[{"10", " ", "x"}], ",", 
   RowBox[{"2", " ", "y"}], ",", 
   RowBox[{"20", " ", "x"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.498143990016658*^9, 3.498144011384927*^9}, 
   3.498144392514926*^9},ExpressionUUID->"011e144a-f7f2-4f6a-b6e3-\
23abc1025498"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "1", ",", " ", "2", ",", " ", "0", ",", " ", "2"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1", ",", " ", 
       RowBox[{"-", "2"}], ",", " ", "1", ",", " ", "0"}], "}"}]}], "}"}], 
   "]"}], ".", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.4981440597484922`*^9, 
  3.498144072357861*^9}},ExpressionUUID->"c20dc32a-ffa9-40b1-b606-\
95add36ed0d3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"y", ",", 
   RowBox[{"x", "+", "y"}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x"}], "-", 
    RowBox[{"2", " ", "y"}]}], ",", "y", ",", 
   RowBox[{"2", " ", "x"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.498144070132464*^9, 
  3.498144072698614*^9}},ExpressionUUID->"54dc668c-e2b9-4f47-a222-\
8a27613234bc"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Odd cases", "Section",
 CellChangeTimes->{{3.494366528732423*^9, 
  3.494366531588024*^9}},ExpressionUUID->"a1fb9ae6-9755-477a-9251-\
d7bd45fdb1b5"],

Cell["Multiple solutions", "Subsection",
 CellChangeTimes->{{3.4943674830287533`*^9, 3.494367487689296*^9}, 
   3.494367773490226*^9},ExpressionUUID->"baaa669f-e3fe-4d6b-995d-\
4b52cfd62be7"],

Cell["Infinite number of solutions", "Subsection",
 CellChangeTimes->{{3.494367496979124*^9, 3.494367503449252*^9}, 
   3.494367774890131*^9},ExpressionUUID->"b0f68e10-e1a1-428a-a375-\
2b82dbd5b209"],

Cell["Simultaneous adjustment of all elements is impossible", "Subsection",
 CellChangeTimes->{
  3.494367597430028*^9},ExpressionUUID->"afb55e4c-1858-470e-a474-\
780bd84de725"],

Cell["\<\
The number of chemical compounds is greater by one than the number of \
chemical elements\
\>", "Subsection",
 CellChangeTimes->{{3.494367631459696*^9, 
  3.494367631682509*^9}},ExpressionUUID->"93d99e04-250d-4e7e-933c-\
1b5991a5c7d6"],

Cell["Chemical compounds are repeated", "Subsection",
 CellChangeTimes->{{3.494367635066627*^9, 3.494367644649251*^9}, 
   3.494367778706164*^9},ExpressionUUID->"d28feb91-9782-4bc7-82e0-\
84c7bef60314"],

Cell["\<\
The molecular formula for a compound is a multiple of the molecular formula \
of another compound\
\>", "Subsection",
 CellChangeTimes->{{3.494367693541047*^9, 
  3.494367694677124*^9}},ExpressionUUID->"bcdcf033-218f-4697-9d3c-\
abff044687c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Existence of solutions", "Section",
 CellChangeTimes->{{3.495838639521722*^9, 
  3.495838647087055*^9}},ExpressionUUID->"73d25aa4-3121-49c9-8a56-\
271120d0f789"],

Cell["\<\
A question that should be answered is under what conditions we have solutions \
of the balancing problem. We showed already how to find the solutions.\
\>", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, {3.496643264187997*^9, 
   3.496643264264138*^9}, 3.496708620209783*^9, {3.4970531456811647`*^9, 
   3.497053173792494*^9}, {3.497053551389126*^9, 3.497053586792392*^9}, {
   3.6900376753708572`*^9, 
   3.690037683388668*^9}},ExpressionUUID->"a1acfcbd-9e09-475b-b67f-\
866a9249ba54"],

Cell["Mathematically, this question translates to: ", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, 3.496643264187997*^9, {
   3.496703358680395*^9, 3.4967033973804703`*^9}, {3.4967086306475687`*^9, 
   3.496708762566242*^9}, {3.496708885741457*^9, 3.496708962103063*^9}, {
   3.4967090083181543`*^9, 3.496709040549336*^9}, {3.4967090725892897`*^9, 
   3.496709353941852*^9}, {3.49705282977634*^9, 
   3.4970528318181543`*^9}},ExpressionUUID->"1f4caf94-f566-44ab-959f-\
bb9554c32894"],

Cell["\<\
Under what conditions a homogeneous System of Linear Diophantine Equations \
(SLDE) has a solution?\
\>", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, 3.496643264187997*^9, {
   3.496703358680395*^9, 3.4967033973804703`*^9}, {3.4967086306475687`*^9, 
   3.496708762566242*^9}, {3.496708885741457*^9, 3.496708962103063*^9}, {
   3.4967090083181543`*^9, 3.496709040549336*^9}, {3.4967090725892897`*^9, 
   3.496709353941852*^9}, {3.49705282977634*^9, 3.497052833712389*^9}, {
   3.497053047479456*^9, 3.4970530582733307`*^9}, {3.497053132572382*^9, 
   3.497053134112158*^9}, {3.49705318126941*^9, 3.497053181673386*^9}, {
   3.497053466635767*^9, 
   3.497053471103826*^9}},ExpressionUUID->"7f25c02a-e1da-408b-ab34-\
ec874ddb9fb4"],

Cell["\<\
We are going to answer this question two different ways. The first is direct \
and more intuitive, and it is applied in our implementation of the balancer \
above. The second way to find when a SLDE has solutions involves the so \
called Smith Normal Form (SNF) of an integer matrix that has application in \
areas like Operations research and Combinatorics. Both answers give methods \
how to find solutions of a SLDE.\
\>", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, 3.496643264187997*^9, {
   3.496703358680395*^9, 3.4967033973804703`*^9}, {3.4967086306475687`*^9, 
   3.496708762566242*^9}, {3.496708885741457*^9, 3.496708962103063*^9}, {
   3.4967090083181543`*^9, 3.496709040549336*^9}, {3.4967090725892897`*^9, 
   3.496709353941852*^9}, 3.49705282977634*^9, {3.4970531922885113`*^9, 
   3.497053265809043*^9}},ExpressionUUID->"e905c470-735a-44c6-b26e-\
c5a4f35bb3c3"],

Cell[CellGroupData[{

Cell["Intuitive reasoning", "Subsection",
 CellChangeTimes->{{3.49670877522248*^9, 
  3.496708785997529*^9}},ExpressionUUID->"2abb0df9-6599-443e-9c64-\
a4d61318c8c9"],

Cell["\<\
Given a SLDE there is always an associated System of Linear Equations (SLE) \
that is obtained by removing the restriction the solutions to be integer. \
Therefore, there is a matrix associated with any SLDE. For example, from the \
SLDE\
\>", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.49664107686412*^9}, {
   3.4967088430436087`*^9, 3.4967088724007587`*^9}, {3.4967093950036917`*^9, 
   3.496709541325387*^9}, {3.49677422528563*^9, 3.49677425811236*^9}, {
   3.496776591011956*^9, 3.496776621733761*^9}, {3.496776725237145*^9, 
   3.49677672705363*^9}, {3.496776800534259*^9, 
   3.4967768015522633`*^9}},ExpressionUUID->"bbad2936-7420-499a-a0d0-\
f04e87752d92"],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"3", " ", "x1"}], "\[LongEqual]", "y1"}]},
     {
      RowBox[{
       RowBox[{"8", " ", "x1"}], "\[LongEqual]", 
       RowBox[{"2", " ", "y2"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "x2"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"2", " ", "y1"}], "+", "y2"}]}]},
     {
      RowBox[{"x1", ">", "0"}]},
     {
      RowBox[{"x2", ">", "0"}]},
     {
      RowBox[{"y1", ">", "0"}]},
     {
      RowBox[{"y2", ">", "0"}]},
     {
      RowBox[{"x1", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"x2", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"y1", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"y2", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{
  3.496600857454558*^9},ExpressionUUID->"3e2c5abf-c1a8-48e1-8ec8-\
0f007f7267d5"],

Cell["we can derive the SLE", "Text",
 CellChangeTimes->{{3.4967742650490427`*^9, 
  3.496774270294115*^9}},ExpressionUUID->"4ac00f18-0b87-4f71-85a7-\
0714610c5a48"],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"3", " ", "x1"}], "\[LongEqual]", "y1"}]},
     {
      RowBox[{
       RowBox[{"8", " ", "x1"}], "\[LongEqual]", 
       RowBox[{"2", " ", "y2"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "x2"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"2", " ", "y1"}], "+", "y2"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{3.496600857454558*^9, 
  3.496774541929975*^9},ExpressionUUID->"a033dfec-4fd1-45d4-b05b-\
6eb6b0cfb144"],

Cell["which can be re-written as", "Text",
 CellChangeTimes->{{3.4967745440308313`*^9, 
  3.496774556949028*^9}},ExpressionUUID->"55141a04-6752-46d6-a3ae-\
f6b1d2c4f335"],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"3", " ", "x1"}], "-", "y1"}], "\[LongEqual]", "0"}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"8", " ", "x1"}], "-", 
        RowBox[{"2", " ", "y2"}]}], "\[LongEqual]", "0"}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"2", " ", "x2"}], "-", 
        RowBox[{"2", " ", "y1"}], "-", "y2"}], "\[LongEqual]", "0"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{
  3.496600857454558*^9, {3.496774280391512*^9, 3.4967743103601017`*^9}, {
   3.496774463928652*^9, 3.496774485689286*^9}, 
   3.4967745291137123`*^9},ExpressionUUID->"bdbe148f-a560-4c44-bfa8-\
27eba60b0f01"],

Cell["and in matrix form as", "Text",
 CellChangeTimes->{{3.496774562015469*^9, 
  3.496774568485174*^9}},ExpressionUUID->"4e1e51f2-4e90-4846-a0f8-\
684601ca13ed"],

Cell[BoxData[
 FormBox[
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"3", "0", 
         RowBox[{"-", "1"}], "0"},
        {"8", "0", "0", 
         RowBox[{"-", "2"}]},
        {"0", "2", 
         RowBox[{"-", "2"}], 
         RowBox[{"-", "1"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"x1"},
        {"x2"},
        {"y1"},
        {"y1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
    "\[LongEqual]", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], " ", 
     "."}]}],
   FontWeight->"Plain"], TraditionalForm]], "Equation", "Input",
 CellChangeTimes->{{3.496774662199497*^9, 3.4967746650153427`*^9}, {
  3.496787298450448*^9, 
  3.4967872984952097`*^9}},ExpressionUUID->"2caae508-4e5f-44b9-b2c1-\
d1f426ba9f73"],

Cell[TextData[{
 "A homogeneous SLE, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"L", " ", "x"}], " ", "=", " ", "0"}], TraditionalForm]],
  ExpressionUUID->"01b6665d-6aee-4e97-960e-4a13b26b45c8"],
 ", would have multiple non-trivial solutions if determinant of the matrix \
associated with it is ",
 Cell[BoxData[
  FormBox["0", TraditionalForm]],ExpressionUUID->
  "5c6de9fc-6e1c-44d5-9f6f-9591850f0808"],
 ". Or in other words if the kernel of the matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"ker", "(", "L", ")"}], TraditionalForm]],ExpressionUUID->
  "c1dce9bf-3fe5-429e-ac7c-9ad35bfd3270"],
 " has dimensionality higher or equal to one. Any matrix can be transformed \
to an equivalent matrix in a reduced row echelon form through the \
Gauss-Jordan algorithm. (See Appendix \"Mathematical concepts\" Section \
\"Matrices and vectors\".) The operations needed by the Gauss-Jordan \
algorithm when applied to an integer matrix are (i) summing a row with a \
rational number mutiple of another row, or (ii) row exchange (i.e. partial \
pivoting). For example, for the integer matrix"
}], "Text",
 CellChangeTimes->{{3.49677525927*^9, 3.4967753010625687`*^9}, {
   3.496775500221919*^9, 3.496775535683813*^9}, {3.4967768202013187`*^9, 
   3.49677693834603*^9}, {3.4967769832121077`*^9, 3.496777044655251*^9}, {
   3.4969284459878397`*^9, 3.49692850206199*^9}, {3.496928729540782*^9, 
   3.496928770096072*^9}, {3.4969317104941*^9, 3.496931718366609*^9}, {
   3.4969317950829487`*^9, 3.496931849695366*^9}, {3.496932381284421*^9, 
   3.496932440023409*^9}, {3.49693270176283*^9, 3.496932778087648*^9}, {
   3.496934281909647*^9, 3.496934321038722*^9}, {3.496934361352221*^9, 
   3.4969343657427893`*^9}, 3.496935220708069*^9, {3.49693861718407*^9, 
   3.496938662344121*^9}, {3.496938694040639*^9, 3.4969387114082727`*^9}, {
   3.496970048938492*^9, 
   3.496970114171979*^9}},ExpressionUUID->"7bf57f6b-9208-4b87-a003-\
6ad9c5275139"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "b", "c"},
     {"d", "e", "f"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Equation",
 CellChangeTimes->{{3.496934322885666*^9, 3.49693435304957*^9}, {
  3.4969343861490917`*^9, 3.496934464065218*^9}, {3.4969347243251343`*^9, 
  3.496934728993257*^9}, {3.496935275151835*^9, 3.496935305619025*^9}, {
  3.496935357547503*^9, 3.496935379418519*^9}, {3.4969354302302732`*^9, 
  3.496935467930604*^9}, {3.496936440270431*^9, 3.496936525496687*^9}, {
  3.496936624339033*^9, 3.49693663804069*^9}, {3.496937304970496*^9, 
  3.4969373053611794`*^9}, {3.496937387595133*^9, 3.496937389320418*^9}, {
  3.4969386784436817`*^9, 3.496938690034149*^9}, {3.4969543615702057`*^9, 
  3.496954365175675*^9}, {3.496961794931057*^9, 3.496961795579117*^9}, {
  3.496962014136219*^9, 3.496962034881398*^9}, {3.496962775292254*^9, 
  3.496962788587117*^9}, {3.496962823986085*^9, 
  3.496962826722301*^9}},ExpressionUUID->"45a2e80e-2032-4c7f-b7a9-\
519f1dd49883"],

Cell["can be transformed to ", "Text",
 CellChangeTimes->{{3.4969374048358*^9, 3.496937411503316*^9}, {
  3.49693864214074*^9, 
  3.496938666183855*^9}},ExpressionUUID->"ccf9c542-b33c-492e-b34d-\
82dd260f0a4c"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "b", "c"},
     {"0", 
      RowBox[{"e", "-", 
       FractionBox[
        RowBox[{"b", " ", "d"}], "a"]}], 
      RowBox[{"f", "-", 
       FractionBox[
        RowBox[{"c", " ", "d"}], "a"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Equation",
 CellChangeTimes->{{3.4969543838415527`*^9, 3.49695438710435*^9}, {
  3.496962041701221*^9, 3.496962046546113*^9}, {3.4969627905973263`*^9, 
  3.4969627960064383`*^9}, {3.496962833547019*^9, 
  3.4969628361709213`*^9}},ExpressionUUID->"89201b56-5e92-43d1-aadd-\
b033621acf01"],

Cell[TextData[{
 "by adding the to the second row the first row multiplied by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "d"}], "/", "a"}], TraditionalForm]],ExpressionUUID->
  "a4e45db3-7cb2-417a-ae65-d367a28900ce"],
 ". The last matrix can be transformed into"
}], "Text",
 CellChangeTimes->{{3.496937451450314*^9, 3.496937519847328*^9}, {
  3.4969375729673033`*^9, 3.4969375895350027`*^9}, {3.4969628120228033`*^9, 
  3.4969628168774023`*^9}},ExpressionUUID->"ad0b02a1-0a34-490a-a1ef-\
19fff7969980"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "0", 
      FractionBox[
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "e"}], "-", 
          RowBox[{"b", " ", "f"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"a", " ", "e"}], "-", 
        RowBox[{"b", " ", "d"}]}]]},
     {"0", 
      RowBox[{"e", "-", 
       FractionBox[
        RowBox[{"b", " ", "d"}], "a"]}], 
      RowBox[{"f", "-", 
       FractionBox[
        RowBox[{"c", " ", "d"}], "a"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Equation",
 CellChangeTimes->{{3.496937545596785*^9, 3.49693756917726*^9}, {
   3.496954400107049*^9, 3.4969544039529877`*^9}, {3.496962055955599*^9, 
   3.496962056195443*^9}, 3.496962844592166*^9, {3.496962876836795*^9, 
   3.496962882555036*^9}},ExpressionUUID->"cb0c745f-e1c4-431f-84f5-\
24f3fead2611"],

Cell[TextData[{
 "by adding to the first row the second row multiplied by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "b"}], "/", 
    RowBox[{"(", 
     RowBox[{"e", "-", 
      FractionBox[
       RowBox[{"b", " ", "d"}], "a"]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"cd25bd92-e7eb-4083-b7d7-9f7751e7f309"],
 ". The last matrix can be transformed into reduced row echelon form by \
multiplying the first row by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", "a"}], TraditionalForm]],ExpressionUUID->
  "bca54dfe-1c54-4501-b75b-ea0ea0650c9b"],
 " and the second row by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"e", "-", 
      FractionBox[
       RowBox[{"b", " ", "d"}], "a"]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"041b29ff-9a97-40f8-ac1c-1bb950492953"],
 ":"
}], "Text",
 CellChangeTimes->{{3.49693759381666*^9, 3.496937719425946*^9}, {
  3.4969628964175463`*^9, 
  3.496962999190229*^9}},ExpressionUUID->"c2e73808-d55e-468e-8d74-\
410468bfb977"],

Cell[BoxData[
 RowBox[{
  FormBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", 
       FractionBox[
        RowBox[{
         RowBox[{"c", " ", "e"}], "-", 
         RowBox[{"b", " ", "f"}]}], 
        RowBox[{
         RowBox[{"a", " ", "e"}], "-", 
         RowBox[{"b", " ", "d"}]}]]},
      {"0", "1", 
       FractionBox[
        RowBox[{
         RowBox[{"c", " ", "d"}], "-", 
         RowBox[{"a", " ", "f"}]}], 
        RowBox[{
         RowBox[{"b", " ", "d"}], "-", 
         RowBox[{"a", " ", "e"}]}]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   TraditionalForm], "."}]], "Equation",
 CellChangeTimes->{
  3.496937356212978*^9, 3.496937728890339*^9, {3.496938567601708*^9, 
   3.496938572041175*^9}, {3.496954409915065*^9, 3.496954412705187*^9}, {
   3.496962064272328*^9, 3.4969620658294487`*^9}, {3.496963003056882*^9, 
   3.496963023812667*^9}},ExpressionUUID->"7ca965a7-07ea-435a-be57-\
d1f298b7333a"],

Cell["\<\
This last matrix has rational numbers in its last column. The solution of its \
matrix equation is (see Appendix \"Mathematical concepts\" Section \"Systems \
of linear equations\") \
\>", "Text",
 CellChangeTimes->{{3.496938582920455*^9, 3.4969385913035088`*^9}, {
  3.4969387234545794`*^9, 3.496938747720525*^9}, {3.496961755636615*^9, 
  3.49696175725753*^9}, {3.496964556950076*^9, 3.496964585785412*^9}, {
  3.4969650208604183`*^9, 3.4969650292973633`*^9}, {3.4969651245398817`*^9, 
  3.496965124993569*^9}, {3.496968256604622*^9, 3.496968267618595*^9}, {
  3.496968479559958*^9, 
  3.496968551489786*^9}},ExpressionUUID->"9a6ccee2-9712-49a9-a771-\
9815014b1e21"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"z", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "e"}], "-", 
          RowBox[{"b", " ", "f"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"a", " ", "e"}], "-", 
        RowBox[{"b", " ", "d"}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"z", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "-", 
          RowBox[{"a", " ", "f"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"b", " ", "d"}], "-", 
        RowBox[{"a", " ", "e"}]}]]}], ",", "z"}], "}"}], "."}], 
  TraditionalForm]], "Equation",
 CellChangeTimes->{{3.496965147198984*^9, 3.496965184531129*^9}, {
   3.4969652891488037`*^9, 3.4969652900284777`*^9}, 
   3.496965358234866*^9},ExpressionUUID->"bbfb94e1-ea1a-464c-8d92-\
87dcfc36f62b"],

Cell[TextData[{
 "Which if ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]],ExpressionUUID->
  "41c5d3dc-3f59-456c-ba7a-3c8dafac4cba"],
 " is an integer that solution can be always made integer by multiplying ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"b", " ", "d"}], "-", 
    RowBox[{"a", " ", "e"}]}], TraditionalForm]],ExpressionUUID->
  "0744d11c-9062-4e0a-9472-98f2aef32115"],
 ", i.e."
}], "Text",
 CellChangeTimes->{{3.496967544544655*^9, 
  3.496967662890437*^9}},ExpressionUUID->"7cb43230-8947-403a-9ef6-\
e2fc5df8baf2"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "e"}], "-", 
        RowBox[{"b", " ", "f"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", "z"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "-", 
        RowBox[{"a", " ", "f"}]}], ")"}]}], ",", 
     RowBox[{"z", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", " ", "d"}], "-", 
        RowBox[{"a", " ", "e"}]}], ")"}]}]}], "}"}], "."}], 
  TraditionalForm]], "Equation",
 CellChangeTimes->{{3.496965147198984*^9, 3.496965184531129*^9}, {
   3.4969652891488037`*^9, 3.4969652900284777`*^9}, 3.496965358234866*^9, {
   3.496967672587942*^9, 
   3.496967692533401*^9}},ExpressionUUID->"6bda7d8d-a80e-4861-8850-\
487461fa68e8"],

Cell["\<\
From this example we can see that for any integer matrix that comes from a \
balancing problem we can derive an integer solution using the reduced row \
echelon form.\
\>", "Text",
 CellChangeTimes->{{3.49696774597786*^9, 3.496967759025682*^9}, {
   3.496967823199032*^9, 3.496967855865963*^9}, {3.4969681434766817`*^9, 
   3.4969681752903957`*^9}, {3.4969682279379263`*^9, 3.496968239890457*^9}, {
   3.496968761908939*^9, 3.496968782818883*^9}, {3.496968849700437*^9, 
   3.496968896202174*^9}, {3.496968936791922*^9, 3.4969689637140636`*^9}, {
   3.496969071954352*^9, 3.496969073602921*^9}, 3.4969695426907988`*^9, {
   3.496969589638516*^9, 3.49696964648803*^9}, {3.4969697442764*^9, 
   3.496969750970243*^9}, {3.496969784347068*^9, 3.4969697875319347`*^9}, {
   3.496970541426588*^9, 3.496970586156795*^9}, {3.496970690491555*^9, 
   3.496970708448365*^9}},ExpressionUUID->"1b65eb93-19ba-44fb-bfa6-\
cdd7dab6cf35"]
}, Closed]],

Cell[CellGroupData[{

Cell["Using Smith normal form", "Subsection",
 CellChangeTimes->{{3.4969703293061657`*^9, 
  3.496970344602112*^9}},ExpressionUUID->"6461214c-99ef-4fd8-abd2-\
9e1c6d06bf6c"],

Cell[TextData[{
 "First we are going to define ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["SL",
      FontSlant->"Italic"], "k"], "(", "\[DoubleStruckCapitalZ]", ")"}], 
   TraditionalForm]],ExpressionUUID->"a1802e9a-2bf0-4186-9590-5f40f5772127"],
 " as the set of all ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "\[Times]", "k"}], TraditionalForm]],ExpressionUUID->
  "fbf3115f-f819-4064-92dd-928ddd3fedd1"],
 " square matrices with integer entries and determinant ",
 Cell[BoxData[
  FormBox["1", TraditionalForm]],ExpressionUUID->
  "1a2bcc7e-8ab2-4d55-9fad-d482a616ddcc"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", "1"}], TraditionalForm]],ExpressionUUID->
  "0a38f58f-aefa-44ad-9221-2054e33acdbb"],
 ". Let ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", 
     RowBox[{"m", ",", "n"}]], "(", "\[DoubleStruckCapitalZ]", ")"}], 
   TraditionalForm]],ExpressionUUID->"acac87b5-da25-49b8-9dbb-3c078877444d"],
 " be the set of all ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "5d00af23-c991-4d49-9599-d328ed9890fc"],
 " matrices with integer entries. We also impose the condition ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "\[LessEqual]", "m", "\[LessEqual]", "n"}], TraditionalForm]],
  ExpressionUUID->"bf8ec788-c147-4c39-bf2b-aa202c176e52"],
 " on ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", 
     RowBox[{"m", ",", "n"}]], "(", "\[DoubleStruckCapitalZ]", ")"}], 
   TraditionalForm]],ExpressionUUID->"8c312ac0-109e-4289-b8dc-376fa36e7551"],
 ". With ",
 Cell[BoxData[
  FormBox[
   RowBox[{"D", "=", 
    RowBox[{
     RowBox[{"diag", "(", 
      RowBox[{
       SubscriptBox["d", "1"], ",", 
       SubscriptBox["d", "2"], ",", "\[Ellipsis]", ",", 
       SubscriptBox["d", "m"]}], ")"}], "\[Element]", 
     RowBox[{
      SubscriptBox["M", 
       RowBox[{"m", ",", "n"}]], "(", "\[DoubleStruckCapitalZ]", ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"e691b18f-6dd4-46a7-bf84-6f26c3ba5d18"],
 " we denote the diagonal matrix which has the integer ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["d", "i"], TraditionalForm]],ExpressionUUID->
  "607b6474-d4f5-4701-bddd-f683aba52fb7"],
 " at its entry ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"i", ",", "i"}], ")"}], TraditionalForm]],ExpressionUUID->
  "e09d9f63-22d0-4017-86fc-cc02a358e7e9"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", "\[Element]", 
    RowBox[{"[", 
     RowBox[{"1", ",", "m"}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "baa8e661-993a-4c81-85eb-bad3c37fc33e"],
 " and all other entries are zero."
}], "Text",
 CellChangeTimes->{{3.496973511880369*^9, 3.49697354740217*^9}, {
  3.497047598017927*^9, 3.497047607231164*^9}, {3.4970476810927153`*^9, 
  3.497047716992898*^9}, {3.497047783115842*^9, 3.497047846160795*^9}, {
  3.497047905803516*^9, 3.497048227353327*^9}, {3.497048270818707*^9, 
  3.497048319432447*^9}, {3.497048468143772*^9, 
  3.497048625847684*^9}},ExpressionUUID->"643600a2-b478-456a-81c9-\
b47fef51a503"],

Cell[BoxData[
 RowBox[{
  StyleBox["Theorem",
   FontWeight->"Bold"], ":", " ", 
  RowBox[{"Let", " ", 
   RowBox[{
    FormBox[
     RowBox[{"A", "\[Element]", 
      RowBox[{
       SubscriptBox["M", 
        RowBox[{"m", ",", "n"}]], "(", "\[DoubleStruckCapitalZ]", ")"}]}],
     TraditionalForm], ".", " ", "Then"}], " ", "the", " ", "following", " ", 
   "matrices", " ", 
   FormBox[
    RowBox[{"L", "\[Element]", 
     RowBox[{
      SubscriptBox[
       StyleBox["SL",
        FontSlant->"Italic"], "m"], "(", "\[DoubleStruckCapitalZ]", ")"}]}],
    TraditionalForm], " ", "and", " ", 
   FormBox[
    RowBox[{"R", "\[Element]", 
     RowBox[{
      SubscriptBox[
       StyleBox["SL",
        FontSlant->"Italic"], "n"], "(", "\[DoubleStruckCapitalZ]", ")"}]}],
    TraditionalForm], " ", "exist", " ", "and", " ", "are", " ", "such", " ", 
   "that", "  "}]}]], "Text",
 CellChangeTimes->{{3.4970495644879627`*^9, 3.497049719016959*^9}, {
  3.4970499748809433`*^9, 3.497049979520865*^9}, {3.829576878733612*^9, 
  3.8295768787378407`*^9}, {3.829576938868896*^9, 
  3.829576959348991*^9}},ExpressionUUID->"1da8db98-e5bb-49e2-adab-\
330ff7317aea"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"L", " ", "A", " ", "R"}], "=", 
    RowBox[{"D", "=", 
     RowBox[{"diag", "(", 
      RowBox[{
       SubscriptBox["d", "1"], ",", 
       SubscriptBox["d", "2"], ",", "\[Ellipsis]", ",", 
       SubscriptBox["d", "s"], ",", "0", ",", "\[Ellipsis]", ",", "0"}], 
      ")"}]}]}], ","}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.4970497351477537`*^9, 
  3.4970498087231617`*^9}},ExpressionUUID->"da8a3036-6f3b-43ad-9650-\
659564dfef6b"],

Cell[BoxData[
 RowBox[{"where", " ", 
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["d", "i"], ">", "0"}], ",", 
    RowBox[{"i", "\[Element]", 
     RowBox[{"[", 
      RowBox[{"1", ",", "s"}], "]"}]}]}],
   TraditionalForm], " ", "and", " ", 
  FormBox[
   SubscriptBox["d", "i"],
   TraditionalForm], " ", "divides", " ", 
  FormBox[
   SubscriptBox["d", 
    RowBox[{"i", "+", "1"}]],
   TraditionalForm], " ", "for", " ", 
  RowBox[{
   FormBox[
    RowBox[{"i", "\[Element]", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"s", "-", "1"}]}], "]"}]}],
    TraditionalForm], "."}]}]], "Text",
 CellChangeTimes->{{3.497049810139598*^9, 3.497049923424739*^9}, {
   3.497050153818039*^9, 3.497050166416691*^9}, {3.829576878742133*^9, 
   3.829576878743973*^9}, 
   3.8295769748731833`*^9},ExpressionUUID->"13b66ab3-5afe-4d55-b8d1-\
4cc2be187b43"],

Cell[TextData[{
 "The matrix ",
 Cell[BoxData[
  FormBox["D", TraditionalForm]],ExpressionUUID->
  "34fc74e0-e296-4304-a2c5-d50bd3ace691"],
 " is called the Smith normal form of ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "70d78c51-6a8a-46fd-89b3-ad719ddad6fa"],
 "."
}], "Text",
 CellChangeTimes->{{3.497050255772545*^9, 
  3.497050324848048*^9}},ExpressionUUID->"0a5d8d6f-7804-4f1c-8f91-\
9a76df43ffff"],

Cell[TextData[{
 "This theorem can be proved constructively, by giving an algorithm that \
computes the matrices ",
 Cell[BoxData[
  FormBox["L", TraditionalForm]],ExpressionUUID->
  "f75889a6-6575-4426-abd2-2b130964a759"],
 ", ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],ExpressionUUID->
  "720b23c3-eead-4a65-8f86-e0a53e864977"],
 ", and ",
 Cell[BoxData[
  FormBox["D", TraditionalForm]],ExpressionUUID->
  "1c4881d8-9c33-4220-9794-b5ea765bd813"],
 " given a matrix ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "d6aafb0b-bdc3-44c1-9598-4578162e9875"],
 ". Before giving the algorithm for the proof, let us see how this theorem \
can be used to answer the question  "
}], "Text",
 CellChangeTimes->{{3.497050222671574*^9, 3.497050251871954*^9}, {
  3.497050332290305*^9, 3.4970503823045053`*^9}, {3.497050413038892*^9, 
  3.497050414192205*^9}, {3.497052348266705*^9, 3.4970523601523743`*^9}, {
  3.497052532090869*^9, 3.4970525652881107`*^9}, {3.497052783059305*^9, 
  3.497052805586123*^9}},ExpressionUUID->"1dae08ac-7adf-4bcd-8f71-\
0e57251a9282"],

Cell["We have the equation equivalence", "Text",
 CellChangeTimes->{{3.497054319388833*^9, 3.49705431996847*^9}, {
  3.4970774528841763`*^9, 3.4970774627241697`*^9}, {3.497077660702806*^9, 
  3.4970776630440693`*^9}},ExpressionUUID->"a4c7c3ea-d04d-4521-83de-\
eea139b2247c"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"A", " ", "x"}], "=", " ", 
   RowBox[{
    RowBox[{"0", "\[DoubleLeftRightArrow]", 
     RowBox[{"L", " ", "A", " ", "x"}]}], "=", 
    RowBox[{
     RowBox[{"0", "\[DoubleLeftRightArrow]", 
      RowBox[{"L", " ", "A", " ", "R", " ", "y"}]}], " ", "=", 
     RowBox[{
      RowBox[{"0", "\[DoubleLeftRightArrow]", 
       RowBox[{"D", " ", "y"}]}], "=", "0."}]}]}]}], 
  TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.49705432536967*^9, 3.497054351563055*^9}, {
  3.497077407762055*^9, 3.497077469373192*^9}, {3.497077586174941*^9, 
  3.497077586958047*^9}},ExpressionUUID->"63506c51-6f65-4de2-95ad-\
0f21b7ca6888"],

Cell[TextData[{
 "Multiplying the solution of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"D", " ", "y"}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "24201c08-c261-4436-b4bf-c3f86a0ea2fd"],
 " with ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],ExpressionUUID->
  "0dc7a0fe-952a-427f-b050-d15c9ee206d8"],
 " we can find the solution of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "x"}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "dc162f2f-8578-4615-b1b6-00b42bb1b67f"],
 ", i.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    RowBox[{"R", " ", "y"}]}], TraditionalForm]],ExpressionUUID->
  "9d0d0b07-f85f-4886-b5ee-3a47ecd0fa89"],
 "."
}], "Text",
 CellChangeTimes->{{3.497077482223206*^9, 3.4970775240525093`*^9}, {
  3.4970775580843067`*^9, 
  3.497077653853485*^9}},ExpressionUUID->"2e458701-a567-418e-9f1c-\
a6c19d437e34"],

Cell["Definition", "Subsubsection",
 CellChangeTimes->{{3.4969769207330112`*^9, 
  3.496976935354972*^9}},ExpressionUUID->"59a797ed-a502-41ad-9618-\
b6fba766871e"],

Cell["Examples", "Subsubsection",
 CellChangeTimes->{{3.496977110111141*^9, 
  3.496977112187179*^9}},ExpressionUUID->"fefba3f5-e704-47d5-afa6-\
05a912e762f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Intuitive example (ok, it is not)",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.495838650457703*^9, 3.4958386600755157`*^9}, {
  3.4969703013394957`*^9, 3.496970309434102*^9}, {3.496973939723476*^9, 
  3.4969739432985888`*^9}},ExpressionUUID->"ef8b9538-a55d-4760-807e-\
12e55546e431"],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"(", GridBox[{
      {"3", "0", 
       RowBox[{"-", "1"}], "0"},
      {"8", "0", "0", 
       RowBox[{"-", "2"}]},
      {"0", "2", 
       RowBox[{"-", "2"}], 
       RowBox[{"-", "1"}]}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.495838693647643*^9, 
  3.4958387048799877`*^9}},ExpressionUUID->"6db6ba11-b2c5-4fb3-ba22-\
2fe918619e4e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]2", "[", 
    RowBox[{"3", ",", "1", ",", "2"}], "]"}], ".", 
   RowBox[{"\[Rho]2", "[", 
    RowBox[{"3", ",", "3", ",", "2"}], "]"}], ".", "m", ".", 
   RowBox[{"\[Gamma]2", "[", 
    RowBox[{"4", ",", "1", ",", "2"}], "]"}]}], "//", "MatrixForm"}]], "Input",\

 CellChangeTimes->{{3.495838751833906*^9, 3.495838872592959*^9}, {
   3.495838953041582*^9, 3.4958389532846823`*^9}, 
   3.495839007471327*^9},ExpressionUUID->"ed599377-b263-420f-b97e-\
9f758715caa4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", "0", 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "1"}]},
     {"0", "3", 
      RowBox[{"-", "1"}], "0"},
     {"0", "8", "0", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.495838785106703*^9, 3.4958387946273127`*^9}, 
   3.495838836223324*^9, 3.495838873486455*^9, 3.495838953547147*^9, 
   3.4958390076019077`*^9, 3.4958394447393827`*^9, 3.495839492570321*^9, {
   3.49585183698695*^9, 3.4958518711703043`*^9}, 
   3.4958519133865023`*^9},ExpressionUUID->"6d97e94f-b871-4674-8be6-\
fe63f76a594d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]1", "[", 
    RowBox[{"3", ",", "3", ",", "2", ",", 
     RowBox[{"-", "8"}]}], "]"}], ".", 
   RowBox[{"\[Rho]1", "[", 
    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "]"}], ".", "%"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.495838892416288*^9, {3.495839360957964*^9, 3.495839361242997*^9}, {
   3.4958394010922203`*^9, 3.495839489977961*^9}, {3.495851827825564*^9, 
   3.495851831112472*^9}, {3.4958518665809803`*^9, 3.495851866816259*^9}, {
   3.495851906201335*^9, 
   3.495851906448266*^9}},ExpressionUUID->"c26f64f4-b36a-4e0a-8341-\
72704b362063"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", "0", 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "1"}]},
     {"0", "3", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "8", 
      RowBox[{"-", "6"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.49583936281548*^9, 3.4958393662810307`*^9}, {
  3.495839414896434*^9, 3.495839418721949*^9}, {3.495839451463491*^9, 
  3.495839493632125*^9}, {3.495851838853869*^9, 3.4958518720680943`*^9}, {
  3.495851907161729*^9, 
  3.495851914453062*^9}},ExpressionUUID->"01d39f54-b95d-484b-95b5-\
df615f04867e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]2", "[", 
    RowBox[{"3", ",", "1", ",", "3"}], "]"}], ".", 
   RowBox[{"(", 
    RowBox[{"m", ".", 
     RowBox[{"\[Gamma]2", "[", 
      RowBox[{"4", ",", "1", ",", "4"}], "]"}]}], ")"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.495838751833906*^9, 3.495838872592959*^9}, {
   3.495838953041582*^9, 3.4958389532846823`*^9}, 3.495839007471327*^9, {
   3.495839816705674*^9, 3.495839829064962*^9}, {3.495839883732749*^9, 
   3.495839947145605*^9}},ExpressionUUID->"3b28fa53-207f-4eb1-8e30-\
5e6684bcfff8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "2", 
      RowBox[{"-", "2"}], "0"},
     {
      RowBox[{"-", "2"}], "0", "0", "8"},
     {"0", "0", 
      RowBox[{"-", "1"}], "3"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.495838785106703*^9, 3.4958387946273127`*^9}, 
   3.495838836223324*^9, 3.495838873486455*^9, 3.495838953547147*^9, 
   3.4958390076019077`*^9, 3.4958394447393827`*^9, 3.495839492570321*^9, {
   3.49583981806382*^9, 3.4958398481985493`*^9}, {3.49583988718228*^9, 
   3.495839947281893*^9}, {3.4958400104020967`*^9, 3.4958400243844852`*^9}, {
   3.495840358952897*^9, 3.495840431918358*^9}, {3.4958404694933443`*^9, 
   3.4958404813671923`*^9}, 3.495840529780085*^9, 3.495841039613461*^9, 
   3.495851918168331*^9},ExpressionUUID->"e484f45d-f6c7-49e4-b7da-\
63dca6d9aabf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]1", "[", 
    RowBox[{"3", ",", "2", ",", "1", ",", 
     RowBox[{"-", "2"}]}], "]"}], ".", "%"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.495838892416288*^9, {3.495839360957964*^9, 3.495839361242997*^9}, {
   3.4958394010922203`*^9, 3.495839489977961*^9}, {3.495839997466633*^9, 
   3.495840014833107*^9}},ExpressionUUID->"f98e985c-2870-4dc2-bd31-\
c82c105a92bb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "2", 
      RowBox[{"-", "2"}], "0"},
     {"0", 
      RowBox[{"-", "4"}], "4", "8"},
     {"0", "0", 
      RowBox[{"-", "1"}], "3"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.49583936281548*^9, 3.4958393662810307`*^9}, {
   3.495839414896434*^9, 3.495839418721949*^9}, {3.495839451463491*^9, 
   3.495839493632125*^9}, {3.495840008027689*^9, 3.495840025377036*^9}, {
   3.495840360107593*^9, 3.495840432968505*^9}, {3.495840470483831*^9, 
   3.495840482639267*^9}, 3.495840530600025*^9, 3.495841040836158*^9, 
   3.495851919553383*^9},ExpressionUUID->"03ce7763-4dcc-47aa-9be4-\
a93ae4d29a7d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", ".", 
   RowBox[{"\[Gamma]1", "[", 
    RowBox[{"4", ",", "2", ",", "1", ",", "2"}], "]"}], ".", 
   RowBox[{"\[Gamma]1", "[", 
    RowBox[{"4", ",", "3", ",", "1", ",", 
     RowBox[{"-", "2"}]}], "]"}], ".", 
   RowBox[{"\[Gamma]1", "[", 
    RowBox[{"4", ",", "3", ",", "2", ",", "1"}], "]"}], ".", 
   RowBox[{"\[Gamma]1", "[", 
    RowBox[{"4", ",", "4", ",", "2", ",", "2"}], "]"}], ".", 
   RowBox[{"\[Gamma]1", "[", 
    RowBox[{"4", ",", "4", ",", "3", ",", "3"}], "]"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.495838892416288*^9, {3.495839360957964*^9, 3.495839361242997*^9}, {
   3.4958394010922203`*^9, 3.495839489977961*^9}, {3.495839997466633*^9, 
   3.495840014833107*^9}, {3.495840211050124*^9, 3.4958402245563183`*^9}, {
   3.495840333142819*^9, 
   3.495840527995595*^9}},ExpressionUUID->"49ed804b-a560-4ec3-9548-\
efac2a88d2ad"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", 
      RowBox[{"-", "4"}], "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.4958403551235437`*^9, 3.495840434664427*^9}, {
   3.495840471471014*^9, 3.49584049538101*^9}, 3.4958405315641403`*^9, 
   3.495841042803172*^9, 
   3.495851921557034*^9},ExpressionUUID->"46908ee2-03e7-4407-8f3e-\
81ade1afa76c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Rho]2", "[", 
      RowBox[{"3", ",", "2", ",", "3"}], "]"}], ".", "%"}], ")"}], ".", 
   RowBox[{"\[Gamma]2", "[", 
    RowBox[{"4", ",", "3", ",", "2"}], "]"}], ".", 
   RowBox[{"\[Gamma]3", "[", 
    RowBox[{"4", ",", "1"}], "]"}], ".", 
   RowBox[{"\[Gamma]3", "[", 
    RowBox[{"4", ",", "2"}], "]"}], ".", 
   RowBox[{"\[Gamma]3", "[", 
    RowBox[{"4", ",", "3"}], "]"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.495838892416288*^9, {3.495839360957964*^9, 3.495839361242997*^9}, {
   3.4958394010922203`*^9, 3.495839489977961*^9}, {3.495839997466633*^9, 
   3.495840014833107*^9}, {3.495840211050124*^9, 3.4958402245563183`*^9}, {
   3.495840333142819*^9, 3.495840527995595*^9}, {3.4958406972685223`*^9, 
   3.4958407730420113`*^9}, {3.4958410012381763`*^9, 3.495841036346877*^9}, {
   3.495851772329981*^9, 
   3.4958517795769577`*^9}},ExpressionUUID->"d63e3431-17d7-4aed-bcc7-\
31780ba02f82"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "4", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4958407747027197`*^9, 3.4958410438321867`*^9, 
  3.4958519228752832`*^9},ExpressionUUID->"bbf821d5-1811-4d06-9467-\
659d13ad4459"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{
    RowBox[{"\[Rho]2", "[", 
     RowBox[{"3", ",", "2", ",", "3"}], "]"}], ".", 
    RowBox[{"\[Rho]1", "[", 
     RowBox[{"3", ",", "2", ",", "1", ",", 
      RowBox[{"-", "2"}]}], "]"}], ".", 
    RowBox[{"\[Rho]2", "[", 
     RowBox[{"3", ",", "1", ",", "3"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"A", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.4958410684397697`*^9, 
  3.495841125688878*^9}},ExpressionUUID->"6b4b1d7e-3abd-43bf-b2cc-\
e3a06986811a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1"},
     {"1", "0", "0"},
     {"0", "1", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.49584111830224*^9, 3.495841126326222*^9}, 
   3.495851923801506*^9},ExpressionUUID->"aaecdbaf-efea-4d92-9230-\
8bb0418be8ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{
    RowBox[{"\[Gamma]2", "[", 
     RowBox[{"4", ",", "1", ",", "4"}], "]"}], ".", 
    RowBox[{"\[Gamma]1", "[", 
     RowBox[{"4", ",", "2", ",", "1", ",", "2"}], "]"}], ".", 
    RowBox[{"\[Gamma]1", "[", 
     RowBox[{"4", ",", "3", ",", "1", ",", 
      RowBox[{"-", "2"}]}], "]"}], ".", 
    RowBox[{"\[Gamma]1", "[", 
     RowBox[{"4", ",", "3", ",", "2", ",", "1"}], "]"}], ".", 
    RowBox[{"\[Gamma]1", "[", 
     RowBox[{"4", ",", "4", ",", "2", ",", "2"}], "]"}], ".", 
    RowBox[{"\[Gamma]1", "[", 
     RowBox[{"4", ",", "4", ",", "3", ",", "3"}], "]"}], ".", 
    RowBox[{"\[Gamma]2", "[", 
     RowBox[{"4", ",", "3", ",", "2"}], "]"}], ".", 
    RowBox[{"\[Gamma]3", "[", 
     RowBox[{"4", ",", "1"}], "]"}], ".", 
    RowBox[{"\[Gamma]3", "[", 
     RowBox[{"4", ",", "2"}], "]"}], ".", 
    RowBox[{"\[Gamma]3", "[", 
     RowBox[{"4", ",", "3"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"B", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.495841131571014*^9, 3.495841172433065*^9}, {
  3.495851762430729*^9, 3.4958517667055883`*^9}, {3.495851932851918*^9, 
  3.495851933306801*^9}},ExpressionUUID->"2e9ff9b0-9d57-4c42-890a-\
355142497b2e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "1"},
     {"0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "5"},
     {"0", 
      RowBox[{"-", "1"}], "0", "3"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "2"}], "4"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.4958411540070477`*^9, 3.495841173187932*^9}, {
  3.495851925643567*^9, 
  3.495851934018237*^9}},ExpressionUUID->"5a1217e1-14df-4280-96fc-\
fd21334df558"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"A", ".", "m", ".", "B"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.495841189778853*^9, 
  3.49584121273076*^9}},ExpressionUUID->"870ff69a-1555-4e6a-8881-\
2a67e7ddbbcd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "4", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.495841194272562*^9, 3.495841213166379*^9}, 
   3.49585193613743*^9},ExpressionUUID->"cdeed02e-b59d-4e14-a8a5-\
30d463583e26"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", ".", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "x"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.495856749003105*^9, 3.4958567720496483`*^9}, {
  3.495856812698408*^9, 3.4958568470815687`*^9}, {3.495856898757391*^9, 
  3.495856901449394*^9}, {3.495857003062235*^9, 
  3.495857005273447*^9}},ExpressionUUID->"bb5eb50c-d078-4780-852c-\
9b8c67cffe44"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", 
   RowBox[{"5", " ", "x"}], ",", 
   RowBox[{"3", " ", "x"}], ",", 
   RowBox[{"4", " ", "x"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4958568180321608`*^9, 3.495856847548046*^9}, 
   3.495856901941411*^9, 
   3.495857006847583*^9},ExpressionUUID->"8a9b7c0e-afc2-41e8-baf1-\
8358871c802a"]
}, Open  ]],

Cell[BoxData[
 FormBox["", TraditionalForm]], "Equation",ExpressionUUID->"7bdfed40-99cb-40a1-b821-68d486183a08"]
}, Closed]],

Cell[CellGroupData[{

Cell["Other formulations", "Subsection",
 CellChangeTimes->{{3.496704587339046*^9, 3.496704590198565*^9}},
 FontSlant->"Italic",ExpressionUUID->"e7e67f30-f9c0-420f-9d49-5b76a3e54943"],

Cell["\<\
A question that should be answered is under what conditions we have solutions \
of the balancing problem. This question can be answered using each of the \
methods for balancing presented above. \
\>", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, {3.496643264187997*^9, 
   3.496643264264138*^9}},ExpressionUUID->"018e603d-ac47-4f52-80a2-\
8ed6542ae508"],

Cell["\<\
So, it can be reformulated as (i) under what conditions a System of Linear \
Diophantine Equations (SLDE) has a solution, (ii) under what conditions a \
homogeneous system of linear equations has multiple solutions.\
\>", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, 3.496643264187997*^9, {
   3.496703358680395*^9, 
   3.4967033973804703`*^9}},ExpressionUUID->"dc754a61-01fc-4359-882e-\
4251d5e6fda3"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Code",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.496937422247843*^9, 
  3.496937423671081*^9}},ExpressionUUID->"99160cad-c647-4aad-99cf-\
aef033866f16"],

Cell[CellGroupData[{

Cell["Numeric / Symbolic", "Subsubsection",
 CellChangeTimes->{{3.49696217884359*^9, 3.4969621792491827`*^9}, {
  3.496962212291333*^9, 
  3.496962220881301*^9}},ExpressionUUID->"7996d56d-ba46-49c6-94c0-\
6283ecf68d23"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]1", "[", 
    RowBox[{"2", ",", "2", ",", "1", ",", 
     RowBox[{"-", "2"}]}], "]"}], ".", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "3", "a"},
       {"2", "0", "b"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496934322885666*^9, 3.49693435304957*^9}, {
   3.4969343861490917`*^9, 3.496934464065218*^9}, {3.4969347243251343`*^9, 
   3.496934728993257*^9}, {3.496935275151835*^9, 3.496935305619025*^9}, {
   3.496935357547503*^9, 3.496935379418519*^9}, {3.4969354302302732`*^9, 
   3.496935467930604*^9}, {3.496936440270431*^9, 3.4969365052654667`*^9}, {
   3.4969366428406143`*^9, 3.4969366486481657`*^9}, 3.496937313843198*^9, {
   3.496961901932371*^9, 3.4969619103866158`*^9}, 
   3.49696196325385*^9},ExpressionUUID->"c7347f8f-26ba-4570-8647-\
784c36a9e0cf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "3", "a"},
     {"0", 
      RowBox[{"-", "6"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "a"}], "+", "b"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.49693650573041*^9, 3.496936648898156*^9, 3.4969373139811783`*^9, 
   3.496954326097177*^9, {3.4969619111052303`*^9, 
   3.496961963938654*^9}},ExpressionUUID->"abf62a71-b373-4f52-94ce-\
d5b7a33ec1f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]1", "[", 
     RowBox[{"2", ",", "1", ",", "2", ",", 
      RowBox[{"1", "/", "2"}]}], "]"}], ".", "%"}], "//", "MatrixForm"}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.496934322885666*^9, 3.49693435304957*^9}, {
  3.4969343861490917`*^9, 3.496934464065218*^9}, {3.4969347243251343`*^9, 
  3.496934728993257*^9}, {3.496935275151835*^9, 3.496935305619025*^9}, {
  3.496935357547503*^9, 3.496935379418519*^9}, {3.4969354302302732`*^9, 
  3.4969355150243587`*^9}, {3.496935595273752*^9, 3.4969355959776993`*^9}, {
  3.4969619178051558`*^9, 3.496961920906393*^9}, {3.4969619553086987`*^9, 
  3.496961970308013*^9}},ExpressionUUID->"90f3d372-d8de-439c-af23-\
c1d8812f5426"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", 
      FractionBox["b", "2"]},
     {"0", 
      RowBox[{"-", "6"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "a"}], "+", "b"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.4969354969983387`*^9, 3.496935518330514*^9}, {
   3.4969355746292477`*^9, 3.496935624796317*^9}, 3.496937331230227*^9, 
   3.496954328414557*^9, 3.496954370731696*^9, 3.496961802188335*^9, {
   3.496961914020206*^9, 
   3.496961970520708*^9}},ExpressionUUID->"d0e3bf7d-eec7-4abb-9718-\
c800d1a4ea24"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]3", "[", 
    RowBox[{"2", ",", "2", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "6"}]}], "]"}], ".", "%"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496934322885666*^9, 3.49693435304957*^9}, {
  3.4969343861490917`*^9, 3.496934464065218*^9}, {3.4969347243251343`*^9, 
  3.496934728993257*^9}, {3.496935275151835*^9, 3.496935305619025*^9}, {
  3.496935357547503*^9, 3.496935379418519*^9}, {3.4969354302302732`*^9, 
  3.4969355150243587`*^9}, {3.496935595273752*^9, 3.4969355959776993`*^9}, {
  3.4969373394683447`*^9, 
  3.496937354752556*^9}},ExpressionUUID->"292d1e7a-4569-4f17-bbd5-\
5e2b07f05fac"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", 
      FractionBox["b", "2"]},
     {"0", "1", 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "a"}], "-", "b"}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.496937356212978*^9, 3.4969543293984823`*^9, 
  3.4969543719149227`*^9, 3.496961931286867*^9, 
  3.4969619728388033`*^9},ExpressionUUID->"622f3164-804c-4a19-bde7-\
ddf987f8d812"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "z"}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.496941053650896*^9, 3.4969411068256397`*^9}, {
   3.4969412805750103`*^9, 3.4969413608973618`*^9}, 3.496941404975171*^9, {
   3.496954334166704*^9, 
   3.49695433565762*^9}},ExpressionUUID->"746c6ec0-3682-4ded-9cbe-\
6f86db0a731f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"b", " ", "z"}], "2"], ",", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "a"}], "-", "b"}], ")"}], " ", "z"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.496941059429274*^9, 3.496941107248247*^9}, {
   3.49694128404778*^9, 3.4969413098317137`*^9}, 3.4969413425485764`*^9, {
   3.496941372898877*^9, 3.496941405314891*^9}, 3.496954336245496*^9, 
   3.496954373612808*^9, 
   3.496961976286837*^9},ExpressionUUID->"4fb6f01d-e46c-4bb0-a730-\
c8d4a7d9a2da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%%", ".", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"-", "%"}], ",", "z"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.496941053650896*^9, 3.4969411068256397`*^9}, {
  3.4969412805750103`*^9, 3.496941411392036*^9}, {3.496954341333702*^9, 
  3.496954341595298*^9}},ExpressionUUID->"f897396f-5218-420c-be1f-\
4378cf4234ff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.496941368114143*^9, 3.496941413596499*^9}, 
   3.496954342348949*^9, 
   3.4969619777864313`*^9},ExpressionUUID->"17add3ac-ca9b-483d-b6ba-\
3b5460af4831"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Symbolic", "Subsubsection",
 CellChangeTimes->{{3.496962228096923*^9, 
  3.4969622293135233`*^9}},ExpressionUUID->"377b4a38-8948-4e59-8055-\
5d65e7feee99"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RowReduce", "[", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"a", "b", "c"},
      {"d", "e", "f"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], "]"}]], "Input",
 CellChangeTimes->{{3.496962103794929*^9, 3.496962153482885*^9}, {
  3.496962235020132*^9, 
  3.496962249202828*^9}},ExpressionUUID->"0f55076e-c188-4d2e-8b52-\
703e7925605f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"c", " ", "e"}], "-", 
       RowBox[{"b", " ", "f"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "b"}], " ", "d"}], "+", 
       RowBox[{"a", " ", "e"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"c", " ", "d"}], "-", 
       RowBox[{"a", " ", "f"}]}], 
      RowBox[{
       RowBox[{"b", " ", "d"}], "-", 
       RowBox[{"a", " ", "e"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.496962126570064*^9, 3.496962153986867*^9}, 
   3.496962367937495*^9, 3.496963208787662*^9, 3.496965222156702*^9, 
   3.49696526679326*^9},ExpressionUUID->"60511bd7-de52-4efb-b169-\
b3d5afeee35b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]1", "[", 
    RowBox[{"2", ",", "2", ",", "1", ",", 
     RowBox[{
      RowBox[{"-", "d"}], "/", "a"}]}], "]"}], ".", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "b", "c"},
       {"d", "e", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496962103794929*^9, 3.496962153482885*^9}, {
   3.496962235020132*^9, 3.496962267407762*^9}, {3.49696232844352*^9, 
   3.4969623361072397`*^9}, 
   3.496962551391591*^9},ExpressionUUID->"99f2a166-ab85-461d-9a73-\
269b092476a8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "b", "c"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"b", " ", "d"}], "a"]}], "+", "e"}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"c", " ", "d"}], "a"]}], "+", "f"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.49696249035454*^9, {3.49696254147174*^9, 3.4969625707850437`*^9}, {
   3.496962862476273*^9, 3.496962870165341*^9}, 3.496963209006198*^9, 
   3.49696522237283*^9, 
   3.4969652670232153`*^9},ExpressionUUID->"6101ac41-596e-427d-81ac-\
349b4aa06245"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]1", "[", 
     RowBox[{"2", ",", "1", ",", "2", ",", 
      RowBox[{
       RowBox[{"-", "b"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"b", " ", "d"}], "a"]}], "+", "e"}], ")"}]}]}], "]"}], ".", 
    TagBox["%",
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496962376259346*^9, 3.496962448260076*^9}, {
  3.496962852132306*^9, 
  3.496962860594541*^9}},ExpressionUUID->"fc95ac9f-dc22-427c-84ce-\
ec202d803897"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "0", 
      FractionBox[
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "e"}], "-", 
          RowBox[{"b", " ", "f"}]}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "b"}], " ", "d"}], "+", 
        RowBox[{"a", " ", "e"}]}]]},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"b", " ", "d"}], "a"]}], "+", "e"}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"c", " ", "d"}], "a"]}], "+", "f"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.4969624500579643`*^9, 3.496962494787912*^9, {3.4969625581386213`*^9, 
   3.496962571389324*^9}, {3.4969628633545227`*^9, 3.496962871256918*^9}, 
   3.496963209072934*^9, 3.496965222443266*^9, 
   3.496965267085396*^9},ExpressionUUID->"206d6c1e-6368-4fff-ade6-\
0ea040c1bfdc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]3", "[", 
     RowBox[{"2", ",", "1", ",", 
      RowBox[{"1", "/", "a"}]}], "]"}], ".", 
    TagBox["%",
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496962376259346*^9, 3.496962488086728*^9}, {
  3.496962531803772*^9, 
  3.4969625657544193`*^9}},ExpressionUUID->"7c305f89-131d-4426-93fa-\
d5a5235e551d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "e"}], "-", 
        RowBox[{"b", " ", "f"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "b"}], " ", "d"}], "+", 
        RowBox[{"a", " ", "e"}]}]]},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"b", " ", "d"}], "a"]}], "+", "e"}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"c", " ", "d"}], "a"]}], "+", "f"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.496962480778721*^9, 3.496962496069643*^9}, {
   3.49696255922685*^9, 3.496962572739088*^9}, 3.4969632091719522`*^9, 
   3.496965222510899*^9, 
   3.496965267162842*^9},ExpressionUUID->"00b94518-1bf3-440e-930d-\
4747afdff619"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]3", "[", 
     RowBox[{"2", ",", "2", ",", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"b", " ", "d"}], "a"]}], "+", "e"}], ")"}]}]}], "]"}], ".", 
    TagBox["%",
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496962376259346*^9, 3.496962488086728*^9}, 
   3.496962529271698*^9, {3.4969625790935383`*^9, 
   3.496962581530835*^9}},ExpressionUUID->"64b440c5-e6af-42a8-b4a0-\
35cd4e17f5fe"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "e"}], "-", 
        RowBox[{"b", " ", "f"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "b"}], " ", "d"}], "+", 
        RowBox[{"a", " ", "e"}]}]]},
     {"0", "1", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "d"}], "-", 
        RowBox[{"a", " ", "f"}]}], 
       RowBox[{
        RowBox[{"b", " ", "d"}], "-", 
        RowBox[{"a", " ", "e"}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.496962560528318*^9, 3.4969625822049007`*^9}, 
   3.4969632092409487`*^9, 3.4969652225869617`*^9, 
   3.4969652672276506`*^9},ExpressionUUID->"e1ebca13-68ba-45e5-8300-\
e70e7e6d4ef3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v2", "=", 
  RowBox[{"%", ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "z"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"v", "=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"-", "v2"}], ",", "z"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.496963144709073*^9, 3.49696315110716*^9}, {
  3.496965192388255*^9, 
  3.496965212989448*^9}},ExpressionUUID->"61bab9a8-580d-4844-8cc1-\
041cb08a0e70"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "e"}], "-", 
       RowBox[{"b", " ", "f"}]}], ")"}], " ", "z"}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "b"}], " ", "d"}], "+", 
     RowBox[{"a", " ", "e"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "-", 
       RowBox[{"a", " ", "f"}]}], ")"}], " ", "z"}], 
    RowBox[{
     RowBox[{"b", " ", "d"}], "-", 
     RowBox[{"a", " ", "e"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.4969631524139*^9, 3.496963209322075*^9, 
  3.496965222683735*^9, 
  3.4969652672988234`*^9},ExpressionUUID->"3d4d0d4b-5a49-4b50-9c38-\
a4feaa0b7ff4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "e"}], "-", 
        RowBox[{"b", " ", "f"}]}], ")"}], " ", "z"}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "b"}], " ", "d"}], "+", 
      RowBox[{"a", " ", "e"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "-", 
        RowBox[{"a", " ", "f"}]}], ")"}], " ", "z"}], 
     RowBox[{
      RowBox[{"b", " ", "d"}], "-", 
      RowBox[{"a", " ", "e"}]}]]}], ",", "z"}], "}"}]], "Output",
 CellChangeTimes->{3.4969631524139*^9, 3.496963209322075*^9, 
  3.496965222683735*^9, 
  3.496965267344796*^9},ExpressionUUID->"368ab21c-d40a-45aa-ad69-\
dd5267df66c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%%%", ".", "v"}], " ", "//", " ", "Simplify"}]], "Input",
 CellChangeTimes->{3.496965217315683*^9, 
  3.49696526330724*^9},ExpressionUUID->"f655b143-fcdc-49e4-afeb-2ee8024551e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.4969632093972797`*^9, 3.4969652229180117`*^9, 
  3.4969652674385033`*^9},ExpressionUUID->"06bab92a-a3bd-413f-84b3-\
31253878a969"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Det", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "e"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.496964828058463*^9, 
  3.49696484508317*^9}},ExpressionUUID->"fcb25205-7d62-412e-802d-\
17244fa97fcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "b"}], " ", "d"}], "+", 
  RowBox[{"a", " ", "e"}]}]], "Output",
 CellChangeTimes->{3.4969648459710217`*^9, 3.496965223043648*^9, 
  3.496965267535007*^9},ExpressionUUID->"125d1c74-aa3e-4eae-ae28-\
d24047295290"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exercises", "Section",
 CellChangeTimes->{{3.4969682991641808`*^9, 
  3.4969683047940807`*^9}},ExpressionUUID->"e0dec2db-f062-42bb-974d-\
1c8054f2f115"],

Cell[CellGroupData[{

Cell["Exercise 1", "Subsection",
 CellChangeTimes->{{3.49696838464402*^9, 
  3.4969683960186653`*^9}},ExpressionUUID->"ee153067-2adf-42a6-938e-\
57308aaba336"],

Cell["Show that from the reduced row echelon form", "Text",
 CellChangeTimes->{{3.496968402526688*^9, 
  3.496968423450523*^9}},ExpressionUUID->"1ffb939a-f22d-4ec5-a881-\
545242929eea"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["References", "Section",
 CellChangeTimes->{{3.488071372106266*^9, 
  3.488071377522324*^9}},ExpressionUUID->"45b89743-5f84-4586-a053-\
2db2c2a8fd64"],

Cell["\<\
[1] Crocker, \"Application of Diophantine Equations to Problems in \
Chemistry\", J. Chem. Educ., 1968, 45 (11), p 731.\
\>", "Text",
 CellChangeTimes->{{3.49436803147502*^9, 3.4943681241230516`*^9}, {
   3.4943681820677233`*^9, 3.494368198086286*^9}, 
   3.497049537021809*^9},ExpressionUUID->"e283077a-641f-4af2-8ef0-\
c9b0e49990aa"],

Cell["\<\
[2] Campanario, J. M. (1995), \"Automatic 'Balancing' of Chemical \
Equations\", Computers Chem.,19, 85-90.\
\>", "Text",
 CellChangeTimes->{{3.4943678980310097`*^9, 3.494367902851012*^9}, {
  3.494368126610832*^9, 
  3.49436812689012*^9}},ExpressionUUID->"d9d1a2f6-b111-47e9-af11-\
e48dc98bcfeb"],

Cell["\<\
[*] Software for Chemical Reaction Stoichiometry (CRS), \
http://www.chemical-stoichiometry.net/software.htm .\
\>", "Text",
 CellChangeTimes->{{3.4943679283421373`*^9, 3.494367930834272*^9}, {
  3.4943681534505987`*^9, 3.494368177626903*^9}, {3.497049539567452*^9, 
  3.4970495399356203`*^9}},ExpressionUUID->"49cd5e5e-4d86-4738-818a-\
89494c77320f"],

Cell["\<\
[3] Lezebnik, On systems of linear Diophantine equations, (1996).\
\>", "Text",
 CellChangeTimes->{{3.497049137032634*^9, 3.4970491430635147`*^9}, {
  3.4970494989702168`*^9, 
  3.497049533535409*^9}},ExpressionUUID->"9a2a5e79-dd26-4a12-b35f-\
57780eebb58e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Section hyperlinks", "Section",
 CellChangeTimes->{{3.485353070347357*^9, 3.485353083727057*^9}, {
   3.485355500308876*^9, 3.485355503983049*^9}, 3.492904600191969*^9},
 FontSlant->"Italic",ExpressionUUID->"4e6c5ab0-3b38-4394-88b8-e526499bf6c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hyperlink", "[", 
  RowBox[{
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Everything is an expression\>\"", ",", "\"\<Text\>\"", ",", 
     RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
   "\"\<paclet:tutorial/EverythingIsAnExpression\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.485352095929475*^9, 3.4853521259369373`*^9}, {
   3.485352163650888*^9, 3.485352210541203*^9}, {3.485352948054144*^9, 
   3.48535299108145*^9}, 
   3.492904600192778*^9},ExpressionUUID->"42624724-4cc9-4e16-bc45-\
1c31e9575be7"],

Cell[BoxData[
 TagBox[
  ButtonBox[
   PaneSelectorBox[{False->
    StyleBox["\<\"Everything is an expression\"\>", "Text",
     StripOnInput->False,
     FontSize->12], True->
    StyleBox[
     StyleBox["\<\"Everything is an expression\"\>", "Text",
      StripOnInput->False,
      FontSize->12], "HyperlinkActive"]}, Dynamic[
     CurrentValue["MouseOver"]],
    BaseStyle->{"Hyperlink"},
    BaselinePosition->Baseline,
    FrameMargins->0,
    ImageSize->Automatic],
   BaseStyle->"Link",
   ButtonData->"paclet:tutorial/EverythingIsAnExpression",
   ButtonNote->"paclet:tutorial/EverythingIsAnExpression"],
  Annotation[#, "paclet:tutorial/EverythingIsAnExpression", 
   "Hyperlink"]& ]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.485352090131234*^9, 3.485352126492825*^9}, {
   3.485352165196126*^9, 3.485352210944434*^9}, {3.4853529597516937`*^9, 
   3.485352991262547*^9}, 
   3.492904600195362*^9},ExpressionUUID->"a55ef12c-fb9e-4924-90a4-\
a4b53163e3e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hyperlink", "[", 
  RowBox[{
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Expressions\>\"", ",", "\"\<Text\>\"", ",", 
     RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
   "\"\<paclet:guide/Expressions\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.485352095929475*^9, 3.4853521259369373`*^9}, {
   3.485352163650888*^9, 3.485352210541203*^9}, {3.485352494551867*^9, 
   3.4853525141209784`*^9}, {3.48535302612949*^9, 3.4853530418168993`*^9}, 
   3.492904600196742*^9},ExpressionUUID->"6b51719c-3928-471a-8b73-\
82b63b86425a"],

Cell[BoxData[
 TagBox[
  ButtonBox[
   PaneSelectorBox[{False->
    StyleBox["\<\"Expressions\"\>", "Text",
     StripOnInput->False,
     FontSize->12], True->
    StyleBox[
     StyleBox["\<\"Expressions\"\>", "Text",
      StripOnInput->False,
      FontSize->12], "HyperlinkActive"]}, Dynamic[
     CurrentValue["MouseOver"]],
    BaseStyle->{"Hyperlink"},
    BaselinePosition->Baseline,
    FrameMargins->0,
    ImageSize->Automatic],
   BaseStyle->"Link",
   ButtonData->"paclet:guide/Expressions",
   ButtonNote->"paclet:guide/Expressions"],
  Annotation[#, "paclet:guide/Expressions", "Hyperlink"]& ]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.485352509925057*^9, 3.485352514443326*^9}, 
   3.485353042296403*^9, 
   3.492904600197295*^9},ExpressionUUID->"f3f69d5a-f889-43d3-b6ca-\
a8586ab3f0fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hyperlink", "[", 
  RowBox[{
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Tally\>\"", ",", "\"\<Program\>\""}], "]"}], ",", 
   "\"\<paclet:ref/Tally\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.485352095929475*^9, 3.4853521259369373`*^9}, {
   3.485352163650888*^9, 3.485352210541203*^9}, {3.485352494551867*^9, 
   3.4853525141209784`*^9}, {3.48535302612949*^9, 3.4853530418168993`*^9}, {
   3.485353640381893*^9, 3.485353661874166*^9}, {3.485354034705617*^9, 
   3.4853540593255653`*^9}, {3.48535409811581*^9, 3.485354116666267*^9}, {
   3.492904336418384*^9, 3.492904377272974*^9}, {3.492904448105538*^9, 
   3.492904484588662*^9}, 
   3.4929046002022457`*^9},ExpressionUUID->"7c858772-c646-40ed-9bf4-\
8a833e932bde"],

Cell[BoxData[
 TagBox[
  ButtonBox[
   PaneSelectorBox[{False->
    StyleBox["\<\"Tally\"\>", "Program",
     StripOnInput->False], True->
    StyleBox[
     StyleBox["\<\"Tally\"\>", "Program",
      StripOnInput->False], "HyperlinkActive"]}, Dynamic[
     CurrentValue["MouseOver"]],
    BaseStyle->{"Hyperlink"},
    BaselinePosition->Baseline,
    FrameMargins->0,
    ImageSize->Automatic],
   BaseStyle->"Link",
   ButtonData->"paclet:ref/Tally",
   ButtonNote->"paclet:ref/Tally"],
  Annotation[#, "paclet:ref/Tally", "Hyperlink"]& ]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.48535411704497*^9, {3.4929043452899227`*^9, 3.492904377775836*^9}, {
   3.4929044496532516`*^9, 3.49290448502775*^9}, 
   3.4929046002058477`*^9},ExpressionUUID->"6e8bc1d7-8ae0-41b1-a294-\
a0e85c8bcd61"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1646, 1250},
WindowMargins->{{780, Automatic}, {Automatic, -1356}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.5, 1.5 Inherited],
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6c268eb9-8681-4d87-b94d-7afef6a21f23"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 515, 8, 146, "Title",ExpressionUUID->"3f8fc1b9-1a00-4b54-ad4f-62e8a36910b8"],
Cell[1085, 32, 159, 3, 47, "Author",ExpressionUUID->"3b000d43-6cc7-4779-a718-bd2bf054df77"],
Cell[1247, 37, 221, 4, 31, "Institution",ExpressionUUID->"1f08a81d-87a3-4a0d-af43-d52c6736370a"],
Cell[CellGroupData[{
Cell[1493, 45, 178, 3, 101, "Section",ExpressionUUID->"54389376-0cd3-4789-a933-fd83c884a3c9"],
Cell[1674, 50, 768, 13, 122, "Text",ExpressionUUID->"51efb276-c86d-4ccc-bfc0-fd2ebe75de07"],
Cell[2445, 65, 824, 13, 88, "Text",ExpressionUUID->"6241d38a-44c4-43ef-9a79-28ef7e8473cf"],
Cell[3272, 80, 206, 3, 53, "Text",ExpressionUUID->"17845732-a4f9-4b17-bd2f-509873dd3c96"],
Cell[3481, 85, 739, 12, 122, "Text",ExpressionUUID->"969f8141-0494-4b6e-90cd-2f3848c5664c"],
Cell[4223, 99, 208, 3, 53, "Text",ExpressionUUID->"5040502a-015d-43ce-a86a-47dae58b3da3"],
Cell[4434, 104, 387, 8, 53, "Text",ExpressionUUID->"1823f382-9760-4ef2-a281-792d79c32871"],
Cell[4824, 114, 1133, 17, 191, "Text",ExpressionUUID->"cf29634a-91ee-4bda-9812-f9c7b40622fe"],
Cell[5960, 133, 431, 13, 119, "Input",ExpressionUUID->"7d3001a2-b5b9-4e8d-89c2-72097cc05f5c"],
Cell[CellGroupData[{
Cell[6416, 150, 223, 4, 67, "Subsubsection",ExpressionUUID->"f3488825-84d7-45b0-94ee-3ecf43798a83"],
Cell[6642, 156, 914, 18, 89, "Text",ExpressionUUID->"90a265ff-a186-46ee-be5b-6cda4d686d65"],
Cell[7559, 176, 1908, 46, 125, "Text",ExpressionUUID->"f738cd17-1566-400b-8cd7-78d82d320ae1"],
Cell[9470, 224, 1719, 46, 90, "Text",ExpressionUUID->"9d526787-58fe-4f72-b348-eca0863dee1b"],
Cell[11192, 272, 1644, 28, 54, "Equation",ExpressionUUID->"da3fe8dc-3865-4d09-87fd-21f53cfc34f0"],
Cell[12839, 302, 2533, 76, 91, "Text",ExpressionUUID->"91634801-143a-4b20-97e0-bfb5b0fbd885"],
Cell[15375, 380, 541, 15, 36, "Equation",ExpressionUUID->"5abe04af-8da0-46cd-9a21-2a7fc8db678c"],
Cell[15919, 397, 627, 10, 88, "Text",ExpressionUUID->"6acbef31-62fb-4ac8-bb40-f2e4ecc216ba"],
Cell[16549, 409, 172, 3, 53, "Text",ExpressionUUID->"07b4ed6a-1871-4f00-b9fa-4754be988364"],
Cell[16724, 414, 342, 8, 30, "Equation",ExpressionUUID->"68149ee0-f3a1-46a7-98d4-ed50c6926d1d"],
Cell[17069, 424, 829, 16, 89, "Text",ExpressionUUID->"c30b9616-757f-456c-a2f5-d9fc5e2c769c"],
Cell[17901, 442, 876, 32, 93, "Input",ExpressionUUID->"6f26e688-2e4c-4ece-b393-7869332f189c"],
Cell[18780, 476, 193, 3, 53, "Text",ExpressionUUID->"78d48388-3320-4b2f-8aec-1b80340fe111"],
Cell[18976, 481, 2126, 59, 119, "Input",ExpressionUUID->"807a2ad0-430e-4632-940d-0a4a0177d649"],
Cell[21105, 542, 543, 9, 53, "Text",ExpressionUUID->"44ee6c0b-673f-4f45-864b-bfc24b2eb9d4"],
Cell[CellGroupData[{
Cell[21673, 555, 922, 26, 93, "Input",ExpressionUUID->"c9053bed-8e4a-4332-85b4-3a92e80ea6a5"],
Cell[22598, 583, 293, 7, 52, "Output",ExpressionUUID->"edbd3796-b277-4fc2-b23c-c59b710bdc4e"]
}, Open  ]],
Cell[22906, 593, 352, 7, 53, "Text",ExpressionUUID->"6da7edc9-82b5-41f8-89aa-d55838c40816"],
Cell[23261, 602, 371, 5, 53, "Text",ExpressionUUID->"83ccca75-641f-4007-950e-e7d8eb01d60b"],
Cell[23635, 609, 1583, 48, 93, "Input",ExpressionUUID->"8eedbb30-1e8d-4bf8-88cd-fbdd821ff0c2"],
Cell[25221, 659, 203, 3, 53, "Text",ExpressionUUID->"3815f431-efbd-413e-99c2-ecc0b23f1101"],
Cell[25427, 664, 646, 22, 52, "Output",ExpressionUUID->"1f80c839-4d27-42c6-b98c-0c11fdadfb84"],
Cell[26076, 688, 434, 10, 53, "Text",ExpressionUUID->"961052ac-5d54-47b0-a01b-b935cc67ce89"],
Cell[CellGroupData[{
Cell[26535, 702, 1946, 53, 93, "Input",ExpressionUUID->"3f0b0ed5-1766-4098-80e9-47d697516a1d"],
Cell[28484, 757, 518, 17, 52, "Output",ExpressionUUID->"58100cfc-fc58-4f38-b1bf-785508e71cac"]
}, Open  ]],
Cell[29017, 777, 294, 8, 53, "Text",ExpressionUUID->"d9ccdce8-a619-460e-a384-dca58c12ca35"],
Cell[CellGroupData[{
Cell[29336, 789, 763, 21, 46, "Input",ExpressionUUID->"ac50a8e7-834b-4b98-bf1d-5d4d5d5a2070"],
Cell[30102, 812, 504, 15, 68, "Output",ExpressionUUID->"a9c32add-9a1e-4020-94f4-69c1073f7847"]
}, Open  ]],
Cell[30621, 830, 200, 7, 53, "Text",ExpressionUUID->"20e3d37a-4369-4290-8842-f030ed3f11be"],
Cell[CellGroupData[{
Cell[30846, 841, 765, 21, 46, "Input",ExpressionUUID->"40362be2-050b-467c-82b6-632f6138a566"],
Cell[31614, 864, 423, 11, 52, "Output",ExpressionUUID->"743df37f-730f-4bc7-9926-d3661a08d185"]
}, Open  ]],
Cell[32052, 878, 273, 7, 53, "Text",ExpressionUUID->"6369998a-ed3d-427f-9d50-895a71a5ebdd"],
Cell[32328, 887, 293, 9, 52, "Output",ExpressionUUID->"c1c9be5a-bc67-48dd-950f-2646eb7d57b3"],
Cell[32624, 898, 311, 6, 53, "Text",ExpressionUUID->"b1796a7c-a99f-41d2-a5dd-2c43634be4f5"],
Cell[CellGroupData[{
Cell[32960, 908, 1076, 27, 46, "Input",ExpressionUUID->"9052ee31-bc36-494f-bf9b-05b2bec96a65"],
Cell[34039, 937, 687, 19, 52, "Output",ExpressionUUID->"fa195db5-046b-47c1-98c9-d8e966447dab"]
}, Open  ]],
Cell[34741, 959, 284, 8, 53, "Text",ExpressionUUID->"c97a2b95-9855-40c6-9e27-79bc75d5a706"],
Cell[CellGroupData[{
Cell[35050, 971, 315, 6, 46, "Input",ExpressionUUID->"7a395717-b443-4d90-aaa7-b6b4d65a10dd"],
Cell[35368, 979, 1007, 36, 47, "Output",ExpressionUUID->"03d8f3f1-cf7e-4f9c-8a62-e469cbc9c150"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36424, 1021, 169, 3, 67, "Subsubsection",ExpressionUUID->"9806ec4c-5f9e-4c81-bea5-896ad0b12918"],
Cell[36596, 1026, 415, 9, 31, "Text",ExpressionUUID->"718766da-8163-4053-84fe-44ff9d2484f7"],
Cell[CellGroupData[{
Cell[37036, 1039, 434, 9, 30, "Input",ExpressionUUID->"51943819-ea37-4151-9263-cd26114b5bcb"],
Cell[37473, 1050, 969, 29, 103, "Output",ExpressionUUID->"15aaab94-269e-46ab-ba64-db3706df0dd1"]
}, Open  ]],
Cell[38457, 1082, 190, 3, 31, "Text",ExpressionUUID->"c612fd56-ae51-4e19-85f2-9b9ebd6eec44"],
Cell[38650, 1087, 1017, 30, 101, "Input",ExpressionUUID->"6293363c-fe0b-4213-a13d-a9f9123a5761"],
Cell[39670, 1119, 306, 5, 31, "Text",ExpressionUUID->"5d5d53a7-ed78-4c53-b3e9-92d52b0d9e88"],
Cell[39979, 1126, 722, 22, 53, "Text",ExpressionUUID->"0e64f84b-4395-470a-855f-2aed2fbcd4ff"],
Cell[40704, 1150, 297, 6, 31, "Text",ExpressionUUID->"43929cf1-8261-40f6-a26c-a147988dc6f3"],
Cell[41004, 1158, 301, 8, 31, "Text",ExpressionUUID->"956b9a05-b3ba-477b-b4dc-e59b45ae04d1"],
Cell[CellGroupData[{
Cell[41330, 1170, 679, 20, 30, "Input",ExpressionUUID->"d81070cd-33bf-4ed8-8237-8ca5b28a1efb"],
Cell[42012, 1192, 365, 10, 30, "Output",ExpressionUUID->"9bc610af-11e0-46ba-965b-4c0e0e99d49c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42414, 1207, 394, 13, 79, "Input",ExpressionUUID->"734391a3-8378-431e-be9e-972c3e68734c"],
Cell[42811, 1222, 219, 6, 30, "Output",ExpressionUUID->"781e4969-5f52-4c7f-9c55-451ab8d74b30"]
}, Open  ]],
Cell[43045, 1231, 346, 7, 52, "Text",ExpressionUUID->"7258fb80-28fb-4595-8511-4225b64139fb"]
}, Closed]],
Cell[CellGroupData[{
Cell[43428, 1243, 196, 4, 55, "Subsection",ExpressionUUID->"f69bcce8-ccb3-45b6-8d99-eff9075c24fb"],
Cell[43627, 1249, 733, 19, 78, "Input",ExpressionUUID->"db04f306-deb0-47e5-a704-1f2760ec9419"],
Cell[CellGroupData[{
Cell[44385, 1272, 657, 19, 46, "Input",ExpressionUUID->"fcca520d-54bd-4732-98c1-9c08d40a6cea"],
Cell[45045, 1293, 1420, 21, 115, "Output",ExpressionUUID->"a0c84e6c-f33a-4e3f-885b-f1d93303693e"]
}, Open  ]],
Cell[46480, 1317, 2275, 63, 119, "Input",ExpressionUUID->"18256079-05d4-484f-a6d6-ba76d11b84e7"],
Cell[CellGroupData[{
Cell[48780, 1384, 610, 19, 46, "Input",ExpressionUUID->"5002538e-7b49-4087-9f68-26d88c6a0bcb"],
Cell[49393, 1405, 1030, 32, 99, "Output",ExpressionUUID->"b3bb0cea-c481-4dd7-a28c-fab1d653e12b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50484, 1444, 244, 4, 101, "Section",ExpressionUUID->"82a1586e-4338-4376-81ae-b3b41b6f4bb0"],
Cell[50731, 1450, 292, 6, 53, "Text",ExpressionUUID->"455b8702-2e2f-4cee-afca-9658a9c90bc6"],
Cell[CellGroupData[{
Cell[51048, 1460, 391, 9, 46, "Input",ExpressionUUID->"354ef40d-910c-4fdc-8f02-2b7ea5bb172b"],
Cell[51442, 1471, 1147, 30, 84, "Output",ExpressionUUID->"f4432d65-be43-487a-9a1e-ea0ed46ab66d"]
}, Open  ]],
Cell[52604, 1504, 642, 11, 88, "Text",ExpressionUUID->"3ad6fe09-81f8-4dd7-b62c-ec580f8b57c1"],
Cell[53249, 1517, 263, 6, 53, "Text",ExpressionUUID->"7419064b-c612-4769-af20-e5ed9f5dc284"],
Cell[CellGroupData[{
Cell[53537, 1527, 298, 7, 46, "Input",ExpressionUUID->"e38c40b0-a1b7-49e4-af2e-4b847a48a7b9"],
Cell[53838, 1536, 312, 7, 52, "Output",ExpressionUUID->"9d625373-6090-4b69-83be-a7cdf5573a5a"]
}, Open  ]],
Cell[54165, 1546, 362, 9, 53, "Text",ExpressionUUID->"ddbe24a6-1045-4002-ac8a-1ea597ce440b"],
Cell[CellGroupData[{
Cell[54552, 1559, 409, 10, 46, "Input",ExpressionUUID->"091219aa-981d-4b9f-90ff-aab9e78e1398"],
Cell[54964, 1571, 595, 16, 52, "Output",ExpressionUUID->"c02c2d4e-f3fd-4ba5-aa27-4e8e38760617"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55596, 1592, 411, 10, 46, "Input",ExpressionUUID->"35f773ff-8bf9-4412-8ce2-a236d13e3009"],
Cell[56010, 1604, 632, 18, 52, "Output",ExpressionUUID->"9371766a-6497-4d3c-b3d6-8f4afe5852c6"]
}, Open  ]],
Cell[56657, 1625, 517, 11, 88, "Text",ExpressionUUID->"bc479e8a-339d-4ad1-982d-658d3f13601e"],
Cell[CellGroupData[{
Cell[57199, 1640, 600, 14, 46, "Input",ExpressionUUID->"c32bae53-07aa-4b56-900b-d3f000ea126c"],
Cell[57802, 1656, 402, 8, 52, "Output",ExpressionUUID->"2ecc3dcd-91ed-44bc-a2da-79f2431551c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58241, 1669, 602, 14, 46, "Input",ExpressionUUID->"c497c9a9-9e7a-4da0-ab9a-a404134d74d9"],
Cell[58846, 1685, 201, 5, 52, "Output",ExpressionUUID->"35789e44-bb96-4f5a-aa37-18edc0b728b6"]
}, Open  ]],
Cell[59062, 1693, 235, 6, 53, "Text",ExpressionUUID->"3b16c327-e9c6-46ae-978e-45722892a15c"],
Cell[CellGroupData[{
Cell[59322, 1703, 822, 20, 46, "Input",ExpressionUUID->"e15f5315-f8ef-4bfb-ad34-7323ee726c7b"],
Cell[60147, 1725, 709, 19, 52, "Output",ExpressionUUID->"ed0c6cad-3588-4f01-a220-2ee674489034"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60893, 1749, 849, 20, 46, "Input",ExpressionUUID->"14a53998-e5c4-4032-bbd3-56a577fb7ba3"],
Cell[61745, 1771, 745, 22, 52, "Output",ExpressionUUID->"c3009d18-a6ed-4330-b53e-4c5cae416612"]
}, Open  ]],
Cell[62505, 1796, 342, 7, 53, "Text",ExpressionUUID->"3177adf0-9d42-4423-bd6e-168be83d4966"],
Cell[CellGroupData[{
Cell[62872, 1807, 1116, 27, 140, "Input",ExpressionUUID->"8a417056-9ec1-452b-8be7-553dc7a3e0da"],
Cell[63991, 1836, 610, 17, 52, "Output",ExpressionUUID->"6093e7f0-5a49-4218-ae50-16c11070a06b"]
}, Open  ]],
Cell[64616, 1856, 238, 6, 53, "Text",ExpressionUUID->"f8d9af8e-7730-41f8-b8bf-b66ec2489c4a"],
Cell[CellGroupData[{
Cell[64879, 1866, 485, 11, 78, "Input",ExpressionUUID->"4b493439-dc75-429d-968b-a8118c8e9fb7"],
Cell[65367, 1879, 413, 10, 52, "Output",ExpressionUUID->"5e954f5f-de5e-473e-a465-ad141a88fd02"]
}, Open  ]],
Cell[65795, 1892, 203, 3, 53, "Text",ExpressionUUID->"8c48e19d-b2d0-4da4-9329-5b1671e49383"],
Cell[CellGroupData[{
Cell[66023, 1899, 448, 11, 78, "Input",ExpressionUUID->"865e328a-9832-4f28-825c-8c7c23bb37a9"],
Cell[66474, 1912, 435, 10, 52, "Output",ExpressionUUID->"239b52a3-987c-4616-b533-ed77566828fc"]
}, Open  ]],
Cell[66924, 1925, 322, 5, 53, "Text",ExpressionUUID->"9d507af3-3daf-4047-9779-779294e7f18c"],
Cell[67249, 1932, 455, 10, 46, "Input",ExpressionUUID->"4d8ec97e-2347-4fdd-b206-34ddea0be799"],
Cell[67707, 1944, 1289, 45, 271, "EquationNumbered",ExpressionUUID->"c0007ab6-3636-4172-9174-e056f45e3449"],
Cell[68999, 1991, 373, 9, 53, "Text",ExpressionUUID->"d14e1237-1eb4-430f-9d11-81e02b548c4a"],
Cell[CellGroupData[{
Cell[69397, 2004, 506, 12, 46, "Input",ExpressionUUID->"a5be5c1a-2067-4d57-af32-751e0d03dd38"],
Cell[69906, 2018, 791, 21, 52, "Output",ExpressionUUID->"7d753f38-eb67-48e9-a3ce-dbb3fca728d6"]
}, Open  ]],
Cell[70712, 2042, 395, 9, 53, "Text",ExpressionUUID->"93027a4d-a60d-4aeb-8607-cc8b74769573"],
Cell[CellGroupData[{
Cell[71132, 2055, 616, 15, 46, "Input",ExpressionUUID->"c330e482-d311-4721-b1d1-def7291a4edc"],
Cell[71751, 2072, 462, 11, 52, "Output",ExpressionUUID->"f1775fb5-bd44-41fb-a558-32281ff7b1f3"]
}, Open  ]],
Cell[72228, 2086, 231, 6, 53, "Text",ExpressionUUID->"fe6ef834-9ee1-4ac7-ba04-c23d5f690a6a"],
Cell[CellGroupData[{
Cell[72484, 2096, 675, 19, 46, "Input",ExpressionUUID->"d5b94b18-3bdf-4a03-9d7d-28615b90e386"],
Cell[73162, 2117, 291, 5, 52, "Output",ExpressionUUID->"58ce1fed-acd7-45a3-97e7-c7bc00f935c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73490, 2127, 675, 19, 46, "Input",ExpressionUUID->"3f254165-d4ba-42a9-8d2a-82b6c2a79a8b"],
Cell[74168, 2148, 212, 3, 52, "Output",ExpressionUUID->"e6152984-ecd4-4dd8-a4a0-6ac0005f3b63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74417, 2156, 234, 5, 46, "Input",ExpressionUUID->"0b5c6253-3e94-41cc-ade4-f55e091e417d"],
Cell[74654, 2163, 227, 4, 52, "Output",ExpressionUUID->"99fca75f-e437-4ef2-8e6c-8dc65e23ff82"]
}, Open  ]],
Cell[74896, 2170, 260, 6, 53, "Text",ExpressionUUID->"591ca1d0-0ff6-489e-9b4b-4a160c6f671e"],
Cell[CellGroupData[{
Cell[75181, 2180, 177, 3, 81, "Subsection",ExpressionUUID->"7a0b4b81-9fd6-46fc-9433-aab742ba1d44"],
Cell[75361, 2185, 565, 10, 88, "Text",ExpressionUUID->"1a23ecb5-e484-41a3-b7e0-7767f7952f01"],
Cell[75929, 2197, 2402, 62, 295, "Input",ExpressionUUID->"2b3d8228-dc14-4880-9f14-9a3711d2ea2b"],
Cell[78334, 2261, 6826, 162, 636, "Input",ExpressionUUID->"a1fb691c-22b1-44d6-8977-2c2c5e4c27a9"],
Cell[CellGroupData[{
Cell[85185, 2427, 155, 3, 67, "Subsubsection",ExpressionUUID->"45270eff-3809-4935-ad52-c909424f0a23"],
Cell[CellGroupData[{
Cell[85365, 2434, 231, 5, 46, "Input",ExpressionUUID->"3d2c5e9e-1114-47d4-8d00-ffbff0c8400c"],
Cell[85599, 2441, 339, 6, 52, "Output",ExpressionUUID->"0693e4e7-c4d0-4212-851c-4eb33cf86940"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85975, 2452, 310, 6, 46, "Input",ExpressionUUID->"cef793ee-9e50-4a25-a73a-bdfe84668688"],
Cell[86288, 2460, 346, 5, 52, "Output",ExpressionUUID->"745d3128-9ba0-4087-91be-3947420c4c06"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86671, 2470, 381, 7, 46, "Input",ExpressionUUID->"954fc7f1-03a1-4c04-86c0-d4b7acc56d84"],
Cell[87055, 2479, 213, 3, 52, "Output",ExpressionUUID->"1a8a16a7-c6c5-4f3b-82aa-9d8b0fc04711"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87341, 2490, 158, 3, 101, "Section",ExpressionUUID->"9072534a-8e4b-49f8-ba0a-925be6525c12"],
Cell[87502, 2495, 312, 6, 53, "Text",ExpressionUUID->"cbf0fef4-8d80-4755-a488-29a950f3bc10"],
Cell[CellGroupData[{
Cell[87839, 2505, 391, 9, 46, "Input",ExpressionUUID->"2f5582f8-e5f1-4202-8fb3-f90e091a8810"],
Cell[88233, 2516, 1150, 30, 84, "Output",ExpressionUUID->"b513076d-6ce1-4bae-974f-ec44499abda5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89420, 2551, 270, 8, 46, "Input",ExpressionUUID->"2853b0fe-b33d-4f6b-b894-cfaa9b0b95db"],
Cell[89693, 2561, 1208, 33, 84, "Output",ExpressionUUID->"2036ac1a-c67c-48d8-a851-ccccfe97f3c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90938, 2599, 296, 8, 46, "Input",ExpressionUUID->"36dc80cb-06df-4c83-85d8-35fe09b46477"],
Cell[91237, 2609, 1010, 28, 84, "Output",ExpressionUUID->"b31494bf-101b-44f1-b59e-342813e0485d"]
}, Open  ]],
Cell[92262, 2640, 616, 11, 88, "Text",ExpressionUUID->"c6adc263-c786-4492-bc54-7d4fc787e02f"],
Cell[92881, 2653, 263, 6, 53, "Text",ExpressionUUID->"684b5f06-ab72-4f14-861e-12bf8dc6662c"],
Cell[CellGroupData[{
Cell[93169, 2663, 298, 7, 46, "Input",ExpressionUUID->"1c1eb402-307b-4f32-b38b-b12964e6d843"],
Cell[93470, 2672, 310, 7, 52, "Output",ExpressionUUID->"ea5ea387-2054-435b-b08e-4dade1a8e332"]
}, Open  ]],
Cell[93795, 2682, 362, 9, 53, "Text",ExpressionUUID->"f3dcf319-610a-471c-9327-7b04ba6429a6"],
Cell[CellGroupData[{
Cell[94182, 2695, 409, 10, 46, "Input",ExpressionUUID->"56f622b3-ac83-4865-8796-17f9835e2285"],
Cell[94594, 2707, 646, 17, 52, "Output",ExpressionUUID->"8c37788e-f490-4105-b617-4c7b5ea48259"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95277, 2729, 362, 9, 46, "Input",ExpressionUUID->"a8a20d2a-0560-42ac-95bf-d53e0ca11ac2"],
Cell[95642, 2740, 609, 18, 52, "Output",ExpressionUUID->"2e0e24d1-688f-4d7c-b063-178036cd3b9b"]
}, Open  ]],
Cell[96266, 2761, 167, 3, 53, "Text",ExpressionUUID->"9bcf6369-c804-49d5-abb1-125c1d6c2feb"],
Cell[CellGroupData[{
Cell[96458, 2768, 458, 12, 46, "Input",ExpressionUUID->"e4f4a1f1-9162-4ce5-8777-7c04c3e0628e"],
Cell[96919, 2782, 556, 16, 52, "Output",ExpressionUUID->"9df9917e-4461-408c-9ebc-226933efcc1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97512, 2803, 506, 12, 46, "Input",ExpressionUUID->"6c895885-8775-41fb-8285-821df7efc89f"],
Cell[98021, 2817, 585, 19, 52, "Output",ExpressionUUID->"b7eff859-bd94-4866-ab9a-3c7f42a414c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98643, 2841, 873, 26, 109, "Input",ExpressionUUID->"93b8738b-6f25-47be-b026-2143ecba0479"],
Cell[99519, 2869, 464, 11, 52, "Output",ExpressionUUID->"631f6531-93e6-4cc0-8dbc-6d6be27e5f56"],
Cell[99986, 2882, 464, 11, 52, "Output",ExpressionUUID->"a5c5c033-4657-444e-998d-b22a424ef344"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100487, 2898, 387, 10, 78, "Input",ExpressionUUID->"0a09124a-bc58-42a4-a960-552db1c77c1b"],
Cell[100877, 2910, 920, 26, 99, "Output",ExpressionUUID->"b2209815-50d1-46df-a1fb-e430b2e96d0e"]
}, Open  ]],
Cell[101812, 2939, 241, 7, 53, "Text",ExpressionUUID->"84a36b22-22e0-4c5b-9ddb-ee71ce1748c8"],
Cell[CellGroupData[{
Cell[102078, 2950, 269, 6, 46, "Input",ExpressionUUID->"73fd8777-9078-48b0-8803-c830983508d6"],
Cell[102350, 2958, 362, 8, 52, "Output",ExpressionUUID->"4d6f53b4-b5d9-4c0d-a792-2a08f6833ac3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102749, 2971, 819, 23, 46, "Input",ExpressionUUID->"a28f59d2-5e09-4f57-a4bd-0f9c871511a8"],
Cell[103571, 2996, 345, 7, 52, "Output",ExpressionUUID->"39ce559f-b197-4562-9dd5-80d8a0bf0296"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103953, 3008, 274, 6, 46, "Input",ExpressionUUID->"ff2ea78b-c7c9-4e75-a531-d1a6ceec01c7"],
Cell[104230, 3016, 735, 19, 52, "Output",ExpressionUUID->"23b36ee9-bc89-4efa-8e25-66f9693cd862"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105002, 3040, 1153, 30, 78, "Input",ExpressionUUID->"2bfc14f2-b013-4782-a894-d428d1798a83"],
Cell[106158, 3072, 321, 5, 52, "Output",ExpressionUUID->"65d7fadd-9359-4d9f-ba41-8ffc82a7eed6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106516, 3082, 1183, 31, 78, "Input",ExpressionUUID->"0a228595-38da-4b45-906f-d79452c18b9d"],
Cell[107702, 3115, 218, 4, 52, "Output",ExpressionUUID->"6603d60a-e406-45eb-b97e-1146f316ff05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107957, 3124, 199, 4, 46, "Input",ExpressionUUID->"4d3bd42c-d14f-45d4-9c44-97ad2523c59c"],
Cell[108159, 3130, 229, 4, 52, "Output",ExpressionUUID->"0ab7f6ef-335d-422a-91a0-89c43b05bd29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108425, 3139, 177, 3, 81, "Subsection",ExpressionUUID->"b5626e53-f263-4a34-bb28-34188507c412"],
Cell[108605, 3144, 3562, 89, 450, "Input",ExpressionUUID->"44d93344-7d28-453d-a5b8-3919be4b30c1"],
Cell[112170, 3235, 8488, 208, 1134, "Input",ExpressionUUID->"94f58834-12c6-4339-bdd1-2bec1cfb8c9d"],
Cell[CellGroupData[{
Cell[120683, 3447, 155, 3, 67, "Subsubsection",ExpressionUUID->"f8631c2b-fedf-4c67-b9c2-01fba2942d23"],
Cell[CellGroupData[{
Cell[120863, 3454, 231, 5, 46, "Input",ExpressionUUID->"3c96347b-4f84-4e46-8c68-92af190b3551"],
Cell[121097, 3461, 578, 10, 52, "Output",ExpressionUUID->"49dc2772-e9c6-4619-9662-77aab169d6a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121712, 3476, 310, 6, 46, "Input",ExpressionUUID->"b2b75ebd-91bd-4f8d-b01b-a90f6df8ec5c"],
Cell[122025, 3484, 558, 9, 52, "Output",ExpressionUUID->"ee7aae4c-90ca-4954-b8b6-31508448e0e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122620, 3498, 381, 7, 46, "Input",ExpressionUUID->"d01249ed-5aa0-4137-b719-246bc0bef18a"],
Cell[123004, 3507, 331, 6, 52, "Output",ExpressionUUID->"238cab62-0ee7-43d1-b107-6e36c95e9ac0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[123384, 3519, 162, 3, 67, "Subsubsection",ExpressionUUID->"9b4fac3a-6ad5-4f68-8a99-f332ff67857f"],
Cell[CellGroupData[{
Cell[123571, 3526, 526, 9, 46, "Input",ExpressionUUID->"e06cb9cc-6f6a-401e-963e-358cdbc2a1d3"],
Cell[124100, 3537, 492, 9, 52, "Output",ExpressionUUID->"6a4bc210-7fa0-40b6-8fae-56a7416ab992"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124629, 3551, 355, 7, 46, "Input",ExpressionUUID->"531308eb-3374-4ba5-8007-98a46b6d41dd"],
Cell[124987, 3560, 481, 8, 52, "Output",ExpressionUUID->"e77996fa-4586-4fd1-9a11-cc2d3f77e758"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125505, 3573, 783, 14, 78, "Input",ExpressionUUID->"f22bf656-137d-4db2-8e96-0d7512ffc6a1"],
Cell[126291, 3589, 415, 7, 52, "Output",ExpressionUUID->"9224d2f2-713a-47c6-acd5-d48b4a900878"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[126755, 3602, 155, 3, 67, "Subsubsection",ExpressionUUID->"71af0258-760b-4f44-a1a1-eb4c5753d9dd"],
Cell[CellGroupData[{
Cell[126935, 3609, 662, 18, 78, "Input",ExpressionUUID->"24fb89ac-2b32-4d5a-96e3-0437c565217c"],
Cell[127600, 3629, 807, 24, 151, "Output",ExpressionUUID->"1de85240-936d-4e4c-bc26-9db1f473f671"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128444, 3658, 600, 15, 78, "Input",ExpressionUUID->"3027f3ce-eb3a-4afe-be89-e07d80cb025c"],
Cell[129047, 3675, 253, 6, 68, "Output",ExpressionUUID->"d3635bce-c4aa-4fe6-bc54-2ffbe0d7140e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129337, 3686, 512, 15, 46, "Input",ExpressionUUID->"aa38c354-8d58-4779-bc21-752e485eeece"],
Cell[129852, 3703, 361, 9, 52, "Output",ExpressionUUID->"011e144a-f7f2-4f6a-b6e3-23abc1025498"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130250, 3717, 561, 17, 46, "Input",ExpressionUUID->"c20dc32a-ffa9-40b1-b606-95add36ed0d3"],
Cell[130814, 3736, 351, 10, 52, "Output",ExpressionUUID->"54dc668c-e2b9-4f47-a222-8a27613234bc"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131238, 3754, 154, 3, 101, "Section",ExpressionUUID->"a1fb9ae6-9755-477a-9251-d7bd45fdb1b5"],
Cell[131395, 3759, 191, 3, 81, "Subsection",ExpressionUUID->"baaa669f-e3fe-4d6b-995d-4b52cfd62be7"],
Cell[131589, 3764, 199, 3, 55, "Subsection",ExpressionUUID->"b0f68e10-e1a1-428a-a375-2b82dbd5b209"],
Cell[131791, 3769, 177, 3, 55, "Subsection",ExpressionUUID->"afb55e4c-1858-470e-a474-780bd84de725"],
Cell[131971, 3774, 245, 6, 55, "Subsection",ExpressionUUID->"93d99e04-250d-4e7e-933c-1b5991a5c7d6"],
Cell[132219, 3782, 202, 3, 55, "Subsection",ExpressionUUID->"d28feb91-9782-4bc7-82e0-84c7bef60314"],
Cell[132424, 3787, 253, 6, 55, "Subsection",ExpressionUUID->"bcdcf033-218f-4697-9d3c-abff044687c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132714, 3798, 167, 3, 101, "Section",ExpressionUUID->"73d25aa4-3121-49c9-8a56-271120d0f789"],
Cell[132884, 3803, 804, 13, 53, "Text",ExpressionUUID->"a1acfcbd-9e09-475b-b67f-866a9249ba54"],
Cell[133691, 3818, 792, 11, 53, "Text",ExpressionUUID->"1f4caf94-f566-44ab-959f-bb9554c32894"],
Cell[134486, 3831, 1049, 17, 53, "Text",ExpressionUUID->"7f25c02a-e1da-408b-ab34-ec874ddb9fb4"],
Cell[135538, 3850, 1196, 18, 122, "Text",ExpressionUUID->"e905c470-735a-44c6-b26e-c5a4f35bb3c3"],
Cell[CellGroupData[{
Cell[136759, 3872, 166, 3, 81, "Subsection",ExpressionUUID->"2abb0df9-6599-443e-9c64-a4d61318c8c9"],
Cell[136928, 3877, 915, 15, 1734, "Text",ExpressionUUID->"bbad2936-7420-499a-a0d0-f04e87752d92"],
Cell[137846, 3894, 1289, 45, 6259, "EquationNumbered",ExpressionUUID->"3e2c5abf-c1a8-48e1-8ec8-0f007f7267d5"],
Cell[139138, 3941, 165, 3, 757, "Text",ExpressionUUID->"4ac00f18-0b87-4f71-85a7-0714610c5a48"],
Cell[139306, 3946, 675, 21, 1750, "EquationNumbered",ExpressionUUID->"a033dfec-4fd1-45d4-b05b-6eb6b0cfb144"],
Cell[139984, 3969, 170, 3, 757, "Text",ExpressionUUID->"55141a04-6752-46d6-a3ae-f6b1d2c4f335"],
Cell[140157, 3974, 849, 25, 1750, "EquationNumbered",ExpressionUUID->"bdbe148f-a560-4c44-bfa8-27eba60b0f01"],
Cell[141009, 4001, 163, 3, 757, "Text",ExpressionUUID->"4e1e51f2-4e90-4846-a0f8-684601ca13ed"],
Cell[141175, 4006, 2169, 62, 2503, "Equation",ExpressionUUID->"2caae508-4e5f-44b9-b2c1-d1f426ba9f73"],
Cell[143347, 4070, 1948, 37, 3208, "Text",ExpressionUUID->"7bf57f6b-9208-4b87-a003-6ad9c5275139"],
Cell[145298, 4109, 1422, 29, 1203, "Equation",ExpressionUUID->"45a2e80e-2032-4c7f-b7a9-519f1dd49883"],
Cell[146723, 4140, 210, 4, 757, "Text",ExpressionUUID->"ccf9c542-b33c-492e-b34d-82dd260f0a4c"],
Cell[146936, 4146, 1007, 27, 1396, "Equation",ExpressionUUID->"89201b56-5e92-43d1-aadd-b033621acf01"],
Cell[147946, 4175, 518, 12, 757, "Text",ExpressionUUID->"ad0b02a1-0a34-490a-a1ef-19fff7969980"],
Cell[148467, 4189, 1286, 36, 1612, "Equation",ExpressionUUID->"cb0c745f-e1c4-431f-84f5-24f3fead2611"],
Cell[149756, 4227, 1027, 31, 1669, "Text",ExpressionUUID->"c2e73808-d55e-468e-8d74-410468bfb977"],
Cell[150786, 4260, 1328, 37, 1477, "Equation",ExpressionUUID->"7ca965a7-07ea-435a-be57-d1f298b7333a"],
Cell[152117, 4299, 678, 12, 1257, "Text",ExpressionUUID->"9a6ccee2-9712-49a9-a771-9815014b1e21"],
Cell[152798, 4313, 903, 29, 1122, "Equation",ExpressionUUID->"bbfb94e1-ea1a-464c-8d92-87dcfc36f62b"],
Cell[153704, 4344, 543, 16, 757, "Text",ExpressionUUID->"7cb43230-8947-403a-9ef6-e2fc5df8baf2"],
Cell[154250, 4362, 830, 26, 609, "Equation",ExpressionUUID->"6bda7d8d-a80e-4861-8850-487461fa68e8"],
Cell[155083, 4390, 931, 15, 1257, "Text",ExpressionUUID->"1b65eb93-19ba-44fb-bfa6-cdd7dab6cf35"]
}, Closed]],
Cell[CellGroupData[{
Cell[156051, 4410, 173, 3, 55, "Subsection",ExpressionUUID->"6461214c-99ef-4fd8-abd2-9e1c6d06bf6c"],
Cell[156227, 4415, 3064, 87, 127, "Text",ExpressionUUID->"643600a2-b478-456a-81c9-b47fef51a503"],
Cell[159294, 4504, 1156, 32, 55, "Text",ExpressionUUID->"1da8db98-e5bb-49e2-adab-330ff7317aea"],
Cell[160453, 4538, 515, 14, 40, "DisplayFormula",ExpressionUUID->"da8a3036-6f3b-43ad-9650-659564dfef6b"],
Cell[160971, 4554, 868, 28, 53, "Text",ExpressionUUID->"13b66ab3-5afe-4d55-b8d1-4cc2be187b43"],
Cell[161842, 4584, 431, 13, 54, "Text",ExpressionUUID->"0a5d8d6f-7804-4f1c-8f91-9a76df43ffff"],
Cell[162276, 4599, 1084, 26, 89, "Text",ExpressionUUID->"1dae08ac-7adf-4bcd-8f71-0e57251a9282"],
Cell[163363, 4627, 274, 4, 53, "Text",ExpressionUUID->"a4c7c3ea-d04d-4521-83de-eea139b2247c"],
Cell[163640, 4633, 675, 17, 40, "DisplayFormula",ExpressionUUID->"63506c51-6f65-4de2-95ad-0f21b7ca6888"],
Cell[164318, 4652, 880, 28, 54, "Text",ExpressionUUID->"2e458701-a567-418e-9f1c-a6c19d437e34"],
Cell[165201, 4682, 163, 3, 67, "Subsubsection",ExpressionUUID->"59a797ed-a502-41ad-9618-b6fba766871e"],
Cell[165367, 4687, 159, 3, 53, "Subsubsection",ExpressionUUID->"fefba3f5-e704-47d5-afa6-05a912e762f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165563, 4695, 324, 5, 81, "Subsection",ExpressionUUID->"ef8b9538-a55d-4760-807e-12e55546e431"],
Cell[165890, 4702, 408, 14, 93, "Input",ExpressionUUID->"6db6ba11-b2c5-4fb3-ba22-2fe918619e4e"],
Cell[CellGroupData[{
Cell[166323, 4720, 517, 13, 46, "Input",ExpressionUUID->"ed599377-b263-420f-b97e-9f758715caa4"],
Cell[166843, 4735, 1068, 28, 99, "Output",ExpressionUUID->"6d97e94f-b871-4674-8be6-fe63f76a594d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167948, 4768, 628, 15, 46, "Input",ExpressionUUID->"c26f64f4-b36a-4e0a-8341-72704b362063"],
Cell[168579, 4785, 1042, 28, 99, "Output",ExpressionUUID->"01d39f54-b95d-484b-95b5-df615f04867e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169658, 4818, 577, 14, 46, "Input",ExpressionUUID->"3b28fa53-207f-4eb1-8e30-5e6684bcfff8"],
Cell[170238, 4834, 1313, 31, 99, "Output",ExpressionUUID->"e484f45d-f6c7-49e4-b7da-63dca6d9aabf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171588, 4870, 433, 10, 46, "Input",ExpressionUUID->"f98e985c-2870-4dc2-bd31-c82c105a92bb"],
Cell[172024, 4882, 1160, 29, 99, "Output",ExpressionUUID->"03ce7763-4dcc-47aa-9be4-a93ae4d29a7d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173221, 4916, 908, 21, 46, "Input",ExpressionUUID->"49ed804b-a560-4ec3-9548-efac2a88d2ad"],
Cell[174132, 4939, 948, 26, 99, "Output",ExpressionUUID->"46908ee2-03e7-4407-8f3e-81ade1afa76c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175117, 4970, 999, 23, 46, "Input",ExpressionUUID->"d63e3431-17d7-4aed-bcc7-31780ba02f82"],
Cell[176119, 4995, 784, 21, 99, "Output",ExpressionUUID->"bbf821d5-1811-4d06-9467-659d13ad4459"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176940, 5021, 542, 15, 78, "Input",ExpressionUUID->"6b4b1d7e-3abd-43bf-b2cc-e3a06986811a"],
Cell[177485, 5038, 787, 22, 99, "Output",ExpressionUUID->"aaecdbaf-efea-4d92-9230-8bb0418be8ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178309, 5065, 1238, 29, 78, "Input",ExpressionUUID->"2e9ff9b0-9d57-4c42-890a-355142497b2e"],
Cell[179550, 5096, 946, 28, 125, "Output",ExpressionUUID->"5a1217e1-14df-4280-96fc-fd21334df558"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180533, 5129, 217, 5, 46, "Input",ExpressionUUID->"870ff69a-1555-4e6a-8881-2a67e7ddbbcd"],
Cell[180753, 5136, 780, 21, 99, "Output",ExpressionUUID->"cdeed02e-b59d-4e14-a8a5-30d463583e26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181570, 5162, 390, 8, 46, "Input",ExpressionUUID->"bb5eb50c-d078-4780-852c-9b8c67cffe44"],
Cell[181963, 5172, 342, 9, 52, "Output",ExpressionUUID->"8a9b7c0e-afc2-41e8-baf1-8358871c802a"]
}, Open  ]],
Cell[182320, 5184, 112, 1, 30, "Equation",ExpressionUUID->"7bdfed40-99cb-40a1-b821-68d486183a08"]
}, Closed]],
Cell[CellGroupData[{
Cell[182469, 5190, 183, 2, 55, "Subsection",ExpressionUUID->"e7e67f30-f9c0-420f-9d49-5b76a3e54943"],
Cell[182655, 5194, 673, 11, 88, "Text",ExpressionUUID->"018e603d-ac47-4f52-80a2-8ed6542ae508"],
Cell[183331, 5207, 721, 12, 88, "Text",ExpressionUUID->"dc754a61-01fc-4359-882e-4251d5e6fda3"]
}, Closed]],
Cell[CellGroupData[{
Cell[184089, 5224, 194, 4, 55, "Subsection",ExpressionUUID->"99160cad-c647-4aad-99cf-aef033866f16"],
Cell[CellGroupData[{
Cell[184308, 5232, 219, 4, 67, "Subsubsection",ExpressionUUID->"7996d56d-ba46-49c6-94c0-6283ecf68d23"],
Cell[CellGroupData[{
Cell[184552, 5240, 1359, 31, 67, "Input",ExpressionUUID->"c7347f8f-26ba-4570-8647-784c36a9e0cf"],
Cell[185914, 5273, 921, 26, 73, "Output",ExpressionUUID->"abf62a71-b373-4f52-94ce-d5b7a33ec1f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186872, 5304, 748, 15, 46, "Input",ExpressionUUID->"90f3d372-d8de-439c-af23-c1d8812f5426"],
Cell[187623, 5321, 1044, 28, 85, "Output",ExpressionUUID->"d0e3bf7d-eec7-4abb-9718-c800d1a4ea24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188704, 5354, 677, 15, 46, "Input",ExpressionUUID->"292d1e7a-4569-4f17-bbd5-5e2b07f05fac"],
Cell[189384, 5371, 959, 27, 95, "Output",ExpressionUUID->"622f3164-804c-4a19-bde7-ddf987f8d812"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190380, 5403, 393, 9, 46, "Input",ExpressionUUID->"746c6ec0-3682-4ded-9cbe-6f86db0a731f"],
Cell[190776, 5414, 580, 16, 70, "Output",ExpressionUUID->"4fb6f01d-e46c-4bb0-a730-c8d4a7d9a2da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191393, 5435, 386, 9, 46, "Input",ExpressionUUID->"f897396f-5218-420c-be1f-4378cf4234ff"],
Cell[191782, 5446, 250, 6, 52, "Output",ExpressionUUID->"17add3ac-ca9b-483d-b6ba-3b5460af4831"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[192081, 5458, 161, 3, 53, "Subsubsection",ExpressionUUID->"377b4a38-8948-4e59-8055-5d65e7feee99"],
Cell[CellGroupData[{
Cell[192267, 5465, 821, 22, 67, "Input",ExpressionUUID->"0f55076e-c188-4d2e-8b52-703e7925605f"],
Cell[193091, 5489, 813, 25, 70, "Output",ExpressionUUID->"60511bd7-de52-4efb-b169-b3d5afeee35b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193941, 5519, 1061, 28, 67, "Input",ExpressionUUID->"99f2a166-ab85-461d-9a73-269b092476a8"],
Cell[195005, 5549, 1082, 31, 85, "Output",ExpressionUUID->"6101ac41-596e-427d-81ac-349b4aa06245"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196124, 5585, 638, 20, 70, "Input",ExpressionUUID->"fc95ac9f-dc22-427c-84ce-ec202d803897"],
Cell[196765, 5607, 1394, 41, 97, "Output",ExpressionUUID->"206d6c1e-6368-4fff-ade6-0ea040c1bfdc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198196, 5653, 464, 14, 46, "Input",ExpressionUUID->"7c305f89-131d-4426-93fa-d5a5235e551d"],
Cell[198663, 5669, 1279, 38, 97, "Output",ExpressionUUID->"00b94518-1bf3-440e-930d-4747afdff619"]
}, Open  ]],
Cell[CellGroupData[{
Cell[199979, 5712, 631, 19, 70, "Input",ExpressionUUID->"64b440c5-e6af-42a8-b4a0-35cd4e17f5fe"],
Cell[200613, 5733, 1219, 36, 2706, "Output",ExpressionUUID->"e1ebca13-68ba-45e5-8300-e70e7e6d4ef3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201869, 5774, 436, 12, 1639, "Input",ExpressionUUID->"61bab9a8-580d-4844-8cc1-041cb08a0e70"],
Cell[202308, 5788, 732, 25, 1639, "Output",ExpressionUUID->"3d4d0d4b-5a49-4b50-9c38-a4feaa0b7ff4"],
Cell[203043, 5815, 797, 27, 1639, "Output",ExpressionUUID->"368ab21c-d40a-45aa-ad69-dd5267df66c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203877, 5847, 213, 4, 1021, "Input",ExpressionUUID->"f655b143-fcdc-49e4-afeb-2ee8024551e3"],
Cell[204093, 5853, 225, 5, 1021, "Output",ExpressionUUID->"06bab92a-a3bd-413f-84b3-31253878a969"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204355, 5863, 330, 10, 1021, "Input",ExpressionUUID->"fcb25205-7d62-412e-802d-17244fa97fcf"],
Cell[204688, 5875, 263, 7, 1021, "Output",ExpressionUUID->"125d1c74-aa3e-4eae-ae28-d24047295290"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[205024, 5890, 158, 3, 101, "Section",ExpressionUUID->"e0dec2db-f062-42bb-974d-1c8054f2f115"],
Cell[CellGroupData[{
Cell[205207, 5897, 159, 3, 81, "Subsection",ExpressionUUID->"ee153067-2adf-42a6-938e-57308aaba336"],
Cell[205369, 5902, 185, 3, 53, "Text",ExpressionUUID->"1ffb939a-f22d-4ec5-a881-545242929eea"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[205603, 5911, 155, 3, 101, "Section",ExpressionUUID->"45b89743-5f84-4586-a053-2db2c2a8fd64"],
Cell[205761, 5916, 345, 7, 53, "Text",ExpressionUUID->"e283077a-641f-4af2-8ef0-c9b0e49990aa"],
Cell[206109, 5925, 307, 7, 53, "Text",ExpressionUUID->"d9d1a2f6-b111-47e9-af11-e48dc98bcfeb"],
Cell[206419, 5934, 361, 7, 53, "Text",ExpressionUUID->"49cd5e5e-4d86-4738-818a-89494c77320f"],
Cell[206783, 5943, 268, 6, 53, "Text",ExpressionUUID->"9a2a5e79-dd26-4a12-b35f-57780eebb58e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207088, 5954, 252, 3, 101, "Section",ExpressionUUID->"4e6c5ab0-3b38-4394-88b8-e526499bf6c1"],
Cell[CellGroupData[{
Cell[207365, 5961, 539, 11, 83034, "Input",ExpressionUUID->"42624724-4cc9-4e16-bc45-1c31e9575be7"],
Cell[207907, 5974, 1006, 27, 50890, "Output",ExpressionUUID->"a55ef12c-fb9e-4924-90a4-a4b53163e3e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208950, 6006, 557, 11, 50890, "Input",ExpressionUUID->"6b51719c-3928-471a-8b73-82b63b86425a"],
Cell[209510, 6019, 846, 25, 50890, "Output",ExpressionUUID->"f3f69d5a-f889-43d3-b6ca-a8586ab3f0fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210393, 6049, 745, 14, 50890, "Input",ExpressionUUID->"7c858772-c646-40ed-9bf4-8a833e932bde"],
Cell[211141, 6065, 830, 24, 50890, "Output",ExpressionUUID->"6e8bc1d7-8ae0-41b1-a294-a0e85c8bcd61"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

