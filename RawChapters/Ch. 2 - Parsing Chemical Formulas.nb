(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    919018,      23668]
NotebookOptionsPosition[    863979,      22829]
NotebookOutlinePosition[    865111,      22865]
CellTagsIndexPosition[    865068,      22862]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Parsing Chemical Formulas and Equations", "Title",
 CellChangeTimes->{{3.441484301148834*^9, 3.441484328702744*^9}, {
  3.441484387080965*^9, 3.4414843950954037`*^9}, {3.460916213295959*^9, 
  3.460916216250139*^9}, {3.4728595615922403`*^9, 3.4728595779679317`*^9}, {
  3.488069501708211*^9, 3.488069519569338*^9}, {3.4880695792795467`*^9, 
  3.488069587618034*^9}, {3.490191124085116*^9, 
  3.490191126597048*^9}},ExpressionUUID->"fe29a8b4-bfba-4785-9e17-\
594ac790e331"],

Cell[CellGroupData[{

Cell["Anton Antonov", "Author",
 CellChangeTimes->{{3.4449300945702057`*^9, 3.444930101932673*^9}, {
  3.7233287932372637`*^9, 
  3.723328793237515*^9}},ExpressionUUID->"54be9971-6d7f-4c93-ac9d-\
bb35f72ef6c7"],

Cell["Mathematica", "Institution",
 CellChangeTimes->{{3.7233287939154587`*^9, 
  3.723328795781493*^9}},ExpressionUUID->"999786cd-ce9b-469e-92d3-\
30df2ce67127"],

Cell["book for Wiley 2009-2010", "Institution",
 CellChangeTimes->{{3.44493010505249*^9, 3.444930142250931*^9}, {
  3.460320667598672*^9, 
  3.460320702010445*^9}},ExpressionUUID->"837312c6-3ed2-4486-b4ce-\
60802b7cdeae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.4880712890840063`*^9, 
  3.488071292665841*^9}},ExpressionUUID->"17dd523d-f607-4051-8552-\
0fe8b8cda95b"],

Cell["\<\
Let us suppose that we want to write a program that balances chemical \
equations. If we, say, have the unbalanced equation\
\>", "Text",
 CellChangeTimes->{{3.488728793501898*^9, 3.488728848281531*^9}, {
  3.488728889259344*^9, 3.488728912410053*^9}, {3.488728965627609*^9, 
  3.488729029962397*^9}, {3.488730779251736*^9, 3.488730812273597*^9}, {
  3.48873087401786*^9, 3.48873088721774*^9}, {3.48873117095043*^9, 
  3.488731210723013*^9}, {3.488731305994827*^9, 3.488731330163654*^9}, {
  3.488731367285142*^9, 3.488731377715848*^9}, {3.488731566220272*^9, 
  3.488731627684657*^9}, {3.488737424461165*^9, 3.48873743988439*^9}, {
  3.488993580717668*^9, 3.488993630937655*^9}, {3.489075193740466*^9, 
  3.489075193744072*^9}, {3.489075335278035*^9, 3.4890753869656267`*^9}, {
  3.489076485493479*^9, 3.489076513062028*^9}, {3.4890766215911827`*^9, 
  3.4890766300780888`*^9}, {3.489085866870976*^9, 3.489085896647743*^9}, {
  3.489183786281952*^9, 3.489183813542144*^9}, {3.489184064505926*^9, 
  3.489184066207353*^9}},ExpressionUUID->"a1fb6244-16fa-46bf-b45a-\
58650b0fb238"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["C", "3"], 
      SubscriptBox["H", "8"]}], "+", 
     SubscriptBox["O", "2"]}], "->", " ", 
    RowBox[{
     RowBox[{"C", " ", 
      SubscriptBox["O", "2"]}], "+", 
     RowBox[{
      SubscriptBox["H", "2"], "O"}]}]}], ","}], TraditionalForm]], "Equation",\

 CellChangeTimes->{{3.4891840540886602`*^9, 3.4891840559439898`*^9}, {
   3.489184164818281*^9, 3.489184182546493*^9}, 
   3.4895433513762817`*^9},ExpressionUUID->"200b325c-51d3-448d-87c3-\
d6b64a7333fc"],

Cell["that can be re-written as", "Text",
 CellChangeTimes->{{3.489184199589226*^9, 
  3.489184210783884*^9}},ExpressionUUID->"ff10da11-2711-44e5-b601-\
da21894a03c1"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", 
      SubscriptBox["C", "3"], 
      SubscriptBox["H", "8"]}], "+", 
     RowBox[{"b", " ", 
      SubscriptBox["O", "2"]}]}], "->", " ", 
    RowBox[{
     RowBox[{"c", " ", "C", " ", 
      SubscriptBox["O", "2"]}], "+", 
     RowBox[{"d", " ", 
      SubscriptBox["H", "2"], "O"}]}]}], ","}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.489183817448042*^9, 3.489183819465403*^9}, {
   3.489183902771233*^9, 3.489183981857111*^9}, 
   3.4895433535443172`*^9},ExpressionUUID->"572e066b-b6bc-447a-afe1-\
0a2745a3633e"],

Cell[TextData[{
 "we want a program to find the stoichiometric coefficients ",
 Cell[BoxData[
  FormBox[
   RowBox[{"a", ",", "b", ",", "c"}], TraditionalForm]],ExpressionUUID->
  "8edf881f-9eb3-4f58-8a0d-509effe9430c"],
 ", and ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "2f7e007b-74af-4e3c-a0cb-5f2d5376467b"],
 "."
}], "Text",
 CellChangeTimes->{{3.489184068501357*^9, 3.489184150544895*^9}, {
   3.48918422295336*^9, 3.489184224177803*^9}, {3.4891843089993963`*^9, 
   3.489184333264594*^9}, {3.4891844510243473`*^9, 3.489184454297267*^9}, 
   3.4895433784959517`*^9, 3.493190052110244*^9, 
   3.49332359911197*^9},ExpressionUUID->"64292ef0-f966-4553-b611-\
c2b79d5add37"],

Cell["\<\
Because of the law of conservation of masses, the amount of atoms of an \
element that appears on the left side of the equation should equal the amount \
of atoms that appear at right side of the equation. Therefore, the problem of \
balancing a chemical equation can be seen as a problem of solving a system of \
linear equations. A basic step of the Chemical Equation Balancer (CEB) is to \
find how many atoms of each element are on the left side and how many atoms \
of each element are on the right side. The mathematical background and \
programming of the CEB are described in the next chapter, \"Chemical equation \
balancing.\"  In this chapter we are going to design and program an \
interpreter of strings representing chemical formulas. That interpreter, \
which we will call Chemical Formula Parser (CFP), would automatically \
recognize how many atoms of each element are in a chemical formula. \
\>", "Text",
 CellChangeTimes->{{3.489184327053894*^9, 3.4891843285596952`*^9}, {
   3.489184456544305*^9, 3.48918463685849*^9}, 3.489487798347355*^9, {
   3.489543315810689*^9, 3.489543318159189*^9}, {3.489544589627829*^9, 
   3.489544667248109*^9}, {3.489879464040276*^9, 3.489879621407654*^9}, {
   3.489879691292884*^9, 3.489879696792116*^9}, {3.489879807519052*^9, 
   3.4898798302715*^9}, {3.48987990807364*^9, 3.489879972839797*^9}, {
   3.4898800048359747`*^9, 3.4898800054182587`*^9}, {3.489880095738956*^9, 
   3.4898801223274603`*^9}, {3.489880204284029*^9, 3.4898802236178827`*^9}, {
   3.489880647094594*^9, 3.4898807597997923`*^9}, 3.4898810517988462`*^9, {
   3.48996750023147*^9, 3.4899675056957693`*^9}, {3.49005025598956*^9, 
   3.4900502676535683`*^9}, {3.4900504601120234`*^9, 3.490050487653844*^9}, {
   3.490050563231338*^9, 3.490050564990003*^9}, {3.490050646826845*^9, 
   3.490050647261366*^9}, {3.4923879341695547`*^9, 3.492387936569661*^9}, {
   3.493218957475272*^9, 3.493218986945183*^9}, {3.493219258233067*^9, 
   3.4932192588730927`*^9}, 
   3.4932422999665947`*^9},ExpressionUUID->"4b700c57-e084-4936-8727-\
f6a77cfc49fa"],

Cell["\<\
Let us explicitly formulate the problem we want to solve using the parser \
described in this chapter.\
\>", "Text",
 CellChangeTimes->{{3.49325840293578*^9, 
  3.4932584036973867`*^9}},ExpressionUUID->"f79994f7-c602-42bc-9468-\
dbed79ba7a3e"],

Cell[CellGroupData[{

Cell["Problem formulation", "Subsection",
 CellChangeTimes->{{3.4932188508945217`*^9, 
  3.493218853744793*^9}},ExpressionUUID->"562e33d1-5304-41bc-9db6-\
43deb22842b2"],

Cell[TextData[{
 "Given a string of the molecule formula of a chemical compound we want to \
compute various quantitative measures and statistics for the compound's \
molecule. More precisely, we want to find the total molecule mass, and the \
percentage of the mass that corresponds to each of the molecule's elements. \
For example, for the molecule ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "6"], 
    SubscriptBox["H", "12"], 
    SubscriptBox["O", "6"]}], TraditionalForm]],ExpressionUUID->
  "cfc10e1d-6571-4145-8268-17ae10ba96ed"],
 " we want to obtain the following data: "
}], "Text",
 CellChangeTimes->{{3.488728793501898*^9, 3.488728848281531*^9}, {
   3.488728889259344*^9, 3.488728912410053*^9}, {3.488728965627609*^9, 
   3.488729029962397*^9}, {3.488730779251736*^9, 3.488730812273597*^9}, {
   3.48873087401786*^9, 3.48873088721774*^9}, {3.48873117095043*^9, 
   3.488731210723013*^9}, {3.488731305994827*^9, 3.488731330163654*^9}, {
   3.488731367285142*^9, 3.488731377715848*^9}, {3.488731566220272*^9, 
   3.488731627684657*^9}, {3.488737424461165*^9, 3.48873743988439*^9}, {
   3.488993580717668*^9, 3.488993630937655*^9}, {3.489075193740466*^9, 
   3.489075328438855*^9}, 3.489487315413103*^9, {3.48954351788142*^9, 
   3.489543575928297*^9}, {3.489543659033691*^9, 3.489543682698357*^9}, {
   3.48954388362289*^9, 3.489543940023406*^9}, {3.489543970463892*^9, 
   3.489543971082244*^9}, {3.48954418289019*^9, 3.489544213464389*^9}, {
   3.489544345665002*^9, 3.4895443651361313`*^9}, {3.489880018018385*^9, 
   3.4898800195815773`*^9}, {3.4898801453549767`*^9, 3.489880172095806*^9}, {
   3.4932188675155277`*^9, 3.493218900533539*^9}, {3.4932190602842493`*^9, 
   3.493219089697254*^9}, {3.493219120911188*^9, 3.4932191528972273`*^9}, {
   3.49321926642976*^9, 3.493219294289274*^9}, {3.493219325527473*^9, 
   3.493219326306426*^9}, {3.49324236764769*^9, 3.493242369288468*^9}, 
   3.493323606701873*^9},ExpressionUUID->"d8f3495f-fdbf-4208-ae1c-\
0dc910992a57"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"moleculeString", "=", "\"\<C6H12O6\>\""}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Molecule formula: \>\"", ",", "Bold", ",", "Italic"}], 
          "]"}], ",", "moleculeString"}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Molecular mass: \>\"", ",", "Bold", ",", "Italic"}], 
          "]"}], ",", 
         RowBox[{"First", "[", 
          RowBox[{"MolecularMassComposition", "[", 
           RowBox[{
            RowBox[{"ParseMolecule", "[", "moleculeString", "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}], 
          "]"}]}], "}"}], "]"}], ",", "\"\<\\n\>\"", ",", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"Rest", "[", 
            RowBox[{"MolecularMassComposition", "[", 
             RowBox[{
              RowBox[{"ParseMolecule", "[", "moleculeString", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "Bold", ",", "Italic"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Element \>\"", ",", "\"\<Mass %\>\"", ",", 
             "\"\<Atomic mass \>\"", ",", "\"\<number of\\natoms\>\""}], 
            "}"}]}]}], "]"}], ",", 
        RowBox[{"Dividers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"None", ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "False"}], "}"}]}], "}"}]}], 
        ",", 
        RowBox[{"Alignment", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Left", ",", "Left", ",", "Left", ",", "Right"}], "}"}], 
          "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.488731885679645*^9, 3.488731938235974*^9}, {
  3.48873201849182*^9, 3.488732103134718*^9}, {3.488732204121586*^9, 
  3.488732379923775*^9}, {3.488732616056084*^9, 3.488732619892799*^9}, {
  3.488737381144268*^9, 3.488737414647825*^9}, {3.488993659496366*^9, 
  3.488993699230289*^9}, {3.488994394140366*^9, 3.488994395088686*^9}, {
  3.489005454983618*^9, 3.489005559847386*^9}, {3.489005727097995*^9, 
  3.489005755037187*^9}, {3.489005824007221*^9, 3.4890058834054956`*^9}, {
  3.489005990547957*^9, 3.489006059456409*^9}, {3.489073634437409*^9, 
  3.489073722797821*^9}, {3.4890737777428303`*^9, 3.4890737882451143`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TemplateBox[{
      StyleBox["\"Molecule formula: \"", StripOnInput -> False, FontWeight -> 
        Bold, FontSlant -> Italic],"\"C6H12O6\""},
      "Row",
      DisplayFunction->(RowBox[{#, "\[InvisibleSpace]", #2}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2}], "}"}], "]"}]& )]},
    {
     TemplateBox[{
      StyleBox["\"Molecular mass: \"", StripOnInput -> False, FontWeight -> 
        Bold, FontSlant -> Italic],
       "180.15588000000000000000000000000000000001`6."},
      "Row",
      DisplayFunction->(RowBox[{#, "\[InvisibleSpace]", #2}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2}], "}"}], "]"}]& )]},
    {"\<\"\\n\"\>"},
    {
     TagBox[GridBox[{
        {
         StyleBox["\<\"Element \"\>",
          StripOnInput->False,
          FontWeight->Bold,
          FontSlant->Italic], 
         StyleBox["\<\"Mass %\"\>",
          StripOnInput->False,
          FontWeight->Bold,
          FontSlant->Italic], 
         StyleBox["\<\"Atomic mass \"\>",
          StripOnInput->False,
          FontWeight->Bold,
          FontSlant->Italic], 
         StyleBox["\<\"number of\\natoms\"\>",
          StripOnInput->False,
          FontWeight->Bold,
          FontSlant->Italic]},
        {"\<\"C\"\>", 
         "0.40001025778342621956052725006810768532`5.698970004336013", 
         "12.0107`6.", "6"},
        {"\<\"H\"\>", 
         "0.0671378586144398950508859327822106056`5.69897000433601", 
         "1.00794`6.", "12"},
        {"\<\"O\"\>", 
         "0.53285188360213388538858681714968170885`5.698970004336013", 
         "15.9994`6.", "6"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {Left, Left, Left, Right}},
       GridBoxDividers->{"Columns" -> {{None}}, "Rows" -> {True, True, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.488731868165741*^9, 3.488731938751968*^9}, 
   3.488732043749815*^9, {3.48873207423054*^9, 3.488732103368376*^9}, 
   3.488732232347995*^9, {3.488732319270966*^9, 3.488732349082106*^9}, 
   3.488732380713201*^9, 3.488732620802748*^9, 3.488737415892623*^9, 
   3.488737845764756*^9, {3.488993677766761*^9, 3.488993680859521*^9}, 
   3.488994344485921*^9, 3.488994395783347*^9, 3.4889970101224003`*^9, 
   3.488997180604237*^9, {3.489005464034004*^9, 3.4890054905366077`*^9}, {
   3.48900552800212*^9, 3.4890055604333963`*^9}, {3.489005728818638*^9, 
   3.48900575551744*^9}, {3.489005848802783*^9, 3.4890058837359257`*^9}, {
   3.489005993369411*^9, 3.4890060598694677`*^9}, {3.489073704535725*^9, 
   3.489073724049342*^9}, 
   3.489073788537444*^9},ExpressionUUID->"fb7de257-daf7-4b0c-bbee-\
6091182b0961"]
}, {2}]],

Cell["\<\
In order to compute the quantitative measures we need to determine which \
elements and what number of their atoms are in the compound's molecule.\
\>", "Text",
 CellChangeTimes->{{3.48866993458862*^9, 3.48867000825483*^9}, {
   3.48873681290701*^9, 3.488736866265412*^9}, {3.488737502605738*^9, 
   3.48873752566043*^9}, {3.489880277439921*^9, 3.489880293424803*^9}, {
   3.490196979749895*^9, 3.490196979752709*^9}, 
   3.493323608861353*^9},ExpressionUUID->"bc5f7097-3c50-4264-b2c6-\
93ae355ffe3b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Approaches", "Subsection",
 CellChangeTimes->{{3.493242290364738*^9, 
  3.4932422929809523`*^9}},ExpressionUUID->"b1ac6e64-becf-41d8-ac17-\
01b7678a83bf"],

Cell["\<\
We are going to show two approaches to parsing molecules. The first one uses \
string matching patterns and it is described in the section \"String match \
parser.\" Reading only that section would provide enough background to move \
to the next chapter,  \"Chemical equation balancing.\" The second approach is \
to define in a formal manner the grammar of the chemical molecule notation, \
and using that grammar to program the concrete steps of the parser. The \
formal description of the chemical formulas notation would be done using the \
so called Backus-Naur Form (BNF), a language for grammar specification.\
\>", "Text",
 CellChangeTimes->{{3.49238675246388*^9, 3.49238678230516*^9}, {
   3.4923868128733187`*^9, 3.492387021002614*^9}, {3.4923871815782433`*^9, 
   3.4923872112493687`*^9}, {3.492387837481524*^9, 3.49238794610546*^9}, {
   3.492388019579664*^9, 3.492388034089649*^9}, {3.4923885063339777`*^9, 
   3.49238853368927*^9}, {3.492557412194551*^9, 3.4925574319695683`*^9}, {
   3.492557703013077*^9, 3.492557731331687*^9}, {3.492784185523376*^9, 
   3.4927841867026863`*^9}, {3.493166666474753*^9, 3.493166676263837*^9}, 
   3.4931669151021023`*^9, {3.493182084605609*^9, 3.493182108321039*^9}, {
   3.493219025715529*^9, 3.49321903850076*^9}, {3.493237126721616*^9, 
   3.493237127709345*^9}, 
   3.493242428215385*^9},ExpressionUUID->"b23b69a3-4a2e-4aca-a09a-\
5d1f8a03c1d7"],

Cell["\<\
The reason we accentuate the second approach is that in general in \
engineering disciplines we prefer the use of standard solutions instead of \
particular (or peculiar) ones. By standard solutions here we mean solutions \
derived within a well understood theoretical or practical framework of \
concepts, approaches, and methodologies. Using these approaches and \
methodologies would, to a degree, guarantee the derivation of the required \
solution.\
\>", "Text",
 CellChangeTimes->{{3.4923855759032097`*^9, 3.492385604112852*^9}, {
   3.492385689664802*^9, 3.492385695832779*^9}, {3.49238599496094*^9, 
   3.492386037954301*^9}, {3.4923861497928143`*^9, 3.49238623421704*^9}, {
   3.4923862779392977`*^9, 3.492386300473136*^9}, {3.492386398986148*^9, 
   3.492386458481332*^9}, 3.492386535692287*^9, 3.493181251424303*^9, {
   3.493182182121282*^9, 3.493182264101542*^9}, {3.4931822986645327`*^9, 
   3.49318235047974*^9}, {3.493182985535768*^9, 3.49318298655015*^9}, {
   3.493189825134973*^9, 3.493189828874284*^9}, {3.493239199740637*^9, 
   3.493239200822342*^9}, {3.4932393596819773`*^9, 
   3.493239359998715*^9}},ExpressionUUID->"6a384a8a-89df-4593-ba10-\
8ba4462d5e50"],

Cell["\<\
The method we follow in this chapter belongs to the theory of compilers, \
programs that translate code of human readable (or high order) programming \
languages to machine code which is readily executable. The method has the \
following steps: \
\>", "Text",
 CellChangeTimes->{{3.489967654616086*^9, 3.489967714855041*^9}, {
  3.489967922327642*^9, 3.4899679299023*^9}, {3.489968063991185*^9, 
  3.4899681149742947`*^9}, {3.490044395815296*^9, 3.490044400444951*^9}, {
  3.49005096034212*^9, 3.49005123246218*^9}, {3.4932369698085737`*^9, 
  3.493237015477337*^9}, {3.493237069512905*^9, 3.4932371228361607`*^9}, {
  3.493237232934835*^9, 3.4932372666749697`*^9}, {3.493239363303492*^9, 
  3.49323948999914*^9}},ExpressionUUID->"17cd53ee-fe41-4ec9-9dae-\
00a407739f15"],

Cell[CellGroupData[{

Cell["\<\
Given a language describe its grammar in a formal manner using BNF or similar \
formalism. \
\>", "Item1",
 CellChangeTimes->{{3.489967654616086*^9, 3.489967714855041*^9}, {
  3.489967922327642*^9, 3.4899679299023*^9}, {3.489968063991185*^9, 
  3.4899681149742947`*^9}, {3.490044395815296*^9, 3.490044400444951*^9}, {
  3.49005096034212*^9, 3.49005123246218*^9}, {3.4932369698085737`*^9, 
  3.493237015477337*^9}, {3.493237069512905*^9, 3.4932371228361607`*^9}, {
  3.493237232934835*^9, 3.493237372386794*^9}, {3.493237551743865*^9, 
  3.4932375528737926`*^9}},ExpressionUUID->"39eeff8c-0053-4c5e-a058-\
55456c042dba"],

Cell["\<\
For each rule of syntactical construction (or language pattern) choose a data \
structure that represents it. \
\>", "Item1",
 CellChangeTimes->{{3.489967654616086*^9, 3.489967714855041*^9}, {
  3.489967922327642*^9, 3.4899679299023*^9}, {3.489968063991185*^9, 
  3.4899681149742947`*^9}, {3.490044395815296*^9, 3.490044400444951*^9}, {
  3.49005096034212*^9, 3.49005123246218*^9}, {3.4932369698085737`*^9, 
  3.493237015477337*^9}, {3.493237069512905*^9, 3.4932371228361607`*^9}, {
  3.493237232934835*^9, 3.49323741356271*^9}, {3.4932378602166157`*^9, 
  3.493237862700625*^9}, {3.4932379145127563`*^9, 
  3.493237958041725*^9}},ExpressionUUID->"14f775e1-c20a-4846-a162-\
c17559fb2079"],

Cell["\<\
Write a syntax analyzer (or parser) that from sequences of symbols produces \
syntactical structures defined by the grammar of the language.\
\>", "Item1",
 CellChangeTimes->{{3.489967654616086*^9, 3.489967714855041*^9}, {
   3.489967922327642*^9, 3.4899679299023*^9}, {3.489968063991185*^9, 
   3.4899681149742947`*^9}, {3.490044395815296*^9, 3.490044400444951*^9}, {
   3.49005096034212*^9, 3.49005123246218*^9}, {3.4932369698085737`*^9, 
   3.493237015477337*^9}, {3.493237069512905*^9, 3.4932371228361607`*^9}, {
   3.493237232934835*^9, 3.493237413560639*^9}, {3.493238010088401*^9, 
   3.493238086329678*^9}, 3.493238168261465*^9, {3.493238242476904*^9, 
   3.493238310040638*^9}, {3.4932384364783983`*^9, 3.493238441153042*^9}, 
   3.493323613509214*^9},ExpressionUUID->"ae04c2f7-c00b-4a4a-88a4-\
7005629b97b8"],

Cell["\<\
For each rule of syntactical construction write an interpreting function \
based on the data structure that represents it.\
\>", "Item1",
 CellChangeTimes->{
  3.4932379208454857`*^9, {3.4932379633206253`*^9, 3.493237990432947*^9}, {
   3.493238504012577*^9, 3.49323851499417*^9}, {3.493238735037719*^9, 
   3.493238738030818*^9}, 3.4932387759729137`*^9, 
   3.493323627965906*^9},ExpressionUUID->"6aac949b-e57c-4582-802f-\
05691ce786b3"]
}, Open  ]],

Cell["\<\
Because we want the section \"String matching parser\" to be independent from \
the rest as much as possible, we are going to discuss first data constructs \
and interpretation.\
\>", "Text",
 CellChangeTimes->{{3.493237565657621*^9, 3.49323771392435*^9}, 
   3.493323633381467*^9},ExpressionUUID->"6a536fcf-4689-42b3-877a-\
ccb8cd763aea"]
}, Open  ]],

Cell["The rest of the chapter", "Subsection",
 CellChangeTimes->{{3.4932434641280127`*^9, 
  3.4932434715988607`*^9}},ExpressionUUID->"85d86543-7bd2-4143-a6a0-\
ba2b218e5df8"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Thinks to speak about",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.4929047845018053`*^9, 
  3.492904792751061*^9}},ExpressionUUID->"f43e66fb-79a1-478f-960b-\
91ea40e9dc0d"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.490196983750495*^9, 3.490196985021618*^9}}],

Cell["Lexical analysis", "Text",
 CellChangeTimes->{{3.490197118919262*^9, 3.490197125621738*^9}}],

Cell["Syntactic analysis", "Text",
 CellChangeTimes->{{3.490197129200438*^9, 3.490197131758769*^9}, {
   3.492772461123176*^9, 3.4927724756599293`*^9}, 3.492772564303046*^9}],

Cell["Parser = Lexical analyser + Syntactic analyzer", "Text",
 CellChangeTimes->{{3.490196986582506*^9, 3.4901969874453983`*^9}, {
   3.492772480214616*^9, 3.492772501580442*^9}, 3.493323736877927*^9}],

Cell["Peoduction = BNF rule", "Text",
 CellChangeTimes->{{3.494794522134473*^9, 3.494794528092032*^9}}],

Cell["Semantic analysis and Code generation", "Text",
 CellChangeTimes->{{3.492772638390442*^9, 3.492772671660103*^9}}],

Cell["Syntactic structure = Parse tree", "Text",
 CellChangeTimes->{{3.4947852421567307`*^9, 3.494785281842476*^9}, {
  3.494790683147678*^9, 3.49479069054718*^9}}],

Cell["\<\
Handle is needed for parsing it is morpheme for terminals and BNF <symbol>\
\>", "Text",
 CellChangeTimes->{{3.4947917494396143`*^9, 3.494791787324318*^9}}],

Cell[TextData[{
 "We show ",
 StyleBox["bottom-up parser",
  FontSlant->"Italic"],
 ". We use something similar to the ",
 StyleBox["shift-reduce parser",
  FontSlant->"Italic"],
 ". Also our grammar is ",
 StyleBox["simple precedence grammar",
  FontSlant->"Italic"],
 ", because we can invert to formula strings using the tree structure if we \
don't use the underscore and parenthesis around single element abbreviation. \
(Proof is needed that the Wirth-Weber precedence relationship holds.)"
}], "Text",
 CellChangeTimes->{{3.4947917924836273`*^9, 3.49479182685161*^9}, {
  3.494791859638726*^9, 3.494791860651585*^9}, {3.4947919228667297`*^9, 
  3.494791940467607*^9}, {3.494792215231464*^9, 3.4947922567072983`*^9}, {
  3.494792382195282*^9, 3.494792537156623*^9}}],

Cell[TextData[{
 "Our parser is also a ",
 StyleBox["predictive parser",
  FontSlant->"Italic"],
 ", because we have only one function for each non-terminal rule in our \
grammar."
}], "Text",
 CellChangeTimes->{{3.494794219680125*^9, 3.494794290269086*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finite automata", "Subsubsection",
 CellChangeTimes->{{3.4901964627823467`*^9, 3.490196466589576*^9}}],

Cell["WFinite automata ", "Text",
 CellChangeTimes->{{3.49019695586664*^9, 3.4901969748935204`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formula representation with data structures", "Subsubsection",
 CellChangeTimes->{{3.488671447463974*^9, 3.4886714607611847`*^9}, {
  3.488671514519457*^9, 3.488671519943405*^9}, {3.48873625504879*^9, 
  3.488736264551138*^9}, {3.488737829343269*^9, 3.488737829805334*^9}}],

Cell["\<\
One way to approach this task is to transform the string that is the chemical \
formula into a data structure that is suitable for calculating molecular mass \
and what percentage to that mass is made by which elements.\
\>", "Text",
 CellChangeTimes->{{3.488736251249826*^9, 3.488736252758835*^9}, {
  3.488737758573885*^9, 3.488737853021183*^9}, {3.488737891597423*^9, 
  3.48873795065404*^9}, {3.488738017775512*^9, 3.488738030014038*^9}, {
  3.488738199093476*^9, 3.488738204254723*^9}, {3.488738246608426*^9, 
  3.488738257278785*^9}}],

Cell["\<\
We can think that a string of a molecule formula is composed of concatenated \
strings of sub-molecules.\
\>", "Text",
 CellChangeTimes->{{3.488738368771131*^9, 3.488738437451395*^9}, {
  3.488738475492436*^9, 3.488738495858644*^9}, {3.494792633819976*^9, 
  3.494792647555505*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chemical formulas grammar", "Subsubsection",
 CellChangeTimes->{{3.488671467327553*^9, 3.488671476983244*^9}}],

Cell["\<\
<element> :: = \"H\" | \"He\" | \"Li\" | \"Be\" | \"B\" | \"C\" | \"N\" | \"O\
\" | \"F\" | \"Ne\" | \"Na\" | \"Mg\" | \"Al\" | \"Si\" | \"P\" | \"S\" | \
\"Cl\" | \"K\" | \"Ar\" | \"Ca\" | \"Sc\" | \"Ti\" | \"V\" | \"Cr\" | \"Mn\" \
| \"Fe\" | \"Ni\" | \"Co\" | \"Cu\" | \"Zn\" | \"Ga\" | \"Ge\" | \"As\" | \
\"Se\" | \"Br\" | \"Kr\" | \"Rb\" | \"Sr\" | \"Y\" | \"Zr\" | \"Nb\" | \"Mo\" \
| \"Tc\" | \"Ru\" | \"Rh\" | \"Pd\" | \"Ag\" | \"Cd\" | \"In\" | \"Sn\" | \
\"Sb\" | \"I\" | \"Te\" | \"Xe\" | \"Cs\" | \"Ba\" | \"La\" | \"Ce\" | \"Pr\" \
| \"Nd\" | \"Pm\" | \"Sm\" | \"Eu\" | \"Gd\" | \"Tb\" | \"Dy\" | \"Ho\" | \
\"Er\" | \"Tm\" | \"Yb\" | \"Lu\" | \"Hf\" | \"Ta\" | \"W\" | \"Re\" | \"Os\" \
| \"Ir\" | \"Pt\" | \"Au\" | \"Hg\" | \"Tl\" | \"Pb\" | \"Bi\" | \"Po\" | \
\"At\" | \"Rn\" | \"Fr\" | \"Ra\" | \"Ac\" | \"Pa\" | \"Th\" | \"Np\" | \"U\" \
| \"Am\" | \"Pu\" | \"Cm\" | \"Bk\" | \"Cf\" | \"Es\" | \"Fm\" | \"Md\" | \
\"No\" | \"Rf\" | \"Lr\" | \"Db\" | \"Bh\" | \"Sg\" | \"Mt\" | \"Rg\" | \
\"Hs\" | \"Ds\" | \"Uub\" | \"Uut\" | \"Uuq\" | \"Uup\" | \"Uuh\" | \"Uus\" | \
\"Uuo\"\
\>", "Program",
 CellChangeTimes->{{3.36769347517414*^9, 3.3676934879616*^9}, {
  3.36769359076764*^9, 3.36769359397675*^9}, {3.36769378036873*^9, 
  3.3676937853401*^9}, {3.36769444964629*^9, 3.36769445108865*^9}, {
  3.36796860756167*^9, 3.36796861095248*^9}}],

Cell["<digit> ::= \
\"0\"|\"1\"|\"2\"|\"3\"|\"4\"|\"5\"|\"6\"|\"7\"|\"8\"|\"9\"", "Program",
 CellChangeTimes->{{3.4925604290013237`*^9, 3.492560530515998*^9}, {
  3.4925611258919992`*^9, 3.4925611277400913`*^9}, {3.492656731707962*^9, 
  3.492656751039681*^9}}],

Cell["<number> ::= <digit>|<digit><number>", "Program",
 CellChangeTimes->{{3.4925604290013237`*^9, 3.492560530515998*^9}, {
  3.4925611258919992`*^9, 3.492561129332983*^9}}],

Cell["\<\
<molecule> ::= <element>|<replicated>|<connected>|\"(\"<molecule>\")\"\
\>", "Program",
 CellChangeTimes->{{3.36769372767308*^9, 3.36769373947807*^9}, {
   3.36769385236817*^9, 3.36769387780906*^9}, {3.36769390950654*^9, 
   3.36769392229028*^9}, {3.36769415836084*^9, 3.36769429282609*^9}, {
   3.36769441927048*^9, 3.36769441980383*^9}, {3.36769470087168*^9, 
   3.36769470839787*^9}, {3.36796863550411*^9, 3.36796865786797*^9}, {
   3.36796876211704*^9, 3.3679687701149*^9}, {3.36797236243425*^9, 
   3.36797236656678*^9}, {3.490313208692965*^9, 3.490313211817232*^9}, 
   3.492898232758937*^9, {3.4939193866646223`*^9, 3.493919388171196*^9}}],

Cell["\<\
<replicated> ::= <molecule><number> | <molecule>\"_\"<number> | \
Subscript[<molecule>, <number>]\
\>", "Program",
 CellChangeTimes->{{3.36769372767308*^9, 3.36769373947807*^9}, {
   3.36769385236817*^9, 3.36769387780906*^9}, {3.36769390950654*^9, 
   3.36769392229028*^9}, {3.36769430233145*^9, 3.3676943471731*^9}, {
   3.36769471111364*^9, 3.36769471402393*^9}, {3.36796866440095*^9, 
   3.36796866585593*^9}, {3.36796877262645*^9, 3.36796877312299*^9}, {
   3.36797237403347*^9, 3.36797237659864*^9}, 3.492898234651224*^9}],

Cell["<connected> ::= <molecule><molecule>", "Program",
 CellChangeTimes->{{3.36769436131365*^9, 3.36769438636395*^9}, {
  3.36769471693148*^9, 3.36769471741541*^9}, {3.36796866807923*^9, 
  3.36796868435203*^9}, {3.36796877584321*^9, 3.36796877619445*^9}, {
  3.36797236975046*^9, 3.36797237107446*^9}, {3.493919276553825*^9, 
  3.493919278091138*^9}}],

Cell["\<\
<mix> ::= <molecule> | <molecule> \"+ h\[Nu]\" | <mix> \"+\" <molecule>\
\>", "Program",
 CellChangeTimes->{{3.36769436131365*^9, 3.36769438636395*^9}, {
  3.36769471693148*^9, 3.36769471741541*^9}, {3.36796866807923*^9, 
  3.36796868435203*^9}, {3.36796877584321*^9, 3.36796877619445*^9}, {
  3.36797236975046*^9, 3.36797237107446*^9}, {3.490192357800621*^9, 
  3.490192379197077*^9}, {3.4901926564080257`*^9, 3.490192659845893*^9}, {
  3.490193156041957*^9, 3.4901932109018393`*^9}, {3.490193293504265*^9, 
  3.490193314565024*^9}, {3.490193578233453*^9, 3.490193581374349*^9}, {
  3.490313250019408*^9, 3.490313253864799*^9}}],

Cell["\<\
<equation> ::= <mix> \"->\" <mix> | <mix> \"=\" <mix> | <mix> \"\
\[LeftArrowRightArrow]\" <mix> \
\>", "Program",
 CellChangeTimes->{{3.36769436131365*^9, 3.36769438636395*^9}, {
  3.36769471693148*^9, 3.36769471741541*^9}, {3.36796866807923*^9, 
  3.36796868435203*^9}, {3.36796877584321*^9, 3.36796877619445*^9}, {
  3.36797236975046*^9, 3.36797237107446*^9}, {3.490192357800621*^9, 
  3.490192379197077*^9}, {3.490192698573299*^9, 3.490192699909083*^9}, {
  3.490193215869103*^9, 3.4901932170380783`*^9}, {3.490193322720324*^9, 
  3.490193358285038*^9}, {3.49019349940657*^9, 3.4901935001100683`*^9}, {
  3.490193773240573*^9, 3.490193777581839*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example: Random molecule creation", "Subsubsection",
 CellChangeTimes->{{3.490313291882615*^9, 3.49031330455266*^9}}],

Cell["\<\
<molecule>
<connected>
<molecule><molecule>
<molecule><replicated>
<element><element><number>
CO2\
\>", "Program",
 CellChangeTimes->{{3.490313492718638*^9, 3.490313571105088*^9}, {
   3.490313651167344*^9, 3.4903137601285057`*^9}, 3.490315565400009*^9, 
   3.492898235543038*^9, {3.49391940901894*^9, 3.493919410442275*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example: Random equation creation", "Subsubsection",
 CellChangeTimes->{{3.490313291882615*^9, 3.49031330455266*^9}, {
  3.4903155776920347`*^9, 3.490315590321392*^9}}],

Cell["\<\
<equation>
<mix> -> <mix>
<molecule> + <molecule> -> <molecule> + <molecule>
<molecule><replicated> + <molecule><replicated> -> <molecule><replicated> + \
<replicated><molecule>
<element><element><number> + <element><element><number> -> \
<element><element><number> + <element><number><element>
CO2 + ClH4 -> CH3 + Cl3O\
\>", "Program",
 CellChangeTimes->{{3.490313492718638*^9, 3.490313571105088*^9}, {
  3.490313651167344*^9, 3.4903137601285057`*^9}, {3.490315565400009*^9, 
  3.490315799713285*^9}, {3.492898236274712*^9, 3.492898238787237*^9}, {
  3.493340858925228*^9, 3.493340865982915*^9}}]
}, Open  ]],

Cell["Parsing formulas into data structures", "Subsubsection",
 CellChangeTimes->{{3.488671492207452*^9, 3.4886715110632563`*^9}, {
  3.488737833182511*^9, 3.488737833629287*^9}}],

Cell[CellGroupData[{

Cell["Parsing with StringMatchQ", "Subsubsection",
 CellChangeTimes->{{3.489080015031782*^9, 3.489080038478444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"moleculeString", "=", "\"\<C6H12O6\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.489080149732173*^9, 3.4890801737271852`*^9}, {
  3.4891036285456448`*^9, 3.489103641533495*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringCases", "[", 
  RowBox[{"\"\<Ca3H4C12Mn\>\"", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"cn", ":", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CharacterRange", "[", 
          RowBox[{"\"\<A\>\"", ",", "\"\<Z\>\""}], "]"}], "~~", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CharacterRange", "[", 
            RowBox[{"\"\<a\>\"", ",", "\"\<x\>\""}], "]"}], "|", "\"\<\>\""}],
           ")"}]}], ")"}]}], ")"}], "~~", 
     RowBox[{"(", 
      RowBox[{"na", ":", 
       RowBox[{"(", 
        RowBox[{"NumberString", "|", "\"\<\>\""}], ")"}]}], ")"}]}], 
    "\[RuleDelayed]", 
    RowBox[{"Molecule", "[", 
     RowBox[{"cn", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"na", "\[Equal]", "\"\<\>\""}], ",", "1", ",", 
        RowBox[{"ToExpression", "[", "na", "]"}]}], "]"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.489103654377119*^9, 3.489103744107451*^9}, {
  3.489103860506013*^9, 3.489103915061077*^9}, {3.4891039649396887`*^9, 
  3.489104056798574*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Molecule", "[", 
    RowBox[{"\<\"Ca\"\>", ",", "3"}], "]"}], ",", 
   RowBox[{"Molecule", "[", 
    RowBox[{"\<\"H\"\>", ",", "4"}], "]"}], ",", 
   RowBox[{"Molecule", "[", 
    RowBox[{"\<\"C\"\>", ",", "12"}], "]"}], ",", 
   RowBox[{"Molecule", "[", 
    RowBox[{"\<\"Mn\"\>", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.489104057332842*^9, 3.489879199123968*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"StringCases", "[", 
   RowBox[{"\"\<Ca3H4C12Mn\>\"", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"cn", ":", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CharacterRange", "[", 
           RowBox[{"\"\<A\>\"", ",", "\"\<Z\>\""}], "]"}], "~~", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"CharacterRange", "[", 
             RowBox[{"\"\<a\>\"", ",", "\"\<x\>\""}], "]"}], "|", 
            "\"\<\>\""}], ")"}]}], ")"}]}], ")"}], "~~", 
      RowBox[{"(", 
       RowBox[{"na", ":", 
        RowBox[{"(", 
         RowBox[{"NumberString", "|", "\"\<\>\""}], ")"}]}], ")"}]}], 
     "\[RuleDelayed]", 
     RowBox[{"Molecule", "[", 
      RowBox[{"cn", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"na", "\[Equal]", "\"\<\>\""}], ",", "1", ",", 
         RowBox[{"ToExpression", "[", "na", "]"}]}], "]"}]}], "]"}]}]}], 
   "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.489103654377119*^9, 3.489103744107451*^9}, {
  3.489103860506013*^9, 3.489103915061077*^9}, {3.4891039649396887`*^9, 
  3.489104056798574*^9}, {3.489104140480397*^9, 3.4891041435222692`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.00038600000016231206`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Ca\"\>", ",", "3"}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"H\"\>", ",", "4"}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"C\"\>", ",", "12"}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Mn\"\>", ",", "1"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4891041440622663`*^9, 3.489879200132678*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"StringCases", "[", 
   RowBox[{"\"\<(Ca3H4)2C12Mn\>\"", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"cn", ":", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CharacterRange", "[", 
           RowBox[{"\"\<A\>\"", ",", "\"\<Z\>\""}], "]"}], "~~", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"CharacterRange", "[", 
             RowBox[{"\"\<a\>\"", ",", "\"\<x\>\""}], "]"}], "|", 
            "\"\<\>\""}], ")"}]}], ")"}]}], ")"}], "~~", 
      RowBox[{"(", 
       RowBox[{"na", ":", 
        RowBox[{"(", 
         RowBox[{"NumberString", "|", "\"\<\>\""}], ")"}]}], ")"}]}], 
     "\[RuleDelayed]", 
     RowBox[{"Molecule", "[", 
      RowBox[{"cn", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"na", "\[Equal]", "\"\<\>\""}], ",", "1", ",", 
         RowBox[{"ToExpression", "[", "na", "]"}]}], "]"}]}], "]"}]}]}], 
   "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.489103654377119*^9, 3.489103744107451*^9}, {
  3.489103860506013*^9, 3.489103915061077*^9}, {3.4891039649396887`*^9, 
  3.489104056798574*^9}, {3.489104140480397*^9, 3.4891041435222692`*^9}, {
  3.489104502701934*^9, 3.489104510012657*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0002279999998791027`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Ca\"\>", ",", "3"}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"H\"\>", ",", "4"}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"C\"\>", ",", "12"}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Mn\"\>", ",", "1"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.489104510979226*^9, 3.48987920086948*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Union", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "&"}], "/@", "elements"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.489104272656376*^9, 3.489104318129218*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"A\"\>", ",", "\<\"B\"\>", ",", "\<\"C\"\>", ",", "\<\"D\"\>", 
   ",", "\<\"E\"\>", ",", "\<\"F\"\>", ",", "\<\"G\"\>", ",", "\<\"H\"\>", 
   ",", "\<\"I\"\>", ",", "\<\"K\"\>", ",", "\<\"L\"\>", ",", "\<\"M\"\>", 
   ",", "\<\"N\"\>", ",", "\<\"O\"\>", ",", "\<\"P\"\>", ",", "\<\"R\"\>", 
   ",", "\<\"S\"\>", ",", "\<\"T\"\>", ",", "\<\"U\"\>", ",", "\<\"V\"\>", 
   ",", "\<\"W\"\>", ",", "\<\"X\"\>", ",", "\<\"Y\"\>", ",", "\<\"Z\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.48910427793474*^9, 3.4891043183621893`*^9}}],

Cell[BoxData["24"], "Output",
 CellChangeTimes->{{3.48910427793474*^9, 3.489104318364272*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Other formulations",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.489880025323299*^9, 3.489880045839293*^9}}],

Cell["\<\
The first, most basic step is from given a molecule formula to find which \
elements and what number of their atoms compose that molecule formula.\
\>", "Text"],

Cell["\<\
These measures can be used for chemical equation balancing that we are going \
consider in the next chapter (\"Chemical Equation Balancing\"). In this \
chapter we are going to design and program an interpreter for strings of \
chemical formulas.\
\>", "Text"],

Cell["\<\
Chemical formulas can be interpreted as ideograms and sumarization of the \
chemical reactions they participate in, [Lazlo \"Conventionalities in Formula \
Writing\"], but we are going to see them as specifications of atoms presence \
in a molecule.\
\>", "Text",
 CellChangeTimes->{{3.489967654616086*^9, 3.489967714855041*^9}, {
   3.489967922327642*^9, 3.48996804103293*^9}, {3.489968158239253*^9, 
   3.489968162663232*^9}, {3.4900505680148773`*^9, 3.4900506045100822`*^9}, 
   3.493323757918007*^9}],

Cell["\<\
The chemical formulas can be seen as commands that have to interpreted in \
order to do symbolic manipulations that reflect the structure and properties \
of the compounds they represent. [Laz01]\
\>", "Text",
 CellChangeTimes->{{3.489968116281167*^9, 3.489968250790667*^9}, {
   3.490044404068725*^9, 3.490044446620646*^9}, {3.490044476706689*^9, 
   3.4900445078136063`*^9}, {3.49004494422812*^9, 3.4900449771344557`*^9}, {
   3.4900450658710537`*^9, 3.490045142613443*^9}, {3.490048828233515*^9, 
   3.490048880885549*^9}, 3.490048912238349*^9, {3.4900489608308783`*^9, 
   3.490048996682535*^9}, {3.490049157173946*^9, 3.49004922194967*^9}, {
   3.490049334765492*^9, 3.490049392429675*^9}, {3.490049701247239*^9, 
   3.490049723517625*^9}, {3.490050176181126*^9, 3.490050195277132*^9}, {
   3.4900506244165287`*^9, 3.490050639205728*^9}, {3.490050742242795*^9, 
   3.490050933402281*^9}, {3.490115420787866*^9, 3.4901154286719646`*^9}, {
   3.490116004842514*^9, 3.4901160059213057`*^9}, {3.493323769234726*^9, 
   3.493323776054948*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Code",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.493240690162657*^9, 
  3.493240690630011*^9}},ExpressionUUID->"6c44ce4b-bf3e-49a6-b422-\
cfc46bd31bea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"ElementData", "[", 
       RowBox[{"#", ",", "\"\<Abbreviation\>\""}], "]"}], "&"}], "/@", 
     RowBox[{"ElementData", "[", "]"}]}], ")"}], ",", "\"\<N\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.49324029647824*^9, 3.4932403704727497`*^9}, 
   3.493240402920321*^9, {3.4932405530493813`*^9, 3.4932405726497183`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "7", "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.4932403112262573`*^9, 3.493240371250922*^9}, 
   3.493240403431232*^9, {3.493240554059795*^9, 3.4932405733852177`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ElementData", "[", 
      RowBox[{"\"\<N\>\"", ",", "\"\<AtomicMass\>\""}], "]"}], "+", 
     RowBox[{"ElementData", "[", 
      RowBox[{"\"\<C\>\"", ",", "\"\<AtomicMass\>\""}], "]"}]}], ")"}], "2"}],
   "+", 
  RowBox[{"ElementData", "[", 
   RowBox[{"\"\<Zn\>\"", ",", "\"\<AtomicMass\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.49324337788518*^9, 3.493243395651821*^9}}],

Cell[BoxData["117.44380000000000000000000000000000000001`5.220948630052174"], \
"Output",
 CellChangeTimes->{3.493243396288372*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parsing and interpretation", "Section",
 CellChangeTimes->{{3.493219345001494*^9, 3.493219371408733*^9}, {
  3.493219413906238*^9, 3.4932194163457212`*^9}, {3.493237221136033*^9, 
  3.4932372251129704`*^9}, {3.493242258876174*^9, 
  3.4932422607104807`*^9}},ExpressionUUID->"b9378c19-8aa7-4aa1-aab5-\
c494ef22a05d"],

Cell[TextData[{
 "The chemical formulas can be seen as words constructed using the \
grammatical rules of a certain language. Let us illustrate this using the \
notion of morpheme. Morpheme is defined as a single unit of meaning in a \
language. For example, the English word \"unknowingly\" has four morphemes: \
",
 StyleBox["un",
  FontSlant->"Italic"],
 ", ",
 StyleBox["know",
  FontSlant->"Italic"],
 ", ",
 StyleBox["ing",
  FontSlant->"Italic"],
 ", and ",
 StyleBox["ly",
  FontSlant->"Italic"],
 ". Each of these morphemes contributes to the meaning of the word. Using the \
morpheme definition we can look at chemical formulas as words comprised of \
two types of morphemes: chemical element abbreviations, and numbers. For \
example, the chemical formula for propane, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "3"], 
    SubscriptBox["H", "8"]}], TraditionalForm]],ExpressionUUID->
  "743a41e0-bda0-4e39-8a50-fa953c274b38"],
 ", can be seen as a word that has four morphemes: ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "3fb792d3-8226-4283-8234-063d7c524e99"],
 ", ",
 Cell[BoxData[
  FormBox["3", TraditionalForm]],ExpressionUUID->
  "c3687d09-27cc-43ba-a0ba-488747de3928"],
 ", ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]],ExpressionUUID->
  "73988c8b-3c92-429e-9f3b-c53d079552cb"],
 ", and ",
 Cell[BoxData[
  FormBox["8", TraditionalForm]],ExpressionUUID->
  "24f4dc53-667e-44aa-acab-de3e2b46eabf"],
 ". "
}], "Text",
 CellChangeTimes->{{3.492614394613402*^9, 3.492614517221057*^9}, {
  3.492615972298514*^9, 3.492616019803447*^9}, {3.492616110238686*^9, 
  3.492616155043428*^9}, {3.492616539896802*^9, 3.492616543379796*^9}, {
  3.492616645109872*^9, 3.492616705131381*^9}, {3.49264286135947*^9, 
  3.492642868883922*^9}, {3.492646452628862*^9, 3.4926464528388968`*^9}, {
  3.492650041169381*^9, 3.492650051659749*^9}, {3.492652511789102*^9, 
  3.492652541975768*^9}, {3.4926526483782873`*^9, 3.492652712597229*^9}, {
  3.493186504681913*^9, 
  3.49318650647374*^9}},ExpressionUUID->"09c8ca70-fb98-4ca2-beb7-\
433f0fab9194"],

Cell["\<\
Since we consider chemical formulas as words, we can extend that analogy and \
see chemical equations as sentences. The signs of summation and yielding can \
be seen as syntactical markers.\
\>", "Text",
 CellChangeTimes->{{3.493238947623802*^9, 3.4932389704139853`*^9}, {
   3.493239001453904*^9, 3.4932390723302507`*^9}, {3.493239129517622*^9, 
   3.493239154314354*^9}, 
   3.493323642036483*^9},ExpressionUUID->"c4322ba0-b3c4-48fa-a2e7-\
3a96fc58c7f8"],

Cell["A typical compiler has the following phases:", "Text",
 CellChangeTimes->{{3.4932397479465*^9, 3.493239759930979*^9}, {
  3.493239796415493*^9, 3.493239833091463*^9}, {3.493239989384529*^9, 
  3.493240009145237*^9}, {3.493240073166457*^9, 3.493240073762587*^9}, {
  3.494792851119627*^9, 
  3.494792852819714*^9}},ExpressionUUID->"25c59ac5-1de5-4d37-b90e-\
2447006b9160"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DefineCompilerVertex", "[", 
    RowBox[{"{", 
     RowBox[{"ffont_", ",", "fsize_", ",", "factor_"}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cl", "=", "0.8"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{"CompilerVertex", ",", "CompilerGraph"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<pinput\>\""}], "]"}], ":=", 
       RowBox[{"IOElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Program\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<lexical\>\""}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"ProcessingElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Lexical analysis\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<syntactic\>\""}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"ProcessingElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Syntactic analysis\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<semantic\>\""}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"ProcessingElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Semantic analysis\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<codegeneration\>\""}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"ProcessingElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Code generation\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<poutput\>\""}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"IOElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Executable code\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerGraph", "[", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<pinput\>\"", "\[Rule]", "\"\<lexical\>\""}], ",", 
         RowBox[{"\"\<lexical\>\"", "\[Rule]", "\"\<syntactic\>\""}], ",", 
         RowBox[{"\"\<syntactic\>\"", "\[Rule]", "\"\<semantic\>\""}], ",", 
         RowBox[{"\"\<semantic\>\"", "\[Rule]", "\"\<codegeneration\>\""}], 
         ",", 
         RowBox[{"\"\<codegeneration\>\"", "\[Rule]", "\"\<poutput\>\""}]}], 
        "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{"DefineCompilerVertex", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Times\>\"", ",", "12", ",", "1.5"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DownDefineNumeratedVertex", "[", 
  RowBox[{"DefineCompilerVertex", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<Times\>\"", ",", "12", ",", "1.2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0.7", ",", "0.7", ",", "0.7"}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DefineCompilerVertexNumerated", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<Times\>\"", ",", "12", ",", "1.2"}], "}"}], "]"}], "k"}], 
   "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LayeredGraphPlot", "[", 
  RowBox[{
   RowBox[{"CompilerGraph", "[", "]"}], ",", 
   RowBox[{"VertexCoordinateRules", "\[Rule]", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1.5", ",", "1"}], "}"}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.5", "i"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"6", ",", 
         RowBox[{"-", "1"}]}], "}"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"VertexRenderingFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CompilerVertex", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
   RowBox[{"EdgeRenderingFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.6", ",", "0", ",", "0"}], "]"}], ",", 
        RowBox[{"Arrowheads", "[", "0.02", "]"}], ",", " ", 
        RowBox[{"MidArrow", "[", 
         RowBox[{"#1", ",", "#2", ",", "#3", ",", 
          RowBox[{"\"\<Ratio\>\"", "->", "0.6"}], ",", 
          RowBox[{"\"\<LabelRatio\>\"", "\[Rule]", "0.47"}]}], "]"}]}], "}"}],
       "&"}], ")"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "750"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.49026423911795*^9, 3.490264243371923*^9}, {
   3.490264325454646*^9, 3.4902643298345137`*^9}, {3.490264517883626*^9, 
   3.49026454173009*^9}, {3.490264689104454*^9, 3.490264713339211*^9}, 
   3.490264791032524*^9, {3.4927764823566513`*^9, 3.492776491250305*^9}, {
   3.492778644170644*^9, 3.4927787469321938`*^9}, {3.492778936940816*^9, 
   3.492778968425805*^9}, {3.4927790840050173`*^9, 3.492779084394067*^9}, 
   3.493236111222023*^9}],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{1.5, 1.}, {1.5, 0.4}}], LineBox[{{1.5, 0.4}, {1.5, 0.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], ArrowBox[{{1.5, 0.}, {2.4, 0.}}],
       LineBox[{{2.4, 0.}, {3., 0.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], ArrowBox[{{3., 0.}, {3.9, 0.}}], 
      LineBox[{{3.9, 0.}, {4.5, 0.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], ArrowBox[{{4.5, 0.}, {5.4, 0.}}],
       LineBox[{{5.4, 0.}, {6., 0.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], ArrowBox[{{6., 0.}, {6., -0.6}}],
       LineBox[{{6., -0.6}, {6., -1.}}]}}, {
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{0.78, 0.8200000000000001}, {1.02, 1.18}, {
       2.2199999999999998`, 1.18}, {1.98, 0.8200000000000001}}], InsetBox[
       StyleBox["\<\"Program\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->12], {1.5, 1.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{1.8599999999999997`, 1.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"1\"\>",
          StripOnInput->False,
          FontSize->10], {1.8599999999999997, 1.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{0.9, -0.18}, {0.9, 0.18}, {2.1, 0.18}, {2.1, -0.18}}], 
      InsetBox[
       StyleBox["\<\"Lexical analysis\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->12], {1.5, 0.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{1.8, 0.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"2\"\>",
          StripOnInput->False,
          FontSize->10], {1.8, 0.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{2.4, -0.18}, {2.4, 0.18}, {3.6, 0.18}, {3.6, -0.18}}], 
      InsetBox[
       StyleBox["\<\"Syntactic analysis\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->12], {3., 0.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{3.3, 0.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"3\"\>",
          StripOnInput->False,
          FontSize->10], {3.3, 0.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{3.9, -0.18}, {3.9, 0.18}, {5.1, 0.18}, {5.1, -0.18}}], 
      InsetBox[
       StyleBox["\<\"Semantic analysis\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->12], {4.5, 0.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{4.8, 0.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"4\"\>",
          StripOnInput->False,
          FontSize->10], {4.8, 0.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{5.4, -0.18}, {5.4, 0.18}, {6.6, 0.18}, {6.6, -0.18}}], 
      InsetBox[
       StyleBox["\<\"Code generation\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->12], {6., 0.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{6.3, 0.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"5\"\>",
          StripOnInput->False,
          FontSize->10], {6.3, 0.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{5.28, -1.18}, {5.52, -0.8200000000000001}, {
       6.72, -0.8200000000000001}, {6.48, -1.18}}], InsetBox[
       StyleBox["\<\"Executable code\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->12], {6., -1.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{6.359999999999999, -0.8200000000000001}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"6\"\>",
          StripOnInput->False,
          FontSize->10], {6.359999999999999, -0.8200000000000001}]}}}}},
   Annotation[#, 
    VertexCoordinateRules -> {{1.5, 1.}, {1.5, 0.}, {3., 0.}, {4.5, 0.}, {6., 
     0.}, {6., -1.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->750,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.4932361211039553`*^9},ExpressionUUID->"dd30f17a-beed-4fbe-805a-\
8f9394af56b2"]
}, {2}]],

Cell["\<\
Some or all of the phases can be combined. We do not need the code generation \
phase to solve our problem. We just want to interpret chemical formulas into \
molecular statistics. So we have the phases:\
\>", "Text",
 CellChangeTimes->{{3.493240014929738*^9, 3.493240018528203*^9}, {
   3.49324007765476*^9, 3.4932400963384438`*^9}, {3.4932419099377403`*^9, 
   3.49324195557056*^9}, {3.4932422793961067`*^9, 3.4932422809409113`*^9}, {
   3.4932424691922293`*^9, 3.493242561724049*^9}, {3.493242637759671*^9, 
   3.493242654231944*^9}, 
   3.4947928566496696`*^9},ExpressionUUID->"465d880e-e94f-40c2-9ca6-\
369de01775a2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DefineCompilerVertex", "[", 
    RowBox[{"{", 
     RowBox[{"ffont_", ",", "fsize_", ",", "factor_"}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cl", "=", "0.8"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{"CompilerVertex", ",", "CompilerGraph"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<pinput\>\""}], "]"}], ":=", 
       RowBox[{"IOElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Chemical formula\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<lexical\>\""}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"ProcessingElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Lexical analysis\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<syntactic\>\""}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"ProcessingElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Syntactic analysis\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<semantic\>\""}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"ProcessingElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Semantic analysis\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<codegeneration\>\""}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"ProcessingElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Code generation\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerVertex", "[", 
        RowBox[{"coords_", ",", "\"\<poutput\>\""}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"IOElement", "[", 
        RowBox[{"coords", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.3"}], "}"}], "factor"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Molecule statistics\>\"", ",", "fsize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "ffont"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CompilerGraph", "[", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<pinput\>\"", "\[Rule]", "\"\<lexical\>\""}], ",", 
         RowBox[{"\"\<lexical\>\"", "\[Rule]", "\"\<syntactic\>\""}], ",", 
         RowBox[{"\"\<syntactic\>\"", "\[Rule]", "\"\<semantic\>\""}], ",", 
         RowBox[{"\"\<semantic\>\"", "\[Rule]", "\"\<poutput\>\""}]}], 
        "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{"DefineCompilerVertex", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Times\>\"", ",", "12", ",", "1.5"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DownDefineNumeratedVertex", "[", 
  RowBox[{"DefineCompilerVertex", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<Times\>\"", ",", "12", ",", "1.2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0.7", ",", "0.7", ",", "0.7"}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DefineCompilerVertexNumerated", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<Times\>\"", ",", "12", ",", "1.2"}], "}"}], "]"}], "k"}], 
   "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LayeredGraphPlot", "[", 
  RowBox[{
   RowBox[{"CompilerGraph", "[", "]"}], ",", 
   RowBox[{"VertexCoordinateRules", "\[Rule]", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1.5", ",", "1"}], "}"}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.5", "i"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "]"}]}], ",", 
   RowBox[{"VertexRenderingFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CompilerVertex", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
   RowBox[{"EdgeRenderingFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.6", ",", "0", ",", "0"}], "]"}], ",", 
        RowBox[{"Arrowheads", "[", "0.02", "]"}], ",", " ", 
        RowBox[{"MidArrow", "[", 
         RowBox[{"#1", ",", "#2", ",", "#3", ",", 
          RowBox[{"\"\<Ratio\>\"", "->", "0.6"}], ",", 
          RowBox[{"\"\<LabelRatio\>\"", "\[Rule]", "0.47"}]}], "]"}]}], "}"}],
       "&"}], ")"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "750"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.49026423911795*^9, 3.490264243371923*^9}, {
   3.490264325454646*^9, 3.4902643298345137`*^9}, {3.490264517883626*^9, 
   3.49026454173009*^9}, {3.490264689104454*^9, 3.490264713339211*^9}, 
   3.490264791032524*^9, {3.4927764823566513`*^9, 3.492776491250305*^9}, {
   3.492778644170644*^9, 3.4927787469321938`*^9}, {3.492778936940816*^9, 
   3.492778968425805*^9}, {3.4927790840050173`*^9, 3.492779084394067*^9}, 
   3.493236111222023*^9, {3.493242056928495*^9, 3.4932421123402967`*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{1.5, 1.}, {1.5, 0.4}}], LineBox[{{1.5, 0.4}, {1.5, 0.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], ArrowBox[{{1.5, 0.}, {2.4, 0.}}],
       LineBox[{{2.4, 0.}, {3., 0.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], ArrowBox[{{3., 0.}, {3.9, 0.}}], 
      LineBox[{{3.9, 0.}, {4.5, 0.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], ArrowBox[{{4.5, 0.}, {5.4, 0.}}],
       LineBox[{{5.4, 0.}, {6., 0.}}]}}, {
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{0.78, 0.8200000000000001}, {1.02, 1.18}, {
       2.2199999999999998`, 1.18}, {1.98, 0.8200000000000001}}], InsetBox[
       StyleBox["\<\"Chemical formula\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->12], {1.5, 1.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{1.8599999999999997`, 1.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"1\"\>",
          StripOnInput->False,
          FontSize->10], {1.8599999999999997, 1.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{0.9, -0.18}, {0.9, 0.18}, {2.1, 0.18}, {2.1, -0.18}}], 
      InsetBox[
       StyleBox["\<\"Lexical analysis\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->12], {1.5, 0.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{1.8, 0.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"2\"\>",
          StripOnInput->False,
          FontSize->10], {1.8, 0.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{2.4, -0.18}, {2.4, 0.18}, {3.6, 0.18}, {3.6, -0.18}}], 
      InsetBox[
       StyleBox["\<\"Syntactic analysis\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->12], {3., 0.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{3.3, 0.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"3\"\>",
          StripOnInput->False,
          FontSize->10], {3.3, 0.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{3.9, -0.18}, {3.9, 0.18}, {5.1, 0.18}, {5.1, -0.18}}], 
      InsetBox[
       StyleBox["\<\"Semantic analysis\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->12], {4.5, 0.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{4.8, 0.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"4\"\>",
          StripOnInput->False,
          FontSize->10], {4.8, 0.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{5.28, -0.18}, {5.52, 0.18}, {6.72, 0.18}, {6.48, -0.18}}], 
      InsetBox[
       StyleBox["\<\"Molecule statistics\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->12], {6., 0.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{6.359999999999999, 0.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"5\"\>",
          StripOnInput->False,
          FontSize->10], {6.359999999999999, 0.18}]}}}}},
   Annotation[#, 
    VertexCoordinateRules -> {{1.5, 1.}, {1.5, 0.}, {3., 0.}, {4.5, 0.}, {6., 
     0.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->750,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.4932361211039553`*^9, {3.4932420943852777`*^9, 
   3.493242113016794*^9}},ExpressionUUID->"683dd1b6-c1e9-4f6f-a7a0-\
da4e23163c10"]
}, {2}]],

Cell["\<\
Applying this sequence of tasks to chemical formulas or equations, the \
lexical analyzer would recognize the morphemes and replace them with tokens \
that allow the syntax analyzer to easily identify them. The syntax analyser \
would produce data structure (a tree) that represents the syntactic structure \
of the formula or equation. (Most programing language syntactic analysers \
would typically use a tree data structure to represent the syntactic \
structure of a program.) \
\>", "Text",
 CellChangeTimes->{{3.493240668702495*^9, 3.493240669747923*^9}, {
  3.493240701579328*^9, 3.493240744109831*^9}, {3.493240954990243*^9, 
  3.4932409797012463`*^9}, {3.493323685991983*^9, 3.493323709671383*^9}, {
  3.49479266927886*^9, 3.4947927558223*^9}, {3.494793012075035*^9, 
  3.494793126427792*^9}, {3.49479315849089*^9, 
  3.494793206966795*^9}},ExpressionUUID->"e94ac8d5-436b-4002-a32e-\
dba95c9eefc8"],

Cell[TextData[{
 "For example, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Zn", "(", "CN", ")"}], "2"}], TraditionalForm]],ExpressionUUID->
  "40f4d42e-5134-4022-853d-74225ec217dd"],
 " could be tokenized by the lexical analyzer to \"[30] ([6][7])2\" in which \
the atoms are replaced with integer identifiers placed in square brackets. \
From that last expression the syntax analyzer could produce a tree structure \
like"
}], "Text",
 CellChangeTimes->{{3.493240668702495*^9, 3.493240669747923*^9}, {
  3.493240701579328*^9, 3.493240744109831*^9}, {3.493240954990243*^9, 
  3.4932409797012463`*^9}, {3.493323685991983*^9, 3.493323709671383*^9}, {
  3.49479266927886*^9, 
  3.494792740703485*^9}},ExpressionUUID->"c3e81473-7749-43ac-8296-\
03cdd7a8d075"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<[30]\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<[6]\>\"", ",", "\"\<[7]\>\""}], "}"}], ",", "2"}], 
       "}"}]}], "}"}], "//", "TreeForm"}], ")"}], "/.", 
  RowBox[{"List", "\[Rule]", "\"\<\>\""}]}]], "Input",
 CellChangeTimes->{{3.493240748931432*^9, 3.493240787304377*^9}, {
  3.493240841175969*^9, 3.493240873456355*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{0.4472135954999579, 2.6832815729997477`}, {0., 
    1.788854381999832}, {0.8944271909999159, 1.788854381999832}, {
    0.4472135954999579, 0.894427190999916}, {0., 0.}, {0.8944271909999159, 
    0.}, {1.3416407864998738`, 0.894427190999916}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {3, 4}, {3, 7}, {4, 5}, {4, 6}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"\"\>", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"\"\"", "[", 
           RowBox[{"\"[30]\"", ",", 
             RowBox[{"\"\"", "[", 
               RowBox[{
                 RowBox[{"\"\"", "[", 
                   RowBox[{"\"[6]\"", ",", "\"[7]\""}], "]"}], ",", "2"}], 
               "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         ""["[30]", 
          ""[
           ""["[6]", "[7]"], 2]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[30]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"[30]\"", HoldForm]],
       Annotation[#, 
        HoldForm["[30]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"\"\>", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"\"\"", "[", 
           RowBox[{
             RowBox[{"\"\"", "[", 
               RowBox[{"\"[6]\"", ",", "\"[7]\""}], "]"}], ",", "2"}], "]"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[
         ""[
          ""["[6]", "[7]"], 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"\"\>", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"\"\"", "[", 
           RowBox[{"\"[6]\"", ",", "\"[7]\""}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         ""["[6]", "[7]"]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[6]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"[6]\"", HoldForm]],
       Annotation[#, 
        HoldForm["[6]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[7]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"[7]\"", HoldForm]],
       Annotation[#, 
        HoldForm["[7]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{0.4472135954999579, 2.6832815729997477`}, {0., 
     1.788854381999832}, {0.8944271909999159, 1.788854381999832}, {
     0.4472135954999579, 0.894427190999916}, {0., 0.}, {0.8944271909999159, 
     0.}, {1.3416407864998738`, 0.894427190999916}}]& ],
  AspectRatio->NCache[2 3^Rational[-1, 2], 1.1547005383792517`],
  FrameTicks->Automatic,
  ImageSize->{212.00000000000009`, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.4932407882883377`*^9, {3.493240843139594*^9, 
   3.493240875350317*^9}},ExpressionUUID->"0869d1c1-a926-498e-a4f8-\
91ce7e4d080a"]
}, {2}]],

Cell[TextData[{
 "at each node ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "3f3faf3a-de47-4a48-82c7-679d795a14ab"],
 " of which the semantic analyzer would generate (or execute) some code that \
depends on ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "1635b9b7-1fe1-4853-a686-b32ef5cbc5b7"],
 ". For example, using the tree above the semantic analyzer could replace all \
element identifiers with the corresponding atomic masses and use the \
operations of summation and multiplication at the relevant nodes in order to \
compute the molecular mass."
}], "Text",
 CellChangeTimes->{{3.493240904959502*^9, 3.493240935804222*^9}, {
   3.49324103193974*^9, 3.49324103854891*^9}, {3.4932413769306927`*^9, 
   3.493241484573729*^9}, {3.4932415812795486`*^9, 3.493241595793612*^9}, {
   3.493243056512211*^9, 3.493243196248111*^9}, {3.493243250077121*^9, 
   3.493243266708889*^9}, 3.493323715712636*^9, {3.49333885408589*^9, 
   3.4933388868694687`*^9}},ExpressionUUID->"1e5b1330-a7be-402d-9d33-\
9f12c342362e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Plus", "[", 
      RowBox[{"\"\<[30]\>\"", ",", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{"Plus", "[", 
          RowBox[{"\"\<[6]\>\"", ",", "\"\<[7]\>\""}], "]"}], ",", "2"}], 
        "]"}]}], "]"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Plus", "\[Rule]", "\"\<+\>\""}], ",", 
      RowBox[{"Times", "\[Rule]", "\"\<*\>\""}], ",", 
      RowBox[{"\"\<[30]\>\"", "\[Rule]", 
       RowBox[{"ElementData", "[", 
        RowBox[{"\"\<Zn\>\"", ",", "\"\<AtomicMass\>\""}], "]"}]}], ",", 
      RowBox[{"\"\<[6]\>\"", "->", 
       RowBox[{"ElementData", "[", 
        RowBox[{"\"\<C\>\"", ",", "\"\<AtomicMass\>\""}], "]"}]}], ",", 
      RowBox[{"\"\<[7]\>\"", "->", 
       RowBox[{"ElementData", "[", 
        RowBox[{"\"\<N\>\"", ",", "\"\<AtomicMass\>\""}], "]"}]}]}], "}"}]}], 
   ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.2"}], ",", "2.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2.6"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.493240748931432*^9, 3.493240787304377*^9}, {
  3.493240841175969*^9, 3.493240873456355*^9}, {3.493242756474238*^9, 
  3.493242811172637*^9}, {3.493242874614757*^9, 3.4932429420690002`*^9}, {
  3.493259071929822*^9, 3.4932591314440937`*^9}, {3.4932592140533667`*^9, 
  3.493259259016534*^9}, {3.493259304552741*^9, 3.4932593131270227`*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{0.4472135954999579, 2.6832815729997477`}, {0., 
    1.788854381999832}, {0.8944271909999159, 1.788854381999832}, {
    0.4472135954999579, 0.894427190999916}, {1.3416407864998738`, 
    0.894427190999916}, {0.8944271909999159, 0.}, {1.7888543819998317`, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {3, 4}, {3, 5}, {5, 6}, {5, 7}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"+\"\>", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"\"+\"", "[", 
           RowBox[{"65.409`5.", ",", 
             RowBox[{"\"*\"", "[", 
               RowBox[{"2", ",", 
                 RowBox[{"\"+\"", "[", 
                   RowBox[{"12.0107`6.", ",", "14.0067`6."}], "]"}]}], 
               "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "+"[65.409`5., 
          "*"[2, 
           "+"[12.0107`6., 14.0067`6.]]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["65.409`5.",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["65.409`5.", HoldForm]],
       Annotation[#, 
        HoldForm[65.409`5.], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"*\"\>", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"\"*\"", "[", 
           RowBox[{"2", ",", 
             RowBox[{"\"+\"", "[", 
               RowBox[{"12.0107`6.", ",", "14.0067`6."}], "]"}]}], "]"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[
         "*"[2, 
          "+"[12.0107`6., 14.0067`6.]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"+\"\>", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"\"+\"", "[", 
           RowBox[{"12.0107`6.", ",", "14.0067`6."}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "+"[12.0107`6., 14.0067`6.]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["12.0107`6.",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["12.0107`6.", HoldForm]],
       Annotation[#, 
        HoldForm[12.0107`6.], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["14.0067`6.",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["14.0067`6.", HoldForm]],
       Annotation[#, 
        HoldForm[14.0067`6.], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{0.4472135954999579, 2.6832815729997477`}, {0., 
     1.788854381999832}, {0.8944271909999159, 1.788854381999832}, {
     0.4472135954999579, 0.894427190999916}, {1.3416407864998738`, 
     0.894427190999916}, {0.8944271909999159, 0.}, {1.7888543819998317`, 
     0.}}]& ],
  AspectRatio->NCache[2 7^Rational[-1, 2], 0.7559289460184544],
  FrameTicks->Automatic,
  ImageSize->{308.66666666666634`, Automatic},
  PlotRange->{{-0.2, 2.1}, {0, 2.6}},
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.49325909069634*^9, 3.493259120341837*^9}, {
  3.493259216627863*^9, 3.49325925934272*^9}, {3.493259305729233*^9, 
  3.493259314018577*^9}},ExpressionUUID->"639b5ba3-ec97-4d91-a07b-\
9cfc60139f31"]
}, {2}]],

Cell[TextData[{
 "The molecular mass, ",
 Cell[BoxData[
  FormBox[
  "117.44380000000000000000000000000000000001`5.220948630052174", 
   TraditionalForm]],ExpressionUUID->"479fc5b7-303a-48a0-b72e-34882174ac07"],
 ", is the output of the semantic analyzer in this example."
}], "Text",
 CellChangeTimes->{{3.493243205077868*^9, 3.49324321796856*^9}, {
  3.493243270520797*^9, 3.4932433627990427`*^9}, {3.4932434036910048`*^9, 
  3.493243429747312*^9}},ExpressionUUID->"9e3231e5-4700-414f-8b4e-\
379f4454f978"],

Cell["\<\
The lexical analyzer can be seen as part of the syntactic analyzer. The CFP \
does not separate them. Also, CFP uses the abbreviated element names as \
element identificators. \
\>", "Text",
 CellChangeTimes->{{3.49330087136933*^9, 3.493300952137705*^9}, {
   3.493301024025565*^9, 3.493301165505797*^9}, 
   3.493323718757551*^9},ExpressionUUID->"d8d8bfe2-b661-4784-853b-\
754437175c97"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Backus-Naur Form", "Section",
 CellChangeTimes->{{3.488748338769208*^9, 3.488748361941662*^9}, {
   3.488882394228191*^9, 3.4888823964175177`*^9}, {3.492657411429934*^9, 
   3.49265741368785*^9}, 
   3.493323576184908*^9},ExpressionUUID->"0116b08c-c62f-4f33-be5e-\
0b32378da58f"],

Cell["\<\
The notation system Backus-Naur Form (BNF) can be used to specify language \
grammars that are free of context.  (By \"free of context\" we mean that \
according to our BNF specification \"O2H\" is correct. The context of bonds, \
valency, etc. is not in the BNF specification.) The specification of a \
grammar using BNF is a list of rules. Each rule has a symbol on the left hand \
side, and one or more sequences of symbols on the right hand side. If there \
are more than one sequence on the right hand side they are separated with \"|\
\" that specifies alternative. Here is a rule\
\>", "Text",
 CellChangeTimes->{{3.492644272886908*^9, 3.4926443830400333`*^9}, {
   3.49264444237523*^9, 3.492644460278735*^9}, {3.4926445119037037`*^9, 
   3.4926445583456707`*^9}, {3.492644592806981*^9, 3.49264460667938*^9}, {
   3.4926446576971073`*^9, 3.492644767896003*^9}, {3.492644890971097*^9, 
   3.492644952830394*^9}, {3.492646102494968*^9, 3.492646232793577*^9}, {
   3.49264628349078*^9, 3.492646297038783*^9}, {3.492646805891983*^9, 
   3.492646844367646*^9}, 3.4926468856706676`*^9, {3.492647250179617*^9, 
   3.4926472654233923`*^9}, {3.492649561905753*^9, 3.492649587063013*^9}, {
   3.492649621855564*^9, 3.492649676319298*^9}, {3.492653023884453*^9, 
   3.492653043849772*^9}, 3.492653086744606*^9, {3.492653172654378*^9, 
   3.492653184711803*^9}, {3.4926532850411158`*^9, 3.4926532915296926`*^9}, {
   3.493237171477504*^9, 3.493237173250812*^9}, 
   3.493323834613106*^9},ExpressionUUID->"499815d3-a3a6-45f7-a388-\
e6fb2c10fa94"],

Cell["<product> ::= <term> | <term> <product>", "Program",
 CellChangeTimes->{{3.492649590662709*^9, 3.492649607223398*^9}, {
  3.4926496847413683`*^9, 
  3.492649759935327*^9}},ExpressionUUID->"79d06807-25e7-4de2-9204-\
ed785a46c6dd"],

Cell[TextData[{
 "This rule defines a product to be either a term or term written next to a \
product. Note that a symbol can appear both on the left and right hand sides. \
Symbols that do not appear on the left hand side are called ",
 StyleBox["terminals",
  FontSlant->"Italic"],
 ". Non-terminal symbols are start with the character '<' and end with the \
character '>' so they can be easily distinguished from the terminals. The \
symbol definition rules in BNF are called ",
 StyleBox["production rules",
  FontSlant->"Italic"],
 ", or ",
 StyleBox["productions",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.492649787636661*^9, 3.492649789416494*^9}, {
  3.4926498783022738`*^9, 3.492649979120202*^9}, {3.4926527504957857`*^9, 
  3.492652808937975*^9}, {3.492653125922221*^9, 3.492653163103771*^9}, {
  3.4926531933436003`*^9, 3.4926532142342978`*^9}, {3.4947945676737223`*^9, 
  3.4947946084522333`*^9}, {3.495028686192499*^9, 
  3.495028812839793*^9}},ExpressionUUID->"5bc2a3a2-3b61-4fe1-b46a-\
06a0013c7217"],

Cell[TextData[{
 "Let us describe using BNF the admissible morphemes in chemical formulas. We \
can make the observation that the element names are abbreviated, the first \
letter is always a capital. Abbreviations are unique. We can enumerate all \
admissible elements as terminal symbols that comprise the rule for the symbol \
",
 StyleBox["<element>", "Program"],
 "."
}], "Text",
 CellChangeTimes->{{3.488738575054175*^9, 3.4887385755153437`*^9}, {
   3.4899675780584793`*^9, 3.489967607341837*^9}, 3.490049771310697*^9, {
   3.492558871738262*^9, 3.492558929872308*^9}, {3.492559323792507*^9, 
   3.4925594252442503`*^9}, {3.492559535215551*^9, 3.492559571108315*^9}, {
   3.492559957192273*^9, 3.492559981116045*^9}, {3.4925600278417253`*^9, 
   3.492560080428277*^9}, {3.492560336206633*^9, 3.4925603917894917`*^9}, {
   3.4926131588641787`*^9, 3.4926133410747337`*^9}, {3.492613372564168*^9, 
   3.492613479347769*^9}, 3.492614232822605*^9, {3.4926432128550253`*^9, 
   3.492643226326694*^9}, {3.4926432991675577`*^9, 3.4926433334228497`*^9}, {
   3.492643377384166*^9, 3.492643381471323*^9}, 3.492643554833034*^9, {
   3.4926438946071177`*^9, 3.492643897870178*^9}, {3.492644024545138*^9, 
   3.492644100806273*^9}, {3.492644255534061*^9, 3.49264426271815*^9}, 
   3.4926500388563223`*^9, {3.492652721559545*^9, 3.492652741055591*^9}, {
   3.49265620279072*^9, 3.4926562235438757`*^9}, {3.4926562700346537`*^9, 
   3.492656297385891*^9}, {3.492911150805149*^9, 3.492911155968998*^9}, {
   3.493323840270918*^9, 3.493323846383093*^9}, {3.495028551054538*^9, 
   3.495028582232645*^9}},ExpressionUUID->"590fbbbb-5006-4c5a-bbb3-\
ca4ea53a5e65"],

Cell["\<\
<element> :: = \"H\" | \"He\" | \"Li\" | \"Be\" | \"B\" | \"C\" | \"N\" | \"O\
\" | \"F\" | \"Ne\" | \"Na\" | \"Mg\" | \"Al\" | \"Si\" | \"P\" | \"S\" | \
\"Cl\" | \"K\" | \"Ar\" | \"Ca\" | \"Sc\" | \"Ti\" | \"V\" | \"Cr\" | \"Mn\" \
| \"Fe\" | \"Ni\" | \"Co\" | \"Cu\" | \"Zn\" | \"Ga\" | \"Ge\" | \"As\" | \
\"Se\" | \"Br\" | \"Kr\" | \"Rb\" | \"Sr\" | \"Y\" | \"Zr\" | \"Nb\" | \"Mo\" \
| \"Tc\" | \"Ru\" | \"Rh\" | \"Pd\" | \"Ag\" | \"Cd\" | \"In\" | \"Sn\" | \
\"Sb\" | \"I\" | \"Te\" | \"Xe\" | \"Cs\" | \"Ba\" | \"La\" | \"Ce\" | \"Pr\" \
| \"Nd\" | \"Pm\" | \"Sm\" | \"Eu\" | \"Gd\" | \"Tb\" | \"Dy\" | \"Ho\" | \
\"Er\" | \"Tm\" | \"Yb\" | \"Lu\" | \"Hf\" | \"Ta\" | \"W\" | \"Re\" | \"Os\" \
| \"Ir\" | \"Pt\" | \"Au\" | \"Hg\" | \"Tl\" | \"Pb\" | \"Bi\" | \"Po\" | \
\"At\" | \"Rn\" | \"Fr\" | \"Ra\" | \"Ac\" | \"Pa\" | \"Th\" | \"Np\" | \"U\" \
| \"Am\" | \"Pu\" | \"Cm\" | \"Bk\" | \"Cf\" | \"Es\" | \"Fm\" | \"Md\" | \
\"No\" | \"Rf\" | \"Lr\" | \"Db\" | \"Bh\" | \"Sg\" | \"Mt\" | \"Rg\" | \
\"Hs\" | \"Ds\" | \"Uub\" | \"Uut\" | \"Uuq\" | \"Uup\" | \"Uuh\" | \"Uus\" | \
\"Uuo\"\
\>", "Program",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.36769347517414*^9, 3.3676934879616*^9}, {
   3.36769359076764*^9, 3.36769359397675*^9}, {3.36769378036873*^9, 
   3.3676937853401*^9}, {3.36769444964629*^9, 3.36769445108865*^9}, {
   3.36796860756167*^9, 3.36796861095248*^9}, {3.4950290881867247`*^9, 
   3.495029091847649*^9}, 
   3.49502923565243*^9},ExpressionUUID->"a6d7037e-69f5-4c29-b334-\
b9d47b86993b"],

Cell[TextData[{
 "We need to define numbers. A number is comprised of digits written next to \
each other. So we define a rule for what a digit is and use it in the \
definition of number. We define the symbol ",
 StyleBox["<digit>", "Program"],
 " as one of the arabic numerals (which are terminal symbols)."
}], "Text",
 CellChangeTimes->{{3.4926563364766817`*^9, 3.492656434623651*^9}, {
  3.492656674312628*^9, 3.492656709201082*^9}, {3.492656973887603*^9, 
  3.492657043989182*^9}, {3.492910859271928*^9, 3.492910867256351*^9}, {
  3.492911252474194*^9, 3.492911265889618*^9}, {3.492911315023841*^9, 
  3.4929114077849503`*^9}, {3.492911490947835*^9, 3.4929115160570908`*^9}, {
  3.495032667073669*^9, 3.495032712008314*^9}, {3.4950327665844717`*^9, 
  3.4950327905850153`*^9}, {3.723329067936721*^9, 
  3.723329068145699*^9}},ExpressionUUID->"15fe43f3-0552-4441-bb20-\
9528e4120cfe"],

Cell["<digit> ::= \
\"0\"|\"1\"|\"2\"|\"3\"|\"4\"|\"5\"|\"6\"|\"7\"|\"8\"|\"9\"", "Program",
 CellChangeTimes->{{3.4926564459933157`*^9, 3.492656541778798*^9}, {
  3.4926568210386477`*^9, 3.492656821783934*^9}, {3.492911412063998*^9, 
  3.492911412480275*^9}, {3.49503268412914*^9, 
  3.4950326889050283`*^9}},ExpressionUUID->"7b21e883-188c-4841-bb4a-\
bbc7be0fe920"],

Cell[TextData[{
 "Now we can define the number symbol ",
 StyleBox["<number>", "Program"],
 " recursively: a number is a digit or a digit written next to a number."
}], "Text",
 CellChangeTimes->{{3.4926563364766817`*^9, 3.492656434623651*^9}, {
   3.492656674312628*^9, 3.492656709201082*^9}, {3.492656973887603*^9, 
   3.492657043989182*^9}, {3.492910859271928*^9, 3.492910867256351*^9}, {
   3.492911252474194*^9, 3.492911265889618*^9}, 3.492911315023841*^9, {
   3.492911418136307*^9, 3.492911442344191*^9}, {3.49291154317177*^9, 
   3.492911611884239*^9}},ExpressionUUID->"e5795d14-c040-4387-84cc-\
9c79e9e05fbd"],

Cell["<number> ::= <digit>|<digit><number>", "Program",
 CellChangeTimes->{{3.4926564459933157`*^9, 3.492656541778798*^9}, {
  3.4926568210386477`*^9, 3.492656821783934*^9}, {3.492911445056201*^9, 
  3.492911446024693*^9}},ExpressionUUID->"88321047-233e-4404-aba9-\
cdf5f743a59b"],

Cell["\<\
Next we need to define molecules. A molecule can be an element. \
Alternatively, a molecule can be put in parentheses. Alternatively, a \
molecule can be an element and a number next to it. Last, a molecule can also \
be recursively defined as a molecule written next to another molecule.\
\>", "Text",
 CellChangeTimes->{{3.492657092930359*^9, 3.492657176888237*^9}, {
   3.4926572502269497`*^9, 3.492657322288394*^9}, 3.492904847173583*^9, {
   3.4929057734143343`*^9, 3.4929057997840853`*^9}, {3.4929061158454447`*^9, 
   3.49290611611978*^9}, {3.4929101742884827`*^9, 3.492910175080347*^9}, {
   3.492910211579152*^9, 3.492910212744172*^9}, {3.492910967596487*^9, 
   3.492911107248958*^9}, {3.492911690595087*^9, 3.492911697968648*^9}, 
   3.493323854623608*^9},ExpressionUUID->"c8b62cf3-7546-42a4-9de5-\
614053c479a7"],

Cell["\<\
<molecule> ::= <element>|<submolecule>|<replicated>|<connected>\
\>", "Program",
 CellChangeTimes->{{3.36769372767308*^9, 3.36769373947807*^9}, {
   3.36769385236817*^9, 3.36769387780906*^9}, {3.36769390950654*^9, 
   3.36769392229028*^9}, {3.36769415836084*^9, 3.36769429282609*^9}, {
   3.36769441927048*^9, 3.36769441980383*^9}, {3.36769470087168*^9, 
   3.36769470839787*^9}, {3.36796863550411*^9, 3.36796865786797*^9}, {
   3.36796876211704*^9, 3.3679687701149*^9}, {3.36797236243425*^9, 
   3.36797236656678*^9}, {3.490313208692965*^9, 3.490313211817232*^9}, 
   3.492898239779263*^9, {3.492911192477716*^9, 3.492911197000291*^9}, {
   3.492911678521061*^9, 3.492911684009357*^9}, {3.495044320243849*^9, 
   3.4950443218427*^9}, {3.4950445473714848`*^9, 
   3.495044552881604*^9}},ExpressionUUID->"1bb02d7f-fead-461c-abf0-\
b003926175ce"],

Cell[TextData[{
 "The first alternative, ",
 StyleBox["<element>", "Program"],
 ", is already defined. The second alternative is needed to describe formulas \
like ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"Ce", "(", 
     SubscriptBox["SO", "4"], ")"}], "2"], TraditionalForm]],ExpressionUUID->
  "44be1463-4423-4ecc-a1b8-c7f9d5c9c420"],
 ", i.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["SO", "4"], ")"}], TraditionalForm]],ExpressionUUID->
  "3d22fb8c-3d38-43ed-8141-62506da01e9c"],
 " is valid molecule, and it is derived from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["SO", "4"], TraditionalForm]],ExpressionUUID->
  "f02fcd07-1e98-4f5c-98a9-d8baa295e7fa"],
 ". "
}], "Text",
 CellChangeTimes->{{3.492911235169932*^9, 3.492911239175846*^9}, {
   3.492911629406103*^9, 3.492911670496159*^9}, {3.4929117045334873`*^9, 
   3.492911837752242*^9}, {3.492912046509507*^9, 3.492912063297071*^9}, {
   3.492912128084*^9, 3.4929121500958014`*^9}, {3.492912189020008*^9, 
   3.492912278802287*^9}, 
   3.493323861462367*^9},ExpressionUUID->"21f8aeaa-0b20-47cc-b1f4-\
de3e9a42bcf4"],

Cell["\<\
The rule of the second alternative <submolecule> simply says that parenthesis \
can placed a string that adheres to the rule of <molecule>. \
\>", "Text",
 CellChangeTimes->{{3.495044368786992*^9, 
  3.495044484001513*^9}},ExpressionUUID->"5fd046ce-c545-43c1-9f53-\
c7a6d8c87208"],

Cell["<submolecule> ::= \"(\"<molecule>\")\"", "Program",
 CellChangeTimes->{{3.36769372767308*^9, 3.36769373947807*^9}, {
   3.36769385236817*^9, 3.36769387780906*^9}, {3.36769390950654*^9, 
   3.36769392229028*^9}, {3.36769415836084*^9, 3.36769429282609*^9}, {
   3.36769441927048*^9, 3.36769441980383*^9}, {3.36769470087168*^9, 
   3.36769470839787*^9}, {3.36796863550411*^9, 3.36796865786797*^9}, {
   3.36796876211704*^9, 3.3679687701149*^9}, {3.36797236243425*^9, 
   3.36797236656678*^9}, {3.490313208692965*^9, 3.490313211817232*^9}, 
   3.492898239779263*^9, {3.492911192477716*^9, 3.492911197000291*^9}, {
   3.492911678521061*^9, 3.492911684009357*^9}, {3.495044320243849*^9, 
   3.4950443577614813`*^9}},ExpressionUUID->"a6e3d249-3ef8-4133-9128-\
e257647ca816"],

Cell["\<\
The rule for <submolecule> can be included in the rule <molecule>:\
\>", "Text",
 CellChangeTimes->{{3.495044486870657*^9, 3.495044532985485*^9}, {
  3.495044590847445*^9, 
  3.4950446333614063`*^9}},ExpressionUUID->"c4c34d22-ecd6-43a2-9198-\
adcf3a4039ea"],

Cell["\<\
<molecule> ::= <element>|\"(\"<molecule>\")\"|<replicated>|<connected>\
\>", "Program",
 CellChangeTimes->{{3.36769372767308*^9, 3.36769373947807*^9}, {
   3.36769385236817*^9, 3.36769387780906*^9}, {3.36769390950654*^9, 
   3.36769392229028*^9}, {3.36769415836084*^9, 3.36769429282609*^9}, {
   3.36769441927048*^9, 3.36769441980383*^9}, {3.36769470087168*^9, 
   3.36769470839787*^9}, {3.36796863550411*^9, 3.36796865786797*^9}, {
   3.36796876211704*^9, 3.3679687701149*^9}, {3.36797236243425*^9, 
   3.36797236656678*^9}, {3.490313208692965*^9, 3.490313211817232*^9}, 
   3.492898239779263*^9, {3.492911192477716*^9, 3.492911197000291*^9}, {
   3.492911678521061*^9, 3.492911684009357*^9}, {3.495044320243849*^9, 
   3.4950443218427*^9}},ExpressionUUID->"3b73bbad-b700-46c1-be5b-\
a049397b1366"],

Cell["\<\
But using a separate rule would make the program design easier to explain.\
\>", "Text",
 CellChangeTimes->{{3.495044635803982*^9, 3.495044636353414*^9}, {
  3.495044706817638*^9, 
  3.495044746073586*^9}},ExpressionUUID->"eed6cbea-8a38-4fb3-a0da-\
af7473c69be0"],

Cell["\<\
We define <replicated> as a molecule next to a number or a molecule, \
underscore, and a number next to each other.\
\>", "Text",
 CellChangeTimes->{{3.492911235169932*^9, 3.492911239175846*^9}, {
  3.492911629406103*^9, 3.492911670496159*^9}, {3.4929117045334873`*^9, 
  3.492911837752242*^9}, {3.492912046509507*^9, 3.492912063297071*^9}, {
  3.492912128084*^9, 3.4929121500958014`*^9}, {3.492912189020008*^9, 
  3.4929123604161787`*^9}, {3.4933248077890377`*^9, 
  3.493324807869026*^9}},ExpressionUUID->"0b84f425-485a-49e8-b92a-\
3f7344019868"],

Cell["<replicated> ::= <molecule><number> | <molecule>\"_\"<number>", \
"Program",
 CellChangeTimes->{{3.36769372767308*^9, 3.36769373947807*^9}, {
   3.36769385236817*^9, 3.36769387780906*^9}, {3.36769390950654*^9, 
   3.36769392229028*^9}, {3.36769430233145*^9, 3.3676943471731*^9}, {
   3.36769471111364*^9, 3.36769471402393*^9}, {3.36796866440095*^9, 
   3.36796866585593*^9}, {3.36796877262645*^9, 3.36796877312299*^9}, {
   3.36797237403347*^9, 3.36797237659864*^9}, 3.492898240627242*^9, {
   3.4929123252402477`*^9, 
   3.492912326328374*^9}},ExpressionUUID->"8ff5c066-9d11-4700-8550-\
7377ebd1a07b"],

Cell["\<\
We define <connected> simply as two molecules next to each other. \
\>", "Text",
 CellChangeTimes->{{3.492911947039979*^9, 3.4929119645933*^9}, {
  3.492912380644932*^9, 3.492912387688113*^9}, {3.492912429576473*^9, 
  3.4929124438525476`*^9}, {3.493919430052588*^9, 
  3.493919431571412*^9}},ExpressionUUID->"d00bb392-23fa-4a5f-9e62-\
c4d1acf5f269"],

Cell["<connected> ::= <molecule><molecule>", "Program",
 CellChangeTimes->{{3.36769436131365*^9, 3.36769438636395*^9}, {
  3.36769471693148*^9, 3.36769471741541*^9}, {3.36796866807923*^9, 
  3.36796868435203*^9}, {3.36796877584321*^9, 3.36796877619445*^9}, {
  3.36797236975046*^9, 3.36797237107446*^9}, {3.49391942467408*^9, 
  3.493919427970996*^9}},ExpressionUUID->"c7e90f34-438f-4547-9733-\
9f4fb154ca2b"],

Cell["\<\
Note that instead of having separate symbol <connected> we could have \
inserted its definition into the definition of <molecule>:\
\>", "Text",
 CellChangeTimes->{{3.492657449172141*^9, 3.492657454311872*^9}, {
   3.4929124475680656`*^9, 3.4929125166081753`*^9}, 3.493323871614468*^9, {
   3.4950396305044537`*^9, 
   3.495039632217289*^9}},ExpressionUUID->"a2668d30-b140-4586-8846-\
f5d568d0066a"],

Cell["\<\
<molecule> ::= \
<element>|\"(\"<molecule>\")\"|<replicated>|<molecule><molecule>\
\>", "Program",
 CellChangeTimes->{{3.36769372767308*^9, 3.36769373947807*^9}, {
   3.36769385236817*^9, 3.36769387780906*^9}, {3.36769390950654*^9, 
   3.36769392229028*^9}, {3.36769415836084*^9, 3.36769429282609*^9}, {
   3.36769441927048*^9, 3.36769441980383*^9}, {3.36769470087168*^9, 
   3.36769470839787*^9}, {3.36796863550411*^9, 3.36796865786797*^9}, {
   3.36796876211704*^9, 3.3679687701149*^9}, {3.36797236243425*^9, 
   3.36797236656678*^9}, {3.490313208692965*^9, 3.490313211817232*^9}, 
   3.492898239779263*^9, {3.492911192477716*^9, 3.492911197000291*^9}, {
   3.492911678521061*^9, 3.492911684009357*^9}, {3.492912529827442*^9, 
   3.49291253633138*^9}},ExpressionUUID->"598a4928-bf9f-42ae-ae2c-\
a8bc72e6e3ad"],

Cell["\<\
Next we want to define structures for chemical equations. We need to define \
grammatic rules Left Hand Side (LHS) and the Right Hand Side (RHS) of an \
equation and how LHS, yield sign, and RHS form an equation. \
\>", "Text",
 CellChangeTimes->{{3.495129069950211*^9, 3.495129248246999*^9}, {
  3.495129329514625*^9, 3.4951294023057737`*^9}, {3.723329178355546*^9, 
  3.72332917989412*^9}},ExpressionUUID->"26ad27d2-1c9c-433d-90d6-\
5df0b0842339"],

Cell[TextData[{
 "The structure of LHS and RHS is identical, so we are going to describe them \
with one production rule, for the symbol ",
 StyleBox["<mixture>", "Program"],
 "."
}], "Text",
 CellChangeTimes->{{3.495129069950211*^9, 3.495129248246999*^9}, {
   3.495129329514625*^9, 3.495129443743937*^9}, {3.495129499426178*^9, 
   3.495129526700801*^9}, 3.495129610188615*^9, {3.4951298018532543`*^9, 
   3.495129802340644*^9}},ExpressionUUID->"0b78a245-6257-4115-a9bc-\
f84b29b71ecd"],

Cell["\<\
<mixture> ::= <molecule> | <molecule> \"+\" \"h\[Nu]\" | <mix> \"+\" \
<molecule>\
\>", "Program",
 CellChangeTimes->{{3.36769436131365*^9, 3.36769438636395*^9}, {
  3.36769471693148*^9, 3.36769471741541*^9}, {3.36796866807923*^9, 
  3.36796868435203*^9}, {3.36796877584321*^9, 3.36796877619445*^9}, {
  3.36797236975046*^9, 3.36797237107446*^9}, {3.490192357800621*^9, 
  3.490192379197077*^9}, {3.4901926564080257`*^9, 3.490192659845893*^9}, {
  3.490193156041957*^9, 3.4901932109018393`*^9}, {3.490193293504265*^9, 
  3.490193314565024*^9}, {3.490193578233453*^9, 3.490193581374349*^9}, {
  3.490313270826837*^9, 3.490313272168833*^9}, {3.495129805182468*^9, 
  3.495129805603943*^9}},ExpressionUUID->"c44271d9-1b70-45e2-85db-\
2280011733ce"],

Cell["\<\
Since there are multiple possibilities what charter or sequence of characters \
is used to show transformation between LHS mixtures and RHS mixtures, we \
define \
\>", "Text",
 CellChangeTimes->{{3.495129940059576*^9, 3.495130050537972*^9}, {
  3.72182465790574*^9, 
  3.7218246670735273`*^9}},ExpressionUUID->"c85bc834-f043-414c-a627-\
9a561c3f90f8"],

Cell["<yield> ::= \"\[Rule]\" | \"->\" | \"=\" | \"\[LeftArrowRightArrow]\"", \
"Program",
 CellChangeTimes->{{3.495130054281087*^9, 3.495130101417924*^9}, {
  3.4951308340365677`*^9, 3.495130850187825*^9}, {3.495130905715156*^9, 
  3.4951309064276953`*^9}},ExpressionUUID->"993ecdc7-c8a9-4061-8247-\
f7345f8a0bfa"],

Cell["\<\
Now defining a production rule for a chemical equation is easy.\
\>", "Text",
 CellChangeTimes->{{3.49512970583747*^9, 3.4951297162123413`*^9}, {
  3.495129767119494*^9, 3.4951298271077833`*^9}, {3.495130874112906*^9, 
  3.495130877547101*^9}},ExpressionUUID->"8b77dc73-de85-4874-b37f-\
7ced194a0f96"],

Cell["<equation> ::= <mixture> <yield> <mixture>", "Program",
 CellChangeTimes->{{3.36769436131365*^9, 3.36769438636395*^9}, {
  3.36769471693148*^9, 3.36769471741541*^9}, {3.36796866807923*^9, 
  3.36796868435203*^9}, {3.36796877584321*^9, 3.36796877619445*^9}, {
  3.36797236975046*^9, 3.36797237107446*^9}, {3.490192357800621*^9, 
  3.490192379197077*^9}, {3.490192698573299*^9, 3.490192699909083*^9}, {
  3.490193215869103*^9, 3.4901932170380783`*^9}, {3.490193322720324*^9, 
  3.490193358285038*^9}, {3.49019349940657*^9, 3.4901935001100683`*^9}, {
  3.490193773240573*^9, 3.490193777581839*^9}, {3.49503967616675*^9, 
  3.495039677140562*^9}, {3.4951298299881983`*^9, 3.4951298401927767`*^9}, {
  3.495130857609934*^9, 
  3.495130903570953*^9}},ExpressionUUID->"f350fd81-607e-4d40-8924-\
d4fc57ef5a9e"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Other formulations",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.492646243544842*^9, 
  3.492646252230858*^9}},ExpressionUUID->"84756167-16d0-4e41-be84-\
dc65969e3c1b"],

Cell["\<\
(By \"free of context\" we mean the grammar and syntax of a sentence like \
\"The cat is flying climbingly.\" is correct, but the meaning might be \
absent.) \
\>", "Text"],

Cell["", "Text"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data structures representing molecules", "Section",
 CellChangeTimes->{{3.488071304035207*^9, 3.4880713159376917`*^9}, {
  3.492643420820798*^9, 3.49264342119825*^9}, {3.4927393947178173`*^9, 
  3.4927394097432756`*^9}},ExpressionUUID->"054b668c-3a16-496b-95e0-\
e6799aed1a99"],

Cell["\<\
Here we are going to present a data structure that would represent the \
information contained in a chemical formula in a way more amenable for \
molecular composition calculations.\
\>", "Text",
 CellChangeTimes->{{3.4927872027190943`*^9, 3.492787341310852*^9}, {
  3.492787743145372*^9, 3.492787743597988*^9}, {3.4928128702054873`*^9, 
  3.492812887518414*^9}},ExpressionUUID->"389ee05e-d796-4fea-88b7-\
be40aecb854f"],

Cell[TextData[{
 "If we look at a molecule like copper(II) sulfate, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["CuSO", "4"], TraditionalForm]],ExpressionUUID->
  "86c50284-cda8-4993-b71a-244017ff7b13"],
 ", we discern it into three groups of symbols because of the three atoms it. \
We can see that formula as a list of three separate entities "
}], "Text",
 CellChangeTimes->{{3.492801755068308*^9, 3.492801771507557*^9}, {
   3.492802853124751*^9, 3.492802899116366*^9}, {3.492803610090579*^9, 
   3.492803613445298*^9}, {3.492803683029001*^9, 3.492803702917837*^9}, {
   3.492803733047586*^9, 3.49280374890139*^9}, {3.49280743178172*^9, 
   3.4928074472335253`*^9}, {3.492808424040317*^9, 3.492808426030096*^9}, {
   3.492810197777259*^9, 3.492810218061804*^9}, {3.492817156955223*^9, 
   3.492817214559825*^9}, 
   3.4928431589467707`*^9},ExpressionUUID->"7a91f5b8-6916-434f-91f6-\
4fe0d4508053"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "\"\<Cu\>\"", ",", "\"\<S\>\"", ",", 
   "\"\<\!\(\*SubscriptBox[\(O\), \(4\)]\)\>\""}], "}"}]], "Input",
 CellChangeTimes->{{3.4928102214869967`*^9, 3.492810238471489*^9}, {
  3.49281110686482*^9, 
  3.492811109711762*^9}},ExpressionUUID->"8ac23b6f-dd7f-4821-abef-\
71aab32e205a"],

Cell[TextData[{
 "We can name this structure, or in other words change the head to be \
something that reflects for  what purposes the structure is going to be used. \
We can use the head ",
 StyleBox["Molecule", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.492810757832952*^9, 3.492810926118854*^9}, {
  3.492812924435947*^9, 3.4928129245665894`*^9}, {3.492899539904394*^9, 
  3.4928995523508377`*^9}},ExpressionUUID->"de8e5454-5486-482a-887e-\
a4fc0bb8bdde"],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{
  "\"\<Cu\>\"", ",", "\"\<S\>\"", ",", 
   "\"\<\!\(\*SubscriptBox[\(O\), \(4\)]\)\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.492803750487751*^9, 3.492803782253993*^9}, {
  3.492807486397744*^9, 3.492807499823715*^9}, {3.492810886984229*^9, 
  3.492810889768804*^9}, {3.492811098610957*^9, 
  3.4928111024512243`*^9}},ExpressionUUID->"cb6f6863-fdc3-4fa4-8450-\
9c8c694bfe2a"],

Cell["\<\
Next we need to decide how to represent in the data structure formula parts \
that specify multiple atoms of a given element. We can choose a sub-structure \
that is an ordered list of an element name and an integer:\
\>", "Text",
 CellChangeTimes->{{3.492810934370542*^9, 3.492810944797876*^9}, {
   3.492811121146811*^9, 3.492811169815473*^9}, {3.4928125310502357`*^9, 
   3.492812544214383*^9}, {3.492812581761725*^9, 3.492812581998477*^9}, {
   3.4928126253530483`*^9, 3.492812689094692*^9}, {3.492812759593129*^9, 
   3.492812822302206*^9}, {3.492812947211999*^9, 3.4928129475425053`*^9}, 
   3.492843192592424*^9, {3.492899578396323*^9, 3.492899591150522*^9}, {
   3.492901566925517*^9, 
   3.492901571591146*^9}},ExpressionUUID->"bc36efc8-7900-4f13-b9b1-\
e336121d8a63"],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{"\"\<Cu\>\"", ",", "\"\<S\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<O\>\"", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.492803750487751*^9, 3.492803782253993*^9}, {
   3.492807486397744*^9, 3.492807499823715*^9}, 3.492810836023548*^9, {
   3.492812966193903*^9, 
   3.492812969664555*^9}},ExpressionUUID->"fb737d59-2ea4-46d4-a178-\
74a9dc141aed"],

Cell[TextData[{
 "Again, we can choose a head that is less generic than ",
 StyleBox["List", "Program"],
 ", that identifies the data. We can (naively) look at ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["CuSO", "4"], TraditionalForm]],ExpressionUUID->
  "ce82a439-804a-4e2f-b094-80607ae79b21"],
 " as ",
 Cell[BoxData[
  FormBox["CuSOOOO", TraditionalForm]],ExpressionUUID->
  "40fb2f95-cbb7-4fb9-a4e5-9fcf971fc418"],
 ", and use the head ",
 StyleBox["Replicated", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.492812972315877*^9, 3.4928130072945623`*^9}, {
   3.49281430691313*^9, 3.492814386070821*^9}, 3.4928981432042418`*^9, {
   3.492899601440661*^9, 
   3.4928996811675262`*^9}},ExpressionUUID->"6bb2e938-30af-4a04-9409-\
648340897fb6"],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{"\"\<Cu\>\"", ",", "\"\<S\>\"", ",", 
   RowBox[{"Replicated", "[", 
    RowBox[{"\"\<O\>\"", ",", "4"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.492803750487751*^9, 3.492803782253993*^9}, {
   3.492807486397744*^9, 3.492807499823715*^9}, 3.492810836023548*^9, 
   3.492898147484311*^9},ExpressionUUID->"2c8671d4-c159-4058-9853-\
a30450a24420"],

Cell[TextData[{
 "The first element in the ",
 StyleBox["Replicated", "Program"],
 " sub-structures can be a molecule not just an element name. For cerium(IV) \
sulfate, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"Ce", "(", 
     SubscriptBox["SO", "4"], ")"}], "2"], TraditionalForm]],ExpressionUUID->
  "a78c90b1-2203-42f8-bf01-6bb8cb1a3d4e"],
 ", we will have the representation"
}], "Text",
 CellChangeTimes->{{3.4929019260517406`*^9, 3.492901961517416*^9}, {
  3.492902207411665*^9, 3.4929023125590754`*^9}, {3.4929023472556133`*^9, 
  3.492902364519071*^9}, {3.4929026312872057`*^9, 3.492902749766889*^9}, {
  3.4929028927087727`*^9, 
  3.492902902623106*^9}},ExpressionUUID->"2e5d6567-1147-4391-9e6e-\
78191e20b4c9"],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{"\"\<Ce\>\"", ",", 
   RowBox[{"Replicated", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\"\<S\>\"", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\"\<O\>\"", ",", "4"}], "]"}]}], "]"}], ",", "2"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.492803750487751*^9, 3.492803782253993*^9}, {
   3.492807486397744*^9, 3.492807499823715*^9}, 3.492810836023548*^9, 
   3.492898147484311*^9, {3.4929027599639053`*^9, 3.492902803057581*^9}, {
   3.492902866044487*^9, 
   3.492902872018396*^9}},ExpressionUUID->"a7920a38-e101-45fd-8a04-\
f1b29c07c88b"],

Cell[TextData[{
 "Now using this data structure let us try to write ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " functions that use it to for different types of results. Let us start with \
programming the computation of molecular mass. We define the function ",
 StyleBox["MolecularMass", "Program"],
 " for each type of sub-expressions we have in our structure."
}], "Text",
 CellChangeTimes->{{3.4928144047185507`*^9, 3.4928145586782513`*^9}, {
  3.4928147628716803`*^9, 3.492814768942539*^9}, {3.493322701046998*^9, 
  3.493322766908968*^9}, {3.493322850617757*^9, 3.4933228510159883`*^9}, {
  3.493322925087041*^9, 
  3.4933229296699953`*^9}},ExpressionUUID->"75ef6b66-5b6b-41aa-8531-\
673021747588"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MolecularMass", "[", "element_String", "]"}], ":=", 
   RowBox[{"ElementData", "[", 
    RowBox[{"element", ",", "\"\<AtomicMass\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MolecularMass", "[", "m_Molecule", "]"}], ":=", 
   RowBox[{"Total", "[", 
    RowBox[{"MolecularMass", "/@", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MolecularMass", "[", "m_Replicated", "]"}], ":=", 
   RowBox[{
    RowBox[{"MolecularMass", "[", 
     RowBox[{"m", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "]"}], "*", 
    RowBox[{"m", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.492814561792733*^9, 3.492814712169962*^9}, {
   3.492814771762006*^9, 3.492814820699539*^9}, {3.492815375915513*^9, 
   3.492815377443303*^9}, 3.492898149353488*^9, {3.492899717735095*^9, 
   3.492899719146187*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MolecularMass", "[", 
  RowBox[{"Molecule", "[", 
   RowBox[{"\"\<Cu\>\"", ",", "\"\<S\>\"", ",", 
    RowBox[{"Replicated", "[", 
     RowBox[{"\"\<O\>\"", ",", "4"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.492814714617014*^9, 3.492814753281999*^9}, 
   3.492898151788224*^9}],

Cell[BoxData["159.6086`5.1944103050615364"], "Output",
 CellChangeTimes->{{3.49281477744525*^9, 3.492814804122108*^9}, 
   3.492815379173402*^9, 3.492898273843667*^9, 3.49289972087568*^9, 
   3.493078047729762*^9}]
}, Open  ]],

Cell["\<\
It would be nice if we can verify this result. If we change the definition \
that finds the atomic mass corresponding to an element abbreviation to return \
the element abbreviation itself i.e.\
\>", "Text",
 CellChangeTimes->{{3.492815391235324*^9, 3.4928154895026693`*^9}, {
  3.492815521943062*^9, 3.492815582926803*^9}, {3.492843220223995*^9, 
  3.49284331882903*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MolecularMass", "[", "element_String", "]"}], ":=", "element"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4928153629873877`*^9, 3.49281538576025*^9}}],

Cell["we can see that our implementation works correctly", "Text",
 CellChangeTimes->{{3.492815492917798*^9, 3.492815513758943*^9}, {
  3.492843334459651*^9, 3.492843340869664*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MolecularMass", "[", 
  RowBox[{"Molecule", "[", 
   RowBox[{"\"\<Cu\>\"", ",", "\"\<S\>\"", ",", 
    RowBox[{"Replicated", "[", 
     RowBox[{"\"\<O\>\"", ",", "4"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.492814714617014*^9, 3.492814753281999*^9}, 
   3.492898152671492*^9}],

Cell[BoxData[
 RowBox[{"\<\"Cu\"\>", "+", 
  RowBox[{"4", " ", "\<\"O\"\>"}], "+", "\<\"S\"\>"}]], "Output",
 CellChangeTimes->{{3.49281477744525*^9, 3.492814804122108*^9}, 
   3.4928153875101023`*^9, 3.492815590780315*^9, 3.4928982825625343`*^9, 
   3.492899724758047*^9, 3.493078048076326*^9}]
}, Open  ]],

Cell["\<\
because in to calculate the molecular mass from the expressions like the one \
above we simply replace element names with atomic masses.\
\>", "Text",
 CellChangeTimes->{{3.492843382737118*^9, 3.492843467389135*^9}}],

Cell[TextData[{
 "Now let us program the conversion of a molecule data structure to a \
chemical formula (which is a string). As with ",
 StyleBox["MolecularMass", "Program"],
 " we define the function ",
 StyleBox["MoleculeToString", "Program"],
 " for each type of sub-expressions we have in our structure."
}], "Text",
 CellChangeTimes->{{3.492814827738163*^9, 3.492814918006488*^9}, {
  3.4933231829885063`*^9, 3.493323208653*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MoleculeToString", "[", "element_String", "]"}], ":=", 
   "element"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MoleculeToString", "[", "m_Molecule", "]"}], ":=", 
   RowBox[{"StringJoin", "@@", 
    RowBox[{"Map", "[", 
     RowBox[{"MoleculeToString", ",", "m"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MoleculeToString", "[", "m_Replicated", "]"}], ":=", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"StringQ", "[", 
       RowBox[{"m", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "]"}], ",", 
      RowBox[{"m", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"\"\<(\>\"", "<>", 
       RowBox[{"MoleculeToString", "[", 
        RowBox[{"m", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], "<>", "\"\<)\>\""}]}], "]"}], "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"m", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4928149201730022`*^9, 3.4928151321367483`*^9}, 
   3.492898154321933*^9, {3.493078687641115*^9, 3.493078696248575*^9}, {
   3.4938993842663507`*^9, 3.4938993913587513`*^9}, {3.493899422449066*^9, 
   3.493899423630829*^9}}],

Cell["Let us check the implementation", "Text",
 CellChangeTimes->{{3.492815658752746*^9, 3.492815661359152*^9}, {
  3.492843498507103*^9, 3.4928435066684427`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MoleculeToString", "[", 
  RowBox[{"Molecule", "[", 
   RowBox[{"\"\<Cu\>\"", ",", "\"\<S\>\"", ",", 
    RowBox[{"Replicated", "[", 
     RowBox[{"\"\<O\>\"", ",", "4"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.492814714617014*^9, 3.492814753281999*^9}, {
   3.492815145243125*^9, 3.49281515145625*^9}, 3.4928981553747473`*^9}],

Cell[BoxData["\<\"CuSO4\"\>"], "Output",
 CellChangeTimes->{
  3.4928151519841223`*^9, 3.492898285432949*^9, {3.493078052462173*^9, 
   3.493078078378028*^9}, 3.493078173509367*^9, 3.49307830075077*^9, 
   3.493078428540872*^9, {3.493078703844964*^9, 3.4930787087290287`*^9}}]
}, Open  ]],

Cell["Let us do another check using the molecule of zinc cyanide:", "Text",
 CellChangeTimes->{{3.492815664535359*^9, 3.492815689534446*^9}, {
  3.492816030978162*^9, 3.492816036661305*^9}, {3.49284351253769*^9, 
  3.492843528620865*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MoleculeToString", "[", 
  RowBox[{"Molecule", "[", 
   RowBox[{"\"\<Zn\>\"", ",", 
    RowBox[{"Replicated", "[", 
     RowBox[{
      RowBox[{"Molecule", "[", 
       RowBox[{"\"\<C\>\"", ",", "\"\<N\>\""}], "]"}], ",", "2"}], "]"}]}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.492814714617014*^9, 3.492814753281999*^9}, {
   3.492815145243125*^9, 3.49281517240912*^9}, {3.4928159898044767`*^9, 
   3.4928160147539597`*^9}, 3.492898156238126*^9}],

Cell[BoxData["\<\"Zn(CN)2\"\>"], "Output",
 CellChangeTimes->{3.492815173227749*^9, 3.492816027589177*^9, 
  3.492898287250806*^9, 3.4930780546471853`*^9, 3.493078822066004*^9}]
}, Open  ]],

Cell[TextData[{
 "Last, let us write a function that finds the number of atoms of each \
element in the compound. The easiest way to program this is to expand the \
sub-expressions with the head ",
 StyleBox["Replicated", "Program"],
 " and convert molecule expressions into lists of element names only. In \
other words we want to change"
}], "Text",
 CellChangeTimes->{{3.492815192935817*^9, 3.492815243174941*^9}, 
   3.492815649335647*^9, {3.4928162635041227`*^9, 3.492816286342844*^9}, {
   3.492841393105792*^9, 3.492841518388377*^9}, {3.492841943396397*^9, 
   3.492841943468615*^9}, {3.4928421758137693`*^9, 3.492842197236576*^9}, {
   3.49284237928747*^9, 3.492842500676256*^9}, {3.492842540977606*^9, 
   3.4928425422604227`*^9}, 3.492842651697114*^9, 3.492842702388238*^9, 
   3.4928981574784327`*^9, {3.492899778862471*^9, 3.492899791774629*^9}, {
   3.492899872511691*^9, 3.492899873502487*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{"\"\<Zn\>\"", ",", 
   RowBox[{"Replicated", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\"\<C\>\"", ",", "\"\<N\>\""}], "]"}], ",", "4"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4929000761134167`*^9, 3.4929001089688597`*^9}}],

Cell["into", "Text",
 CellChangeTimes->{{3.492899860994144*^9, 3.4928998777584553`*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{"\"\<Zn\>\"", ",", " ", 
   RowBox[{"Molecule", "[", 
    RowBox[{
    "\"\<C\>\"", ",", " ", "\"\<N\>\"", ",", "\"\<C\>\"", ",", "\"\<N\>\""}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.492899821699395*^9, 3.492899835280904*^9}, {
  3.4929000810578413`*^9, 3.492900086958766*^9}}],

Cell["or better yet", "Text",
 CellChangeTimes->{{3.492899880381439*^9, 3.49289988519038*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{
  "\"\<Zn\>\"", ",", " ", "\"\<C\>\"", ",", " ", "\"\<N\>\"", ",", 
   "\"\<C\>\"", ",", "\"\<N\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.492899821699395*^9, 3.492899835280904*^9}, {
  3.492899891295233*^9, 3.4928998956012907`*^9}}],

Cell[TextData[{
 "Then we can simply count the number of occurrences of each element. Let us \
clarify using actual code. We are going to take the molecule structure that \
corresponds to acetone, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["CH", "3"], ")"}], "2"], "CO"}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.492815192935817*^9, 3.492815243174941*^9}, 
   3.492815649335647*^9, {3.4928162635041227`*^9, 3.492816286342844*^9}, {
   3.492841393105792*^9, 3.492841518388377*^9}, {3.492841943396397*^9, 
   3.492841943468615*^9}, {3.4928421758137693`*^9, 3.492842197236576*^9}, {
   3.49284237928747*^9, 3.492842500676256*^9}, {3.492842540977606*^9, 
   3.4928425422604227`*^9}, 3.492842651697114*^9, 3.492842702388238*^9, 
   3.4928981574784327`*^9, 3.492899778862471*^9, {3.492900146197014*^9, 
   3.492900213023158*^9}, {3.4929041468978233`*^9, 3.492904161727315*^9}, 
   3.4933237841814537`*^9}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{
   RowBox[{"Replicated", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\"\<C\>\"", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\"\<H\>\"", ",", "3"}], "]"}]}], "]"}], ",", "2"}], "]"}], 
   ",", "\"\<C\>\"", ",", "\"\<O\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.4929006594540863`*^9, 3.49290067892986*^9}}],

Cell[TextData[{
 "and expand the ",
 StyleBox["Replicated", "Program"],
 " sub-expressions using ",
 StyleBox["ReplaceRepeated", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.492901132927581*^9, 3.4929011347516813`*^9}, {
  3.4929012914190063`*^9, 3.49290131896983*^9}, {3.492901351302128*^9, 
  3.492901356463121*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Molecule", "[", 
   RowBox[{
    RowBox[{"Replicated", "[", 
     RowBox[{
      RowBox[{"Molecule", "[", 
       RowBox[{"\"\<C\>\"", ",", 
        RowBox[{"Replicated", "[", 
         RowBox[{"\"\<H\>\"", ",", "3"}], "]"}]}], "]"}], ",", "2"}], "]"}], 
    ",", "\"\<C\>\"", ",", "\"\<O\>\""}], "]"}], "//.", 
  RowBox[{
   RowBox[{"Replicated", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", "n", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.4928419951159163`*^9, 3.4928420031344976`*^9}, {
  3.492842224801427*^9, 3.4928422263271847`*^9}, {3.492898162137568*^9, 
  3.492898162939312*^9}, {3.492900908854184*^9, 3.492900931893258*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"C\"\>", ",", 
       RowBox[{"{", 
        RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>", ",", "\<\"H\"\>"}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"C\"\>", ",", 
       RowBox[{"{", 
        RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>", ",", "\<\"H\"\>"}], "}"}]}], 
      "]"}]}], "}"}], ",", "\<\"C\"\>", ",", "\<\"O\"\>"}], "]"}]], "Output",
 CellChangeTimes->{
  3.492842003889361*^9, 3.492842226856254*^9, 3.492843015284408*^9, 
   3.492898289673265*^9, {3.492900915747962*^9, 3.492900932592958*^9}}]
}, Open  ]],

Cell[TextData[{
 "Next, we replace ",
 StyleBox["Molecule", "Program"],
 " with ",
 StyleBox["List", "Program"],
 " and flatten the expression:"
}], "Text",
 CellChangeTimes->{{3.492842786514153*^9, 3.492842811756404*^9}, {
   3.4928428733749323`*^9, 3.492842949380724*^9}, 3.492904171322764*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"%", "/.", 
   RowBox[{"Molecule", "\[Rule]", "List"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.492842018053323*^9, 3.492842030157999*^9}, {
  3.492842244471039*^9, 3.492842255141725*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"H\"\>", ",", "\<\"H\"\>", 
   ",", "\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"H\"\>", ",", "\<\"H\"\>", 
   ",", "\<\"C\"\>", ",", "\<\"O\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.4928420318074923`*^9, 3.492842255811605*^9, 
  3.492843016754479*^9, 3.492898292139132*^9, 3.4929009427702217`*^9}]
}, Open  ]],

Cell[TextData[{
 "At this point the number of atoms for each element can be found using the \
function ",
 StyleBox[ButtonBox["Tally",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/Tally"], "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.492842954169361*^9, 3.492842996684121*^9}, {
  3.492904180227544*^9, 3.492904200959257*^9}, {3.492904360111412*^9, 
  3.49290436205462*^9}, {3.492904533116633*^9, 3.492904558891962*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.492843002445196*^9, 3.492843007141652*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"C\"\>", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"H\"\>", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"O\"\>", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.49284300809112*^9, 3.492843017935872*^9}, 
   3.492898293954257*^9, 3.492900946905216*^9}]
}, Open  ]],

Cell["\<\
Let us define a function executes the steps shown above for given molecule \
argument:\
\>", "Text",
 CellChangeTimes->{{3.492843046019683*^9, 3.492843084820383*^9}, {
  3.49290469717968*^9, 3.49290474049656*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "MoleculeToAtoms", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MoleculeToAtoms", "[", "mArg_Molecule", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", "mArg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"m", "//.", "\[InvisibleSpace]", 
        RowBox[{
         RowBox[{"Replicated", "[", 
          RowBox[{"x_", ",", "n_"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"Table", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", "n", "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"m", "/.", "\[InvisibleSpace]", 
         RowBox[{"Molecule", "\[Rule]", "List"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sort", "[", 
       RowBox[{"Tally", "[", "m", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.492821036708927*^9, 3.492821042820332*^9}, {
   3.4928210977031097`*^9, 3.492821151741076*^9}, {3.492821728713213*^9, 
   3.492821743628758*^9}, {3.492842261106804*^9, 3.492842262640554*^9}, 
   3.492898163893837*^9, {3.493163260396514*^9, 3.493163263021476*^9}, {
   3.493163370628644*^9, 3.493163372835685*^9}, {3.493163526350401*^9, 
   3.4931635288468037`*^9}}],

Cell["A simple test:", "Text",
 CellChangeTimes->{{3.492843103028614*^9, 3.492843111796254*^9}, {
  3.492904755471428*^9, 3.4929047621273823`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m", "=", 
  RowBox[{"MoleculeToAtoms", "[", 
   RowBox[{"Molecule", "[", 
    RowBox[{
     RowBox[{"Replicated", "[", 
      RowBox[{
       RowBox[{"Molecule", "[", 
        RowBox[{"\"\<C\>\"", ",", 
         RowBox[{"Replicated", "[", 
          RowBox[{"\"\<H\>\"", ",", "3"}], "]"}]}], "]"}], ",", "2"}], "]"}], 
     ",", "\"\<C\>\"", ",", "\"\<O\>\""}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.492816165660445*^9, 3.492816176012145*^9}, {
   3.492816226070232*^9, 3.492816256491312*^9}, {3.492816302323255*^9, 
   3.492816302969108*^9}, {3.4928167146200857`*^9, 3.4928167222658663`*^9}, 
   3.492898164855249*^9, {3.492904684275525*^9, 3.492904684756996*^9}, {
   3.4931631710258408`*^9, 3.493163171363761*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"C\"\>", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"H\"\>", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"O\"\>", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4928163037448177`*^9, 3.4928167228070374`*^9, 3.4928210458052883`*^9, 
   3.492821153818055*^9, {3.492821807850418*^9, 3.4928218281608543`*^9}, 
   3.492842267799333*^9, 3.492898297161394*^9, 3.4929013958006477`*^9, 
   3.492904685157442*^9, 3.493078849153886*^9, {3.4930822262812*^9, 
   3.4930822322631617`*^9}, 3.493082465315469*^9, 3.4930825040714273`*^9, 
   3.493082567382244*^9, 3.4931631774727707`*^9, {3.493163267448599*^9, 
   3.493163289222493*^9}}]
}, Open  ]],

Cell["\<\
Although easy to invent and program, this method is both slow and memory \
consuming. (See Exercise 5.)\
\>", "Text",
 CellChangeTimes->{{3.4930829425620813`*^9, 3.493082990347268*^9}, {
  3.493322554888039*^9, 3.4933225775248957`*^9}, {3.495417822118259*^9, 
  3.495417824162808*^9}}],

Cell[TextData[{
 "We can make another implementation, which is more in the spirit of the \
implementations of ",
 StyleBox["MolecularMass", "Program"],
 " and ",
 StyleBox["MoleculeToString", "Program"],
 ". i.e. give definition of ",
 StyleBox["MoleculeToAtoms", "Program"],
 " for each type of sub-expressionin our data structure."
}], "Text",
 CellChangeTimes->{{3.493082595108244*^9, 3.493082671226235*^9}, {
   3.493166175907625*^9, 3.493166222673903*^9}, {3.493166255191956*^9, 
   3.493166267801364*^9}, {3.493323268425579*^9, 3.49332330158844*^9}, 
   3.493323796335343*^9}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "MoleculeToAtoms", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MoleculeToAtoms", "[", "element_String", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"element", ",", "1"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MoleculeToAtoms", "[", "r_Replicated", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "*", 
        RowBox[{
        "r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
      "}"}], "&"}], "/@", 
    RowBox[{"MoleculeToAtoms", "[", 
     RowBox[{"r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MoleculeToAtoms", "[", "m_Molecule", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Sort", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"Total", "[", 
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], "}"}],
      "&"}], "/@", 
    RowBox[{"GatherBy", "[", 
     RowBox[{
      RowBox[{"Join", "@@", 
       RowBox[{"Map", "[", 
        RowBox[{"MoleculeToAtoms", ",", "m"}], "]"}]}], ",", "First"}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.492821036708927*^9, 3.492821042820332*^9}, {
   3.4928210977031097`*^9, 3.492821151741076*^9}, {3.492821728713213*^9, 
   3.492821743628758*^9}, {3.492842261106804*^9, 3.492842262640554*^9}, 
   3.492898163893837*^9, {3.493081689897368*^9, 3.493081914600791*^9}, {
   3.493081949769868*^9, 3.493081952916815*^9}, {3.493082132988407*^9, 
   3.493082133747531*^9}, {3.493082170502461*^9, 3.493082223239915*^9}, {
   3.49308228005905*^9, 3.493082282703659*^9}, {3.493082320622349*^9, 
   3.493082323880834*^9}, {3.4930823904216213`*^9, 3.493082399088491*^9}, {
   3.493082450175416*^9, 3.493082461440679*^9}, {3.4930824997511463`*^9, 
   3.493082500417247*^9}, {3.493082545312587*^9, 3.49308254923475*^9}, {
   3.493082592946557*^9, 3.49308259389509*^9}, {3.493082813348784*^9, 
   3.4930828167100677`*^9}, {3.4931635386329412`*^9, 3.493163539128929*^9}, {
   3.493322520934723*^9, 3.493322523013431*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MoleculeToAtoms", "[", 
  RowBox[{"Molecule", "[", 
   RowBox[{
    RowBox[{"Replicated", "[", 
     RowBox[{
      RowBox[{"Molecule", "[", 
       RowBox[{"\"\<C\>\"", ",", 
        RowBox[{"Replicated", "[", 
         RowBox[{"\"\<H\>\"", ",", "3"}], "]"}]}], "]"}], ",", "2"}], "]"}], 
    ",", "\"\<C\>\"", ",", "\"\<O\>\""}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.492816165660445*^9, 3.492816176012145*^9}, {
   3.492816226070232*^9, 3.492816256491312*^9}, {3.492816302323255*^9, 
   3.492816302969108*^9}, {3.4928167146200857`*^9, 3.4928167222658663`*^9}, 
   3.492898164855249*^9, {3.492904684275525*^9, 3.492904684756996*^9}, 
   3.493082228821054*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"C\"\>", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"H\"\>", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"O\"\>", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.493082250927937*^9, 3.4930822847274427`*^9, 3.4930824210631447`*^9, 
   3.493082467495542*^9, {3.4930825635718403`*^9, 3.493082570150731*^9}, 
   3.495417790085894*^9}]
}, Open  ]],

Cell["\<\
We can say that it was easy to program these \
functiona\[AliasDelimiter]lities, and conclude that the data structure chosen \
is adequate. The recursive calls each of these functions can be derived from \
the grammar described in the section \"Backus-Naur Form.\"\
\>", "Text",
 CellChangeTimes->{{3.4928219793616743`*^9, 3.492822006863412*^9}, {
   3.492840705020054*^9, 3.492840706244388*^9}, {3.493079079179983*^9, 
   3.493079103985793*^9}, {3.49307914822577*^9, 3.493079187211411*^9}, {
   3.49307922617729*^9, 3.49307927353936*^9}, {3.493079330250677*^9, 
   3.493079341162106*^9}, {3.493079451171527*^9, 3.493079509626115*^9}, 
   3.493079601532201*^9, {3.493079736172176*^9, 3.493079743091572*^9}, {
   3.493080164348117*^9, 3.493080173705761*^9}, {3.493323315027774*^9, 
   3.493323369953936*^9}, {3.493323411145406*^9, 3.4933235061258097`*^9}, {
   3.49332356068121*^9, 3.493323561637578*^9}, {3.690037762546324*^9, 
   3.6900377793999567`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data structures representing equations", "Section",
 CellChangeTimes->{{3.495144936271866*^9, 3.495144952838846*^9}}],

Cell[TextData[{
 "From the production rule for ",
 StyleBox["<mixture>", "Program"],
 " we can use the structure ",
 StyleBox["Mixture[_Molecule...]", "Program"],
 " to represent LHS and RHS of an equation. From the production rule for ",
 StyleBox["<equation>", "Program"],
 " we can use the structure ",
 StyleBox["Equation[_Mixture,_Mixture]", "Program"],
 " to represent chemical equations."
}], "Text",
 CellChangeTimes->{{3.4951449580062227`*^9, 3.4951449928389482`*^9}, {
  3.495146364211671*^9, 3.495146365535349*^9}, {3.495146469782209*^9, 
  3.495146611622693*^9}, {3.495146789487211*^9, 3.49514681373486*^9}}],

Cell["\<\
For example, consider the unbalanced equation NO2 \[Rule] N2O4. It is \
represented with the proposed structures as:\
\>", "Text",
 CellChangeTimes->{{3.495146810206725*^9, 3.495146880502763*^9}, {
  3.495147029584947*^9, 3.495147050695127*^9}, {3.495147362491724*^9, 
  3.495147363863741*^9}}],

Cell[BoxData[
 RowBox[{"Equation", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Mixture", "[", 
    RowBox[{"Molecule", "[", 
     RowBox[{"\"\<N\>\"", ",", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\"\<O\>\"", ",", "2"}], "]"}]}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Mixture", "[", 
    RowBox[{"Molecule", "[", 
     RowBox[{
      RowBox[{"Replicated", "[", 
       RowBox[{"\"\<N\>\"", ",", "2"}], "]"}], ",", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\"\<O\>\"", ",", "4"}], "]"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.495145161783765*^9, {3.495145205265926*^9, 3.495145206855638*^9}, {
   3.495145300936228*^9, 3.495145315153791*^9}, {3.495146368819758*^9, 
   3.495146372211644*^9}, {3.495146895043799*^9, 3.4951469371337147`*^9}}],

Cell[TextData[{
 "We can easily do various operations on that structure. Let us apply ",
 StyleBox["MolecularMass", "Program"],
 " (defined above) to it:"
}], "Text",
 CellChangeTimes->{{3.49514711622007*^9, 3.4951471630387163`*^9}, {
  3.4951472241499643`*^9, 3.495147235102968*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Equation", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mixture", "[", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\"\<N\>\"", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\"\<O\>\"", ",", "2"}], "]"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Mixture", "[", 
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\"\<N\>\"", ",", "2"}], "]"}], ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\"\<O\>\"", ",", "4"}], "]"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"m_Molecule", "\[RuleDelayed]", 
    RowBox[{"MolecularMass", "[", "m", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.4951469165122433`*^9, 3.495147004490004*^9}, {
  3.495147076458497*^9, 3.495147105180348*^9}, {3.4951471819337463`*^9, 
  3.495147204093205*^9}}],

Cell[BoxData[
 RowBox[{"Equation", "[", 
  RowBox[{
   RowBox[{"Mixture", "[", "46.0055`6.", "]"}], ",", 
   RowBox[{"Mixture", "[", "92.011`6.", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.495146955272957*^9, 3.495147006755031*^9}, {
   3.495147077381874*^9, 3.495147105650717*^9}, 3.4951472053208437`*^9}]
}, Open  ]],

Cell["\<\
[[ May here we should have some rudimentary balancing example ]]\
\>", "Text",
 CellChangeTimes->{{3.495147251302866*^9, 3.495147269871163*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finite State Machines", "Section",
 CellChangeTimes->{{3.4888937632707767`*^9, 3.488893774669849*^9}}],

Cell["\<\
The concept of finite state machine can be used to explain and understand the \
work of many concrete or theoretical devices encountered in real life and \
sciences. A typical example of a finite state machine is a vending machine. \
\>", "Text",
 CellChangeTimes->{
  3.493341059227722*^9, {3.493341098757512*^9, 3.493341099205543*^9}, {
   3.4933411352788477`*^9, 3.493341138412854*^9}, {3.4933412723400297`*^9, 
   3.493341276741591*^9}, {3.493341961360071*^9, 3.493342082527565*^9}}],

Cell["\<\
A vending machine at its initial state waits for one of two types of events \
to happen: (1) money deposit, or (2) correct dial pad code entry. If an event \
of type (1) happens the vending machine waits for an event of type (2) to \
happen. Similarly, if an event of type (2) happens the vending machine waits \
for an event of type (1) to happen. After an event of each type has happened, \
the vending machine checks is the amount of money deposited is enough to \
purchase an item corresponding to the code dialed. If yes, the machine checks \
does it have an item in stock. If yes, the machine would dispense an item. If \
the amount of the money deposited is larger than the amount of money required \
the vending machine would return change. \
\>", "Text",
 CellChangeTimes->{
  3.493341059227722*^9, {3.493341098757512*^9, 3.493341099205543*^9}, {
   3.4933411352788477`*^9, 3.493341138412854*^9}, {3.4933412723400297`*^9, 
   3.493341276741591*^9}, {3.493341961360071*^9, 3.493342086760556*^9}, {
   3.493362087772241*^9, 3.493362095781055*^9}, 3.493362176996125*^9, 
   3.4933622661553307`*^9, {3.495250726758205*^9, 3.4952507487526903`*^9}}],

Cell["\<\
As we can see from this description the vending machine passes through \
various stages of event awaiting. The reaction to an event would change the \
vending machine state. For example, after dispensing an item, more money will \
be in the vending machine bank, and the vending machine will have one less \
item corresponding to the code dialed -- that is a state different from the \
state before dispensing the item. The vending machine has also intermediate \
states, like counting the deposited money, and buttons pressed.\
\>", "Text",
 CellChangeTimes->{
  3.493341059227722*^9, {3.493341098757512*^9, 3.493341099205543*^9}, {
   3.4933411352788477`*^9, 3.493341138412854*^9}, {3.4933412723400297`*^9, 
   3.493341276741591*^9}, {3.493341961360071*^9, 3.493342301420936*^9}, {
   3.493358584532536*^9, 3.4933586177522306`*^9}, {3.493358649105995*^9, 
   3.4933586496615143`*^9}, {3.493358683791716*^9, 3.493358685069426*^9}, {
   3.4952508069177427`*^9, 3.495250843149097*^9}, 3.690037785315867*^9}],

Cell[TextData[{
 "Finite state machines have states, rules ",
 StyleBox["{_State, _Input}\[Rule]_State", "Program"],
 " how to switch from state to state, and actions, which depending on the \
machine, are associated with the rules or the states."
}], "Text",
 CellChangeTimes->{{3.495302148579995*^9, 3.495302282772266*^9}, {
  3.4953023797904463`*^9, 3.4953024205249157`*^9}, {3.495302500133689*^9, 
  3.4953025025473022`*^9}}],

Cell["\<\
Let us introduce a type of diagrams called finite state machine diagrams\
\>", "Text",
 CellChangeTimes->{{3.4953021006335573`*^9, 3.495302132162862*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsGroupBox[{GraphicsComplexBox[CompressedData["
1:eJx1k21Mk1cYhl/eVvmaHzNglxLj1GAdhTBLhSqZz1EIGxohwaUCAzLsnPwA
8YM4IKidAzcWhSbIMhUJqBE/Akwy11mZDyQgyOagqKVKNIDFFoRStFAptp3z
HH/ww5OcnJyc8z7nue/7elfszE3axXMcF/9m/r++Z5C562LynvOW0jB7prGy
E8anl5xNXHQfpfViyYmef2EkUNh0p+URftswsrN7rAfM3xlOhrgGUD2q6v2y
rQeU+T8HWOpNOOPe4xwavAvF05zu6CYLNha1dQ8EdkC1yVip+uk5FgaL/SRu
HfBLt9fYlFbUyFtDJPpSeDkcsM8SY8O2Kd8qf5MWlanmJqvbhkPx0fK/C7pw
/71dZb1Jk/jjhnU5B6ruY53wdUdU9CQ2n5De1lzvx7WSqLzkGzZ0rz51cThg
EO07EuJH6ibw022NibX6p+h3RRc6GTaOoenKovKxYQwZ3yJuDh7FGzXnFfXx
Zlz/xy35Oe0zPD92M/KBwYzSTY+zPv/wKfbWtJNrx80YeLf+i/zbTzB1d7gx
KPcZiv+J22Jt7sPkxOSJseMm1LZzExUqPR5Z2L9b7hlE2ZTB1bGsEx81OGUP
ux9jnFx/85R/C25sN+RkDxhQkT3s4F9dx1i2X0P3YGT3I+l9ULN6K2k9SGHv
NdD3IJ31E0D7AQPrdxHtF+qYntVUD9xieuVUL6xlfgRTPyCK+TWf+gUCCfXT
Rv2ETuZ3OPUbNCyPizQPcLG89tK8wDY3T/hNRvO207whYS4PUMt4qaK8gJnx
VEJ5goOMtxTKG2QwHi2UR1jFeLVSXuF7xrOV8gyzdWfKzvR74PKOtLA3/wzh
SzSRFdtd0LpM+mtfBEdsQUPje/lZ0Pao5aEtHLEKUsM7RTNQIEncP++0FynW
bI626xwQqKh2jTTyxH7Uf3LC2wEp6V+XlT8XEN+rfrGiBQ5IUw+evRAxjygu
fZTJdTngB1HYVmPOfNLVWiktDp+BzK9Mumm1N4nVl6qmPp6FTx5knbYqfYgw
7fcjOQddIOttivnliQ9xet4OOHbNs+aDBb7EqQ8md2K9SAQ7TxFFJ5Tk8iSE
fb90+brRz7IERMXqD1w90O0RC8kx9n7+FWd6XoGQZLD+ijcWevsUCUka679Z
mzFUslJIREyftzvJEpQnIIVMv8+LhaUdh3nyJ/Pn0F/abyKVXuSdf3xok0K2
hCPv/P0PTDlGeQ==
      "], 
      {RGBColor[0.5, 0., 0.], Arrowheads[{{0.02554714064914992, 0.7}}], 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"correct code\"", Larger, Bold, StripOnInput -> False], 
                 StripOnInput -> False], TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{1, 2}]}, {
        {Arrowheads[{{0.5, 0.5, 
            GraphicsBox[{
              GrayLevel[0], 
              InsetBox[
               BoxData[
                FormBox[
                 StyleBox[
                  StyleBox[
                  "\"no code\"", Larger, Bold, StripOnInput -> False], 
                  StripOnInput -> False], TraditionalForm]], {0, 0}, 
               ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
               GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
         ArrowBox[{1, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 
          20, 21, 22, 23, 24, 25, 26, 27, 1}]}, 
        {Arrowheads[{{0.5, 0.5, 
            GraphicsBox[{
              GrayLevel[0], 
              InsetBox[
               BoxData[
                FormBox[
                 StyleBox[
                  StyleBox[
                  "\"incorrect code\"", Larger, Bold, StripOnInput -> False], 
                  StripOnInput -> False], TraditionalForm]], {0, 0}, 
               ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
               GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
         ArrowBox[{1, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 
          42, 43, 44, 45, 46, 47, 48, 49, 50, 1}]}}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"money is\\nnot enough\"", Larger, Bold, StripOnInput -> 
                  False], StripOnInput -> False], TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{2, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 
         65, 66, 67, 68, 69, 70, 71, 72, 73, 2}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"money is\\nenough\"", Larger, Bold, StripOnInput -> 
                  False], StripOnInput -> False], TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{2, 3}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"finished\\ndispensing\"", Larger, Bold, StripOnInput -> 
                  False], StripOnInput -> False], TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{3, 4}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"change\\nreturned\"", Larger, Bold, StripOnInput -> 
                  False], StripOnInput -> False], TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{4, 1}]}}], {
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[0.85]], 
       DiskBox[{0., 0.}, 0.55], InsetBox[
        StyleBox["\<\"Idle\"\>",
         StripOnInput->False,
         FontFamily->"Helvetica",
         FontSize->12,
         FontWeight->Bold], {0., 0.}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
       DiskBox[{2., 2.}, 0.55], InsetBox[
        StyleBox["\<\"Money\\ncollecting\"\>",
         StripOnInput->False,
         FontFamily->"Helvetica",
         FontSize->12,
         FontWeight->Bold], {2., 2.}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
       DiskBox[{4., 0.}, 0.55], InsetBox[
        StyleBox["\<\"Dispensing\"\>",
         StripOnInput->False,
         FontFamily->"Helvetica",
         FontSize->12,
         FontWeight->Bold], {4., 0.}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
       DiskBox[{2., -2.}, 0.55], InsetBox[
        StyleBox["\<\"Balancing\"\>",
         StripOnInput->False,
         FontFamily->"Helvetica",
         FontSize->12,
         FontWeight->Bold], {2., -2.}]}}},
    ContentSelectable->True],
   Annotation[#, 
    VertexCoordinateRules -> {{0., 0.}, {2., 2.}, {4., 0.}, {2., -2.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{451.7333333333335, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.495254890017303*^9, 3.4952549036540937`*^9}, {
   3.495254938007719*^9, 3.495255021818315*^9}, {3.495255093860403*^9, 
   3.49525511198317*^9}, {3.495255151293455*^9, 3.49525515546062*^9}, 
   3.495255198742526*^9, 3.4952552342424717`*^9, {3.49525530243725*^9, 
   3.495255309945485*^9}, 3.495255398654614*^9, 3.495255435510067*^9}],

Cell["When parsing a chemical formula we ", "Text",
 CellChangeTimes->{{3.495252763519302*^9, 3.495252784659609*^9}, {
  3.690037789906199*^9, 3.690037792843799*^9}}],

Cell["state digit accumulation", "Text",
 CellChangeTimes->{{3.493363181591264*^9, 3.493363182399727*^9}}],

Cell["element accumulation", "Text",
 CellChangeTimes->{{3.4933631834372387`*^9, 3.4933631917412157`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Code",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.488987004581583*^9, 3.4889870099437227`*^9}}],

Cell[BoxData[
 RowBox[{"NewCoords", "[", 
  RowBox[{"state_", ",", "coords_", ",", "value_"}], "]"}]], "Input",
 CellChangeTimes->{{3.4889739813662643`*^9, 3.488974012678742*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cockroach", "[", "stateChangingRules_", "]"}], "[", 
     RowBox[{"state_", ",", "coords_", ",", "value_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newstate", ",", "newvalue", ",", "newcoords"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newstate", ",", "newcoords", ",", "newvalue"}], "}"}], "=", 
        
        RowBox[{
         RowBox[{"{", 
          RowBox[{"state", ",", "coords", ",", "value"}], "}"}], "/.", 
         "stateChangingRules"}]}], ";"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.488973701062635*^9, 3.4889739202452*^9}, {
   3.488974036067154*^9, 3.488974051251131*^9}, 3.488974112098085*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FL", "[", 
    RowBox[{"cells_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nn", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "cells"}], ",", 
          RowBox[{
           RowBox[{"#", ">", "0"}], "&"}]}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"nn", ">", "4"}], ",", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"cells", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ">", "0"}], "&&", 
        RowBox[{"nn", "<", "3"}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"nn", "\[Equal]", "3"}], "&&", 
        RowBox[{
         RowBox[{"cells", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "\[Equal]", 
         "0"}]}], ",", "2", ",", 
       RowBox[{
        RowBox[{"cells", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ">", "1"}], ",", 
       "1", ",", "True", ",", 
       RowBox[{"cells", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrayPlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ImageSize", "->", "40"}], ",", 
     RowBox[{"Mesh", "->", "True"}]}], "]"}], "&"}], "/@", 
  RowBox[{"CellularAutomaton", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"FL", ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", "0"}], "}"}],
     ",", "10"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.488974266501027*^9, 3.488974275089571*^9}, {
  3.488974807797165*^9, 3.488974807841151*^9}, {3.488975003416768*^9, 
  3.4889750084638767`*^9}, {3.488975845369266*^9, 3.4889759833141747`*^9}, {
  3.48897612179919*^9, 3.488976306952166*^9}, {3.488976764709681*^9, 
  3.488976790195574*^9}, {3.488976951126986*^9, 3.488976952091915*^9}, {
  3.488987104529442*^9, 3.4889871767453337`*^9}, {3.488987246649844*^9, 
  3.488987250713048*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{
     RasterBox[{{2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}, {0, 0, 0, 
      2, 2}, {2, 2, 0, 2, 2}, {2, 0, 2, 2, 2}}, {{0, 0}, {5, 6}}, {0, 2}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 6}, {5, 6}}, {{0, 5}, {5, 5}}, {{0, 4}, {5, 4}}, {{0, 
         3}, {5, 3}}, {{0, 2}, {5, 2}}, {{0, 1}, {5, 1}}, {{0, 0}, {5, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 6}}, {{1, 0}, {1, 6}}, {{2, 0}, {2, 6}}, {{3, 
         0}, {3, 6}}, {{4, 0}, {4, 6}}, {{5, 0}, {5, 6}}}],
        Antialiasing->False]}}},
    Frame->False,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    ImageSize->40], ",", 
   GraphicsBox[{
     RasterBox[{{2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}, {2, 0, 2, 2, 2}, {2, 1, 1, 
      2, 2}, {0, 2, 1, 2, 2}, {2, 2, 2, 2, 2}}, {{0, 0}, {5, 6}}, {0, 2}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 6}, {5, 6}}, {{0, 5}, {5, 5}}, {{0, 4}, {5, 4}}, {{0, 
         3}, {5, 3}}, {{0, 2}, {5, 2}}, {{0, 1}, {5, 1}}, {{0, 0}, {5, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 6}}, {{1, 0}, {1, 6}}, {{2, 0}, {2, 6}}, {{3, 
         0}, {3, 6}}, {{4, 0}, {4, 6}}, {{5, 0}, {5, 6}}}],
        Antialiasing->False]}}},
    Frame->False,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    ImageSize->40], ",", 
   GraphicsBox[{
     RasterBox[{{2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}, {2, 1, 0, 2, 2}, {0, 2, 1, 
      2, 2}, {2, 2, 1, 2, 2}, {2, 2, 2, 2, 2}}, {{0, 0}, {5, 6}}, {0, 2}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 6}, {5, 6}}, {{0, 5}, {5, 5}}, {{0, 4}, {5, 4}}, {{0, 
         3}, {5, 3}}, {{0, 2}, {5, 2}}, {{0, 1}, {5, 1}}, {{0, 0}, {5, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 6}}, {{1, 0}, {1, 6}}, {{2, 0}, {2, 6}}, {{3, 
         0}, {3, 6}}, {{4, 0}, {4, 6}}, {{5, 0}, {5, 6}}}],
        Antialiasing->False]}}},
    Frame->False,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    ImageSize->40], ",", 
   GraphicsBox[{
     RasterBox[{{2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}, {2, 1, 1, 2, 2}, {2, 2, 1, 
      0, 2}, {2, 0, 2, 2, 2}, {2, 2, 2, 2, 2}}, {{0, 0}, {5, 6}}, {0, 2}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 6}, {5, 6}}, {{0, 5}, {5, 5}}, {{0, 4}, {5, 4}}, {{0, 
         3}, {5, 3}}, {{0, 2}, {5, 2}}, {{0, 1}, {5, 1}}, {{0, 0}, {5, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 6}}, {{1, 0}, {1, 6}}, {{2, 0}, {2, 6}}, {{3, 
         0}, {3, 6}}, {{4, 0}, {4, 6}}, {{5, 0}, {5, 6}}}],
        Antialiasing->False]}}},
    Frame->False,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    ImageSize->40], ",", 
   GraphicsBox[{
     RasterBox[{{2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}, {2, 1, 1, 0, 2}, {2, 2, 2, 
      1, 2}, {2, 2, 0, 2, 2}, {2, 2, 2, 2, 2}}, {{0, 0}, {5, 6}}, {0, 2}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 6}, {5, 6}}, {{0, 5}, {5, 5}}, {{0, 4}, {5, 4}}, {{0, 
         3}, {5, 3}}, {{0, 2}, {5, 2}}, {{0, 1}, {5, 1}}, {{0, 0}, {5, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 6}}, {{1, 0}, {1, 6}}, {{2, 0}, {2, 6}}, {{3, 
         0}, {3, 6}}, {{4, 0}, {4, 6}}, {{5, 0}, {5, 6}}}],
        Antialiasing->False]}}},
    Frame->False,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    ImageSize->40], ",", 
   GraphicsBox[{
     RasterBox[{{2, 2, 2, 2, 2}, {2, 2, 0, 2, 2}, {2, 2, 1, 1, 2}, {2, 0, 2, 
      1, 2}, {2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}}, {{0, 0}, {5, 6}}, {0, 2}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 6}, {5, 6}}, {{0, 5}, {5, 5}}, {{0, 4}, {5, 4}}, {{0, 
         3}, {5, 3}}, {{0, 2}, {5, 2}}, {{0, 1}, {5, 1}}, {{0, 0}, {5, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 6}}, {{1, 0}, {1, 6}}, {{2, 0}, {2, 6}}, {{3, 
         0}, {3, 6}}, {{4, 0}, {4, 6}}, {{5, 0}, {5, 6}}}],
        Antialiasing->False]}}},
    Frame->False,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    ImageSize->40], ",", 
   GraphicsBox[{
     RasterBox[{{2, 2, 2, 2, 2}, {2, 2, 1, 0, 2}, {2, 0, 2, 1, 2}, {2, 2, 2, 
      1, 2}, {2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}}, {{0, 0}, {5, 6}}, {0, 2}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 6}, {5, 6}}, {{0, 5}, {5, 5}}, {{0, 4}, {5, 4}}, {{0, 
         3}, {5, 3}}, {{0, 2}, {5, 2}}, {{0, 1}, {5, 1}}, {{0, 0}, {5, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 6}}, {{1, 0}, {1, 6}}, {{2, 0}, {2, 6}}, {{3, 
         0}, {3, 6}}, {{4, 0}, {4, 6}}, {{5, 0}, {5, 6}}}],
        Antialiasing->False]}}},
    Frame->False,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    ImageSize->40], ",", 
   GraphicsBox[{
     RasterBox[{{2, 2, 2, 2, 2}, {2, 2, 1, 1, 2}, {2, 2, 2, 1, 0}, {2, 2, 0, 
      2, 2}, {2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}}, {{0, 0}, {5, 6}}, {0, 2}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 6}, {5, 6}}, {{0, 5}, {5, 5}}, {{0, 4}, {5, 4}}, {{0, 
         3}, {5, 3}}, {{0, 2}, {5, 2}}, {{0, 1}, {5, 1}}, {{0, 0}, {5, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 6}}, {{1, 0}, {1, 6}}, {{2, 0}, {2, 6}}, {{3, 
         0}, {3, 6}}, {{4, 0}, {4, 6}}, {{5, 0}, {5, 6}}}],
        Antialiasing->False]}}},
    Frame->False,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    ImageSize->40], ",", 
   GraphicsBox[{
     RasterBox[{{2, 2, 2, 2, 2}, {2, 2, 1, 1, 0}, {2, 2, 2, 2, 1}, {2, 2, 2, 
      0, 2}, {2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}}, {{0, 0}, {5, 6}}, {0, 2}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 6}, {5, 6}}, {{0, 5}, {5, 5}}, {{0, 4}, {5, 4}}, {{0, 
         3}, {5, 3}}, {{0, 2}, {5, 2}}, {{0, 1}, {5, 1}}, {{0, 0}, {5, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 6}}, {{1, 0}, {1, 6}}, {{2, 0}, {2, 6}}, {{3, 
         0}, {3, 6}}, {{4, 0}, {4, 6}}, {{5, 0}, {5, 6}}}],
        Antialiasing->False]}}},
    Frame->False,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    ImageSize->40], ",", 
   GraphicsBox[{
     RasterBox[{{2, 2, 2, 0, 2}, {2, 2, 2, 1, 1}, {2, 2, 0, 2, 1}, {2, 2, 2, 
      2, 2}, {2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}}, {{0, 0}, {5, 6}}, {0, 2}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 6}, {5, 6}}, {{0, 5}, {5, 5}}, {{0, 4}, {5, 4}}, {{0, 
         3}, {5, 3}}, {{0, 2}, {5, 2}}, {{0, 1}, {5, 1}}, {{0, 0}, {5, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 6}}, {{1, 0}, {1, 6}}, {{2, 0}, {2, 6}}, {{3, 
         0}, {3, 6}}, {{4, 0}, {4, 6}}, {{5, 0}, {5, 6}}}],
        Antialiasing->False]}}},
    Frame->False,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    ImageSize->40], ",", 
   GraphicsBox[{
     RasterBox[{{2, 2, 2, 1, 0}, {2, 2, 0, 2, 1}, {2, 2, 2, 2, 1}, {2, 2, 2, 
      2, 2}, {2, 2, 2, 2, 2}, {2, 2, 2, 2, 2}}, {{0, 0}, {5, 6}}, {0, 2}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 6}, {5, 6}}, {{0, 5}, {5, 5}}, {{0, 4}, {5, 4}}, {{0, 
         3}, {5, 3}}, {{0, 2}, {5, 2}}, {{0, 1}, {5, 1}}, {{0, 0}, {5, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 6}}, {{1, 0}, {1, 6}}, {{2, 0}, {2, 6}}, {{3, 
         0}, {3, 6}}, {{4, 0}, {4, 6}}, {{5, 0}, {5, 6}}}],
        Antialiasing->False]}}},
    Frame->False,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    ImageSize->40]}], "}"}]], "Output",
 CellChangeTimes->{{3.488976129863275*^9, 3.488976170175383*^9}, 
   3.488976205201672*^9, {3.488976249195919*^9, 3.488976307846298*^9}, 
   3.488976547162177*^9, 3.488976794769162*^9, {3.4889769480645638`*^9, 
   3.488976952784671*^9}, 3.488987124225878*^9, {3.488987161527534*^9, 
   3.488987177625383*^9}, 3.4889872484756308`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "FL", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FL", "[", 
    RowBox[{"cells_", ",", "s_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"cells", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "!=", "2"}], ",", 
       RowBox[{"cells", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "ELSE", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"cells", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "=", "1"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrayPlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ImageSize", "->", "40"}], ",", 
     RowBox[{"Mesh", "->", "True"}]}], "]"}], "&"}], "/@", 
  RowBox[{"CellularAutomaton", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"FL", ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", "0"}], "}"}],
     ",", "10"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.488974266501027*^9, 3.488974275089571*^9}, {
  3.488974807797165*^9, 3.488974807841151*^9}, {3.488975003416768*^9, 
  3.4889750084638767`*^9}, {3.488975845369266*^9, 3.4889759833141747`*^9}, {
  3.48897612179919*^9, 3.488976306952166*^9}, {3.488976764709681*^9, 
  3.488976790195574*^9}, {3.488976951126986*^9, 3.488976968259161*^9}, {
  3.4889770047257*^9, 3.488977035289949*^9}, {3.488977065794179*^9, 
  3.488977072644375*^9}, {3.488977126122373*^9, 3.488977184699769*^9}, {
  3.4889772962366943`*^9, 3.488977296677329*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parser of chemical formulas (first)", "Section",
 CellChangeTimes->{{3.488071338108965*^9, 3.48807136599387*^9}, {
  3.492643429821102*^9, 3.4926434454140797`*^9}, {3.4944455180344963`*^9, 
  3.4944455203037243`*^9}}],

Cell[CellGroupData[{

Cell["The basic idea", "Subsection",
 CellChangeTimes->{{3.49479114906076*^9, 3.4947911516436234`*^9}}],

Cell["[[ copied below ]]", "Text",
 CellChangeTimes->{{3.494791156800519*^9, 3.494791166987648*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extracting element name abbreviations", "Subsection",
 CellChangeTimes->{{3.49394102225729*^9, 3.4939410442177362`*^9}}],

Cell["[[ copied below ]]", "Text",
 CellChangeTimes->{{3.4947911697307587`*^9, 3.494791178258995*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extracting numbers", "Subsection",
 CellChangeTimes->{{3.493942748871745*^9, 3.4939427586369963`*^9}}],

Cell["This is straightforward. For example,", "Text",
 CellChangeTimes->{{3.493942764194717*^9, 3.49394277263698*^9}, {
  3.493942829509097*^9, 3.4939428342769747`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringCases", "[", 
  RowBox[{"\"\<12H10CrO5\>\"", ",", " ", 
   RowBox[{"RegularExpression", "[", "\"\<^\\\\d+\>\"", "]"}], ",", " ", 
   "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.4939428239049177`*^9, 3.493942848032072*^9}}],

Cell[BoxData[
 RowBox[{"{", "\<\"12\"\>", "}"}]], "Output",
 CellChangeTimes->{3.493942848617467*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["The parser as a finite state machine", "Subsection",
 CellChangeTimes->{{3.494023488260393*^9, 3.49402351680273*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"stateTable", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<INIT\>\"", ",", "\"\<\>\"", ",", "\"\<WORD READ\>\"", ",", 
       "\"\<tree=Molecule[]\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<WORD READ\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is a \
letter\>\"", ",", "\"\<WORD READ\>\"", ",", 
       "\"\<Accumulate letters to word, formula=Rest[formula]\>\""}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<WORD READ\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is not a letter\
\>\"", ",", "\"\<ELEMENTS\>\"", ",", "\"\<\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ELEMENTS\>\"", ",", "\"\<word is comprised of elements\>\"", ",", 
       "\"\<POST-ELEMENTS\>\"", ",", "\"\<Append elements to tree\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ELEMENTS\>\"", ",", "\"\<word has non-element sub-string\>\"", 
       ",", "\"\<ERROREXIT\>\"", ",", "\"\<Message: wrong element(s).\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<POST-ELEMENTS\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is a digit\>\"",
        ",", "\"\<NUMBER READ\>\"", ",", "\"\<\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<POST-ELEMENTS\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is '_'\>\"", 
       ",", "\"\<NUMBER READ\>\"", ",", "\"\<formula=Rest[formula]\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<POST-ELEMENTS\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is '('\>\"", 
       ",", "\"\<SUB-FORMULA-READ\>\"", ",", 
       "\"\<formula=Rest[formula];level++\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<POST-ELEMENTS\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is ')'\>\"", 
       ",", "\"\<EXIT\>\"", ",", 
       "\"\<formula=Rest[formula]; Return[{tree,formula}]\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<NUMBER READ\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is a digit\>\"",
        ",", "\"\<NUMBER READ\>\"", ",", 
       "\"\<Accumulate digits to num, formula=Rest[formula]\>\""}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<NUMBER READ\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is not a \
digit\>\"", ",", "\"\<REPLICATION\>\"", ",", "\"\<\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<REPLICATION\>\"", ",", "\"\<Length[tree]==0\>\"", ",", 
       "\"\<ERROREXIT\>\"", ",", 
       "\"\<Message: number without an element.\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<REPLICATION\>\"", ",", "\"\<Length[tree]>0\>\"", ",", 
       "\"\<POST-REPLICATION\>\"", ",", 
       "\"\<tree\[LeftDoubleBracket]-1\[RightDoubleBracket]=Replicated[tree\
\[LeftDoubleBracket]-1\[RightDoubleBracket],num]\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<POST-REPLICATION\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is a \
letter\>\"", ",", "\"\<WORD READ\>\"", ",", "\"\<\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<POST-REPLICATION\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is '('\>\"", 
       ",", "\"\<SUB-FORMULA-READ\>\"", ",", 
       "\"\<formula=Rest[formula];level++\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<POST-REPLICATION\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is '_'\>\"", 
       ",", "\"\<ERROREXIT\>\"", ",", 
       "\"\<Message: '_' is not allowed after a number\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<POST-REPLICATION\>\"", ",", 
       "\"\<formula\[LeftDoubleBracket]1\[RightDoubleBracket] is ')'\>\"", 
       ",", "\"\<EXIT\>\"", ",", 
       "\"\<formula=Rest[formula]; Return[{tree,formula}]\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<SUB-FORMULA-READ\>\"", ",", "\"\<\>\"", ",", "\"\<INIT\>\"", ",", 
       "\"\<oldtree=tree\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<EXIT\>\"", ",", "\"\<level==0\>\"", ",", "\"\<\>\"", ",", 
       "\"\<Return[{tree,formula}]\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{
      "\"\<EXIT\>\"", ",", "\"\<level>0\>\"", ",", "\"\<WORD READ\>\"", ",", 
       "\"\<tree=Append[oldtree,tree];level--\>\""}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\n", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{"stateTable", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"#", ",", "Bold", ",", "Italic"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
       "\"\<state\>\"", ",", "\"\<input\>\"", ",", "\"\<new state\>\"", ",", 
        "\"\<action\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.4940249520821238`*^9, 3.4940250127316437`*^9}, {
   3.49402509713936*^9, 3.494025360905335*^9}, {3.494025491911085*^9, 
   3.4940256648809*^9}, {3.494025708205038*^9, 3.494025745572968*^9}, {
   3.494025787070765*^9, 3.4940259079698057`*^9}, {3.494026021695711*^9, 
   3.49402603893576*^9}, {3.494026175588832*^9, 3.4940262386485023`*^9}, {
   3.4940262918564796`*^9, 3.494026316329446*^9}, {3.494026460191209*^9, 
   3.4940266063590727`*^9}, {3.494026719269937*^9, 3.4940267499242077`*^9}, {
   3.494028011060006*^9, 3.49402828055068*^9}, {3.494028326646344*^9, 
   3.4940289092040987`*^9}, {3.494028952875329*^9, 3.494028975289864*^9}, {
   3.49402901107397*^9, 3.49402918927214*^9}, {3.49402941352636*^9, 
   3.494029419803564*^9}, {3.4940294870881767`*^9, 3.4940295804586277`*^9}, {
   3.494029673942397*^9, 3.494029696375319*^9}, {3.4940297393190737`*^9, 
   3.494029762623962*^9}, {3.494029848950975*^9, 3.494029974789797*^9}, {
   3.4940300449170933`*^9, 3.494030049438653*^9}, {3.49403008008524*^9, 
   3.49403013527147*^9}, {3.494030192739688*^9, 3.4940301930663977`*^9}, 
   3.4945046159867887`*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"state\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"input\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"new state\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"action\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic]},
    {"\<\"INIT\"\>", "\<\"\"\>", "\<\"WORD READ\"\>", \
"\<\"tree=Molecule[]\"\>"},
    {"\<\"WORD READ\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is a letter\"\>", "\<\"WORD READ\"\>", "\<\"Accumulate \
letters to word, formula=Rest[formula]\"\>"},
    {"\<\"WORD READ\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is not a letter\"\>", "\<\"ELEMENTS\"\>", "\<\"\"\>"},
    {"\<\"ELEMENTS\"\>", "\<\"word is comprised of elements\"\>", \
"\<\"POST-ELEMENTS\"\>", "\<\"Append elements to tree\"\>"},
    {"\<\"ELEMENTS\"\>", "\<\"word has non-element sub-string\"\>", \
"\<\"ERROREXIT\"\>", "\<\"Message: wrong element(s).\"\>"},
    {"\<\"POST-ELEMENTS\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is a digit\"\>", "\<\"NUMBER READ\"\>", "\<\"\"\>"},
    {"\<\"POST-ELEMENTS\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is '_'\"\>", "\<\"NUMBER READ\"\>", \
"\<\"formula=Rest[formula]\"\>"},
    {"\<\"POST-ELEMENTS\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is '('\"\>", "\<\"SUB-FORMULA-READ\"\>", \
"\<\"formula=Rest[formula];level++\"\>"},
    {"\<\"POST-ELEMENTS\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is ')'\"\>", "\<\"EXIT\"\>", \
"\<\"formula=Rest[formula]; Return[{tree,formula}]\"\>"},
    {"\<\"NUMBER READ\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is a digit\"\>", "\<\"NUMBER READ\"\>", "\<\"Accumulate \
digits to num, formula=Rest[formula]\"\>"},
    {"\<\"NUMBER READ\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is not a digit\"\>", "\<\"REPLICATION\"\>", \
"\<\"\"\>"},
    {"\<\"REPLICATION\"\>", "\<\"Length[tree]==0\"\>", "\<\"ERROREXIT\"\>", "\
\<\"Message: number without an element.\"\>"},
    {"\<\"REPLICATION\"\>", "\<\"Length[tree]>0\"\>", "\<\"POST-REPLICATION\"\
\>", "\<\"tree\[LeftDoubleBracket]-1\[RightDoubleBracket]=Replicated[tree\
\[LeftDoubleBracket]-1\[RightDoubleBracket],num]\"\>"},
    {"\<\"POST-REPLICATION\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is a letter\"\>", "\<\"WORD READ\"\>", "\<\"\"\>"},
    {"\<\"POST-REPLICATION\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is '('\"\>", "\<\"SUB-FORMULA-READ\"\>", \
"\<\"formula=Rest[formula];level++\"\>"},
    {"\<\"POST-REPLICATION\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is '_'\"\>", "\<\"ERROREXIT\"\>", "\<\"Message: '_' is \
not allowed after a number\"\>"},
    {"\<\"POST-REPLICATION\"\>", "\<\"formula\[LeftDoubleBracket]1\
\[RightDoubleBracket] is ')'\"\>", "\<\"EXIT\"\>", \
"\<\"formula=Rest[formula]; Return[{tree,formula}]\"\>"},
    {"\<\"SUB-FORMULA-READ\"\>", "\<\"\"\>", "\<\"INIT\"\>", \
"\<\"oldtree=tree\"\>"},
    {"\<\"EXIT\"\>", "\<\"level==0\"\>", "\<\"\"\>", \
"\<\"Return[{tree,formula}]\"\>"},
    {"\<\"EXIT\"\>", "\<\"level>0\"\>", "\<\"WORD READ\"\>", \
"\<\"tree=Append[oldtree,tree];level--\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.494026673657255*^9, 3.494026708761199*^9}, {
   3.494028228492557*^9, 3.494028257661371*^9}, 3.494028295411273*^9, {
   3.494028786368392*^9, 3.494028814013967*^9}, 3.4940291913485613`*^9, 
   3.494029453742476*^9, {3.4940297343694057`*^9, 3.494029741143446*^9}, 
   3.494029795013898*^9, 3.494029928362412*^9, 3.494030139010111*^9, 
   3.494030197434888*^9, 3.4945046363287363`*^9}]
}, {2}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"stateTable", "\[LeftDoubleBracket]", 
   RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
  "Union"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.4940704418831387`*^9, 3.494070461527356*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"ELEMENTS\"\>", ",", "\<\"EXIT\"\>", ",", "\<\"INIT\"\>", 
   ",", "\<\"NUMBER READ\"\>", ",", "\<\"POST-ELEMENTS\"\>", 
   ",", "\<\"POST-REPLICATION\"\>", ",", "\<\"REPLICATION\"\>", 
   ",", "\<\"SUB-FORMULA-READ\"\>", ",", "\<\"WORD READ\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.494070455604568*^9, 3.4940704620529423`*^9}, 
   3.494504689287901*^9}],

Cell[BoxData["9"], "Output",
 CellChangeTimes->{{3.494070455604568*^9, 3.4940704620529423`*^9}, 
   3.494504689324997*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["The complete algorithm", "Subsection",
 CellChangeTimes->{{3.49394272548066*^9, 3.4939427337329817`*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{-4., 10.}, {-4., 9.4}}], LineBox[{{-4., 9.4}, {-4., 9.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{-4., 9.}, {-4., 8.4}}], LineBox[{{-4., 8.4}, {-4., 8.}}], 
      {GrayLevel[0], InsetBox["\<\"Yes\"\>", {-4., 8.53},
        Background->GrayLevel[1]]}}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{-4., 9.}, {-2.8, 9.}}], LineBox[{{-2.8, 9.}, {-2., 9.}}], 
      {GrayLevel[0], InsetBox["\<\"No\"\>", {-3.06, 9.},
        Background->GrayLevel[1]]}}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{-4., 8.}, {-5.2, 8.}}], LineBox[{{-5.2, 8.}, {-6., 8.}}], 
      {GrayLevel[0], InsetBox["\<\"No\"\>", {-4.9399999999999995, 8.},
        Background->GrayLevel[1]]}}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{-4., 8.}, {-4., 7.4}}], LineBox[{{-4., 7.4}, {-4., 7.}}], 
      {GrayLevel[0], InsetBox["\<\"Yes\"\>", {-4., 7.53},
        Background->GrayLevel[1]]}}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{-4., 7.}, {-4., 6.4}}], LineBox[{{-4., 6.4}, {-4., 6.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{-4., 6.}, {-2.8, 7.8}}], 
      LineBox[{{-2.8, 7.8}, {-2., 9.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{-2., 9.}, {-2., 8.4}}], LineBox[{{-2., 8.4}, {-2., 8.}}], 
      {GrayLevel[0], InsetBox["\<\"Yes\"\>", {-2., 8.53},
        Background->GrayLevel[1]]}}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{-2., 9.}, {-0.8, 9.}}], LineBox[{{-0.8, 9.}, {0., 9.}}], 
      {GrayLevel[0], InsetBox["\<\"No\"\>", {-1.06, 9.},
        Background->GrayLevel[1]]}}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{-2., 8.}, {-2., 7.4}}], LineBox[{{-2., 7.4}, {-2., 7.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{-2., 7.}, {-0.8, 8.2}}], LineBox[{{-0.8, 8.2}, {0., 9.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], ArrowBox[{{0., 9.}, {0., 8.4}}], 
      LineBox[{{0., 8.4}, {0., 8.}}], 
      {GrayLevel[0], InsetBox["\<\"Yes\"\>", {0., 8.53},
        Background->GrayLevel[1]]}}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], ArrowBox[{{0., 8.}, {0., 7.4}}], 
      LineBox[{{0., 7.4}, {0., 7.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], ArrowBox[{{0., 7.}, {0., 6.4}}], 
      LineBox[{{0., 6.4}, {0., 6.}}]}, 
     {RGBColor[0.6, 0, 0], Arrowheads[0.02], 
      ArrowBox[{{0., 6.}, {-2.4000000000000004`, 7.800000000000001}}], 
      LineBox[{{-2.4000000000000004`, 7.800000000000001}, {-4., 9.}}]}}, {
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-4.936, 9.76}, {-4.6240000000000006`, 10.24}, {-3.064, 
       10.24}, {-3.376, 9.76}}], InsetBox[
       TagBox[GridBox[{
          {
           
           TemplateBox[{
            StyleBox[
             "\"function: \"", StripOnInput -> False, FontFamily -> "Times", 
              FontSize -> 10],StyleBox[
             "\"ParseMolecule\"", StripOnInput -> False, FontFamily -> 
              "Times", FontSize -> 10, FontWeight -> Bold]},
            "Row",
            DisplayFunction->(RowBox[{#, "\[InvisibleSpace]", #2}]& ),
            InterpretationFunction->(RowBox[{"Row", "[", 
               RowBox[{"{", 
                 RowBox[{#, ",", #2}], "}"}], "]"}]& )]},
          {
           
           TemplateBox[{
            StyleBox[
             "\"formula: \"", StripOnInput -> False, FontFamily -> "Times", 
              FontSize -> 10],StyleBox[
             "\"formula string\"", StripOnInput -> False, FontFamily -> 
              "Times", FontSize -> 10, FontWeight -> Bold]},
            "Row",
            DisplayFunction->(RowBox[{#, "\[InvisibleSpace]", #2}]& ),
            InterpretationFunction->(RowBox[{"Row", "[", 
               RowBox[{"{", 
                 RowBox[{#, ",", #2}], "}"}], "]"}]& )]},
          {
           
           TemplateBox[{
            StyleBox[
             "\"level:\"", StripOnInput -> False, FontFamily -> "Times", 
              FontSize -> 10],StyleBox[
             "0", StripOnInput -> False, FontFamily -> "Times", FontSize -> 
              10, FontWeight -> Bold]},
            "Row",
            DisplayFunction->(RowBox[{#, "\[InvisibleSpace]", #2}]& ),
            InterpretationFunction->(RowBox[{"Row", "[", 
               RowBox[{"{", 
                 RowBox[{#, ",", #2}], "}"}], "]"}]& )]}
         },
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Column"], {-4., 10.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{-3.532, 10.24}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"1\"\>",
          StripOnInput->False,
          FontSize->10], {-3.532, 10.24}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-4., 9.18}, {-3.2800000000000002`, 9.}, {-4., 
       8.82}, {-4.72, 9.}}], InsetBox[
       StyleBox["\<\"Can get a word\\nfrom the start?\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {-4., 9.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{-3.64, 9.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"2\"\>",
          StripOnInput->False,
          FontSize->10], {-3.64, 9.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-4., 8.24}, {-3.2199999999999998`, 8.}, {-4., 
       7.76}, {-4.78, 8.}}], InsetBox[
       StyleBox["\<\"Is the word\\ncomprised of\\nelements.\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {-4., 8.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{-3.61, 8.24}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"3\"\>",
          StripOnInput->False,
          FontSize->10], {-3.61, 8.24}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-6.864, 7.82}, {-6.576, 8.18}, {-5.136, 8.18}, {-5.424, 
       7.82}}], InsetBox[
       StyleBox["\<\"Error: contains \\nnon-element sub-string.\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {-6., 8.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{-5.568, 8.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"4\"\>",
          StripOnInput->False,
          FontSize->10], {-5.568, 8.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-4.84, 6.82}, {-4.84, 7.18}, {-3.16, 7.18}, {-3.16, 
       6.82}}], InsetBox[
       StyleBox["\<\"Append each element\\nas a node to the tree.\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {-4., 7.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{-3.58, 7.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"5\"\>",
          StripOnInput->False,
          FontSize->10], {-3.58, 7.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-4.84, 5.82}, {-4.84, 6.18}, {-3.16, 6.18}, {-3.16, 
       5.82}}], InsetBox[
       StyleBox["\<\"Drop the word\\nfrom formula.\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {-4., 6.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{-3.58, 6.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"6\"\>",
          StripOnInput->False,
          FontSize->10], {-3.58, 6.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-2., 9.18}, {-1.28, 9.}, {-2., 
       8.82}, {-2.7199999999999998`, 9.}}], InsetBox[
       StyleBox["\<\"Can get a number\\nfrom the start.\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {-2., 9.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{-1.6400000000000001`, 9.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"7\"\>",
          StripOnInput->False,
          FontSize->10], {-1.6400000000000001, 9.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-2., 8.18}, {-1.28, 8.}, {-2., 
       7.82}, {-2.7199999999999998`, 8.}}], InsetBox[
       StyleBox["\<\"Make replicated node.\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {-2., 8.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{-1.6400000000000001`, 8.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"8\"\>",
          StripOnInput->False,
          FontSize->10], {-1.6400000000000001, 8.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-2.7199999999999998`, 6.82}, {-2.7199999999999998`, 
       7.18}, {-1.28, 7.18}, {-1.28, 6.82}}], InsetBox[
       StyleBox["\<\"Drop the number\\nfrom formula.\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {-2., 7.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{-1.6400000000000001`, 7.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"9\"\>",
          StripOnInput->False,
          FontSize->10], {-1.6400000000000001, 7.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{0., 9.18}, {0.72, 9.}, {0., 8.82}, {-0.72, 9.}}], 
      InsetBox[
       StyleBox["\<\"Is the first symbol '('.\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {0., 9.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{0.36, 9.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"10\"\>",
          StripOnInput->False,
          FontSize->10], {0.36, 9.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-0.72, 7.82}, {-0.72, 8.18}, {0.72, 8.18}, {0.72, 7.82}}], 
      InsetBox[
       StyleBox["\<\"Drop the '('\\nfrom formula.\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {0., 8.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{0.36, 8.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"11\"\>",
          StripOnInput->False,
          FontSize->10], {0.36, 8.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-0.8999999999999999, 6.82}, {-0.8999999999999999, 7.18}, {
       0.8999999999999999, 7.18}, {0.8999999999999999, 6.82}}], InsetBox[
       StyleBox["\<\"Recursive call:\\nParseMolecule[formula, level+1].\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {0., 7.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{0.44999999999999996`, 7.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"12\"\>",
          StripOnInput->False,
          FontSize->10], {0.44999999999999996, 7.18}]}}}, 
     {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
      PolygonBox[{{-0.72, 5.82}, {-0.72, 6.18}, {0.72, 6.18}, {0.72, 5.82}}], 
      InsetBox[
       StyleBox["\<\"Drop ')'\\nfrom formula\"\>",
        StripOnInput->False,
        FontFamily->"Times",
        FontSize->10], {0., 6.}], 
      {RGBColor[0.7, 0.7, 0.7], AbsolutePointSize[12.], 
       PointBox[{{0.36, 6.18}}], 
       {GrayLevel[0], InsetBox[
         StyleBox["\<\"13\"\>",
          StripOnInput->False,
          FontSize->10], {0.36, 6.18}]}}}}},
   Annotation[#, 
    VertexCoordinateRules -> {{-4., 10.}, {-4., 9.}, {-4., 8.}, {-6., 
     8.}, {-4., 7.}, {-4., 6.}, {-2., 9.}, {-2., 8.}, {-2., 7.}, {0., 9.}, {
     0., 8.}, {0., 7.}, {0., 6.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{Automatic, 376.147003262922},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.4937741933706827`*^9, 3.4937742759983*^9, 3.493774457815257*^9, 
   3.493943245574027*^9, 3.493943277611126*^9, 3.49394341081503*^9, {
   3.493943491654169*^9, 3.493943516578298*^9}, 3.4939437294183493`*^9, 
   3.4939437870510187`*^9, 3.4939438495501413`*^9}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parser of chemical formulas", "Section",
 CellChangeTimes->{{3.488071338108965*^9, 3.48807136599387*^9}, {
   3.492643429821102*^9, 3.492643460952256*^9}, 3.4928441269117107`*^9, {
   3.494445532723138*^9, 3.4944455339823523`*^9}}],

Cell[CellGroupData[{

Cell["The basic idea", "Subsection",
 CellChangeTimes->{{3.493941004691113*^9, 3.493941012153062*^9}}],

Cell["\<\
We are going to program the parser in such a way that the lexical analysis is \
combined with the syntactical analysis. Why this is easier to do for the \
problem we are solving would become clear in the exposition below. \
\>", "Text",
 CellChangeTimes->{{3.493853396305399*^9, 3.493853398499432*^9}, {
   3.4938544617367487`*^9, 3.493854468990219*^9}, {3.4939040174273767`*^9, 
   3.49390401788979*^9}, {3.493911260323423*^9, 3.493911299492023*^9}, {
   3.493911389077385*^9, 3.493911445097136*^9}, {3.493911498657545*^9, 
   3.49391153994431*^9}, {3.4947698433983707`*^9, 3.494769865186639*^9}, 
   3.494785226776094*^9}],

Cell["\<\
In order to program the parser let us all look at some examples of formulas \
and their syntactical structures. (I don't think programming can be done just \
considering abstract rules of a specification. One needs to think with \
concrete examples and contra-examples, and consider how they relate to the \
abstract specification. This point should be stated in the preface and/or in \
each chapter.) \
\>", "Text",
 CellChangeTimes->{{3.493853396305399*^9, 3.493853398499432*^9}, {
   3.4938544617367487`*^9, 3.493854468990219*^9}, {3.4939040174273767`*^9, 
   3.49390401788979*^9}, {3.493911260323423*^9, 3.493911299492023*^9}, {
   3.493911389077385*^9, 3.493911445097136*^9}, {3.493911498657545*^9, 
   3.493911501791498*^9}, {3.493911582499731*^9, 3.493911818895852*^9}, 
   3.493914656412516*^9, {3.494791187683281*^9, 3.4947911955154667`*^9}, {
   3.690037797207522*^9, 3.690037812302978*^9}}],

Cell[TextData[{
 "Let us consider molecules like ",
 Cell[BoxData[
  FormBox["CaHIO3", TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox["CBrClF2", TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox["CHBrCl2", TraditionalForm]]],
 ". If we use instead of terminals their corresponding BNF symbols these \
formulas have the same syntactic structure -- see Figure 2.1."
}], "Text",
 CellChangeTimes->{{3.493916696582569*^9, 3.493916712692794*^9}, {
   3.4939168072324038`*^9, 3.493916893292665*^9}, 3.493917035488863*^9, {
   3.493918101593925*^9, 3.493918101727477*^9}, {3.493918763010798*^9, 
   3.4939188272918987`*^9}, {3.493918929174934*^9, 3.49391893868581*^9}, {
   3.494770142309072*^9, 3.4947702048088007`*^9}, {3.494791202479772*^9, 
   3.494791202955372*^9}}],

Cell[TextData[{
 "Figure 2.1 Tree representation of the syntactic structure of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["CaHIO", "3"], TraditionalForm]]],
 ". The terminals \"Ca\", \"H\", \"I\", \"O\", and \"3\" are replaced with \
their BNF symbols, ",
 StyleBox["<element>", "Program"],
 " and ",
 StyleBox["<number>", "Program"],
 "."
}], "TableTitle",
 CellChangeTimes->{{3.4939177588463984`*^9, 3.493917762323457*^9}, {
  3.493917965358087*^9, 3.4939179886310387`*^9}, {3.4939187490586443`*^9, 
  3.493918755545817*^9}, {3.4939188471684*^9, 3.4939188585135117`*^9}, {
  3.4947699150046577`*^9, 3.4947699193289757`*^9}, {3.49477002207829*^9, 
  3.494770126234002*^9}, {3.494790995485879*^9, 3.494791010525333*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.0834726777719228`, 1.4446302370292303`}, {0., 
    0.7223151185146152}, {0.7223151185146152, 0.7223151185146152}, {
    1.4446302370292303`, 0.7223151185146152}, {2.1669453555438456`, 
    0.7223151185146152}, {1.8057877962865378`, 0.}, {2.528102914801153, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 5}, {5, 6}, {5, 7}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"<molecule>\"\>", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.020512820512820513`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"\"<molecule>\"", "[", 
           
           RowBox[{"\"<element>\"", ",", "\"<element>\"", ",", 
             "\"<element>\"", ",", 
             RowBox[{"\"<replicated>\"", "[", 
               RowBox[{"\"<element>\"", ",", "\"<number>\""}], "]"}]}], "]"}],
          HoldForm]],
       Annotation[#, 
        HoldForm[
         "<molecule>"["<element>", "<element>", "<element>", 
          "<replicated>"["<element>", "<number>"]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"<element>\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.020512820512820513`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"<element>\"", HoldForm]],
       Annotation[#, 
        HoldForm["<element>"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"<element>\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.020512820512820513`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"<element>\"", HoldForm]],
       Annotation[#, 
        HoldForm["<element>"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"<element>\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.020512820512820513`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["\"<element>\"", HoldForm]],
       Annotation[#, 
        HoldForm["<element>"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"<replicated>\"\>", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.020512820512820513`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"\"<replicated>\"", "[", 
           RowBox[{"\"<element>\"", ",", "\"<number>\""}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "<replicated>"["<element>", "<number>"]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"<element>\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.020512820512820513`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"<element>\"", HoldForm]],
       Annotation[#, 
        HoldForm["<element>"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"<number>\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.020512820512820513`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"<number>\"", HoldForm]],
       Annotation[#, 
        HoldForm["<number>"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.0834726777719228`, 1.4446302370292303`}, {0.,
      0.7223151185146152}, {0.7223151185146152, 0.7223151185146152}, {
     1.4446302370292303`, 0.7223151185146152}, {2.1669453555438456`, 
     0.7223151185146152}, {1.8057877962865378`, 0.}, {2.528102914801153, 
     0.}}]& ],
  AspectRatio->NCache[Rational[2, 13]^Rational[1, 2], 0.3922322702763681],
  FrameTicks->Automatic,
  ImageSize->{426.6666666666666, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Figure",
 CellChangeTimes->{{3.493854580829627*^9, 3.4938545906311817`*^9}, 
   3.493914914607643*^9}],

Cell[TextData[{
 "We can say that the syntactic structure is derived from the symbol ",
 StyleBox["<molecule>", "Program"],
 " using the sequence of transformations shown in Table 2.1."
}], "Text",
 CellChangeTimes->{{3.4939190802992373`*^9, 3.493919098649818*^9}, {
  3.4939931883363323`*^9, 3.493993227763955*^9}, {3.494769987236779*^9, 
  3.4947699940816*^9}, {3.494770225239726*^9, 3.494770264761202*^9}, {
  3.494791217275497*^9, 3.494791233435813*^9}}],

Cell[CellGroupData[{

Cell["Table 2.1", "TableTitle",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.494791245717054*^9, 3.494791266711089*^9}}],

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#", ",", "Bold", ",", "Italic"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\>\"", ",", "\"\<structure\>\"", ",", "\"\<rule applied\>\""}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"MapIndexed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{
          "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<<molecule>\>\"", ",", "\"\<\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<<connected>\>\"", ",", "\"\<<molecule>\>\""}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<<molecule><molecule>\>\"", ",", "\"\<<connected>\>\""}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<<connected><connected>\>\"", ",", " ", "\"\<<molecule>\>\""}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<<molecule><molecule><molecule><molecule>\>\"", ",", 
           "\"\<<connected>\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<<element><element><element><replicated>\>\"", ",", 
           "\"\<<molecule>\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<<element><element><element><element><number>\>\"", ",", 
           "\"\<<replicated>\>\""}], "}"}]}], "}"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"Alignment", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Left", ",", "Center", ",", "Left"}], "}"}], ",", 
      "Automatic"}], "}"}]}], ",", 
   RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.494770290129551*^9, 3.4947703045073843`*^9}, {
  3.4947703696833553`*^9, 3.49477072147751*^9}, {3.494791266711319*^9, 
  3.494791287192977*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"structure\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"rule applied\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic]},
    {"1", "\<\"<molecule>\"\>", "\<\"\"\>"},
    {"2", "\<\"<connected>\"\>", "\<\"<molecule>\"\>"},
    {"3", "\<\"<molecule><molecule>\"\>", "\<\"<connected>\"\>"},
    {"4", "\<\"<connected><connected>\"\>", "\<\"<molecule>\"\>"},
    {"5", "\<\"<molecule><molecule><molecule><molecule>\"\>", \
"\<\"<connected>\"\>"},
    {"6", "\<\"<element><element><element><replicated>\"\>", \
"\<\"<molecule>\"\>"},
    {"7", "\<\"<element><element><element><element><number>\"\>", \
"\<\"<replicated>\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{
    "Columns" -> {Left, Center, Left}, "Rows" -> {{Automatic}}},
   GridBoxDividers->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxFrame->{"ColumnsIndexed" -> {{{1, -1}, {1, -1}} -> True}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.494770701571479*^9, 3.4947707219285593`*^9}, {
  3.494791266711491*^9, 3.494791287193224*^9}}]
}, Open  ]],

Cell[TextData[{
 "If we read the strings of these molecules from left to right, we are \
reading four element names and then we read a number. The number is applied \
to the last element name. Before reaching a digit we would read a number of \
letters -- these formulas can be split into two parts: an all letters one, \
and a digit one. The capital letters can seen as delimiters that separate the \
element names from each other. We also observe that if we append the element \
names to ",
 StyleBox["Molecule[]", "Program"],
 ", we will have almost correct syntactic structure, only the last node is \
incorrect. For example,"
}], "Text",
 CellChangeTimes->{{3.4939186875358257`*^9, 3.493918713361601*^9}, {
   3.493918921619281*^9, 3.493919007156711*^9}, {3.4939195268044443`*^9, 
   3.4939196033335123`*^9}, {3.493933884290753*^9, 3.493933946152605*^9}, {
   3.493934115092444*^9, 3.493934165520529*^9}, 3.49393422061753*^9, {
   3.4939342727160673`*^9, 3.4939343483722878`*^9}, {3.4939360898163843`*^9, 
   3.4939361432497263`*^9}, {3.493936173890091*^9, 3.49393619529005*^9}, {
   3.493936479014576*^9, 3.493936631453801*^9}, {3.4939367140132923`*^9, 
   3.49393673805824*^9}, {3.4939369587320538`*^9, 3.493936960899732*^9}, {
   3.493937763560966*^9, 3.493937957068022*^9}, {3.493938160332137*^9, 
   3.4939381878157063`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fold", "[", 
  RowBox[{"Append", ",", 
   RowBox[{"Molecule", "[", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Ca\>\"", ",", "\"\<H\>\"", ",", "\"\<I\>\"", ",", "\"\<O\>\""}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.493937960128584*^9, 3.4939380031480007`*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{"\<\"Ca\"\>", ",", "\<\"H\"\>", ",", "\<\"I\"\>", 
   ",", "\<\"O\"\>"}], "]"}]], "Output",
 CellChangeTimes->{3.493938003867144*^9}]
}, Open  ]],

Cell[TextData[{
 "The last node needs to be converted to ",
 StyleBox["Replicated", "Program"],
 " sub-expression with the number at the end of the formulas. We can do that \
using ",
 StyleBox["MapAt", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.493938014962677*^9, 3.4939380764160023`*^9}, {
  3.493938208930729*^9, 3.493938219784143*^9}, {3.690037820045031*^9, 
  3.690037820391453*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MapAt", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Replicated", "[", 
     RowBox[{"#", ",", "3"}], "]"}], "&"}], ",", "%", ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.493938081425047*^9, 3.4939381143380003`*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{"\<\"Ca\"\>", ",", "\<\"H\"\>", ",", "\<\"I\"\>", ",", 
   RowBox[{"Replicated", "[", 
    RowBox[{"\<\"O\"\>", ",", "3"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.493938115133456*^9}]
}, Open  ]],

Cell["\<\
With these two operations we have obtained the correct syntactic structure.\
\>", "Text",
 CellChangeTimes->{{3.493938252875646*^9, 3.4939382877911797`*^9}, {
  3.494888814506647*^9, 3.494888820425819*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.49393823286825*^9, 3.493938239280472*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.0834726777719228`, 1.4446302370292303`}, {0., 
    0.7223151185146152}, {0.7223151185146152, 0.7223151185146152}, {
    1.4446302370292303`, 0.7223151185146152}, {2.1669453555438456`, 
    0.7223151185146152}, {1.8057877962865378`, 0.}, {2.528102914801153, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 5}, {5, 6}, {5, 7}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"\"Ca\"", ",", "\"H\"", ",", "\"I\"", ",", 
             RowBox[{"Replicated", "[", 
               RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule["Ca", "H", "I", 
          $CellContext`Replicated["O", 3]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"H\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"H\"", HoldForm]],
       Annotation[#, 
        HoldForm["H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"I\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["\"I\"", HoldForm]],
       Annotation[#, 
        HoldForm["I"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{"\"O\"", ",", "3"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated["O", 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"O\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"O\"", HoldForm]],
       Annotation[#, 
        HoldForm["O"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.0834726777719228`, 1.4446302370292303`}, {0.,
      0.7223151185146152}, {0.7223151185146152, 0.7223151185146152}, {
     1.4446302370292303`, 0.7223151185146152}, {2.1669453555438456`, 
     0.7223151185146152}, {1.8057877962865378`, 0.}, {2.528102914801153, 
     0.}}]& ],
  AspectRatio->NCache[Rational[3, 7]^Rational[1, 2], 0.6546536707079771],
  FrameTicks->Automatic,
  ImageSize->{230.66666666666663`, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.493938241885775*^9}]
}, Open  ]],

Cell["\<\
If we think about all formulas that start with a capital letter, then using \
the above observations we can come up with the following algorithm: \
\>", "Text",
 CellChangeTimes->{{3.4939186875358257`*^9, 3.493918713361601*^9}, {
   3.493918921619281*^9, 3.493919007156711*^9}, {3.4939195268044443`*^9, 
   3.4939196033335123`*^9}, {3.493933884290753*^9, 3.493933946152605*^9}, {
   3.493934115092444*^9, 3.493934165520529*^9}, 3.49393422061753*^9, {
   3.4939342727160673`*^9, 3.4939343483722878`*^9}, {3.4939360898163843`*^9, 
   3.4939361432497263`*^9}, {3.493936173890091*^9, 3.49393619529005*^9}, {
   3.493936479014576*^9, 3.493936631453801*^9}, {3.4939367140132923`*^9, 
   3.493936738055189*^9}, {3.493938312924067*^9, 3.493938315271682*^9}, {
   3.494888884158039*^9, 3.4948888855136557`*^9}}],

Cell[TextData[{
 "1. The input is a string ",
 StyleBox["formula", "Program"],
 ". "
}], "Text",
 CellChangeTimes->{{3.4939186875358257`*^9, 3.493918713361601*^9}, {
   3.493918921619281*^9, 3.493919007156711*^9}, {3.4939195268044443`*^9, 
   3.4939196033335123`*^9}, {3.493933884290753*^9, 3.493933946152605*^9}, {
   3.493934115092444*^9, 3.493934165520529*^9}, 3.49393422061753*^9, {
   3.4939342727160673`*^9, 3.4939343483722878`*^9}, {3.4939360898163843`*^9, 
   3.4939361432497263`*^9}, {3.493936173890091*^9, 3.493936204850527*^9}, {
   3.493936270188678*^9, 3.493936285884901*^9}, {3.4939363888931293`*^9, 
   3.4939364042380657`*^9}, {3.493938321783349*^9, 3.4939383248017273`*^9}}],

Cell[TextData[{
 "2. Initialize parse tree ",
 StyleBox["tree", "Program"],
 " with ",
 StyleBox["Molecule[]", "Program",
  FontSize->18],
 " . "
}], "Text",
 CellChangeTimes->{{3.4939383260631332`*^9, 3.4939383691435757`*^9}, 
   3.4948887593601*^9, {3.494888893748027*^9, 3.4948888997852716`*^9}}],

Cell["\<\
3. Read letters until reaching a non-letter (a digit or a left parenthesis, \
according to the grammar). Split the formula into all letters part and all \
digits part.\
\>", "Text",
 CellChangeTimes->{{3.493936323728331*^9, 3.4939363805669127`*^9}, {
   3.49393642675228*^9, 3.493936429461685*^9}, {3.493936833937603*^9, 
   3.493936859752186*^9}, 3.4939408222229033`*^9, 3.493942860245216*^9, 
   3.6900378249839487`*^9}],

Cell[TextData[{
 "4. Extract and validate element names from the all letters part. Append the \
element names to ",
 StyleBox["tree", "Program"],
 "."
}], "Text",
 CellChangeTimes->{{3.493936305749351*^9, 3.493936313829019*^9}, {
  3.49393687733228*^9, 3.493936941875765*^9}, {3.4939384118291073`*^9, 
  3.4939384221039677`*^9}, {3.493940824134516*^9, 3.4939408255257807`*^9}}],

Cell[TextData[{
 "5. Make a number ",
 StyleBox["n", "Program"],
 " from the all digits part and change the last node into ",
 StyleBox["Replicated[Last[tree],n]", "Program"],
 "."
}], "Text",
 CellChangeTimes->{{3.493936912787257*^9, 3.493936932852169*^9}, {
   3.493938432215579*^9, 3.493938476215184*^9}, 3.493940827622817*^9}],

Cell["\<\
This algorithm can be applied to the sub-strings between a matching pair of \
parenthesis. Therefore, we can call it recursively when we encounter \"(\" \
and make sure there is a closing \")\".\
\>", "Text",
 CellChangeTimes->{{3.493940646223342*^9, 3.493940786285432*^9}, {
   3.493941491648938*^9, 3.493941492832176*^9}, 3.6900378304376297`*^9}],

Cell["\<\
Before giving the complete algorithm, let us resolve the questions of \
extracting and validating elements from the beginning of a chemical formula \
string.\
\>", "Text",
 CellChangeTimes->{{3.493940790107131*^9, 3.493940874380501*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extracting element name abbreviations", "Subsection",
 CellChangeTimes->{{3.49394102225729*^9, 3.4939410442177362`*^9}}],

Cell["\<\
First let us get the element name abbreviations in suitably named variable:\
\>", "Text",
 CellChangeTimes->{{3.493941048676682*^9, 3.493941075689632*^9}, {
  3.690037837922374*^9, 3.6900378437013893`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"elements", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ElementData", "[", 
     RowBox[{"#", ",", "\"\<Abbreviation\>\""}], "]"}], "&"}], "/@", 
   RowBox[{"ElementData", "[", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.493922605697125*^9, 3.4939226253137417`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"H\"\>", ",", "\<\"He\"\>", ",", "\<\"Li\"\>", 
   ",", "\<\"Be\"\>", ",", "\<\"B\"\>", ",", "\<\"C\"\>", ",", "\<\"N\"\>", 
   ",", "\<\"O\"\>", ",", "\<\"F\"\>", ",", "\<\"Ne\"\>", ",", "\<\"Na\"\>", 
   ",", "\<\"Mg\"\>", ",", "\<\"Al\"\>", ",", "\<\"Si\"\>", ",", "\<\"P\"\>", 
   ",", "\<\"S\"\>", ",", "\<\"Cl\"\>", ",", "\<\"Ar\"\>", ",", "\<\"K\"\>", 
   ",", "\<\"Ca\"\>", ",", "\<\"Sc\"\>", ",", "\<\"Ti\"\>", ",", "\<\"V\"\>", 
   ",", "\<\"Cr\"\>", ",", "\<\"Mn\"\>", ",", "\<\"Fe\"\>", ",", "\<\"Co\"\>",
    ",", "\<\"Ni\"\>", ",", "\<\"Cu\"\>", ",", "\<\"Zn\"\>", 
   ",", "\<\"Ga\"\>", ",", "\<\"Ge\"\>", ",", "\<\"As\"\>", ",", "\<\"Se\"\>",
    ",", "\<\"Br\"\>", ",", "\<\"Kr\"\>", ",", "\<\"Rb\"\>", 
   ",", "\<\"Sr\"\>", ",", "\<\"Y\"\>", ",", "\<\"Zr\"\>", ",", "\<\"Nb\"\>", 
   ",", "\<\"Mo\"\>", ",", "\<\"Tc\"\>", ",", "\<\"Ru\"\>", ",", "\<\"Rh\"\>",
    ",", "\<\"Pd\"\>", ",", "\<\"Ag\"\>", ",", "\<\"Cd\"\>", 
   ",", "\<\"In\"\>", ",", "\<\"Sn\"\>", ",", "\<\"Sb\"\>", ",", "\<\"Te\"\>",
    ",", "\<\"I\"\>", ",", "\<\"Xe\"\>", ",", "\<\"Cs\"\>", ",", "\<\"Ba\"\>",
    ",", "\<\"La\"\>", ",", "\<\"Ce\"\>", ",", "\<\"Pr\"\>", 
   ",", "\<\"Nd\"\>", ",", "\<\"Pm\"\>", ",", "\<\"Sm\"\>", ",", "\<\"Eu\"\>",
    ",", "\<\"Gd\"\>", ",", "\<\"Tb\"\>", ",", "\<\"Dy\"\>", 
   ",", "\<\"Ho\"\>", ",", "\<\"Er\"\>", ",", "\<\"Tm\"\>", ",", "\<\"Yb\"\>",
    ",", "\<\"Lu\"\>", ",", "\<\"Hf\"\>", ",", "\<\"Ta\"\>", ",", "\<\"W\"\>",
    ",", "\<\"Re\"\>", ",", "\<\"Os\"\>", ",", "\<\"Ir\"\>", 
   ",", "\<\"Pt\"\>", ",", "\<\"Au\"\>", ",", "\<\"Hg\"\>", ",", "\<\"Tl\"\>",
    ",", "\<\"Pb\"\>", ",", "\<\"Bi\"\>", ",", "\<\"Po\"\>", 
   ",", "\<\"At\"\>", ",", "\<\"Rn\"\>", ",", "\<\"Fr\"\>", ",", "\<\"Ra\"\>",
    ",", "\<\"Ac\"\>", ",", "\<\"Th\"\>", ",", "\<\"Pa\"\>", ",", "\<\"U\"\>",
    ",", "\<\"Np\"\>", ",", "\<\"Pu\"\>", ",", "\<\"Am\"\>", 
   ",", "\<\"Cm\"\>", ",", "\<\"Bk\"\>", ",", "\<\"Cf\"\>", ",", "\<\"Es\"\>",
    ",", "\<\"Fm\"\>", ",", "\<\"Md\"\>", ",", "\<\"No\"\>", 
   ",", "\<\"Lr\"\>", ",", "\<\"Rf\"\>", ",", "\<\"Db\"\>", ",", "\<\"Sg\"\>",
    ",", "\<\"Bh\"\>", ",", "\<\"Hs\"\>", ",", "\<\"Mt\"\>", 
   ",", "\<\"Ds\"\>", ",", "\<\"Rg\"\>", ",", "\<\"Uub\"\>", 
   ",", "\<\"Uut\"\>", ",", "\<\"Uuq\"\>", ",", "\<\"Uup\"\>", 
   ",", "\<\"Uuh\"\>", ",", "\<\"Uus\"\>", ",", "\<\"Uuo\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.4939226178905067`*^9, 3.4945352559903507`*^9, 
  3.4953213394703817`*^9}]
}, Open  ]],

Cell[TextData[{
 "We are going to use the string pattern matching capabilities in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ", and more precisely use regular expressions in ",
 StyleBox["StringCases", "Program"],
 ". For example, using the regular expression string pattern \"F[emr]?\" we \
can extract from a string all element name abbreviations that start with \
\"F\"."
}], "Text",
 CellChangeTimes->{{3.4939411571376762`*^9, 3.493941219839888*^9}, {
  3.493941400905447*^9, 3.493941487676923*^9}, {3.493993294974482*^9, 
  3.493993313015427*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringCases", "[", 
  RowBox[{"\"\<FrClBFmCHF2\>\"", ",", 
   RowBox[{"RegularExpression", "[", "\"\<F[emr]?\>\"", "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4939412218130198`*^9, 3.4939412515015287`*^9}, {
   3.493941284163846*^9, 3.49394139776143*^9}, {3.493993317250339*^9, 
   3.4939933352420607`*^9}, 3.493993400731906*^9, 3.493993576490368*^9, {
   3.4939936137854633`*^9, 3.4939936154087543`*^9}, {3.49399415669987*^9, 
   3.493994164406879*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Fr\"\>", ",", "\<\"Fm\"\>", ",", "\<\"F\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.493941312265004*^9, {3.49394136860958*^9, 3.493941382403594*^9}, 
   3.493941765061247*^9, 3.493993336283414*^9, 3.493993401174159*^9, 
   3.49399357750072*^9, 3.493993616443277*^9, 3.493993820322482*^9, {
   3.493994158964252*^9, 3.493994164825732*^9}, 3.49532134142978*^9}]
}, Open  ]],

Cell[TextData[{
 "So let us divide the elements into groups of elements that start with the \
same letter. We can accomplish that by gathering them -- using ",
 StyleBox["GatherBy", "Program"],
 " --  according to their first letter. (We also sort the result of ",
 StyleBox["GatherBy", "Program"],
 " alphabetically.)"
}], "Text",
 CellChangeTimes->{{3.4939415252365627`*^9, 3.493941576943997*^9}, {
  3.493994198156805*^9, 3.493994313285671*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"elementGroups", "=", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Sort", "/@", 
      RowBox[{"GatherBy", "[", 
       RowBox[{"elements", ",", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "]"}]}], ",", "First"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"elementGroups", "//", "ColumnForm"}]}], "Input",
 CellChangeTimes->{{3.493922404573086*^9, 3.493922494340785*^9}, {
  3.493922612505919*^9, 3.493922662137864*^9}, {3.4939413410914707`*^9, 
  3.493941345674655*^9}, {3.493941724147129*^9, 3.493941742319344*^9}}],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"Ac\"\>", ",", "\<\"Ag\"\>", ",", "\<\"Al\"\>", 
       ",", "\<\"Am\"\>", ",", "\<\"Ar\"\>", ",", "\<\"As\"\>", 
       ",", "\<\"At\"\>", ",", "\<\"Au\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"B\"\>", ",", "\<\"Ba\"\>", ",", "\<\"Be\"\>", 
       ",", "\<\"Bh\"\>", ",", "\<\"Bi\"\>", ",", "\<\"Bk\"\>", 
       ",", "\<\"Br\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "\<\"Ca\"\>", ",", "\<\"Cd\"\>", 
       ",", "\<\"Ce\"\>", ",", "\<\"Cf\"\>", ",", "\<\"Cl\"\>", 
       ",", "\<\"Cm\"\>", ",", "\<\"Co\"\>", ",", "\<\"Cr\"\>", 
       ",", "\<\"Cs\"\>", ",", "\<\"Cu\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Db\"\>", ",", "\<\"Ds\"\>", ",", "\<\"Dy\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Er\"\>", ",", "\<\"Es\"\>", ",", "\<\"Eu\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"F\"\>", ",", "\<\"Fe\"\>", ",", "\<\"Fm\"\>", 
       ",", "\<\"Fr\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Ga\"\>", ",", "\<\"Gd\"\>", ",", "\<\"Ge\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", "\<\"He\"\>", ",", "\<\"Hf\"\>", 
       ",", "\<\"Hg\"\>", ",", "\<\"Ho\"\>", ",", "\<\"Hs\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"I\"\>", ",", "\<\"In\"\>", ",", "\<\"Ir\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"K\"\>", ",", "\<\"Kr\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"La\"\>", ",", "\<\"Li\"\>", ",", "\<\"Lr\"\>", 
       ",", "\<\"Lu\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Md\"\>", ",", "\<\"Mg\"\>", ",", "\<\"Mn\"\>", 
       ",", "\<\"Mo\"\>", ",", "\<\"Mt\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"N\"\>", ",", "\<\"Na\"\>", ",", "\<\"Nb\"\>", 
       ",", "\<\"Nd\"\>", ",", "\<\"Ne\"\>", ",", "\<\"Ni\"\>", 
       ",", "\<\"No\"\>", ",", "\<\"Np\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", "\<\"Os\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"P\"\>", ",", "\<\"Pa\"\>", ",", "\<\"Pb\"\>", 
       ",", "\<\"Pd\"\>", ",", "\<\"Pm\"\>", ",", "\<\"Po\"\>", 
       ",", "\<\"Pr\"\>", ",", "\<\"Pt\"\>", ",", "\<\"Pu\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Ra\"\>", ",", "\<\"Rb\"\>", ",", "\<\"Re\"\>", 
       ",", "\<\"Rf\"\>", ",", "\<\"Rg\"\>", ",", "\<\"Rh\"\>", 
       ",", "\<\"Rn\"\>", ",", "\<\"Ru\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S\"\>", ",", "\<\"Sb\"\>", ",", "\<\"Sc\"\>", 
       ",", "\<\"Se\"\>", ",", "\<\"Sg\"\>", ",", "\<\"Si\"\>", 
       ",", "\<\"Sm\"\>", ",", "\<\"Sn\"\>", ",", "\<\"Sr\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Ta\"\>", ",", "\<\"Tb\"\>", ",", "\<\"Tc\"\>", 
       ",", "\<\"Te\"\>", ",", "\<\"Th\"\>", ",", "\<\"Ti\"\>", 
       ",", "\<\"Tl\"\>", ",", "\<\"Tm\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"U\"\>", ",", "\<\"Uub\"\>", ",", "\<\"Uuh\"\>", 
       ",", "\<\"Uuo\"\>", ",", "\<\"Uup\"\>", ",", "\<\"Uuq\"\>", 
       ",", "\<\"Uus\"\>", ",", "\<\"Uut\"\>"}], "}"}]},
    {
     RowBox[{"{", "\<\"V\"\>", "}"}]},
    {
     RowBox[{"{", "\<\"W\"\>", "}"}]},
    {
     RowBox[{"{", "\<\"Xe\"\>", "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Y\"\>", ",", "\<\"Yb\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Zn\"\>", ",", "\<\"Zr\"\>"}], "}"}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  ColumnForm[{{"Ac", "Ag", "Al", "Am", "Ar", "As", "At", "Au"}, {
    "B", "Ba", "Be", "Bh", "Bi", "Bk", "Br"}, {
    "C", "Ca", "Cd", "Ce", "Cf", "Cl", "Cm", "Co", "Cr", "Cs", "Cu"}, {
    "Db", "Ds", "Dy"}, {"Er", "Es", "Eu"}, {"F", "Fe", "Fm", "Fr"}, {
    "Ga", "Gd", "Ge"}, {"H", "He", "Hf", "Hg", "Ho", "Hs"}, {
    "I", "In", "Ir"}, {"K", "Kr"}, {"La", "Li", "Lr", "Lu"}, {
    "Md", "Mg", "Mn", "Mo", "Mt"}, {
    "N", "Na", "Nb", "Nd", "Ne", "Ni", "No", "Np"}, {"O", "Os"}, {
    "P", "Pa", "Pb", "Pd", "Pm", "Po", "Pr", "Pt", "Pu"}, {
    "Ra", "Rb", "Re", "Rf", "Rg", "Rh", "Rn", "Ru"}, {
    "S", "Sb", "Sc", "Se", "Sg", "Si", "Sm", "Sn", "Sr"}, {
    "Ta", "Tb", "Tc", "Te", "Th", "Ti", "Tl", "Tm"}, {
    "U", "Uub", "Uuh", "Uuo", "Uup", "Uuq", "Uus", "Uut"}, {"V"}, {"W"}, {
    "Xe"}, {"Y", "Yb"}, {"Zn", "Zr"}}],
  Editable->False]], "Output",
 CellChangeTimes->{{3.493922422553473*^9, 3.493922495027432*^9}, {
   3.493922629408103*^9, 3.493922663329361*^9}, 3.493941346181758*^9, {
   3.493941728968487*^9, 3.493941743128106*^9}, 3.493994322726644*^9, 
   3.494535256184086*^9, {3.4953213220309668`*^9, 3.495321342049961*^9}}]
}, Open  ]],

Cell["Then we construct a regular expression for each group.", "Text",
 CellChangeTimes->{{3.493941775590475*^9, 3.49394179058877*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"elementGroupPatterns", "=", "\[IndentingNewLine]", 
  RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "#2", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"#1", "<>", "\"\<[\>\"", "<>", 
        RowBox[{"Apply", "[", 
         RowBox[{"StringJoin", ",", "#2"}], "]"}], "<>", "\"\<]\>\"", "<>", 
        RowBox[{"If", "[", 
         RowBox[{"#3", ",", "\"\<?\>\"", ",", "\"\<\>\""}], "]"}]}], ",", 
       "#1"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "&"}], "/@", "elementGroups"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Characters", "[", 
              RowBox[{"StringTake", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], "&"}], ",", 
            "#"}], "]"}], "]"}], "]"}], "&"}], "/@", "elementGroups"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"#", ",", 
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
       "elementGroups"}]}], "\[IndentingNewLine]", "}"}], ",", "1"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.493922595919734*^9, {3.4939226325404053`*^9, 3.493922633727531*^9}, {
   3.493922688671859*^9, 3.493923034180153*^9}, {3.493941598701653*^9, 
   3.493941621191586*^9}, {3.4939416572741833`*^9, 3.493941712766211*^9}, {
   3.4939418015828667`*^9, 3.49394181111861*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"A[cglmrstu]\"\>", ",", "\<\"B[aehikr]?\"\>", 
   ",", "\<\"C[adeflmorsu]?\"\>", ",", "\<\"D[bsy]\"\>", 
   ",", "\<\"E[rsu]\"\>", ",", "\<\"F[emr]?\"\>", ",", "\<\"G[ade]\"\>", 
   ",", "\<\"H[efgos]?\"\>", ",", "\<\"I[nr]?\"\>", ",", "\<\"K[r]?\"\>", 
   ",", "\<\"L[airu]\"\>", ",", "\<\"M[dgnot]\"\>", 
   ",", "\<\"N[abdeiop]?\"\>", ",", "\<\"O[s]?\"\>", 
   ",", "\<\"P[abdmortu]?\"\>", ",", "\<\"R[abefghnu]\"\>", 
   ",", "\<\"S[bcegimnr]?\"\>", ",", "\<\"T[abcehilm]\"\>", 
   ",", "\<\"U[bhopqstu]?\"\>", ",", "\<\"V\"\>", ",", "\<\"W\"\>", 
   ",", "\<\"X[e]\"\>", ",", "\<\"Y[b]?\"\>", ",", "\<\"Z[nr]\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.493922928743169*^9, 3.493922966977697*^9, 3.4939230350224457`*^9, 
   3.493941600506665*^9, {3.49394169481245*^9, 3.493941713815494*^9}, 
   3.4939417531260843`*^9, 3.493941812189946*^9, 3.493994325742675*^9, 
   3.494535256344482*^9, 3.49532134211485*^9}]
}, Open  ]],

Cell["Then we combine the group regular expressions into one.", "Text",
 CellChangeTimes->{{3.493942017076212*^9, 3.493942038468857*^9}, {
  3.493994363176759*^9, 3.493994374388994*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"elementsPattern", "=", 
  RowBox[{"StringJoin", "@@", 
   RowBox[{"Riffle", "[", 
    RowBox[{"elementGroupPatterns", ",", "\"\<|\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.49394204209125*^9, 3.493942078439619*^9}}],

Cell[BoxData["\<\"A[cglmrstu]|B[aehikr]?|C[adeflmorsu]?|D[bsy]|E[rsu]|F[emr]?|\
G[ade]|H[efgos]?|I[nr]?|K[r]?|L[airu]|M[dgnot]|N[abdeiop]?|O[s]?|P[abdmortu]?|\
R[abefghnu]|S[bcegimnr]?|T[abcehilm]|U[bhopqstu]?|V|W|X[e]|Y[b]?|Z[nr]\"\>"], \
"Output",
 CellChangeTimes->{{3.493942065147565*^9, 3.4939420795427217`*^9}, 
   3.494535300963575*^9, 3.495321342163259*^9}]
}, Open  ]],

Cell[TextData[{
 "We can check and demonstrate that the pattern is working by applying it to \
random molecules from ",
 StyleBox["ChemicalData", "Program"],
 "."
}], "Text",
 CellChangeTimes->{{3.493942324506514*^9, 3.4939424649333067`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"randomCompounds", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ChemicalData", "[", 
     RowBox[{"#", ",", "\"\<CompoundFormulaString\>\""}], "]"}], "&"}], "/@", 
   
   RowBox[{
    RowBox[{"ChemicalData", "[", "\"\<MetalCarbonyls\>\"", "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "50"}], "}"}], ",", "5"}], "]"}], 
    "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.4939418224309177`*^9, 3.493941909136307*^9}, {
  3.493941942605217*^9, 3.493941971009193*^9}, {3.493942169485943*^9, 
  3.493942308615943*^9}, {3.493942397748036*^9, 3.4939423985846987`*^9}, {
  3.493942677416808*^9, 3.493942681200693*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"C12H9O3W-3\"\>", ",", "\<\"C10H8CrO3\"\>", 
   ",", "\<\"C7H7CrNO6\"\>", ",", "\<\"C10H8CrO3\"\>", 
   ",", "\<\"C11H11MnO4\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.4939426780141773`*^9, 3.4939426816793833`*^9}, 
   3.4945352553119802`*^9, {3.49453539380359*^9, 3.4945353963795767`*^9}, 
   3.495321355983274*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"randomCompoundElements", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"StringCases", "[", 
      RowBox[{"#", ",", 
       RowBox[{"RegularExpression", "[", "elementsPattern", "]"}]}], "]"}], 
     "&"}], ",", "randomCompounds"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.493942599508335*^9, 3.493942625607972*^9}, {
  3.493942669837048*^9, 3.4939426718705063`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"O\"\>", 
     ",", "\<\"W\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"Cr\"\>", 
     ",", "\<\"O\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"Cr\"\>", 
     ",", "\<\"N\"\>", ",", "\<\"O\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"Cr\"\>", 
     ",", "\<\"O\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"Mn\"\>", 
     ",", "\<\"O\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.493942626888988*^9, 3.493942684351098*^9, 
  3.4945352571601963`*^9, 3.494535302675783*^9, 3.4945353979979067`*^9, 
  3.49532135617619*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"randomCompounds", ",", "randomCompoundElements"}], "}"}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"#", ",", "Bold", ",", "Italic"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"\"\<formula\>\"", ",", "\"\<elements\>\""}], "}"}]}]}], "]"}],
    ",", 
   RowBox[{"Dividers", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "True"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"False", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "randomCompounds", "]"}], "-", "1"}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"{", "True", "}"}]}], "]"}]}], "}"}]}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4939419804723883`*^9, 3.493942004676536*^9}, {
  3.493942084278145*^9, 3.4939421337678556`*^9}, {3.49394247195778*^9, 
  3.4939425782669373`*^9}, {3.493942632771579*^9, 3.493942661149006*^9}, {
  3.4945351864702873`*^9, 3.494535216516741*^9}, {3.4945353075528173`*^9, 
  3.494535308332996*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"formula\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"elements\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic]},
    {"\<\"C12H9O3W-3\"\>", 
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"O\"\>", 
       ",", "\<\"W\"\>"}], "}"}]},
    {"\<\"C10H8CrO3\"\>", 
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"Cr\"\>", 
       ",", "\<\"O\"\>"}], "}"}]},
    {"\<\"C7H7CrNO6\"\>", 
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"Cr\"\>", 
       ",", "\<\"N\"\>", ",", "\<\"O\"\>"}], "}"}]},
    {"\<\"C10H8CrO3\"\>", 
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"Cr\"\>", 
       ",", "\<\"O\"\>"}], "}"}]},
    {"\<\"C11H11MnO4\"\>", 
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"Mn\"\>", 
       ",", "\<\"O\"\>"}], "}"}]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{
    "Columns" -> {{True}}, 
     "Rows" -> {True, True, False, False, False, False, True}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.4939420931451597`*^9, 3.493942146191002*^9}, {
   3.4939422131389112`*^9, 3.493942275125997*^9}, 3.493942312415566*^9, 
   3.493942480457472*^9, {3.493942512757441*^9, 3.493942536466446*^9}, 
   3.4939425790660553`*^9, 3.493942661905363*^9, 3.493942692428406*^9, 
   3.494535257478149*^9, {3.494535304282379*^9, 3.494535308464519*^9}, 
   3.494535398900421*^9, 3.4953213566775103`*^9}]
}, {2}]],

Cell["\<\
Finaly, let us define a function that extracts the elements from the \
beginning of a string.\
\>", "Text",
 CellChangeTimes->{{3.49532148848869*^9, 3.49532151605239*^9}, {
  3.495321697807164*^9, 3.495321705668788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetElements", "[", "formula_String", "]"}], ":=", 
  RowBox[{"StringCases", "[", 
   RowBox[{"formula", ",", 
    RowBox[{
    "RegularExpression", "[", 
     "\"\<A[cglmrstu]|B[aehikr]?|C[adeflmorsu]?|D[bsy]|E[rsu]|F[emr]?|G[ade]|\
H[efgos]?|I[nr]?|K[r]?|L[airu]|M[dgnot]|N[abdeiop]?|O[s]?|P[abdmortu]?|R[\
abefghnu]|S[bcegimnr]?|T[abcehilm]|U[bhopqstu]?|V|W|X[e]|Y[b]?|Z[nr]\>\"", 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495321528230801*^9, 3.495321658490386*^9}, {
   3.495321714246276*^9, 3.495321735742612*^9}, 3.495321823644698*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GetElements", "[", "\"\<C10H8CrO3\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.495321609390276*^9, 3.49532161582121*^9}, {
  3.495321669794147*^9, 3.495321685367683*^9}, {3.495324009460413*^9, 
  3.495324026646832*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"Cr\"\>", 
   ",", "\<\"O\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.495321685922155*^9, {3.495321716345709*^9, 3.495321728219499*^9}, {
   3.495321807205633*^9, 3.495321826755906*^9}, 3.495324027224696*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Types of symbols ", "Subsection",
 CellChangeTimes->{{3.494534587435171*^9, 3.494534594032545*^9}}],

Cell["\<\
The algorithm of the parser would scan a chemical formula string from left to \
right. After a morpheme is found the data structure of the formula syntactic \
tree is updated, and the morpheme is deleted from the from the formula string.\
\>", "Text",
 CellChangeTimes->{{3.494534707951879*^9, 3.494534859273149*^9}}],

Cell["\<\
Reading a formula from left to right we would encounter different \
combinations of characters. Using the BNF we can make the following \
observations.\
\>", "Text",
 CellChangeTimes->{{3.494450017616906*^9, 3.49445003144517*^9}, {
  3.494460800394095*^9, 3.4944608507041807`*^9}, {3.4944611214112186`*^9, 
  3.494461160776882*^9}, {3.4945348991975527`*^9, 3.494534904083064*^9}, {
  3.494534934568213*^9, 3.494535011209441*^9}}],

Cell[CellGroupData[{

Cell["\<\
There are five types of terminal symbols: capital letters, small letters, \
digits, left and right parenthesis, and the underscore.\
\>", "Item",
 CellChangeTimes->{{3.4944608353567657`*^9, 3.4944609459815817`*^9}, {
  3.4945349526173553`*^9, 3.4945349546576433`*^9}, {3.49488967037246*^9, 
  3.494889677929298*^9}}],

Cell["All element names begin with a capital letter.", "Item",
 CellChangeTimes->{{3.4944609469924307`*^9, 3.494460956504599*^9}, {
  3.494461003000298*^9, 3.4944610030039577`*^9}, {3.4944610599444103`*^9, 
  3.4944611100002623`*^9}}],

Cell["The underscore symbol is only followed by a digit.", "Item",
 CellChangeTimes->{{3.494461008848456*^9, 3.494461054928659*^9}, {
  3.494461176799247*^9, 3.494461176804748*^9}}],

Cell["\<\
The number of left parenthesis is the same as the number of right parenthesis.\
\>", "Item",
 CellChangeTimes->{{3.4944611792977457`*^9, 3.494461213364229*^9}}],

Cell["\<\
Characters between a matching pair of parenthesis can be seen as separate \
chemical formulas. We will call these substrings sub-formulas.\
\>", "Item",
 CellChangeTimes->{{3.494461335438973*^9, 3.494461467448639*^9}, {
  3.4945350780401163`*^9, 3.4945350797053423`*^9}, {3.494889887065913*^9, 
  3.4948898882174873`*^9}, {3.690037853211604*^9, 3.690037855739204*^9}}],

Cell["Formulas and sub-formulas do not begin with a digit.", "Item",
 CellChangeTimes->{{3.494461470252882*^9, 3.494461489144719*^9}, {
   3.4948898786101427`*^9, 3.49488989484934*^9}, 3.6900378587288027`*^9}]
}, Open  ]],

Cell["\<\
Not all sequences of characters appear. For example, a digit cannot be \
followed by the underscore. Let us find all possible occurrences allowed by \
the BNF of one type of characters followed by another.\
\>", "Text",
 CellChangeTimes->{{3.4944737701664333`*^9, 3.494473836909658*^9}, {
   3.494473881579842*^9, 3.494473886365315*^9}, {3.494473961890225*^9, 
   3.494474025414145*^9}, {3.494474107116276*^9, 3.49447410811726*^9}, {
   3.494478755723703*^9, 3.49447876213439*^9}, {3.494504205000936*^9, 
   3.494504235940934*^9}, {3.494504299746279*^9, 3.494504338419435*^9}, {
   3.4945043757693043`*^9, 3.494504393960396*^9}, {3.494535498478231*^9, 
   3.4945355037405252`*^9}, {3.494537330616172*^9, 3.494537337114174*^9}, {
   3.690037863186644*^9, 3.6900378736300287`*^9}, 3.69003791338421*^9}],

Cell[CellGroupData[{

Cell["\<\
Table 2.1 Character combinations and BNF transformation rules that produce \
them.\
\>", "TableTitle",
 CellChangeTimes->{{3.494535145000511*^9, 3.494535166233369*^9}, {
   3.4945352561242027`*^9, 3.494535288128688*^9}, 3.494540896803985*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"description\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"example\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"BNF symbol sequence\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"rule of derivation\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic]},
    {
     StyleBox[
      StyleBox["\<\"a letter followed by a letter\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...ClF...\"\>", "\<\"...<element><element>...\"\>", \
"\<\"<connected> \[Rule] <element><element>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a letter followed by a digit\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...Cl2...\"\>", "\<\"...<element><number>...\"\>", \
"\<\"<replicated> \[Rule] <element><number>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a letter followed by _\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...O_2...\"\>", "\<\"...<element>_<number>...\"\>", \
"\<\"<replicated> \[Rule] <element><number>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a letter followed by (\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...H(Cl...\"\>", "\<\"...<element>\\\"(\\\"<element>...\"\
\>", "\<\"<connected> \[Rule] <element><molecule>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a letter followed by (...(\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...H((Cl\"\>", \
"\<\"...<element>\\\"(\\\"...\\\"(\\\"<element>...\"\>", "\<\"<connected> \
\[Rule] <element><molecule>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a digit followed by a capital letter\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...2H...\"\>", "\<\"...<number><element>...\"\>", \
"\<\"<replicated><element> or <replicated><replicated>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a digit followed by (\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...2(Mn..\"\>", "\<\"...<number>\\\"(\\\"...\"\>", \
"\<\"<replicated><molecule>\"\>"},
    {
     StyleBox[
      StyleBox["\<\") followed by a capital letter\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...)C...\"\>", "\<\"...\\\")\\\"<element>...\"\>", \
"\<\"<molecule><molecule>\"\>"},
    {
     StyleBox[
      StyleBox["\<\") followed by a digit\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...)3...\"\>", "\<\"...\\\")\\\"<number>...\"\>", \
"\<\"<replicated>\"\>"},
    {
     StyleBox[
      StyleBox["\<\") followed by _\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...)_3...\"\>", "\<\"...\\\")\\\"_<number>...\"\>", \
"\<\"<replicated>\"\>"},
    {
     StyleBox[
      StyleBox["\<\") followed by (\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...)(C...\"\>", \
"\<\"...\\\")\\\"\\\"(\\\"<element>...\"\>", "\<\"<molecule><molecule>\"\>"},
    {
     StyleBox[
      StyleBox["\<\") followed by (...(\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...)((Cl...\"\>", \
"\<\"...\\\")\\\"\\\"(\\\"...\\\"(\\\"<element>...\"\>", "\<\"<connected> \
repeated\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{
    "Columns" -> {Left, Center, Left, Left}, "Rows" -> {{Center}}},
   GridBoxDividers->{
    "Columns" -> {{True}}, 
     "Rows" -> {
      True, True, False, False, False, False, True, False, True, False, False,
        False, False, True}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.494450712979507*^9, 3.4944507330303698`*^9}, {
   3.49445076561901*^9, 3.494450774647768*^9}, {3.494450811345806*^9, 
   3.494450833619546*^9}, 3.494451019314104*^9, {3.494451318955532*^9, 
   3.4944513638097763`*^9}, {3.494455424857082*^9, 3.494455531361493*^9}, {
   3.4944555627553253`*^9, 3.49445559005847*^9}, 3.494455677745133*^9, {
   3.494455726321995*^9, 3.4944557562981443`*^9}, 3.494455830610435*^9, {
   3.4944558916454782`*^9, 3.4944559524986553`*^9}, 3.494455984590043*^9, {
   3.494458158095083*^9, 3.4944581807120237`*^9}, {3.494458226451635*^9, 
   3.494458237323739*^9}, 3.4944583317354937`*^9, 3.494458466345314*^9, 
   3.494459053055666*^9, 3.4944593697809153`*^9, 3.49446001397276*^9, 
   3.494460234278028*^9, {3.494460458471369*^9, 3.4944604826310167`*^9}, 
   3.4944605443942823`*^9, 3.494473945434968*^9, 3.494533994134932*^9, {
   3.49454479013874*^9, 3.4945448134433203`*^9}, 3.494544844157455*^9}]
}, Open  ]],

Cell["\<\
The table below shows what successions of characters are valid. \
\>", "Text",
 CellChangeTimes->{{3.49453738496839*^9, 3.494537396081441*^9}, {
   3.4945381072135897`*^9, 3.494538154968832*^9}, 3.6900379278428583`*^9}],

Cell[CellGroupData[{

Cell["\<\
Table 2.2 Character type succession. A checkmark says that the character type \
of the corresponding row can be followed by the character of the \
corresponding column.\
\>", "TableTitle",
 CellChangeTimes->{{3.494537399268244*^9, 3.494537464569894*^9}, {
   3.4945388672120943`*^9, 3.4945388921052017`*^9}, {3.494538925217247*^9, 
   3.494538954121109*^9}, {3.494539012937601*^9, 3.49453901743351*^9}, {
   3.4945392672974033`*^9, 3.494539286329265*^9}, {3.494540527000725*^9, 
   3.494540554555976*^9}, {3.494540792501343*^9, 3.494540802457264*^9}, {
   3.494540836081828*^9, 3.494540889177356*^9}, 3.4946301603675413`*^9, 
   3.494630193214197*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"character type\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"capital\\nletter\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"small\\nletter\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"digit\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"(\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\")\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"_\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic]},
    {
     StyleBox[
      StyleBox["\<\"capital letter\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\
\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\
\[Checkmark]\"\>"},
    {
     StyleBox[
      StyleBox["\<\"small letter\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\
\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\
\[Checkmark]\"\>"},
    {
     StyleBox[
      StyleBox["\<\"digit\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\[Checkmark]\"\>", "\<\"\"\>", "\<\"\[Checkmark]\"\>", "\<\
\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\"\>"},
    {
     StyleBox[
      StyleBox["\<\"(\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\[Checkmark]\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\
\[Checkmark]\"\>", "\<\"\"\>", "\<\"\"\>"},
    {
     StyleBox[
      StyleBox["\<\")\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\[Checkmark]\"\>", "\<\"\"\>", "\<\"\[Checkmark]\"\>", "\<\
\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>"},
    {
     StyleBox[
      StyleBox["\<\"_\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\"\>", "\<\"\"\>", "\<\"\[Checkmark]\"\>", "\<\"\"\>", "\<\
\"\"\>", "\<\"\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{
    "Columns" -> {True, True, False, False, False, False, False, True}, 
     "Rows" -> {True, True, True, True, True, True, True, True}},
   GridBoxItemSize->{
    "Columns" -> {8, 5, 5, 5, 5, 5, 5}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.494537794634489*^9, 3.494537810720593*^9}}]
}, Open  ]],

Cell["\<\
We can say that Table 2.1 suggests that the parser would have certain modes. \
Each group of that table corresponds to a different mode: element parsing \
mode, replication mode, and submolecule mode. The changes of the character \
types while reading the formula, would switch the parser from one mode to \
another. This process is illustrated with the graph on Figure 2.1. The gray \
oval node \"Caller\" does not represent a parsing mode but an initiation of \
the parsing. Each arrow shows transition from the arrow's source to arrow's \
target if a certain condition is met.\
\>", "Text",
 CellChangeTimes->{{3.4946298825412703`*^9, 3.494630079940699*^9}, {
  3.494630445051262*^9, 3.49463046372471*^9}, {3.4946322095259113`*^9, 
  3.494632314581236*^9}, {3.4946483641080103`*^9, 3.494648373382115*^9}, {
  3.494649516135334*^9, 3.4946495840610313`*^9}, {3.4946496458313828`*^9, 
  3.494649797029957*^9}}],

Cell[CellGroupData[{

Cell["\<\
Figure 2.1 Parsing mode switching diagram. The chemical formula string is \
designated with the symbol \"f.\" With f\[LeftDoubleBracket]1\
\[RightDoubleBracket] is designated the first symbol of f. The character \
ranges assume alphabetical order.\
\>", "TableTitle",
 CellChangeTimes->{{3.494630106479076*^9, 3.4946301066845903`*^9}, {
  3.494630149725923*^9, 3.494630152085085*^9}, {3.494630201631505*^9, 
  3.494630367556776*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsGroupBox[{GraphicsComplexBox[CompressedData["
1:eJx1lH9M1HUYx++Os6HcXdgfLRDbmaghICdIYNGeJ2AMtB83BIKjFiIgsCBO
CJEakbNiRZcoIBBMypMdCEmQAqL7MCh+JLeUH6cgBSIgvw1DQOCguM/jH7X1
bN89+27ff77v1/v1bAn/wD9SJBAIIv551vb/DPL1J/znnfFtiU8+LK49G1W0
sQUyFJu+m/2lCVpPv9ybEaQH33hjWv6jVmhMjT2WPHQTgiMcVD6TejCYp78Q
7tINilc+iXkp4CbYXBPdM+behsK2j9S+2Z0ge965bq+sD5Rjc6XaS91Qnun0
8eqZfkiw0D5XXHMLtPlrcxd0pt0DBab9CL417TE4p1Prjp2YA8X1mm6/1HF4
Oj3OdWviPOyOs7E5vG8CZrpK4vZHLkDKBq1j5fpJKGN1kSWqx7A+tGfjWM0k
OBqzdt/3X4RTRxvt7gRMwXhpxjJ7YwlE1YLXAgemYGrk1y2D+5Zhof7VInvV
NNxo1c1M6/RQjLYOPu+WsaTg36WCtg6wjF6cDzRWsiiL2r2HfjLASa/JH7eH
XGKJQquYqJxeGNjhqq7BKyy0PMKvI/YPSCjvP5VWxdjMqm1OndVdUO7XfHPI
0Miaf7C5KJkfhLBOeentZ5tZT/vaDEGl6X/b2B6XtZkHvu+xPptZucB6AZSL
FX852Q6x4ynVWerlBQj7SnzBcdswa1DCF9j7GNw3ebbccR1hN4zvHd1RvQhJ
4Xh9KPA+Czp4/uDg50swO5IUM31ilGkqaod2BS5DshaL8xvH2ENzhwPtm40w
6lJ367hsgmkyrR9oeoU4R3lYXqgXykNEuFLF84oXuh3ONIhQQ3k6ybfqy/3N
8CnKOzPHwU+lN8MjxMMIfpHxPmJ0JF5V9i32TdfEuJN4upn+cx3mEm/O3wIL
qQ/xslRLgVSCEdQXz6s9re5pEkTqU5jurJd8SoInqW+jKxfrT4dIUU59LKvs
UKibpIjU1+agd46c2SlDBfU5RZxrN6KRYTT1fYryGOB5QAbllcDzAiXlOc7z
hHbKO5bnDVeIxx7OA9KIl4rzAgPxfJ3zhF3EW8F5g576kMf7APXUF1/eFxim
PiHvE3hT35D3DUKpjw28j/Am9TWd9xVU1GcB7zPk/bvvMEo+EH82TL4Qf/Yi
+UT8mZZ8I/5sgnwk/sycfCX+rIh8Jv4sm3wn/qyA7gHxZ9l0L4g/W9jM7wnx
Z2K6N8Sf/Uz3iPizcrpXxJ8V0j0j/iyF7h3xZx8mDluqt8nwSR6zAd4r/SVS
JP8he6U1L9FOiuQ/dPb3OR+okCD5D8mxnZfPO0uQ/Id1DZcLsuoskPwHZZd7
l4enBZL/YMLdvgHJf4iOWhsxkv+QPfPZg9WHZkj+Q4PXdreWT82Q/Ifv3w67
2v+MGZL/YC1Uer9fIkLyH4LfcvxN4yFC8h88Ss99Hd0tRPIfvlyKMViphUj+
w99Wjg7o
      "], 
      {RGBColor[0.5, 0., 0.], Arrowheads[{{0.02554714064914992, 0.7}}], 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] \[Element] \
['A','Z']\"", Larger, Bold, StripOnInput -> False], StripOnInput -> False], 
                TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{1, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 
         20, 2}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] = '('\"", 
                  Larger, Bold, StripOnInput -> False], StripOnInput -> 
                 False], TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{1, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
         35, 36, 3}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] = '_'  \[Or]  \
f\[LeftDoubleBracket]1\[RightDoubleBracket] \[Element] ['0','9']\"", Larger, 
                  Bold, StripOnInput -> False], StripOnInput -> False], 
                TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{2, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 
         51, 52, 4}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] = ')'  \[Or]  \
f = \\\"\\\"\"", Larger, Bold, StripOnInput -> False], StripOnInput -> False],
                 TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{2, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 
         67, 68, 1}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] = '_'  \[Or]  \
f\[LeftDoubleBracket]1\[RightDoubleBracket] \[Element] ['0','9']\"", Larger, 
                  Bold, StripOnInput -> False], StripOnInput -> False], 
                TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{3, 4}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] = ')'  \[Or]  \
f = \\\"\\\"\"", Larger, Bold, StripOnInput -> False], StripOnInput -> False],
                 TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{3, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 
         83, 84, 1}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] \[Element] \
['A','Z']\"", Larger, Bold, StripOnInput -> False], StripOnInput -> False], 
                TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{4, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 
         99, 100, 2}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] = ')'  \[Or]  \
f = \\\"\\\"\"", Larger, Bold, StripOnInput -> False], StripOnInput -> False],
                 TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.02554714064914992, 0.8}}], 
        ArrowBox[{4, 1}]}}], {
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[0.85]], 
       DiskBox[{0., 0.}, {0.46799999999999997, 0.324}], InsetBox[
        StyleBox["\<\"Caller\"\>", "Courier",
         StripOnInput->False,
         FontFamily->10,
         FontWeight->Bold], {0., 0.}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
       DiskBox[{2., 1.}, 0.36], InsetBox[
        StyleBox["\<\"Element\\nSequence\"\>", "Courier",
         StripOnInput->False,
         FontFamily->10,
         FontWeight->Bold], {2., 1.}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
       DiskBox[{2., -1.}, 0.36], InsetBox[
        StyleBox["\<\"Submolecule\"\>", "Courier",
         StripOnInput->False,
         FontFamily->10,
         FontWeight->Bold], {2., -1.}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
       DiskBox[{4., 0.}, 0.36], InsetBox[
        StyleBox["\<\"Replication\"\>", "Courier",
         StripOnInput->False,
         FontFamily->10,
         FontWeight->Bold], {4., 0.}]}}},
    ContentSelectable->True],
   Annotation[#, 
    VertexCoordinateRules -> {{0., 0.}, {2., 1.}, {2., -1.}, {4., 0.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{692.9333333333324, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.494619148111576*^9, {3.494619217945861*^9, 3.49461924042733*^9}, 
   3.494619288645938*^9, {3.494619357352759*^9, 3.49461938328868*^9}, {
   3.494619418563044*^9, 3.49461943507056*^9}, {3.4946195302056503`*^9, 
   3.494619550480962*^9}, 3.4946196119992743`*^9, {3.494619765742807*^9, 
   3.494619821762848*^9}, {3.494619960030121*^9, 3.494620015648806*^9}, {
   3.494620092243845*^9, 3.494620113190021*^9}, {3.4946201432959223`*^9, 
   3.494620181911964*^9}, {3.494620294941971*^9, 3.494620309719953*^9}, 
   3.494620358522788*^9, 3.4946203888097*^9, {3.494620550370614*^9, 
   3.494620567249301*^9}, {3.494620633976089*^9, 3.494620662307732*^9}, {
   3.494620700321271*^9, 3.494620778582052*^9}, 3.494621020053083*^9, 
   3.494621056070381*^9, {3.494621203712112*^9, 3.494621226941374*^9}, {
   3.494621303368074*^9, 3.494621339308422*^9}, 3.494629697056738*^9, 
   3.494629731252584*^9, 3.494629762824924*^9, {3.4946498161718616`*^9, 
   3.4946498398013372`*^9}}]
}, Open  ]],

Cell["\<\
For each mode we can program a function that would take as arguments a \
formula string, syntactic tree, and the number of encountered left \
parentheses unmatched by right parentheses. According to its mode each \
function would drop characters from the begining of the formula string, \
change the syntactic tree, and either return the changed formula and tree as \
a result, or invoke another mode function using them as arguments.\
\>", "Text",
 CellChangeTimes->{{3.494630471348978*^9, 3.4946305070130367`*^9}, {
  3.494648387047565*^9, 3.49464844975791*^9}, {3.494648505805476*^9, 
  3.4946485626697903`*^9}, {3.494648593583028*^9, 3.494648597141281*^9}, {
  3.4946488708961*^9, 3.4946490346852503`*^9}, {3.494649189311907*^9, 
  3.494649264108925*^9}, {3.4946499385796137`*^9, 3.494649983029396*^9}, {
  3.494650032839571*^9, 3.4946500343251047`*^9}, {3.494650070148856*^9, 
  3.4946501465412683`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["First implementation", "Subsection",
 CellChangeTimes->{{3.495045296697412*^9, 3.495045307361532*^9}}],

Cell[CellGroupData[{

Cell["Tests of the first character", "Subsubsection",
 CellChangeTimes->{{3.494650598407784*^9, 3.494650615733089*^9}, {
  3.4947334308974123`*^9, 3.494733460703011*^9}}],

Cell["\<\
Before proceeding further let us define for each type of characters a \
function that would give true if the first character in a formula belongs to \
function's type.\
\>", "Text",
 CellChangeTimes->{{3.494570027488751*^9, 3.4945700726316032`*^9}, {
  3.49457181491595*^9, 3.494571818825095*^9}, {3.494616968706506*^9, 
  3.494617094680458*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CapitalLetterFirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{"StartOfString", "~~", 
      RowBox[{"CharacterRange", "[", 
       RowBox[{"\"\<A\>\"", ",", "\"\<Z\>\""}], "]"}], "~~", "___"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DigitFirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{"StartOfString", "~~", "DigitCharacter", "~~", "___"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftParethesisFirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{"StartOfString", "~~", "\"\<(\>\"", "~~", "___"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RightParethesisFirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{"StartOfString", "~~", "\"\<)\>\"", "~~", "___"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UnderscoreFirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{"StartOfString", "~~", "\"\<_\>\"", "~~", "___"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.494319660109632*^9, 3.494319743930101*^9}, {
   3.4943197828889513`*^9, 3.4943197964819393`*^9}, {3.4943198938275337`*^9, 
   3.494319909834494*^9}, {3.494571545201881*^9, 3.49457157093854*^9}, 
   3.495144841634818*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Element sequence parsing mode", "Subsubsection",
 CellChangeTimes->{{3.494650622980978*^9, 3.494650630365521*^9}, {
  3.494650662412916*^9, 3.4946506633571463`*^9}}],

Cell[TextData[{
 "Let us program the part of the parser that deals with the first group of \
character sequences in in Table 2.1. We note that in that first group except \
the \"letter followed by letter\" case in all the rest after the last letter \
read we encounter a non-letter character and hence we have already read a \
name of an element. If we reach a digit we need to switch into parsing a \
formula part described by ",
 StyleBox["<replicated>", "Program"],
 "; if we reach left parenthesis we need to switch into parsing a \
sub-molecule. If the formula is empty or the first character is right \
parenthesis we return the data structure with the accumulated parsed entities."
}], "Text",
 CellChangeTimes->{{3.4945694637105083`*^9, 3.494569584815606*^9}, {
  3.494569680824707*^9, 3.494569927231658*^9}, {3.494615885908328*^9, 
  3.494615914976671*^9}, {3.494615971874771*^9, 3.4946160035342493`*^9}, {
  3.4946169191063967`*^9, 3.494616927569271*^9}, {3.494617123661405*^9, 
  3.494617194201489*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ParseElementSequence", "[", 
    RowBox[{"treeArg_Molecule", ",", "formulaArg_String", ",", "level_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tree", "=", "treeArg"}], ",", 
        RowBox[{"formula", "=", "formulaArg"}], ",", "w", ",", "t"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Extract", " ", "elements", " ", "from", " ", "the", " ", "begining", 
        " ", "of", " ", "the", " ", "formula", " ", "string"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"w", "=", 
        RowBox[{"StringCases", "[", 
         RowBox[{"formula", ",", 
          RowBox[{"RegularExpression", "[", "\"\<^[a-zA-Z]+\>\"", "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"w", "=", 
        RowBox[{"w", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"t", "=", 
        RowBox[{"GetElements", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "for", " ", "redundant", " ", "letters"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "[", 
           RowBox[{"StringJoin", "[", "t", "]"}], "]"}], "=!=", 
          RowBox[{"StringLength", "[", "w", "]"}]}], ",", 
         RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Drop", " ", "the", " ", "letters", " ", "of", " ", "the", " ", 
         "obtained", " ", "elements"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"formula", "=", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"formula", ",", 
          RowBox[{"StringLength", "[", "w", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Append", " ", "each", " ", "element", " ", "name", " ", "to", " ", 
         "the", " ", "data", " ", "structure"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"tree", "=", 
        RowBox[{"Fold", "[", 
         RowBox[{"Append", ",", "tree", ",", "t"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Choose", " ", "an", " ", "action", " ", "according", " ", "to", " ", 
         "the", " ", "first", " ", "character", " ", "in", " ", "the", " ", 
         "formula", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"formula", "\[Equal]", "\"\<\>\""}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RightParethesisFirstQ", "[", "formula", "]"}], "&&", 
            RowBox[{"level", ">", "0"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"DigitFirstQ", "[", "formula", "]"}], ",", 
         RowBox[{"ParseReplication", "[", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"UnderscoreFirstQ", "[", "formula", "]"}], ",", 
         RowBox[{"ParseReplication", "[", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LeftParethesisFirstQ", "[", "formula", "]"}], ",", 
         RowBox[{"ParseSubMolecule", "[", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "]"}], ",", 
         "\[IndentingNewLine]", "True", ",", "$Failed"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"CapitalLetterFirstQ", "[", "formulaArg", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.494278460147875*^9, 3.4942785018250637`*^9}, {
   3.494278548218536*^9, 3.494278581392293*^9}, {3.49427863189084*^9, 
   3.494278701371698*^9}, {3.4942787388537283`*^9, 3.494278769493989*^9}, {
   3.4942788353587847`*^9, 3.4942788686610823`*^9}, {3.494279660697146*^9, 
   3.494279672829597*^9}, {3.494283166659258*^9, 3.494283258749546*^9}, {
   3.494283294003528*^9, 3.494283296009294*^9}, {3.494285820213026*^9, 
   3.4942858360368347`*^9}, {3.4942859394213953`*^9, 3.49428593973003*^9}, {
   3.494286657851851*^9, 3.4942866607453833`*^9}, {3.494319519684943*^9, 
   3.4943196534739037`*^9}, {3.4943199614326963`*^9, 3.49431996762571*^9}, {
   3.494320063995408*^9, 3.494320065577959*^9}, {3.4943201104768553`*^9, 
   3.494320264338526*^9}, {3.494320971868062*^9, 3.494321005624354*^9}, {
   3.494321559061605*^9, 3.4943215602694798`*^9}, {3.494321606789344*^9, 
   3.494321626069118*^9}, 3.494322595629827*^9, {3.494322736814213*^9, 
   3.49432275280206*^9}, 3.4943231782433453`*^9, {3.494323288382782*^9, 
   3.4943232917104607`*^9}, {3.494569983318074*^9, 3.49456998443721*^9}, {
   3.494616193328155*^9, 3.494616203054461*^9}, {3.4946163183901043`*^9, 
   3.494616326566524*^9}, {3.494616359445509*^9, 3.49461644033327*^9}, {
   3.494616577501853*^9, 3.494616584018865*^9}, {3.494616616764298*^9, 
   3.494616865923847*^9}, {3.494650772168663*^9, 3.4946507778003597`*^9}, {
   3.494650905322414*^9, 3.494650920774456*^9}, {3.4947335063731527`*^9, 
   3.4947335103001966`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Replication parsing mode", "Subsubsection",
 CellChangeTimes->{{3.4946506394129744`*^9, 3.494650669149708*^9}}],

Cell[TextData[{
 "Next we are going to program the functions that react to reading a number. \
Or in other words, the functions that establish that the rule ",
 StyleBox["<connected>", "Program"],
 " from BNF is applicable."
}], "Text",
 CellChangeTimes->{{3.49503987232067*^9, 3.4950399091531353`*^9}, {
  3.495041689878387*^9, 3.495041846913617*^9}}],

Cell[TextData[{
 "The production rule for the symbol ",
 StyleBox["<connected>", "Program"],
 " gives two cases: (1) a ",
 StyleBox["<molecule>", "Program"],
 " string and a ",
 StyleBox["<number>", "Program"],
 " strin a separated by the underscore symbol, of (2) a ",
 StyleBox["<molecule>", "Program"],
 " string and a ",
 StyleBox["<number>", "Program"],
 " string a next to each other. We are going to give two definitions of the \
function ",
 StyleBox["ParseReplication", "Program"],
 ", one for each case respectively."
}], "Text",
 CellChangeTimes->{{3.495042414302863*^9, 3.495042620489769*^9}, {
  3.4950428783324823`*^9, 3.495042887281488*^9}, {3.495043056866151*^9, 
  3.495043125707735*^9}}],

Cell[TextData[{
 "Assume the first symbol of the string parsed in the underscore. Then \
according to BNF we expect a digit after it. We drop the underscore. If the \
first character is a digit then we have can say that we have reduced the \
first case to the second case, and hence, we call the second definition of \
the ",
 StyleBox["ParseReplication", "Program"],
 ". If the fist character is not a digit, then we have an error. The first \
signature of ",
 StyleBox["ParseReplication", "Program"],
 " corresponds to this algorithm:"
}], "Text",
 CellChangeTimes->{{3.495041876883709*^9, 3.4950419883779078`*^9}, {
  3.495042146940875*^9, 3.495042193257351*^9}, {3.495042229433961*^9, 
  3.495042397395006*^9}, {3.495042899997983*^9, 3.4950430395308332`*^9}, {
  3.495043135298643*^9, 3.49504330772535*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ParseReplication", "[", 
    RowBox[{"tree_Molecule", ",", "formulaArg_String", ",", "level_"}], "]"}],
    ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "formula", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Drop", " ", "the", " ", "underscore", " ", "symbol"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"formula", "=", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"formulaArg", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Proceed", " ", "with", " ", "replication", " ", "parsing", " ", "if",
          " ", "possible"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DigitFirstQ", "[", "formula", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ParseReplication", "[", 
          RowBox[{"tree", ",", "formula"}], "]"}], ",", "\[IndentingNewLine]",
          "$Failed"}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"UnderscoreFirstQ", "[", "formulaArg", "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.49427871060213*^9, 3.494278730717525*^9}, {
   3.4942787956688547`*^9, 3.494278831528695*^9}, {3.4942788768823977`*^9, 
   3.494279055143342*^9}, 3.494279160043522*^9, {3.494279378447418*^9, 
   3.494279378909539*^9}, {3.494279677293407*^9, 3.494279684433565*^9}, {
   3.494283501916156*^9, 3.4942835643016443`*^9}, {3.4943202844133987`*^9, 
   3.494320392412148*^9}, 3.4943215656967688`*^9, {3.4943228167576036`*^9, 
   3.4943228314540043`*^9}, {3.494322910261582*^9, 3.494322910778821*^9}, {
   3.494650816836791*^9, 3.494650828785632*^9}, {3.494650860994094*^9, 
   3.494650862033722*^9}, {3.494651027284685*^9, 3.494651032049625*^9}, {
   3.494651195102317*^9, 3.494651204172153*^9}, {3.494651351220982*^9, 
   3.494651446054049*^9}}],

Cell[TextData[{
 "Assume the first character of the parsed string is a digit. First we read \
all digits next to each other at the beginning of the parsed string. We drop \
them, and we make a number ",
 StyleBox["num", "Program"],
 " from them (using ",
 StyleBox["FromDigits", "Program"],
 "). Then, as explained in the sub-section \"The basic idea\" we change the \
last expression (node) in the parse tree from tree\[LeftDoubleBracket]-1\
\[RightDoubleBracket] to Replicated[tree\[LeftDoubleBracket]-1\
\[RightDoubleBracket],num]. Finaly, we test the first character of the \
(modified) parsed string, and call a corresponding function,  or return the \
(modified) parse tree as a result, or return failure. (See the parse mode \
switching diagram.) The second signature of ParseReplication corresponds to \
the algorithm outlined in this paragraph:"
}], "Text",
 CellChangeTimes->{{3.495042202516082*^9, 3.495042248969686*^9}, {
  3.495043323261715*^9, 3.495043345610168*^9}, {3.495043474910084*^9, 
  3.495044053113467*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ParseReplication", "[", 
    RowBox[{"treeArg_Molecule", ",", "formulaArg_String", ",", "level_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tree", "=", "treeArg"}], ",", 
        RowBox[{"formula", "=", "formulaArg"}], ",", "num"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Extract", " ", "number", " ", "from", " ", "the", " ", "begining", 
        " ", "of", " ", "the", " ", "formula", " ", "string"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"num", "=", 
        RowBox[{"StringCases", "[", 
         RowBox[{"formula", ",", 
          RowBox[{"RegularExpression", "[", "\"\<^\\\\d+\>\"", "]"}], ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"num", "=", 
        RowBox[{"num", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Drop", " ", "the", " ", "characters", " ", "of", " ", "the", " ", 
         "number", " ", "found"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"formula", "=", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"formula", ",", 
          RowBox[{"StringLength", "[", "num", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Replicate", " ", "the", " ", "last", " ", "parsed", " ", "node"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tree", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{"Replicated", "[", 
         RowBox[{
          RowBox[{"tree", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"FromDigits", "[", "num", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Choose", " ", "an", " ", "action", " ", "according", " ", "to", " ", 
         "the", " ", "first", " ", "character", " ", "in", " ", "the", " ", 
         "formula"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"formula", "\[Equal]", "\"\<\>\""}], "||", 
          RowBox[{
           RowBox[{"RightParethesisFirstQ", "[", "formula", "]"}], "&&", 
           RowBox[{"level", ">", "0"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CapitalLetterFirstQ", "[", "formula", "]"}], ",", 
         RowBox[{"ParseElementSequence", "[", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LeftParethesisFirstQ", "[", "formula", "]"}], ",", 
         RowBox[{"ParseSubMolecule", "[", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "]"}], ",", 
         "\[IndentingNewLine]", "True", ",", "$Failed"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"DigitFirstQ", "[", "formulaArg", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.49427871060213*^9, 3.494278730717525*^9}, {
   3.4942787956688547`*^9, 3.494278831528695*^9}, {3.4942788768823977`*^9, 
   3.494279055143342*^9}, 3.494279160043522*^9, {3.494279378447418*^9, 
   3.494279378909539*^9}, {3.494279677293407*^9, 3.494279684433565*^9}, {
   3.494283310677986*^9, 3.494283333660501*^9}, {3.494283435316429*^9, 
   3.494283479032748*^9}, {3.4943204117309017`*^9, 3.494320528961426*^9}, {
   3.4943210239168377`*^9, 3.49432104222086*^9}, {3.4943214498072357`*^9, 
   3.494321522819972*^9}, 3.494321568791741*^9, {3.4943222551810293`*^9, 
   3.4943222617241573`*^9}, {3.494322292580778*^9, 3.494322346385263*^9}, {
   3.494322938468321*^9, 3.494322939585741*^9}, {3.494323261653572*^9, 
   3.494323269413316*^9}, {3.494650805917094*^9, 3.494650824463243*^9}, {
   3.4946510329765*^9, 3.4946510453068132`*^9}, {3.494651212872952*^9, 
   3.494651329121295*^9}, {3.494651447580531*^9, 3.494651470136693*^9}, {
   3.494652136045141*^9, 3.494652136420723*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sub-molecule parsing mode", "Subsubsection",
 CellChangeTimes->{{3.49465064934925*^9, 3.494650672749587*^9}, {
  3.690037941678075*^9, 3.6900379427917833`*^9}}],

Cell["\<\
Next we are going to program the functions that react to reading a \
sub-molecule. Or in other words, the functions that establish that the rule \
<submolecule> from BNF is applicable.\
\>", "Text",
 CellChangeTimes->{{3.49503987232067*^9, 3.4950399091531353`*^9}, {
   3.495041689878387*^9, 3.495041846913617*^9}, {3.495044268565571*^9, 
   3.495044289242288*^9}, {3.495044818861045*^9, 3.4950448191937227`*^9}, 
   3.690037945773028*^9}],

Cell["\<\
Assume the first character of the parsed string is left parenthesis, '('. \
Then we drop and try to parse a molecule until we reach a matching right \
parenthesis, ')'. If failure does not occur, we append to the parse tree the \
parse tree of the sub-molecule. Finally, we test the first character of the \
(modified) parsed string, and call a corresponding function,  or return the \
(modified) parse tree as a result, or return failure. (See the parse mode \
switching diagram.) \
\>", "Text",
 CellChangeTimes->{{3.49504483334676*^9, 3.495044900337737*^9}, {
  3.495044954897581*^9, 3.49504516846896*^9}, {3.690037948889513*^9, 
  3.690037951431986*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ParseSubMolecule", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParseSubMolecule", "[", 
    RowBox[{"treeArg_Molecule", ",", "formulaArg_", ",", "level_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tree", "=", "treeArg"}], ",", "formula", ",", "t", ",", 
        "l"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Drop", " ", "'"}], 
        RowBox[{"(", 
         RowBox[{
         "'", " ", "from", " ", "the", " ", "begining", " ", "of", " ", "the",
           " ", "formula"}], " "}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"formula", "=", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"formulaArg", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Recursive", " ", "call", " ", "in", " ", "order", " ", "to", " ", 
         "parse", " ", "the", " ", "submolecule"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"t", "=", 
        RowBox[{"ParseMolecule", "[", 
         RowBox[{
          RowBox[{"Molecule", "[", "]"}], ",", "formula", ",", 
          RowBox[{"level", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"t", "===", "$Failed"}], ",", 
         RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Assign", " ", "the", " ", "submolecule", " ", "tree", " ", "and", 
         " ", "processed", " ", "formula"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "formula"}], "}"}], "=", "t"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{" ", 
             RowBox[{
              RowBox[{
              "If", " ", "the", " ", "parentheses", " ", "are", " ", 
               "balanced"}], ",", " ", 
              RowBox[{
               RowBox[{"i", ".", "e", ".", " ", "if"}], " ", "there", " ", 
               "is", " ", "a", " ", 
               RowBox[{"closing", "\[IndentingNewLine]", "'"}]}]}], ")"}], 
            "'"}], ",", " ", 
           RowBox[{
           "append", " ", "the", " ", "submolecule", " ", "structure", " ", 
            "to", " ", "the", " ", "tree", " ", "and", " ", 
            RowBox[{"drop", " ", "'"}]}]}], ")"}], "'"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"RightParethesisFirstQ", "[", "formula", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tree", ",", "formula"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{"tree", ",", "t"}], "]"}], ",", 
            RowBox[{"StringDrop", "[", 
             RowBox[{"formula", ",", "1"}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Choose", " ", "an", " ", "action", " ", "according", " ", "to", " ", 
         "the", " ", "first", " ", "character", " ", "in", " ", "the", " ", 
         "formula"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"formula", "\[Equal]", "\"\<\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"DigitFirstQ", "[", "formula", "]"}], ",", 
         RowBox[{"ParseReplication", "[", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"UnderscoreFirstQ", "[", "formula", "]"}], ",", 
         RowBox[{"ParseReplication", "[", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LeftParethesisFirstQ", "[", "formula", "]"}], ",", 
         RowBox[{"ParseSubMolecule", "[", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "]"}], ",", 
         "\[IndentingNewLine]", "True", ",", "$Failed"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"LeftParethesisFirstQ", "[", "formulaArg", "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4942791648848743`*^9, 3.4942792179943237`*^9}, {
   3.49427925744661*^9, 3.4942793552975607`*^9}, {3.49427939242144*^9, 
   3.494279430005376*^9}, {3.494279690134836*^9, 3.494279725829481*^9}, {
   3.494279949605999*^9, 3.4942799949851093`*^9}, {3.4942836060924587`*^9, 
   3.494283612537311*^9}, {3.494284792785213*^9, 3.494284793976798*^9}, {
   3.494285840697603*^9, 3.4942858417755833`*^9}, {3.494320541177791*^9, 
   3.494320557278174*^9}, {3.49432061940676*^9, 3.494320814213379*^9}, {
   3.494320921577952*^9, 3.4943209257524652`*^9}, {3.494321074011067*^9, 
   3.494321170061468*^9}, 3.4943215722469187`*^9, {3.494321674717966*^9, 
   3.494321698226287*^9}, {3.49432173094552*^9, 3.494321770178114*^9}, {
   3.4943219325680447`*^9, 3.494321935328393*^9}, {3.494322403250698*^9, 
   3.494322412008041*^9}, {3.494322444897126*^9, 3.4943224538920794`*^9}, {
   3.494650476025621*^9, 3.494650500712988*^9}, {3.4946508432524157`*^9, 
   3.4946508444365673`*^9}, {3.494651046011948*^9, 3.494651059965478*^9}, {
   3.49465151386383*^9, 3.4946516393545847`*^9}, {3.494651673602775*^9, 
   3.494651859569943*^9}, {3.494651891308979*^9, 3.494651940210127*^9}, {
   3.4946519970908537`*^9, 3.494652033507414*^9}, {3.494652068821953*^9, 
   3.494652083515396*^9}, {3.494652115264469*^9, 3.494652147860428*^9}, {
   3.495322333797179*^9, 3.49532233411784*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The caller", "Subsubsection",
 CellChangeTimes->{{3.495132972581874*^9, 3.4951329740062857`*^9}}],

Cell["\<\
Given a formula, we have to decide should we start with parsing an element \
sequence (if the first character is capital letter) or we should start with \
parsing a sub-molecule (if the first character is left parenthesis) or give \
failure. (See \"Caller\" node on Figure 2.1.)\
\>", "Text",
 CellChangeTimes->{{3.495133012765596*^9, 3.4951330475901947`*^9}, {
   3.495133078633271*^9, 3.495133324743878*^9}, 3.4951438892929277`*^9, 
   3.690037956216453*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ParseMolecule", "[", "formula_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"ParseMolecule", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", "]"}], ",", "formula", ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParseMolecule", "[", 
    RowBox[{"treeArg_", ",", "formulaArg_", ",", "levelArg_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "tree", ",", "formula", ",", "level"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tree", ",", "formula", ",", "level"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"treeArg", ",", "formulaArg", ",", "levelArg"}], "}"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"t", "=", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CapitalLetterFirstQ", "[", "formula", "]"}], ",", 
         RowBox[{"ParseElementSequence", "[", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LeftParethesisFirstQ", "[", "formula", "]"}], ",", 
         RowBox[{"ParseSubMolecule", "[", 
          RowBox[{"tree", ",", "formula", ",", "level"}], "]"}], ",", 
         "\[IndentingNewLine]", "True", ",", "$Failed"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "===", "$Failed"}], ",", "t", ",", 
        RowBox[{"Most", "[", "t", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.494280019178563*^9, 3.494280102653575*^9}, 
   3.494281710972406*^9, 3.49428224363836*^9, {3.49428586053362*^9, 
   3.494285879057906*^9}, {3.494286146500186*^9, 3.494286181831353*^9}, {
   3.494286212142001*^9, 3.494286212583338*^9}, {3.4942865050496187`*^9, 
   3.494286551007296*^9}, {3.494320854349517*^9, 3.494320889701823*^9}, {
   3.494321202301835*^9, 3.494321253660389*^9}, 3.4946508117264442`*^9, {
   3.49465106149268*^9, 3.4946510676316977`*^9}, {3.4950619224024487`*^9, 
   3.495061926848797*^9}, {3.495133009945689*^9, 3.495133011042622*^9}, {
   3.4953229323728952`*^9, 3.4953230105264177`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parsing examples", "Subsection",
 CellChangeTimes->{{3.495321096712267*^9, 3.495321116036277*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParseMolecule", "[", "\"\<Zn(SO2)3\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.4953211179795523`*^9, 3.495321133140875*^9}, {
  3.4953218392114973`*^9, 3.495321846694841*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Molecule", "[", 
    RowBox[{"\<\"Zn\"\>", ",", 
     RowBox[{"Replicated", "[", 
      RowBox[{
       RowBox[{"Molecule", "[", 
        RowBox[{"\<\"S\"\>", ",", 
         RowBox[{"Replicated", "[", 
          RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", "3"}], 
      "]"}]}], "]"}], ",", "\<\"\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.495321847525958*^9, 3.495321892515047*^9, {3.495322338441826*^9, 
   3.495322346939712*^9}, 3.495323307036621*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", 
  RowBox[{"%", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.49532330361386*^9, 3.495323315548737*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{0.4472135954999579, 3.5777087639996634`}, {0., 
    2.6832815729997477`}, {0.8944271909999159, 2.6832815729997477`}, {
    0.4472135954999579, 1.7888543819998317`}, {0., 0.8944271909999157}, {
    0.8944271909999159, 0.8944271909999157}, {0.4472135954999579, 0.}, {
    1.3416407864998738`, 0.}, {1.3416407864998738`, 1.7888543819998317`}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {3, 4}, {3, 9}, {4, 5}, {4, 6}, {6, 7}, {6, 
       8}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"\"Zn\"", ",", 
             RowBox[{"Replicated", "[", 
               RowBox[{
                 RowBox[{"Molecule", "[", 
                   RowBox[{"\"S\"", ",", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"O\"", ",", "2"}], "]"}]}], "]"}], ",", "3"}], 
               "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule["Zn", 
          $CellContext`Replicated[
           $CellContext`Molecule["S", 
            $CellContext`Replicated["O", 2]], 3]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Zn\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"Zn\"", HoldForm]],
       Annotation[#, 
        HoldForm["Zn"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{"\"S\"", ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"\"O\"", ",", "2"}], "]"}]}], "]"}], ",", "3"}], 
           "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated[
          $CellContext`Molecule["S", 
           $CellContext`Replicated["O", 2]], 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"\"S\"", ",", 
             RowBox[{"Replicated", "[", 
               RowBox[{"\"O\"", ",", "2"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule["S", 
          $CellContext`Replicated["O", 2]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"S\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"S\"", HoldForm]],
       Annotation[#, 
        HoldForm["S"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{"\"O\"", ",", "2"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated["O", 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"O\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"O\"", HoldForm]],
       Annotation[#, 
        HoldForm["O"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{0.4472135954999579, 3.5777087639996634`}, {0., 
     2.6832815729997477`}, {0.8944271909999159, 2.6832815729997477`}, {
     0.4472135954999579, 1.7888543819998317`}, {0., 0.8944271909999157}, {
     0.8944271909999159, 0.8944271909999157}, {0.4472135954999579, 0.}, {
     1.3416407864998738`, 0.}, {1.3416407864998738`, 1.7888543819998317`}}]& ],
  AspectRatio->NCache[Rational[5, 6]^Rational[1, 2], 0.9128709291752769],
  FrameTicks->Automatic,
  ImageSize->{242., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.495323317708544*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Code",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.49453111420924*^9, 3.4945311147201843`*^9}}],

Cell[CellGroupData[{

Cell["BNF symbol sequence cases", "Subsubsection",
 CellChangeTimes->{{3.4945311322620573`*^9, 3.494531145128293*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"symbolSequenceCases", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<a letter followed by a letter\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...ClF...\>\"", ",", 
         "\"\<...<element><element>...\>\"", ",", 
         "\"\<<connected> \[Rule] <element><element>\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<a letter followed by a digit\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...Cl2...\>\"", ",", 
         "\"\<...<element><number>...\>\"", ",", 
         "\"\<<replicated> \[Rule] <element><number>\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<a letter followed by _\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...O_2...\>\"", ",", 
         "\"\<...<element>_<number>...\>\"", ",", 
         "\"\<<replicated> \[Rule] <element><number>\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<a letter followed by (\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...H(Cl...\>\"", ",", 
         "\"\<...<element>\\\"(\\\"<element>...\>\"", ",", 
         "\"\<<connected> \[Rule] <element><molecule>\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<a letter followed by (...(\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...H((Cl\>\"", ",", 
         "\"\<...<element>\\\"(\\\"...\\\"(\\\"<element>...\>\"", ",", 
         "\"\<<connected> \[Rule] <element><molecule>\>\""}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<a digit followed by a capital letter\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...2H...\>\"", ",", 
         "\"\<...<number><element>...\>\"", ",", 
         "\"\<<replicated><element> or <replicated><replicated>\>\""}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<a digit followed by (\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...2(Mn..\>\"", ",", 
         "\"\<...<number>\\\"(\\\"...\>\"", ",", 
         "\"\<<replicated><molecule>\>\""}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<) followed by a capital letter\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...)C...\>\"", ",", 
         "\"\<...\\\")\\\"<element>...\>\"", ",", 
         "\"\<<molecule><molecule>\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<) followed by a digit\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...)3...\>\"", ",", 
         "\"\<...\\\")\\\"<number>...\>\"", ",", "\"\<<replicated>\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<) followed by _\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...)_3...\>\"", ",", 
         "\"\<...\\\")\\\"_<number>...\>\"", ",", "\"\<<replicated>\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<) followed by (\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...)(C...\>\"", ",", 
         "\"\<...\\\")\\\"\\\"(\\\"<element>...\>\"", ",", 
         "\"\<<molecule><molecule>\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\"\<) followed by (...(\>\"",
          StripOnInput->False,
          FontFamily->Times], ",", "\"\<...)((Cl...\>\"", ",", 
         "\"\<...\\\")\\\"\\\"(\\\"...\\\"(\\\"<element>...\>\"", ",", 
         "\"\<<connected> repeated\>\""}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"symbolSequenceCases", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"#", ",", 
        RowBox[{"FontFamily", "\[Rule]", "Times"}]}], "]"}], "&"}], ",", 
     RowBox[{"symbolSequenceCases", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Join", "@@", "symbolSequenceCases"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"#", ",", "Bold", ",", "Italic"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
       "\"\<description\>\"", ",", "\"\<example\>\"", ",", 
        "\"\<BNF symbol sequence\>\"", ",", "\"\<rule of derivation\>\""}], 
       "}"}]}]}], "]"}], ",", 
   RowBox[{"Dividers", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"False", ",", 
                RowBox[{"{", 
                 RowBox[{"#", "-", "1"}], "}"}]}], "]"}], "&"}], ",", 
             RowBox[{"Length", "/@", "symbolSequenceCases"}]}], "]"}], ",", 
           "True", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
        "True"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"Alignment", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Left", ",", "Center", ",", "Left", ",", "Left"}], "}"}], ",", 
      "Center"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.494450169973887*^9, 3.494450401420858*^9}, {
   3.4944504636512003`*^9, 3.494450538540606*^9}, {3.494450615340048*^9, 
   3.4944506963667107`*^9}, {3.494450801687591*^9, 3.494450830597701*^9}, 
   3.4944510150023193`*^9, {3.49445130208729*^9, 3.494451386184843*^9}, 
   3.4944542124951563`*^9, {3.494454244814929*^9, 3.494454421416497*^9}, {
   3.494454465552382*^9, 3.49445447616849*^9}, {3.4944545109925947`*^9, 
   3.4944545469618263`*^9}, {3.494454623200865*^9, 3.494454688865313*^9}, {
   3.4944549073802357`*^9, 3.49445494391786*^9}, {3.494455120863741*^9, 
   3.4944551314906483`*^9}, {3.494455297965201*^9, 3.494455326058888*^9}, {
   3.494455974491273*^9, 3.494455982658922*^9}, {3.4944578630130043`*^9, 
   3.494458168859931*^9}, {3.49445829805694*^9, 3.4944583260704517`*^9}, {
   3.49445840253543*^9, 3.4944584633638287`*^9}, {3.494459030898418*^9, 
   3.4944590355906267`*^9}, 3.4944593651557093`*^9, {3.4944595768946*^9, 
   3.4944597852256317`*^9}, {3.494459827595832*^9, 3.4944600087642593`*^9}, {
   3.494460402488583*^9, 3.49446048020494*^9}, 3.4944607857145987`*^9, {
   3.494473922758832*^9, 3.494473934996992*^9}, {3.494544782359069*^9, 
   3.494544843778903*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"description\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"example\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"BNF symbol sequence\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"rule of derivation\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic]},
    {
     StyleBox[
      StyleBox["\<\"a letter followed by a letter\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...ClF...\"\>", "\<\"...<element><element>...\"\>", \
"\<\"<connected> \[Rule] <element><element>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a letter followed by a digit\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...Cl2...\"\>", "\<\"...<element><number>...\"\>", \
"\<\"<replicated> \[Rule] <element><number>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a letter followed by _\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...O_2...\"\>", "\<\"...<element>_<number>...\"\>", \
"\<\"<replicated> \[Rule] <element><number>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a letter followed by (\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...H(Cl...\"\>", "\<\"...<element>\\\"(\\\"<element>...\"\
\>", "\<\"<connected> \[Rule] <element><molecule>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a letter followed by (...(\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...H((Cl\"\>", \
"\<\"...<element>\\\"(\\\"...\\\"(\\\"<element>...\"\>", "\<\"<connected> \
\[Rule] <element><molecule>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a digit followed by a capital letter\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...2H...\"\>", "\<\"...<number><element>...\"\>", \
"\<\"<replicated><element> or <replicated><replicated>\"\>"},
    {
     StyleBox[
      StyleBox["\<\"a digit followed by (\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...2(Mn..\"\>", "\<\"...<number>\\\"(\\\"...\"\>", \
"\<\"<replicated><molecule>\"\>"},
    {
     StyleBox[
      StyleBox["\<\") followed by a capital letter\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...)C...\"\>", "\<\"...\\\")\\\"<element>...\"\>", \
"\<\"<molecule><molecule>\"\>"},
    {
     StyleBox[
      StyleBox["\<\") followed by a digit\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...)3...\"\>", "\<\"...\\\")\\\"<number>...\"\>", \
"\<\"<replicated>\"\>"},
    {
     StyleBox[
      StyleBox["\<\") followed by _\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...)_3...\"\>", "\<\"...\\\")\\\"_<number>...\"\>", \
"\<\"<replicated>\"\>"},
    {
     StyleBox[
      StyleBox["\<\") followed by (\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...)(C...\"\>", \
"\<\"...\\\")\\\"\\\"(\\\"<element>...\"\>", "\<\"<molecule><molecule>\"\>"},
    {
     StyleBox[
      StyleBox["\<\") followed by (...(\"\>",
       StripOnInput->False,
       FontFamily->Times],
      StripOnInput->False,
      FontFamily->
       Times], "\<\"...)((Cl...\"\>", \
"\<\"...\\\")\\\"\\\"(\\\"...\\\"(\\\"<element>...\"\>", "\<\"<connected> \
repeated\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{
    "Columns" -> {Left, Center, Left, Left}, "Rows" -> {{Center}}},
   GridBoxDividers->{
    "Columns" -> {{True}}, 
     "Rows" -> {
      True, True, False, False, False, False, True, False, True, False, False,
        False, False, True}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.494450712979507*^9, 3.4944507330303698`*^9}, {
   3.49445076561901*^9, 3.494450774647768*^9}, {3.494450811345806*^9, 
   3.494450833619546*^9}, 3.494451019314104*^9, {3.494451318955532*^9, 
   3.4944513638097763`*^9}, {3.494455424857082*^9, 3.494455531361493*^9}, {
   3.4944555627553253`*^9, 3.49445559005847*^9}, 3.494455677745133*^9, {
   3.494455726321995*^9, 3.4944557562981443`*^9}, 3.494455830610435*^9, {
   3.4944558916454782`*^9, 3.4944559524986553`*^9}, 3.494455984590043*^9, {
   3.494458158095083*^9, 3.4944581807120237`*^9}, {3.494458226451635*^9, 
   3.494458237323739*^9}, 3.4944583317354937`*^9, 3.494458466345314*^9, 
   3.494459053055666*^9, 3.4944593697809153`*^9, 3.49446001397276*^9, 
   3.494460234278028*^9, {3.494460458471369*^9, 3.4944604826310167`*^9}, 
   3.4944605443942823`*^9, 3.494473945434968*^9, 3.494533994134932*^9, {
   3.49454479013874*^9, 3.4945448134433203`*^9}, 3.494544844157455*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Which symbols can follow a given symbol", "Subsubsection",
 CellChangeTimes->{{3.494531154584659*^9, 3.494531210152409*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"characterType", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"#", ",", "Bold", ",", "Italic"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{
     "\"\<capital letter\>\"", ",", "\"\<small letter\>\"", ",", 
      "\"\<digit\>\"", ",", "\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\<_\>\""}],
      "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"canBeFollowed", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
       "True"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
       "True"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "True", ",", "False", ",", "True", ",", "True", ",", "True", ",", 
       "False"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "True", ",", "False", ",", "False", ",", "True", ",", "False", ",", 
       "False"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "True", ",", "False", ",", "True", ",", "True", ",", "True", ",", 
       "True"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "False", ",", "False", ",", "True", ",", "False", ",", "False", ",", 
       "False"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<character type\>\"", ",", "Bold", ",", "Italic"}], 
          "]"}], "}"}], ",", 
        RowBox[{"characterType", "/.", 
         RowBox[{"s_String", ":>", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"s", ",", 
            RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\\n\>\""}]}], "]"}]}]}]}], 
       "]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#2", ",", "#1"}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"#", ",", "Bold"}], "]"}], "&"}], "/@", "characterType"}],
          ",", 
         RowBox[{"canBeFollowed", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"True", "\[Rule]", "\"\<\[Checkmark]\>\""}], ",", 
            RowBox[{"False", "\[Rule]", "\"\<\>\""}]}], "}"}]}]}], "}"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ItemSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "8", "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"5", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "characterType", "]"}], "}"}]}], "]"}]}], 
       "]"}], ",", "Automatic"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Dividers", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "True"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"False", ",", 
          RowBox[{"{", "5", "}"}]}], "]"}], ",", 
        RowBox[{"{", "True", "}"}]}], "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "True"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"True", ",", 
          RowBox[{"{", "5", "}"}]}], "]"}], ",", 
        RowBox[{"{", "True", "}"}]}], "]"}]}], "}"}]}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ7bWVxVqP85XjmiPznUH0SY+VXiB6ktCsXBDt2N9V
CKK/Wr+uA9F20+Q6QbQH9+pJINoijXMGiHZvylgOoo8snr0WbN7pK4dA9LdW
Gz99IL3rsUIoiA7RWlwHoussLzeD6CUFTh0g+siHuZ0gOmWS1AQQ3Xc7C0xf
k7w1BUQrcf+ZBaK9T62fD6IPmOqvBNFqnodOg+imI57nQfQGrx83QTRDYvJL
EH3Pr4bVAEgvqrwJpjc8yeQB0aGbzXlBtLz+e2VfIL2pbqoGiL5gEasHoq+L
WFiD6PTQtU4gujvPzwtEAwB+BIC1
  "]],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"character type\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"capital\\nletter\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"small\\nletter\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"digit\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"(\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\")\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"_\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic]},
    {
     StyleBox[
      StyleBox["\<\"capital letter\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\
\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\
\[Checkmark]\"\>"},
    {
     StyleBox[
      StyleBox["\<\"small letter\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\
\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\
\[Checkmark]\"\>"},
    {
     StyleBox[
      StyleBox["\<\"digit\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\[Checkmark]\"\>", "\<\"\"\>", "\<\"\[Checkmark]\"\>", "\<\
\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\"\>"},
    {
     StyleBox[
      StyleBox["\<\"(\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\[Checkmark]\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\
\[Checkmark]\"\>", "\<\"\"\>", "\<\"\"\>"},
    {
     StyleBox[
      StyleBox["\<\")\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\[Checkmark]\"\>", "\<\"\"\>", "\<\"\[Checkmark]\"\>", "\<\
\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>", "\<\"\[Checkmark]\"\>"},
    {
     StyleBox[
      StyleBox["\<\"_\"\>",
       StripOnInput->False,
       FontWeight->Bold,
       FontSlant->Italic],
      StripOnInput->False,
      FontWeight->
       Bold], "\<\"\"\>", "\<\"\"\>", "\<\"\[Checkmark]\"\>", "\<\"\"\>", "\<\
\"\"\>", "\<\"\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{
    "Columns" -> {True, True, False, False, False, False, False, True}, 
     "Rows" -> {True, True, True, True, True, True, True, True}},
   GridBoxItemSize->{
    "Columns" -> {8, 5, 5, 5, 5, 5, 5}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.494537794634489*^9, 3.494537810720593*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Check first letter test functions", "Subsubsection",
 CellChangeTimes->{{3.494571944073112*^9, 3.494571957215699*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Outer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "[", "#2", "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "CapitalLetterFirstQ", ",", "DigitFirstQ", ",", "LeftParethesisFirstQ", 
      ",", "RightParethesisFirstQ", ",", "UnderscoreFirstQ"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<HC12\>\"", ",", "\"\<123Ca\>\"", ",", "\"\<(CH2)\>\"", ",", 
      "\"\<)2C12\>\"", ",", "\"\<_45C12\>\""}], "}"}]}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.494571629450742*^9, 3.494571798901641*^9}, {
  3.4945718840319357`*^9, 3.494571897379978*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"True", "False", "False", "False", "False"},
    {"False", "True", "False", "False", "False"},
    {"False", "False", "True", "False", "False"},
    {"False", "False", "False", "True", "False"},
    {"False", "False", "False", "False", "True"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.7]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.4945717530675697`*^9, 3.49457179903253*^9}, {
  3.494571886938774*^9, 3.4945718980940723`*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parser of chemical equations", "Section",
 CellChangeTimes->{{3.488071338108965*^9, 3.48807136599387*^9}, {
   3.492643429821102*^9, 3.492643460952256*^9}, 3.4928441269117107`*^9}],

Cell["\<\
After we have implemented a parser for chemical formulas, parsing a chemical \
formula seems easy. Given a string with a chemical equation, we start parsing \
it to get a molecule. That molecule would belong to the left hand side of the \
equation. If we reach a plus sign we drop it and continue to parse another \
molecule. If we reach a yield sign we drop it and start parsing molecules for \
the right hand sign.\
\>", "Text",
 CellChangeTimes->{{3.4950518865913153`*^9, 3.495051943119926*^9}, {
  3.495052089001627*^9, 3.4950523004315767`*^9}, {3.495052334240189*^9, 
  3.495052381239586*^9}, {3.690037960919134*^9, 3.6900379630082483`*^9}}],

Cell["\<\
So to summarize, in order to parse a chemical equation we need to call the \
chemical formula parser in between signs for mixing, '+', and yield, \
'\[Rule]', '->' , '='. This can be illustrated with the diagram on Figure 2.2.\
\>", "Text",
 CellChangeTimes->{{3.4947393789211283`*^9, 3.494739511408105*^9}, {
  3.494739753246415*^9, 3.494739776640101*^9}, {3.4947398157901154`*^9, 
  3.494739817992371*^9}, {3.4950527199108152`*^9, 3.495052740328199*^9}, {
  3.495133359676352*^9, 3.495133377369141*^9}}],

Cell[CellGroupData[{

Cell["Figure 2.2", "TableTitle",
 CellChangeTimes->{{3.4947397827927856`*^9, 3.494739787935911*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsGroupBox[{GraphicsComplexBox[CompressedData["
1:eJx1lX1QVFUYxnf5ZiFQdhcRREL8IMEUMHEMfI8KtEOEqw4JCButg5mQrgmE
hIkCo2VUaFIEKip+CyWMlGW+qJjijDZIDIGhaAvL1wKbe4FllyXxHP7YnfHO
3Hnnzr1zzznv+zy/x1u+bW2yBY/H2/H8nqgvuQgtWqDVjfxQPHF1g9l7NHuP
PQ/DZ27caEm2nvq5lN+lBffflNv8oqxI74I813FPDuyjglyuv2FN5i2Rtp5b
xYGwqam+1cuGLNWPuA3FciCttA1cKLAlGemz57QlcvB2/ZHGNK0tEZK49MS1
HBSMOYXIH9kRJ25nedYSDt55kiWqvG1PHJpPKkIFHLyokUIyP+HrG5zvf5D7
/q8WW68JydGzCYLUPg30Jb13zypQRL7ceuDO2WMaGOvOONRWLiJFEQKnupUa
CK//ZN1frmLy+t3U0damQQiLubz21j4xkcy7W+UcNwgR9od8C4bFpD1+aqVL
8QA8TT5ab7fJlShlQb2qpH4QXCgtLqwdB49368XHtc9geN3T24nBRriSnPPn
4s5nUNU+TVF2xQCCXdqSgnAtyP+Jy5cn6+HK42grPwcO2m95+HwYMwrLMldX
58wbgvPVN+Pdj+lgodXpsoV5wxCwf1bAfakO3IJdz9+x1sG3PO/LFQodNHTu
ncsVjAJwf/csMehAdto40jKmh4+j1kdv6xqFg7OqnfOXjsFhQ7m2dpYBxqWf
b148xwgXpD4dioNjMEP52VXJJSOo5bODC93HwUa27/DVBiMIcuVPfKKfz/s7
xyiLPCPclUT8ccTAI2eibqQF3x+DpVllloYv+ORVWV/VuWsGSAy1Fzj088mJ
Dp+ymi162NCw7ti4pwXhG2RpnmodbBl4rVU4zYLk2PhGKjeOwAG31d6NLXxy
LnKmXK8eAtz+IMg5hU+294aN3jvLgf/x6dN2N/JIyuaaWk2FFlojNAXOXjwi
WtWc4zNVC44ubYroaFdSGz0/qaheBWknXpH0tIhJXWhhakmiCvRxnRleyWIi
XaBThruoIEMsLnEZFBH/k2c+qFB1QouvYVNXloj8VCld/bitEzZ4BBTdshaR
tOmqykfaTli2Z+TJ/W+EJOfHU9JyfxXET8hqhpDs713zy8x8FfRNlBR7IpnQ
4Vtq0IccGPXJtSNJkva867Vq8Fu+InmoxJbsv7rXThLfD3b+Li1hNTZE4Zi/
a6poALI+mhK3/oE1Ida15f+qB+DTmMPx6YNWJO+UhfvvOwYhQ91S2THFisi8
6tJX8TSwfPHN1P4gS5LgGdQcW6qBMPYcS58xm32fQL/HPex/e+n/cDdbL4Su
h06m+8EAtt9sul/kh9LzxNLzoMb0vJjI+pFH+4GhrF/ZtF8oY/3MpP3Eh6zf
F2m/cafpPNBoOi/MYPO8Q+eJTmzedXTeaKYHNNMLXmN6UlA9oZne0EyPOKlX
HtUrmukZJ/XuRfWOZn5AB1O/YL+pn/Ciqd+wiPmRt+aFH3HSr4eoX9HMzzjp
90bqd1xkygOc5MUiyguc5MmblCdoxhu8xHjkQHmEQ6a8QnvGM3fKM2xnvBuk
vMMwxkMl5SGuYLyMorzElYyngZSnqGe8/Z7yFrsZj7+iPMYcxusyymu0Yzz3
pzxHCeO9I+U97mN54EzzAMNN8wIjWZ5k0jxBJ5Y3wTRv0JLl0VyaRygyzStU
sjxLpXmG/wPhL2Mm
      "], 
      {RGBColor[0.5, 0., 0.], Arrowheads[{{0.021167650531286893`, 0.7}}], 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] \[Element] \
['A','Z']  \[Or]  f\[LeftDoubleBracket]1\[RightDoubleBracket] = '('\"", 
                  Larger, Bold, StripOnInput -> False], StripOnInput -> 
                 False], TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.021167650531286893`, 0.8}}], 
        ArrowBox[{1, 2}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] \[Element] \
['A','Z'] \[Or] f\[LeftDoubleBracket]1\[RightDoubleBracket] = '('\"", Larger, 
                  Bold, StripOnInput -> False], StripOnInput -> False], 
                TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.021167650531286893`, 0.8}}], 
        ArrowBox[{2, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 
         21, 3}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] = '+'\"", 
                  Larger, Bold, StripOnInput -> False], StripOnInput -> 
                 False], TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.021167650531286893`, 0.8}}], 
        ArrowBox[{2, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 
         36, 37, 38, 39, 40, 41, 42, 43, 44, 2}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] = '\[Rule]'  \
\[Or]  f = '='  \[Or]  \
f\[LeftDoubleBracket]1;;2\[RightDoubleBracket]=\\\"->\\\"\"", Larger, Bold, 
                  StripOnInput -> False], StripOnInput -> False], 
                TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.021167650531286893`, 0.8}}], 
        ArrowBox[{2, 4}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] = '+' \[Or] f\
\[LeftDoubleBracket]1\[RightDoubleBracket] = '=' \[Or] f\[LeftDoubleBracket]1\
\[RightDoubleBracket] = '\[Rule]'\"", Larger, Bold, StripOnInput -> False], 
                 StripOnInput -> False], TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.021167650531286893`, 0.8}}], 
        ArrowBox[{3, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 
         59, 60, 2}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] \[Element] \
['A','Z'] \[Or] f\[LeftDoubleBracket]1\[RightDoubleBracket] = '('\"", Larger, 
                  Bold, StripOnInput -> False], StripOnInput -> False], 
                TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.021167650531286893`, 0.8}}], 
        ArrowBox[{4, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 
         75, 76, 5}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] = '+'\"", 
                  Larger, Bold, StripOnInput -> False], StripOnInput -> 
                 False], TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.021167650531286893`, 0.8}}], 
        ArrowBox[{4, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 
         91, 92, 93, 94, 95, 96, 97, 98, 99, 4}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f = \\\"\\\"\"", Larger, Bold, StripOnInput -> False], 
                 StripOnInput -> False], TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.021167650531286893`, 0.8}}], 
        ArrowBox[{4, 1}]}, 
       {Arrowheads[{{0.5, 0.5, 
           GraphicsBox[{
             GrayLevel[0], 
             InsetBox[
              BoxData[
               FormBox[
                StyleBox[
                 StyleBox[
                 "\"f\[LeftDoubleBracket]1\[RightDoubleBracket] = '+' \[Or] f \
= \\\"\\\"\"", Larger, Bold, StripOnInput -> False], StripOnInput -> False], 
                TraditionalForm]], {0, 0}, 
              ImageScaled[{0.5, 0.5}], Automatic, None, Background -> 
              GrayLevel[1]]}]}, {0.021167650531286893`, 0.8}}], 
        ArrowBox[{5, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 
         111, 112, 113, 114, 115, 4}]}}], {
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[0.85]], 
       DiskBox[{0., 0.}, {0.45499999999999996, 0.315}], InsetBox[
        StyleBox["\<\"Caller\"\>", "Courier",
         StripOnInput->False,
         FontFamily->10,
         FontWeight->Bold], {0., 0.}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
       DiskBox[{2., 1.25}, 0.35], InsetBox[
        StyleBox["\<\"Left\\nHand\\nSide\"\>", "Courier",
         StripOnInput->False,
         FontFamily->10,
         FontWeight->Bold], {2., 1.25}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
       DiskBox[{6., 0.8}, 0.35], InsetBox[
        StyleBox["\<\"Chemical\\nFormula\"\>", "Courier",
         StripOnInput->False,
         FontFamily->10,
         FontWeight->Bold], {6., 0.8}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
       DiskBox[{2., -1.25}, 0.35], InsetBox[
        StyleBox["\<\"Right\\nHand\\nSide\"\>", "Courier",
         StripOnInput->False,
         FontFamily->10,
         FontWeight->Bold], {2., -1.25}]}, 
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
       DiskBox[{6., -0.8}, 0.35], InsetBox[
        StyleBox["\<\"Chemical\\nFormula\"\>", "Courier",
         StripOnInput->False,
         FontFamily->10,
         FontWeight->Bold], {6., -0.8}]}}},
    ContentSelectable->True],
   Annotation[#, 
    VertexCoordinateRules -> {{0., 0.}, {2., 1.25}, {6., 0.8}, {2., -1.25}, {
     6., -0.8}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{Automatic, 424.5396854746883},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.4947391469301558`*^9, 3.494739189876708*^9, {3.494739319981893*^9, 
   3.4947393337861357`*^9}, {3.4947396038134203`*^9, 
   3.4947396144089537`*^9}, {3.494739700542144*^9, 3.494739725525831*^9}, {
   3.4950527815587597`*^9, 3.49505280511464*^9}}]
}, Open  ]],

Cell["\<\
Let us describe the process outlined on Figure 2.2. The \"Caller\" has string \
containing a chemical equation. With that string start with a character that \
is valid first character according to the grammar for chemical formulas, the \
parser switches to the \"Left Hand Side\" parsing mode. In that mode if the \
parsed string starts with a capital letter or left parenthesis, the parser \
switches to a \"Chemical Formula\" parsing mode that switches back to \"Left \
Hand Side\" if it reaches '+' or a yield sign. If '+' is reached \"Left Hand \
Side\" would not switch to another mode (and drop '+' from the parsed \
string). If the one of the yield signs is reached \"Left Hand Side\" would \
switch to \"Right Hand Side.\"  If the first character is the parsed string \
is a capital letter or a left parenthesis, \"Right Hand Side\" would switch \
to \"Chemical Formula.\" When called by the \"Right Hand Side,\" \"Chemical \
Formula\" would switch back without an error if the plus sign is encountered \
or the parsed string becomes empty. \"Right Hand Side\" switches to \
\"Caller\" if the parsed string becomes empty.\
\>", "Text",
 CellChangeTimes->{{3.495053664324019*^9, 3.495053859000566*^9}, {
  3.495053937064727*^9, 3.4950542486412077`*^9}, {3.495060613829393*^9, 
  3.495060643528487*^9}, {3.4950607455804043`*^9, 3.495060836583838*^9}, {
  3.495060925287734*^9, 3.4950610652634993`*^9}, {3.495061266556115*^9, 
  3.4950612796181173`*^9}, {3.6900381297769938`*^9, 3.690038156069467*^9}}],

Cell[CellGroupData[{

Cell["Implementation using the state diagram", "Subsection",
 CellChangeTimes->{{3.495128515261999*^9, 3.4951285358501177`*^9}}],

Cell[TextData[{
 "In this sub-section we are going implement the parser according to Figure \
2.2. We can say that the (defined below) functions ",
 StyleBox["YieldSignFirstQ", "Program"],
 " amd ",
 StyleBox["YieldSign2FirstQ", "Program"],
 " implement the prdocution rule for ",
 StyleBox["<yield>,", "Program"],
 " and the functions ",
 StyleBox["LeftHandSide", "Program"],
 " and ",
 StyleBox["RightHandSide", "Program"],
 " -- the former is calling the later -- are implementing production rule for \
",
 StyleBox["<equation>", "Program"],
 "."
}], "Text",
 CellChangeTimes->{{3.4951286154512672`*^9, 3.495128629706678*^9}, {
   3.4951288128432293`*^9, 3.4951288234279947`*^9}, 3.49513293747499*^9, {
   3.4951439790301943`*^9, 3.495144156230925*^9}, {3.495144569289193*^9, 
   3.4951445783025513`*^9}, {3.495144610932106*^9, 3.495144650911029*^9}}],

Cell[CellGroupData[{

Cell["Additional first symbol tests", "Subsubsection",
 CellChangeTimes->{{3.495133454388204*^9, 3.495133462787766*^9}}],

Cell[TextData[{
 "First we need some additional definitions for the production rule for the \
BNF symbol ",
 StyleBox["<yield>", "Program"],
 ". We going to separate the single character yield signs from the two \
character yield signs. That makes the removal of the yield signs from the \
parsed string more convenient. (See the definition of ",
 StyleBox["LeftHandSide", "Program"],
 ".)"
}], "Text",
 CellChangeTimes->{{3.495141857779475*^9, 3.495141892814028*^9}, {
  3.495141933756147*^9, 3.495142064166593*^9}, {3.6900381602457247`*^9, 
  3.6900381602892017`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"YieldSignFirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{
     "RegularExpression", "[", 
      "\"\<^[\[Rule]|=|\[LeftArrowRightArrow]].*\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YieldSign2FirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{"RegularExpression", "[", "\"\<^\\\\-\\\\>.*\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.495063650974525*^9, 3.495063683094215*^9}, {
  3.49513405140362*^9, 3.4951340786643953`*^9}, {3.4951341134503937`*^9, 
  3.495134116049828*^9}, {3.495144089335438*^9, 3.495144091476057*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The left hand side", "Subsubsection",
 CellChangeTimes->{{3.4951333890424137`*^9, 3.495133394207108*^9}}],

Cell["\<\
The \"Left Hand Side\" parsing mode is invoked if the first character is a \
capital letter or a left parenthesis. \"Left Hand Side\" calls CFP and \
filters out the plus signs in between the chemical formulas. If a yield sign \
is encountered a switch to \"Right Hand Side\" is made. If CFP fails then \
\"Left Hand Side\" fails too. \"Left Hand Side\" also fails if parsed string \
has unexpected symbols of if its end is reached.\
\>", "Text",
 CellChangeTimes->{{3.495142088540411*^9, 3.495142100982087*^9}, {
  3.4951421969038363`*^9, 3.495142313886499*^9}, {3.495142715165683*^9, 
  3.495142849406708*^9}, {3.495142937864245*^9, 3.495142970718515*^9}, {
  3.4951433899467793`*^9, 3.495143514726275*^9}, {3.495143644456544*^9, 
  3.495143645023079*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LeftHandSide", "[", 
    RowBox[{"treeArg_", ",", "equationArg_String"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"tree", "=", "treeArg"}]}], "}"}], ",", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "=", 
        RowBox[{"ParseMolecule", "[", "equationArg", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"t", "===", "$Failed"}], ",", 
         RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tree", "=", 
        RowBox[{"MapAt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"#", ",", 
             RowBox[{
             "t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], "&"}], ",", "tree", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "=", 
        RowBox[{"t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PlusFirstQ", "[", "t", "]"}], ",", 
         RowBox[{"LeftHandSide", "[", 
          RowBox[{"tree", ",", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"t", ",", "1"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"YieldSignFirstQ", "[", "t", "]"}], ",", 
         RowBox[{"RightHandSide", "[", 
          RowBox[{"tree", ",", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"t", ",", "1"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"YieldSign2FirstQ", "[", "t", "]"}], ",", 
         RowBox[{"RightHandSide", "[", 
          RowBox[{"tree", ",", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"t", ",", "2"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "True", ",", "$Failed"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"LeftParethesisFirstQ", "[", "equationArg", "]"}], "||", 
      RowBox[{"CapitalLetterFirstQ", "[", "equationArg", "]"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4950626700130653`*^9, 3.495062721447136*^9}, {
   3.495062788028756*^9, 3.4950628799072123`*^9}, {3.495062912861959*^9, 
   3.495062914685877*^9}, {3.4950629514796*^9, 3.4950630650605707`*^9}, {
   3.495063274805723*^9, 3.4950633173639593`*^9}, {3.495063374798182*^9, 
   3.4950635715975857`*^9}, {3.495063721094804*^9, 3.4950637638768053`*^9}, {
   3.495063965978413*^9, 3.4950639683723097`*^9}, {3.495064217274707*^9, 
   3.495064219897139*^9}, {3.495064378096386*^9, 3.495064378951811*^9}, {
   3.495064436584042*^9, 3.495064441664*^9}, {3.49506459975625*^9, 
   3.4950646194522877`*^9}, {3.495064828493572*^9, 3.495064879339183*^9}, {
   3.4951341984115553`*^9, 3.495134201398985*^9}, {3.495140113273204*^9, 
   3.4951401141251993`*^9}, {3.495322851066938*^9, 3.495322868370296*^9}, 
   3.4953230535391493`*^9, {3.495323172873723*^9, 3.495323191927506*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The right hand side", "Subsubsection",
 CellChangeTimes->{{3.495133397719308*^9, 3.495133401327183*^9}}],

Cell["\<\
The \"Right Hand Side\" is invoked from \"Left Hand Side\" after the later \
reaches a yield sign and after the yield sign the parsed string has a capital \
letter or a left parenthesis. As \"Left Hand Side,\" \"Right Hand Side\" \
calls CFP and filters out the plus signs in between the chemical formulas. \
\"Right Hand Side\" fails if unexpected symbols are encountered in the parsed \
string.\
\>", "Text",
 CellChangeTimes->{{3.495143533090485*^9, 3.4951437261361628`*^9}, {
   3.495143820758994*^9, 3.495143846590517*^9}, 3.690038164477146*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RightHandSide", "[", 
    RowBox[{"treeArg_", ",", "equationArg_String"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"tree", "=", "treeArg"}]}], "}"}], ",", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "=", 
        RowBox[{"ParseMolecule", "[", "equationArg", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"t", "===", "$Failed"}], ",", 
         RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tree", "=", 
        RowBox[{"MapAt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"#", ",", 
             RowBox[{
             "t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], "&"}], ",", "tree", ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "=", 
        RowBox[{"t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "===", "\"\<\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{"tree", ",", "t"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlusFirstQ", "[", "t", "]"}], ",", 
         RowBox[{"RightHandSide", "[", 
          RowBox[{"tree", ",", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"t", ",", "1"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "True", ",", "$Failed"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"LeftParethesisFirstQ", "[", "equationArg", "]"}], "||", 
      RowBox[{"CapitalLetterFirstQ", "[", "equationArg", "]"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4950626700130653`*^9, 3.495062721447136*^9}, {
  3.495062788028756*^9, 3.4950628799072123`*^9}, {3.495062912861959*^9, 
  3.495062914685877*^9}, {3.4950629514796*^9, 3.4950630650605707`*^9}, {
  3.495063274805723*^9, 3.4950633173639593`*^9}, {3.495063374798182*^9, 
  3.4950635715975857`*^9}, {3.495063721094804*^9, 3.495063865958753*^9}, {
  3.49506390752112*^9, 3.495063956449916*^9}, {3.495064282271262*^9, 
  3.495064316286628*^9}, {3.495064362046709*^9, 3.495064362175398*^9}, {
  3.495064541786665*^9, 3.495064564903532*^9}, {3.495064885924431*^9, 
  3.4950648872211933`*^9}, {3.495140107128097*^9, 3.495140108547771*^9}, {
  3.495143528430306*^9, 3.495143531484495*^9}, {3.495323168612224*^9, 
  3.4953231983958178`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The caller", "Subsubsection",
 CellChangeTimes->{{3.495128611869636*^9, 3.495128612490551*^9}, {
  3.495132964348812*^9, 3.4951329665662317`*^9}}],

Cell[TextData[{
 "Given a chemical equation, we have to decide should we start with parsing \
its left hand side or give failure. (See \"Caller\" node on Figure 2.2.) We \
also initialize the parse tree structure to be and equation with empty LHS \
and RHS, i.e. ",
 StyleBox["Equation[Mix[],Mix[]]", "Program"],
 "."
}], "Text",
 CellChangeTimes->{{3.495133012765596*^9, 3.4951330475901947`*^9}, {
   3.495133078633271*^9, 3.495133324743878*^9}, {3.4951438892929277`*^9, 
   3.4951439657586412`*^9}, {3.495144668393651*^9, 3.4951447294783154`*^9}, 
   3.690038171080531*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemicalEquationParser", "[", "equationArg_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"equation", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"equationArg", ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}]}], ",", "t", 
       ",", 
       RowBox[{"tree", "=", 
        RowBox[{"Equation", "[", 
         RowBox[{
          RowBox[{"Mix", "[", "]"}], ",", 
          RowBox[{"Mix", "[", "]"}]}], "]"}]}], ",", "molecule"}], "}"}], ",",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LeftParethesisFirstQ", "[", "equationArg", "]"}], "||", 
        RowBox[{"CapitalLetterFirstQ", "[", "equationArg", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "=", 
        RowBox[{"LeftHandSide", "[", 
         RowBox[{"tree", ",", "equation"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "$Failed"}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.36798353820668*^9, 3.36798387085144*^9}, {
  3.36798424770527*^9, 3.36798429958592*^9}, {3.3679843754773*^9, 
  3.36798455327064*^9}, {3.36798459087832*^9, 3.36798459565757*^9}, {
  3.3679846400392*^9, 3.3679846464835*^9}, {3.36798469003727*^9, 
  3.36798473706314*^9}, {3.36800291294576*^9, 3.36800292807606*^9}, {
  3.36800508590628*^9, 3.36800510713561*^9}, {3.36810438626976*^9, 
  3.36810438797144*^9}, {3.36814442640146*^9, 3.36814445976809*^9}, {
  3.495061872615568*^9, 3.4950618738865213`*^9}, {3.4950640039467773`*^9, 
  3.495064162740283*^9}, {3.495064939094391*^9, 3.4950650204473753`*^9}, {
  3.49513176686952*^9, 3.495131780989829*^9}, {3.4951321597194853`*^9, 
  3.495132170153254*^9}, {3.49514385095527*^9, 3.495143851786751*^9}, {
  3.495144745207609*^9, 3.495144748244697*^9}, {3.495323136362089*^9, 
  3.4953231626207733`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation using a loop", "Subsection",
 CellChangeTimes->{{3.495045375893827*^9, 3.495045382378283*^9}, {
  3.495045461307487*^9, 3.495045469074139*^9}, {3.495128540695505*^9, 
  3.495128543713408*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "ChemicalEquationParser", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemicalEquationParser", "[", "equationArg_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"equation", "=", "equationArg"}], ",", "t", ",", 
       RowBox[{"lhs", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"rhs", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"side", "=", "\"\<LHS\>\""}], ",", "molecule"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "[", "equation", "]"}], ">", "0"}], "&&", 
         RowBox[{"t", "=!=", "$Failed"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"ParseMolecule", "[", "equation", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "===", "$Failed"}], ",", 
           RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"molecule", ",", "equation"}], "}"}], "=", "t"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"side", "\[Equal]", "\"\<LHS\>\""}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"lhs", ",", "molecule"}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"rhs", ",", "molecule"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringLength", "[", "equation", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"t", "=", 
             RowBox[{"StringCases", "[", 
              RowBox[{"equation", ",", 
               RowBox[{"StartOfString", "~~", 
                RowBox[{"WhitespaceCharacter", "..."}], "~~", "\"\<+\>\"", "~~", 
                RowBox[{"WhitespaceCharacter", "..."}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "t", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"t", "===", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"side", "\[Equal]", "\"\<LHS\>\""}], ",", 
                 RowBox[{
                  RowBox[{"t", "=", 
                   RowBox[{"StringCases", "[", 
                    RowBox[{"equation", ",", 
                    RowBox[{"StartOfString", "~~", 
                    RowBox[{"WhitespaceCharacter", "..."}], "~~", 
                    RowBox[{"(", 
                    RowBox[{
                    "\"\<->\>\"", "|", "\"\<\[Rule]\>\"", "|", "\"\<<->\>\"", 
                    "|", "\"\<\[LeftRightArrow]\>\"", "|", "\"\<=\>\""}], 
                    ")"}], "~~", 
                    RowBox[{"WhitespaceCharacter", "..."}]}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"t", "===", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"side", "=", "\"\<RHS\>\""}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", "ELSE", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"Return", "[", "$Failed", "]"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"equation", "=", 
             RowBox[{"StringTake", "[", 
              RowBox[{"equation", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"StringLength", "[", 
                   RowBox[{
                   "t", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "+", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "equation", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"lhs", ",", "rhs", ",", "equation"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.36798353820668*^9, 3.36798387085144*^9}, {
  3.36798424770527*^9, 3.36798429958592*^9}, {3.3679843754773*^9, 
  3.36798455327064*^9}, {3.36798459087832*^9, 3.36798459565757*^9}, {
  3.3679846400392*^9, 3.3679846464835*^9}, {3.36798469003727*^9, 
  3.36798473706314*^9}, {3.36800291294576*^9, 3.36800292807606*^9}, {
  3.36800508590628*^9, 3.36800510713561*^9}, {3.36810438626976*^9, 
  3.36810438797144*^9}, {3.36814442640146*^9, 3.36814445976809*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples of parsing chemical equations", "Subsection",
 CellChangeTimes->{{3.4953223799589853`*^9, 3.4953224020212927`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChemicalEquationParser", "[", "\"\<NO2+C2->CNO2\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.495322404813614*^9, 3.495322457878469*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Equation", "[", 
    RowBox[{
     RowBox[{"Mix", "[", 
      RowBox[{
       RowBox[{"Molecule", "[", 
        RowBox[{"\<\"N\"\>", ",", 
         RowBox[{"Replicated", "[", 
          RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
       RowBox[{"Molecule", "[", 
        RowBox[{"Replicated", "[", 
         RowBox[{"\<\"C\"\>", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"Mix", "[", 
      RowBox[{"Molecule", "[", 
       RowBox[{"\<\"C\"\>", ",", "\<\"N\"\>", ",", 
        RowBox[{"Replicated", "[", 
         RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], "]"}]}], "]"}], 
   ",", "\<\"\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.49532244086136*^9, 3.495322458388558*^9}, 
   3.495323239606368*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChemicalEquationParser", "[", "\"\<NO2 + C2 -> CNO2\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.495322404813614*^9, 3.495322464615755*^9}, {
  3.49532255611889*^9, 3.495322561867386*^9}, {3.495322650907363*^9, 
  3.4953226554068003`*^9}, {3.49532320829628*^9, 3.4953232093194437`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Equation", "[", 
    RowBox[{
     RowBox[{"Mix", "[", 
      RowBox[{
       RowBox[{"Molecule", "[", 
        RowBox[{"\<\"N\"\>", ",", 
         RowBox[{"Replicated", "[", 
          RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
       RowBox[{"Molecule", "[", 
        RowBox[{"Replicated", "[", 
         RowBox[{"\<\"C\"\>", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"Mix", "[", 
      RowBox[{"Molecule", "[", 
       RowBox[{"\<\"C\"\>", ",", "\<\"N\"\>", ",", 
        RowBox[{"Replicated", "[", 
         RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], "]"}]}], "]"}], 
   ",", "\<\"\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.495322478672802*^9, {3.4953225569374113`*^9, 3.495322562254459*^9}, {
   3.495322651437352*^9, 3.495322655771749*^9}, 3.495322879670225*^9, 
   3.495323017913744*^9, {3.495323056555773*^9, 3.495323063082882*^9}, {
   3.495323203375691*^9, 3.4953232594874077`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", 
  RowBox[{"%", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4953232470139503`*^9, 3.495323287894992*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{2.566128590014312, 3.041337588165111}, {
    1.330585194822236, 2.2810031911238333`}, {0.38016719852063885`, 
    1.5206687940825554`}, {0., 0.7603343970412779}, {0.7603343970412777, 
    0.7603343970412779}, {0.38016719852063885`, 0.}, {1.1405015955619164`, 
    0.}, {2.281003191123833, 1.5206687940825554`}, {2.281003191123833, 
    0.7603343970412779}, {1.9008359926031941`, 0.}, {2.661170389644472, 0.}, {
    3.8016719852063883`, 2.2810031911238333`}, {3.8016719852063883`, 
    1.5206687940825554`}, {3.041337588165111, 0.7603343970412779}, {
    3.8016719852063883`, 0.7603343970412779}, {4.562006382247666, 
    0.7603343970412779}, {4.1818391837270275`, 0.}, {4.942173580768305, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 12}, {2, 3}, {2, 8}, {3, 4}, {3, 5}, {5, 6}, {5, 
       7}, {8, 9}, {9, 10}, {9, 11}, {12, 13}, {13, 14}, {13, 15}, {13, 16}, {
       16, 17}, {16, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Equation", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"Equation", "[", 
           RowBox[{
             RowBox[{"Mix", "[", 
               RowBox[{
                 RowBox[{"Molecule", "[", 
                   RowBox[{"\"N\"", ",", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"O\"", ",", "2"}], "]"}]}], "]"}], ",", 
                 RowBox[{"Molecule", "[", 
                   RowBox[{"Replicated", "[", 
                    RowBox[{"\"C\"", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Mix", "[", 
               RowBox[{"Molecule", "[", 
                 RowBox[{"\"C\"", ",", "\"N\"", ",", 
                   RowBox[{"Replicated", "[", 
                    RowBox[{"\"O\"", ",", "2"}], "]"}]}], "]"}], "]"}]}], 
           "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Equation[
          $CellContext`Mix[
           $CellContext`Molecule["N", 
            $CellContext`Replicated["O", 2]], 
           $CellContext`Molecule[
            $CellContext`Replicated["C", 2]]], 
          $CellContext`Mix[
           $CellContext`Molecule["C", "N", 
            $CellContext`Replicated["O", 2]]]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Mix", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"Mix", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{"\"N\"", ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"\"O\"", ",", "2"}], "]"}]}], "]"}], ",", 
             RowBox[{"Molecule", "[", 
               RowBox[{"Replicated", "[", 
                 RowBox[{"\"C\"", ",", "2"}], "]"}], "]"}]}], "]"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Mix[
          $CellContext`Molecule["N", 
           $CellContext`Replicated["O", 2]], 
          $CellContext`Molecule[
           $CellContext`Replicated["C", 2]]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"\"N\"", ",", 
             RowBox[{"Replicated", "[", 
               RowBox[{"\"O\"", ",", "2"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule["N", 
          $CellContext`Replicated["O", 2]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"N\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["\"N\"", HoldForm]],
       Annotation[#, 
        HoldForm["N"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{"\"O\"", ",", "2"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated["O", 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"O\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"O\"", HoldForm]],
       Annotation[#, 
        HoldForm["O"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"Replicated", "[", 
             RowBox[{"\"C\"", ",", "2"}], "]"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`Replicated["C", 2]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{"\"C\"", ",", "2"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated["C", 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"C\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\"C\"", HoldForm]],
       Annotation[#, 
        HoldForm["C"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Mix", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"Mix", "[", 
           RowBox[{"Molecule", "[", 
             RowBox[{"\"C\"", ",", "\"N\"", ",", 
               RowBox[{"Replicated", "[", 
                 RowBox[{"\"O\"", ",", "2"}], "]"}]}], "]"}], "]"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Mix[
          $CellContext`Molecule["C", "N", 
           $CellContext`Replicated["O", 2]]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"\"C\"", ",", "\"N\"", ",", 
             RowBox[{"Replicated", "[", 
               RowBox[{"\"O\"", ",", "2"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule["C", "N", 
          $CellContext`Replicated["O", 2]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"C\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"C\"", HoldForm]],
       Annotation[#, 
        HoldForm["C"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"N\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["\"N\"", HoldForm]],
       Annotation[#, 
        HoldForm["N"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{"\"O\"", ",", "2"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated["O", 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"O\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\"O\"", HoldForm]],
       Annotation[#, 
        HoldForm["O"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.024242424242424246`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{2.566128590014312, 3.041337588165111}, {
     1.330585194822236, 2.2810031911238333`}, {0.38016719852063885`, 
     1.5206687940825554`}, {0., 0.7603343970412779}, {0.7603343970412777, 
     0.7603343970412779}, {0.38016719852063885`, 0.}, {1.1405015955619164`, 
     0.}, {2.281003191123833, 1.5206687940825554`}, {2.281003191123833, 
     0.7603343970412779}, {1.9008359926031941`, 0.}, {2.661170389644472, 
     0.}, {3.8016719852063883`, 2.2810031911238333`}, {3.8016719852063883`, 
     1.5206687940825554`}, {3.041337588165111, 0.7603343970412779}, {
     3.8016719852063883`, 0.7603343970412779}, {4.562006382247666, 
     0.7603343970412779}, {4.1818391837270275`, 0.}, {4.942173580768305, 
     0.}}]& ],
  AspectRatio->NCache[Rational[10, 33]^Rational[1, 2], 0.5504818825631803],
  FrameTicks->Automatic,
  ImageSize->{425.3333333333333, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.495323257223714*^9, 3.4953232889067087`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["String matching parser", "Section",
 CellChangeTimes->{{3.490149675593338*^9, 3.490149704620263*^9}, {
  3.493237145513349*^9, 3.4932371475507793`*^9}}],

Cell[CellGroupData[{

Cell["Definitions", "Subsection",
 CellChangeTimes->{{3.489146740657996*^9, 3.489146741968154*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"specieSP", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CharacterRange", "[", 
       RowBox[{"\"\<A\>\"", ",", "\"\<Z\>\""}], "]"}], "~~", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CharacterRange", "[", 
         RowBox[{"\"\<a\>\"", ",", "\"\<x\>\""}], "]"}], "|", "\"\<\>\""}], 
       ")"}]}], ")"}], "~~", 
    RowBox[{"(", 
     RowBox[{"NumberString", "|", "\"\<\>\""}], ")"}]}]}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "StringsToMolecule", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StringsToMolecule", "[", 
    RowBox[{"ename_", ",", "na_String"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"na", "\[Equal]", "\"\<\>\""}], ",", "ename", ",", 
     RowBox[{"Replicated", "[", 
      RowBox[{"ename", ",", 
       RowBox[{"ToExpression", "[", "na", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4891214503133783`*^9, 3.489121490649247*^9}, {
   3.4891215220361557`*^9, 3.489121557355021*^9}, {3.489148942658795*^9, 
   3.489148959633662*^9}, 3.492898467247826*^9}],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"ParseMolecule", ",", "ParseSubMolecule"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParseMolecule", "[", "moleculeArg_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", "=", 
       RowBox[{"ParseSubMolecule", "[", "moleculeArg", "]"}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "t", "]"}], "=!=", "Molecule"}], ",", 
       RowBox[{"Molecule", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParseSubMolecule", "[", "moleculeArg_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"braced", ",", "notbraced"}], "}"}], ",", 
     RowBox[{
      RowBox[{"PRINT", "[", "\"\<general\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"braced", "=", 
       RowBox[{"StringCases", "[", 
        RowBox[{"moleculeArg", ",", 
         RowBox[{"(", 
          RowBox[{"\"\<(\>\"", "~~", 
           RowBox[{"(", 
            RowBox[{"specieSP", "..."}], ")"}], "~~", "\"\<)\>\"", "~~", 
           RowBox[{"(", 
            RowBox[{"NumberString", "|", "\"\<\>\""}], ")"}]}], ")"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Molecule", "@@", 
       RowBox[{"Map", "[", 
        RowBox[{"ParseSubMolecule", ",", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"moleculeArg", ",", 
           RowBox[{"Thread", "[", 
            RowBox[{"braced", "->", "braced"}], "]"}]}], "]"}]}], "]"}]}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParseSubMolecule", "[", "moleculeArg_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "t", "}"}], ",", 
      RowBox[{
       RowBox[{"PRINT", "[", "\"\<( & ) free\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "=", 
        RowBox[{"StringCases", "[", 
         RowBox[{"moleculeArg", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"en", ":", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"CharacterRange", "[", 
                 RowBox[{"\"\<A\>\"", ",", "\"\<Z\>\""}], "]"}], "~~", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"CharacterRange", "[", 
                   RowBox[{"\"\<a\>\"", ",", "\"\<x\>\""}], "]"}], "|", 
                  "\"\<\>\""}], ")"}]}], ")"}]}], ")"}], "~~", 
            RowBox[{"(", 
             RowBox[{"na", ":", 
              RowBox[{"(", 
               RowBox[{"NumberString", "|", "\"\<\>\""}], ")"}]}], ")"}]}], 
           "\[RuleDelayed]", 
           RowBox[{"StringsToMolecule", "[", 
            RowBox[{"en", ",", "na"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "t", "]"}], "\[Equal]", "1"}], ",", 
         RowBox[{"t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"Molecule", "@@", "t"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], "/;", 
    RowBox[{"StringFreeQ", "[", 
     RowBox[{"moleculeArg", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParseSubMolecule", "[", "moleculeArg_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "t", "}"}], ",", 
      RowBox[{
       RowBox[{"PRINT", "[", "\"\<(~~___~~)\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "=", 
        RowBox[{"StringCases", "[", 
         RowBox[{"moleculeArg", ",", 
          RowBox[{
           RowBox[{
           "StartOfString", "~~", "\"\<(\>\"", "~~", "x___", "~~", 
            "\"\<)\>\"", "~~", 
            RowBox[{"(", 
             RowBox[{"nm", ":", 
              RowBox[{"(", 
               RowBox[{"NumberString", "|", "\"\<\>\""}], ")"}]}], ")"}], "~~",
             "EndOfString"}], ":>", 
           RowBox[{"StringsToMolecule", "[", 
            RowBox[{
             RowBox[{"ParseSubMolecule", "[", "x", "]"}], ",", "nm"}], 
            "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "t", "]"}], "\[Equal]", "1"}], ",", 
         RowBox[{"t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"Molecule", "@@", "t"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], "/;", 
    RowBox[{"StringMatchQ", "[", 
     RowBox[{"moleculeArg", ",", 
      RowBox[{
      "StartOfString", "~~", "\"\<(\>\"", "~~", "___", "~~", "\"\<)\>\"", "~~", 
       RowBox[{"(", 
        RowBox[{"NumberString", "|", "\"\<\>\""}], ")"}], "~~", 
       "EndOfString"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.489147660010243*^9, 3.48914774999716*^9}, {
   3.489148668627379*^9, 3.489148733974323*^9}, {3.489148779880607*^9, 
   3.489148874970632*^9}, {3.489148974144516*^9, 3.489148976893006*^9}, {
   3.489149018096416*^9, 3.489149034781126*^9}, {3.48914907483264*^9, 
   3.489149092652433*^9}, {3.489149131628885*^9, 3.489149144162279*^9}, {
   3.489149190188155*^9, 3.489149219919448*^9}, {3.489157506446504*^9, 
   3.489157575269338*^9}, {3.489157672424548*^9, 3.489157685759007*^9}, {
   3.489157758685858*^9, 3.48915786042785*^9}, 3.489157999084318*^9, {
   3.489158468608343*^9, 3.489158471565865*^9}, {3.489158507055463*^9, 
   3.489158526834124*^9}, {3.489158745007887*^9, 3.489158769166334*^9}, {
   3.489159548546763*^9, 3.489159573895008*^9}, {3.489160226088354*^9, 
   3.489160299459978*^9}, {3.489160340814122*^9, 3.489160380930558*^9}, {
   3.4891604270496492`*^9, 3.48916061833454*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParseMolecule", "[", "\"\<(Ca3H4)2\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.489159623053084*^9, 3.489159623430921*^9}, {
  3.489160302174871*^9, 3.489160302665087*^9}, {3.489160385391447*^9, 
  3.48916038573756*^9}, {3.489160440191404*^9, 3.4891604407616*^9}, {
  3.489160622688494*^9, 3.489160623274446*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{"Replicated", "[", 
   RowBox[{
    RowBox[{"Molecule", "[", 
     RowBox[{
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"Ca\"\>", ",", "3"}], "]"}], ",", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"H\"\>", ",", "4"}], "]"}]}], "]"}], ",", "2"}], "]"}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.489159612027941*^9, 3.489159623954919*^9}, {
   3.4891602646995*^9, 3.489160303128156*^9}, {3.489160382683801*^9, 
   3.489160386440588*^9}, {3.489160441050011*^9, 3.489160468566237*^9}, 
   3.489160529830359*^9, 3.489160623706879*^9, 3.4902180920468473`*^9, 
   3.492383511719097*^9, 3.492898550942254*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ParseMolecule", "[", "\"\<(Ca3H4)2\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ParseMolecule", "[", "\"\<(Ca3H4(Ca4O3)4)2\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.489148896956012*^9, 3.489148920641447*^9}, {
  3.489149002017944*^9, 3.489149003948853*^9}, {3.489149040317118*^9, 
  3.489149051869581*^9}, {3.489159627277213*^9, 3.489159630279818*^9}, {
  3.489160329081644*^9, 3.489160329888262*^9}, {3.48916041479795*^9, 
  3.489160417690722*^9}, {3.489160470704119*^9, 3.489160474074599*^9}, {
  3.489160625838869*^9, 3.489160628267403*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{"Replicated", "[", 
   RowBox[{
    RowBox[{"Molecule", "[", 
     RowBox[{
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"Ca\"\>", ",", "3"}], "]"}], ",", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"H\"\>", ",", "4"}], "]"}]}], "]"}], ",", "2"}], "]"}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.489148899621092*^9, 3.489148979552313*^9}, {
   3.4891490364867*^9, 3.48914905226086*^9}, 3.489149094493002*^9, {
   3.489149138112732*^9, 3.489149145340814*^9}, 3.489149215597041*^9, 
   3.489157693853008*^9, 3.489157862462639*^9, 3.489157966687224*^9, 
   3.489158001597882*^9, 3.489159585946783*^9, 3.48915963157833*^9, 
   3.48916028034434*^9, 3.489160330236612*^9, {3.489160410203724*^9, 
   3.489160418137133*^9}, {3.489160472101439*^9, 3.489160474583793*^9}, 
   3.489160533316448*^9, {3.489160626633802*^9, 3.489160628681595*^9}, 
   3.490218092107027*^9, 3.4923835119456244`*^9, 3.492898551925213*^9}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{"Replicated", "[", 
   RowBox[{
    RowBox[{"Molecule", "[", 
     RowBox[{
      RowBox[{"Molecule", "[", 
       RowBox[{
        RowBox[{"Replicated", "[", 
         RowBox[{"\<\"Ca\"\>", ",", "3"}], "]"}], ",", 
        RowBox[{"Replicated", "[", 
         RowBox[{"\<\"H\"\>", ",", "4"}], "]"}]}], "]"}], ",", 
      RowBox[{"Replicated", "[", 
       RowBox[{
        RowBox[{"Molecule", "[", 
         RowBox[{
          RowBox[{"Replicated", "[", 
           RowBox[{"\<\"Ca\"\>", ",", "4"}], "]"}], ",", 
          RowBox[{"Replicated", "[", 
           RowBox[{"\<\"O\"\>", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
       "]"}]}], "]"}], ",", "2"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{{3.489148899621092*^9, 3.489148979552313*^9}, {
   3.4891490364867*^9, 3.48914905226086*^9}, 3.489149094493002*^9, {
   3.489149138112732*^9, 3.489149145340814*^9}, 3.489149215597041*^9, 
   3.489157693853008*^9, 3.489157862462639*^9, 3.489157966687224*^9, 
   3.489158001597882*^9, 3.489159585946783*^9, 3.48915963157833*^9, 
   3.48916028034434*^9, 3.489160330236612*^9, {3.489160410203724*^9, 
   3.489160418137133*^9}, {3.489160472101439*^9, 3.489160474583793*^9}, 
   3.489160533316448*^9, {3.489160626633802*^9, 3.489160628681595*^9}, 
   3.490218092107027*^9, 3.4923835119456244`*^9, 3.492898551977087*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParseMolecule", "[", "\"\<(Ca3H4(Ca4O3)4)2\>\"", "]"}], "//", 
  "TreeForm"}]], "Input",
 CellChangeTimes->{{3.4923836666168623`*^9, 3.4923836708422127`*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQHbToSN3j1+wO+yqF57/6IOgA4784VRp35xmvAwff
G770dywOwSjqPtpDaEao+uv2IWD6uz0DFED4z+2DoDSM/xxs7l+4+iAoDZOH
mQvjz9BXT9cpEnCAiT+HugtVPztcPcy9MHfMMZv7Lv4lF5wP8ye6+TD5x4f/
X1uRL4xD/Xd7mHmw8AAAI++dMA==
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {2, 3}, {2, 20}, {3, 4}, {3, 11}, {4, 5}, {4, 8}, {5, 
       6}, {5, 7}, {8, 9}, {8, 10}, {11, 12}, {11, 19}, {12, 13}, {12, 16}, {
       13, 14}, {13, 15}, {16, 17}, {16, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"Replicated", "[", 
             RowBox[{
               RowBox[{"Molecule", "[", 
                 RowBox[{
                   RowBox[{"Molecule", "[", 
                    RowBox[{
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], ",", 
                   RowBox[{"Replicated", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
                    "]"}]}], "]"}], ",", "2"}], "]"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`Replicated[
           $CellContext`Molecule[
            $CellContext`Molecule[
             $CellContext`Replicated["Ca", 3], 
             $CellContext`Replicated["H", 4]], 
            $CellContext`Replicated[
             $CellContext`Molecule[
              $CellContext`Replicated["Ca", 4], 
              $CellContext`Replicated["O", 3]], 4]], 2]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"Molecule", "[", 
                   RowBox[{
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
                   "]"}]}], "]"}], ",", "2"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated[
          $CellContext`Molecule[
           $CellContext`Molecule[
            $CellContext`Replicated["Ca", 3], 
            $CellContext`Replicated["H", 4]], 
           $CellContext`Replicated[
            $CellContext`Molecule[
             $CellContext`Replicated["Ca", 4], 
             $CellContext`Replicated["O", 3]], 4]], 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"Replicated", "[", 
                   RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], ",", 
             RowBox[{"Replicated", "[", 
               RowBox[{
                 RowBox[{"Molecule", "[", 
                   RowBox[{
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
               "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`Molecule[
           $CellContext`Replicated["Ca", 3], 
           $CellContext`Replicated["H", 4]], 
          $CellContext`Replicated[
           $CellContext`Molecule[
            $CellContext`Replicated["Ca", 4], 
            $CellContext`Replicated["O", 3]], 4]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"Replicated", "[", 
               RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
             RowBox[{"Replicated", "[", 
               RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`Replicated["Ca", 3], 
          $CellContext`Replicated["H", 4]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{"\"Ca\"", ",", "3"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated["Ca", 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{"\"H\"", ",", "4"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated["H", 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"H\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"H\"", HoldForm]],
       Annotation[#, 
        HoldForm["H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"Replicated", "[", 
                   RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
           "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated[
          $CellContext`Molecule[
           $CellContext`Replicated["Ca", 4], 
           $CellContext`Replicated["O", 3]], 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"Replicated", "[", 
               RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
             RowBox[{"Replicated", "[", 
               RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`Replicated["Ca", 4], 
          $CellContext`Replicated["O", 3]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{"\"Ca\"", ",", "4"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated["Ca", 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{"\"O\"", ",", "3"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated["O", 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"O\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\"O\"", HoldForm]],
       Annotation[#, 
        HoldForm["O"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQAWIQHbToSN3j1+wO+yqF57/6IOgA4784VRp35xmvAwff
G770dywOwSjqPtpDaEao+uv2IWD6uz0DFED4z+2DoDSM/xxs7l+4+iAoDZOH
mQvjz9BXT9cpEnCAiT+HugtVPztcPcy9MHfMMZv7Lv4lF5wP8ye6+TD5x4f/
X1uRL4xD/Xd7mHmw8AAAI++dMA==
     "]]& ],
  AspectRatio->NCache[Rational[14, 29]^Rational[1, 2], 0.6948083337796512],
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.492383671700839*^9, 3.4928985544548883`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParseMolecule", "[", "\"\<(Ca3H4(Ca4O3)4)2\>\"", "]"}], "//", 
  "MolecularMass"}]], "Input",
 CellChangeTimes->{{3.492383781188312*^9, 3.4923837852620907`*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3", " ", "\<\"Ca\"\>"}], "+", 
    RowBox[{"4", " ", "\<\"H\"\>"}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "\<\"Ca\"\>"}], "+", 
       RowBox[{"3", " ", "\<\"O\"\>"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.4923837854012823`*^9, 3.49289855783572*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ParseMolecule", "[", "\"\<(Ca3H4(Ca4O3)4)2\>\"", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Replicated", "\[Rule]", "Times"}], ",", 
    RowBox[{"Molecule", "\[Rule]", "Plus"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", "atomicWeightsRule"}]}], "Input",
 CellChangeTimes->{{3.492383548020026*^9, 3.4923835718665524`*^9}, {
   3.492383702469295*^9, 3.4923837231178493`*^9}, 3.492898467500239*^9}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3", " ", "\<\"Ca\"\>"}], "+", 
    RowBox[{"4", " ", "\<\"H\"\>"}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "\<\"Ca\"\>"}], "+", 
       RowBox[{"3", " ", "\<\"O\"\>"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.492383573419141*^9, 3.49238374844903*^9}],

Cell[BoxData["1915.01312000000000000000000000000000000004`5.088443762859626"],\
 "Output",
 CellChangeTimes->{3.492383573419141*^9, 3.492383748451689*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.489158048259123*^9, 3.4891580519362*^9}, 
   3.489158102630374*^9}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.505545305418162, 3.7638632635454052`}, {
    1.1291589790636216`, 3.011090610836324}, {1.8819316317727026`, 
    3.011090610836324}, {0.3763863263545406, 2.2583179581272432`}, {0., 
    1.505545305418162}, {0.7527726527090811, 1.505545305418162}, {
    1.8819316317727026`, 2.2583179581272432`}, {1.505545305418162, 
    1.505545305418162}, {2.2583179581272432`, 1.505545305418162}, {
    3.387476937190865, 2.2583179581272432`}, {3.011090610836324, 
    1.505545305418162}, {3.7638632635454052`, 1.505545305418162}, {
    3.011090610836324, 0.7527726527090812}, {2.6347042844817836`, 0.}, {
    3.387476937190865, 0.}, {4.5166359162544865`, 0.7527726527090812}, {
    4.140249589899946, 0.}, {4.893022242609026, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {3, 4}, {3, 7}, {3, 10}, {4, 5}, {4, 6}, {7, 
       8}, {7, 9}, {10, 11}, {10, 12}, {12, 13}, {12, 16}, {13, 14}, {13, 
       15}, {16, 17}, {16, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"2", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{"3", " ", "\"Ca\""}], "+", 
               RowBox[{"4", " ", "\"H\""}], "+", 
               RowBox[{"4", " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{"4", " ", "\"Ca\""}], "+", 
                    RowBox[{"3", " ", "\"O\""}]}], ")"}]}]}], ")"}]}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[2 (3 "Ca" + 4 "H" + 4 (4 "Ca" + 3 "O"))], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Plus", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{
           RowBox[{"3", " ", "\"Ca\""}], "+", 
           RowBox[{"4", " ", "\"H\""}], "+", 
           RowBox[{"4", " ", 
             RowBox[{"(", 
               RowBox[{
                 RowBox[{"4", " ", "\"Ca\""}], "+", 
                 RowBox[{"3", " ", "\"O\""}]}], ")"}]}]}], HoldForm]],
       Annotation[#, 
        HoldForm[3 "Ca" + 4 "H" + 4 (4 "Ca" + 3 "O")], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"3", " ", "\"Ca\""}], HoldForm]],
       Annotation[#, 
        HoldForm[3 "Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox[
         RowBox[{"4", " ", "\"H\""}], HoldForm]],
       Annotation[#, 
        HoldForm[4 "H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"H\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"H\"", HoldForm]],
       Annotation[#, 
        HoldForm["H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"4", " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{"4", " ", "\"Ca\""}], "+", 
               RowBox[{"3", " ", "\"O\""}]}], ")"}]}], HoldForm]],
       Annotation[#, 
        HoldForm[4 (4 "Ca" + 3 "O")], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Plus", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{
           RowBox[{"4", " ", "\"Ca\""}], "+", 
           RowBox[{"3", " ", "\"O\""}]}], HoldForm]],
       Annotation[#, 
        HoldForm[4 "Ca" + 3 "O"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox[
         RowBox[{"4", " ", "\"Ca\""}], HoldForm]],
       Annotation[#, 
        HoldForm[4 "Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox[
         RowBox[{"3", " ", "\"O\""}], HoldForm]],
       Annotation[#, 
        HoldForm[3 "O"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"O\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"O\"", HoldForm]],
       Annotation[#, 
        HoldForm["O"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.505545305418162, 3.7638632635454052`}, {
     1.1291589790636216`, 3.011090610836324}, {1.8819316317727026`, 
     3.011090610836324}, {0.3763863263545406, 2.2583179581272432`}, {0., 
     1.505545305418162}, {0.7527726527090811, 1.505545305418162}, {
     1.8819316317727026`, 2.2583179581272432`}, {1.505545305418162, 
     1.505545305418162}, {2.2583179581272432`, 1.505545305418162}, {
     3.387476937190865, 2.2583179581272432`}, {3.011090610836324, 
     1.505545305418162}, {3.7638632635454052`, 1.505545305418162}, {
     3.011090610836324, 0.7527726527090812}, {2.6347042844817836`, 0.}, {
     3.387476937190865, 0.}, {4.5166359162544865`, 0.7527726527090812}, {
     4.140249589899946, 0.}, {4.893022242609026, 0.}}]& ],
  AspectRatio->NCache[2 5^Rational[-1, 2], 0.8944271909999159],
  FrameTicks->Automatic,
  ImageSize->{377.60000000000014`, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.489158052534356*^9, 3.489160282523279*^9, 
  3.489160540450584*^9, 3.489160630404105*^9, 3.490218093147912*^9, 
  3.492383514101466*^9, 3.492383651678314*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParseMolecule", "[", "\"\<Ca3H4(Ca4O3)4C12(H2Mn4)5\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.489157713762311*^9, 3.489157715199116*^9}, {
  3.489157802628848*^9, 3.489157811599568*^9}, {3.4891606387532*^9, 
  3.489160639146686*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{
   RowBox[{"Molecule", "[", 
    RowBox[{
     RowBox[{"SelfJoined", "[", 
      RowBox[{"\<\"Ca\"\>", ",", "3"}], "]"}], ",", 
     RowBox[{"SelfJoined", "[", 
      RowBox[{"\<\"H\"\>", ",", "4"}], "]"}]}], "]"}], ",", 
   RowBox[{"SelfJoined", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"SelfJoined", "[", 
        RowBox[{"\<\"Ca\"\>", ",", "4"}], "]"}], ",", 
       RowBox[{"SelfJoined", "[", 
        RowBox[{"\<\"O\"\>", ",", "3"}], "]"}]}], "]"}], ",", "4"}], "]"}], 
   ",", 
   RowBox[{"SelfJoined", "[", 
    RowBox[{"\<\"C\"\>", ",", "12"}], "]"}], ",", 
   RowBox[{"SelfJoined", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"SelfJoined", "[", 
        RowBox[{"\<\"H\"\>", ",", "2"}], "]"}], ",", 
       RowBox[{"SelfJoined", "[", 
        RowBox[{"\<\"Mn\"\>", ",", "4"}], "]"}]}], "]"}], ",", "5"}], "]"}]}],
   "]"}]], "Output",
 CellChangeTimes->{
  3.489157715802313*^9, {3.489157791933398*^9, 3.48915781186346*^9}, {
   3.489157843799264*^9, 3.489157902849246*^9}, 3.489158006454146*^9, 
   3.48915810623894*^9, 3.489158779600179*^9, 3.489160639579899*^9, 
   3.490218093251279*^9, 3.492383514463338*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGCQBWIQzVt6s7jyJ5fDVLV5JzTnMTvct3y7xi73rf0DMP3X
HiJ+GUp/tmeAgmlg/mOo+GN7GN9qw1GrLa0/4OphNEz+PtRcGB9mP8w+iH4O
B1T9zA4w9YcSu/pTtBgdYO5If72R8b0gG5wPMZ/XAd18mPymfwzPmB/yY6iH
2afjIqLjniIEdw/EPkE09wjD+RfPWs+76C0OVw9xjxiGeph7YObD7P/HoZHK
c0MEzof4XwKuHmY+TH7xJP/r0/ZLYqiH2QcAxfG6nQ==
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 9}, {1, 18}, {1, 21}, {2, 3}, {2, 6}, {3, 4}, {3, 
       5}, {6, 7}, {6, 8}, {9, 10}, {9, 17}, {10, 11}, {10, 14}, {11, 12}, {
       11, 13}, {14, 15}, {14, 16}, {18, 19}, {18, 20}, {21, 22}, {21, 29}, {
       22, 23}, {22, 26}, {23, 24}, {23, 25}, {26, 27}, {26, 28}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{
                 RowBox[{"Molecule", "[", 
                   RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
               "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"C\"", ",", "12"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{
                 RowBox[{"Molecule", "[", 
                   RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"H\"", ",", "2"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Mn\"", ",", "4"}], "]"}]}], "]"}], ",", "5"}], 
               "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`Molecule[
           $CellContext`SelfJoined["Ca", 3], 
           $CellContext`SelfJoined["H", 4]], 
          $CellContext`SelfJoined[
           $CellContext`Molecule[
            $CellContext`SelfJoined["Ca", 4], 
            $CellContext`SelfJoined["O", 3]], 4], 
          $CellContext`SelfJoined["C", 12], 
          $CellContext`SelfJoined[
           $CellContext`Molecule[
            $CellContext`SelfJoined["H", 2], 
            $CellContext`SelfJoined["Mn", 4]], 5]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined["Ca", 3], 
          $CellContext`SelfJoined["H", 4]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"Ca\"", ",", "3"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["Ca", 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"H\"", ",", "4"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["H", 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"H\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"H\"", HoldForm]],
       Annotation[#, 
        HoldForm["H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
           "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined[
          $CellContext`Molecule[
           $CellContext`SelfJoined["Ca", 4], 
           $CellContext`SelfJoined["O", 3]], 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined["Ca", 4], 
          $CellContext`SelfJoined["O", 3]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"Ca\"", ",", "4"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["Ca", 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"O\"", ",", "3"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["O", 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"O\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["\"O\"", HoldForm]],
       Annotation[#, 
        HoldForm["O"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"C\"", ",", "12"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["C", 12]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"C\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"C\"", HoldForm]],
       Annotation[#, 
        HoldForm["C"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["12",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["12", HoldForm]],
       Annotation[#, 
        HoldForm[12], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"H\"", ",", "2"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"Mn\"", ",", "4"}], "]"}]}], "]"}], ",", "5"}], 
           "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined[
          $CellContext`Molecule[
           $CellContext`SelfJoined["H", 2], 
           $CellContext`SelfJoined["Mn", 4]], 5]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 22],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"H\"", ",", "2"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"Mn\"", ",", "4"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined["H", 2], 
          $CellContext`SelfJoined["Mn", 4]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 23],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"H\"", ",", "2"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["H", 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"H\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 24],
        TagBox["\"H\"", HoldForm]],
       Annotation[#, 
        HoldForm["H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 25],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 26],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"Mn\"", ",", "4"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["Mn", 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mn\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 27],
        TagBox["\"Mn\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mn"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 28],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["5",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.017777777777777778`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 29],
        TagBox["5", HoldForm]],
       Annotation[#, 
        HoldForm[5], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGCQBWIQzVt6s7jyJ5fDVLV5JzTnMTvct3y7xi73rf0DMP3X
HiJ+GUp/tmeAgmlg/mOo+GN7GN9qw1GrLa0/4OphNEz+PtRcGB9mP8w+iH4O
B1T9zA4w9YcSu/pTtBgdYO5If72R8b0gG5wPMZ/XAd18mPymfwzPmB/yY6iH
2afjIqLjniIEdw/EPkE09wjD+RfPWs+76C0OVw9xjxiGeph7YObD7P/HoZHK
c0MEzof4XwKuHmY+TH7xJP/r0/ZLYqiH2QcAxfG6nQ==
     "]]& ],
  AspectRatio->NCache[Rational[1, 3] 2^Rational[1, 2], 0.4714045207910317],
  FrameTicks->Automatic,
  ImageSize->{557.6, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.489158107167752*^9, 3.489160641269343*^9, 
  3.490218093451602*^9, 3.492383514682002*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PRINT", "=."}], "\[IndentingNewLine]", 
 RowBox[{"ParseSubMolecule", "[", "\"\<(Ca3H4)2C12(C2H5)Mn\>\"", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.4891238867545023`*^9, 3.489123893497843*^9}, {
  3.489158792422129*^9, 3.489158796514816*^9}, {3.489158838550821*^9, 
  3.489158847478437*^9}, {3.489159225288305*^9, 3.48915922944445*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{
   RowBox[{"SelfJoined", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"SelfJoined", "[", 
        RowBox[{"\<\"Ca\"\>", ",", "3"}], "]"}], ",", 
       RowBox[{"SelfJoined", "[", 
        RowBox[{"\<\"H\"\>", ",", "4"}], "]"}]}], "]"}], ",", "2"}], "]"}], 
   ",", 
   RowBox[{"SelfJoined", "[", 
    RowBox[{"\<\"C\"\>", ",", "12"}], "]"}], ",", 
   RowBox[{"Molecule", "[", 
    RowBox[{
     RowBox[{"SelfJoined", "[", 
      RowBox[{"\<\"C\"\>", ",", "2"}], "]"}], ",", 
     RowBox[{"SelfJoined", "[", 
      RowBox[{"\<\"H\"\>", ",", "5"}], "]"}]}], "]"}], ",", "\<\"Mn\"\>"}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.489157886480215*^9, 3.48915800758156*^9, {3.489158782031995*^9, 
   3.48915885122019*^9}, 3.489159230332472*^9, 3.489160678971666*^9, 
   3.4902180935598516`*^9, 3.492383514792684*^9, 3.492787632466054*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQ7b/kUPsXeU6HJzXVikkarFD6q32YtaXR5D3/ofR7
e5g4hL4KpZ/aM6ABdHHZmFsrq4p+wdXDzIHJw+zBrh5mH6sDTJ0Hr8/d0GYm
uDsb36xKzTvLDudXhprsPm8gCFe/6zTnuzZxXrg8xHwuB5h7IOr44Xyxo8n/
b18VhquH2CfkgOp+UQz1MPsAFxmEQQ==
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 11}, {1, 14}, {1, 21}, {2, 3}, {2, 10}, {3, 4}, {3,
        7}, {4, 5}, {4, 6}, {7, 8}, {7, 9}, {11, 12}, {11, 13}, {14, 15}, {14,
        18}, {15, 16}, {15, 17}, {18, 19}, {18, 20}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{
                 RowBox[{"Molecule", "[", 
                   RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], ",", "2"}], 
               "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"C\"", ",", "12"}], "]"}], ",", 
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"C\"", ",", "2"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"H\"", ",", "5"}], "]"}]}], "]"}], ",", 
             "\"Mn\""}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined[
           $CellContext`Molecule[
            $CellContext`SelfJoined["Ca", 3], 
            $CellContext`SelfJoined["H", 4]], 2], 
          $CellContext`SelfJoined["C", 12], 
          $CellContext`Molecule[
           $CellContext`SelfJoined["C", 2], 
           $CellContext`SelfJoined["H", 5]], "Mn"]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], ",", "2"}], 
           "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined[
          $CellContext`Molecule[
           $CellContext`SelfJoined["Ca", 3], 
           $CellContext`SelfJoined["H", 4]], 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined["Ca", 3], 
          $CellContext`SelfJoined["H", 4]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"Ca\"", ",", "3"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["Ca", 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"H\"", ",", "4"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["H", 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"H\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"H\"", HoldForm]],
       Annotation[#, 
        HoldForm["H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"C\"", ",", "12"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["C", 12]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"C\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["\"C\"", HoldForm]],
       Annotation[#, 
        HoldForm["C"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["12",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["12", HoldForm]],
       Annotation[#, 
        HoldForm[12], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"C\"", ",", "2"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"H\"", ",", "5"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined["C", 2], 
          $CellContext`SelfJoined["H", 5]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"C\"", ",", "2"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["C", 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"C\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"C\"", HoldForm]],
       Annotation[#, 
        HoldForm["C"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"H\"", ",", "5"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["H", 5]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"H\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"H\"", HoldForm]],
       Annotation[#, 
        HoldForm["H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["5",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["5", HoldForm]],
       Annotation[#, 
        HoldForm[5], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mn\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"Mn\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mn"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQ7b/kUPsXeU6HJzXVikkarFD6q32YtaXR5D3/ofR7
e5g4hL4KpZ/aM6ABdHHZmFsrq4p+wdXDzIHJw+zBrh5mH6sDTJ0Hr8/d0GYm
uDsb36xKzTvLDudXhprsPm8gCFe/6zTnuzZxXrg8xHwuB5h7IOr44Xyxo8n/
b18VhquH2CfkgOp+UQz1MPsAFxmEQQ==
     "]]& ],
  AspectRatio->NCache[Rational[1, 4] 5^Rational[1, 2], 0.5590169943749475],
  FrameTicks->Automatic,
  ImageSize->{804.0000000000003, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.489158853012186*^9, 3.489159232906822*^9, 
  3.489160679997628*^9, 3.4902180936948967`*^9, 3.492383514927209*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ParseMolecule", "[", "\"\<(Ca3H4)2C12(C2H5)Mn\>\"", "]"}], 
  "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"TreeForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.489159238057917*^9, 3.489159256309415*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{
   RowBox[{"SelfJoined", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"SelfJoined", "[", 
        RowBox[{"\<\"Ca\"\>", ",", "3"}], "]"}], ",", 
       RowBox[{"SelfJoined", "[", 
        RowBox[{"\<\"H\"\>", ",", "4"}], "]"}]}], "]"}], ",", "2"}], "]"}], 
   ",", 
   RowBox[{"SelfJoined", "[", 
    RowBox[{"\<\"C\"\>", ",", "12"}], "]"}], ",", 
   RowBox[{"Molecule", "[", 
    RowBox[{
     RowBox[{"SelfJoined", "[", 
      RowBox[{"\<\"C\"\>", ",", "2"}], "]"}], ",", 
     RowBox[{"SelfJoined", "[", 
      RowBox[{"\<\"H\"\>", ",", "5"}], "]"}]}], "]"}], ",", "\<\"Mn\"\>"}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.489159247473517*^9, 3.489159259313634*^9}, 
   3.489160700069565*^9, 3.4902180938101807`*^9, 3.492383515625842*^9, {
   3.492787497364929*^9, 3.49278751675386*^9}, 3.492787548883368*^9, 
   3.492787648612018*^9}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQ7b/kUPsXeU6HJzXVikkarFD6q32YtaXR5D3/ofR7
e5g4hL4KpZ/aM6ABdHHZmFsrq4p+wdXDzIHJw+zBrh5mH6sDTJ0Hr8/d0GYm
uDsb36xKzTvLDudXhprsPm8gCFe/6zTnuzZxXrg8xHwuB5h7IOr44Xyxo8n/
b18VhquH2CfkgOp+UQz1MPsAFxmEQQ==
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 11}, {1, 14}, {1, 21}, {2, 3}, {2, 10}, {3, 4}, {3,
        7}, {4, 5}, {4, 6}, {7, 8}, {7, 9}, {11, 12}, {11, 13}, {14, 15}, {14,
        18}, {15, 16}, {15, 17}, {18, 19}, {18, 20}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{
                 RowBox[{"Molecule", "[", 
                   RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], ",", "2"}], 
               "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"C\"", ",", "12"}], "]"}], ",", 
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"C\"", ",", "2"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"H\"", ",", "5"}], "]"}]}], "]"}], ",", 
             "\"Mn\""}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined[
           $CellContext`Molecule[
            $CellContext`SelfJoined["Ca", 3], 
            $CellContext`SelfJoined["H", 4]], 2], 
          $CellContext`SelfJoined["C", 12], 
          $CellContext`Molecule[
           $CellContext`SelfJoined["C", 2], 
           $CellContext`SelfJoined["H", 5]], "Mn"]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], ",", "2"}], 
           "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined[
          $CellContext`Molecule[
           $CellContext`SelfJoined["Ca", 3], 
           $CellContext`SelfJoined["H", 4]], 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined["Ca", 3], 
          $CellContext`SelfJoined["H", 4]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"Ca\"", ",", "3"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["Ca", 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"H\"", ",", "4"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["H", 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"H\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"H\"", HoldForm]],
       Annotation[#, 
        HoldForm["H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"C\"", ",", "12"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["C", 12]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"C\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["\"C\"", HoldForm]],
       Annotation[#, 
        HoldForm["C"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["12",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["12", HoldForm]],
       Annotation[#, 
        HoldForm[12], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"C\"", ",", "2"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"H\"", ",", "5"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined["C", 2], 
          $CellContext`SelfJoined["H", 5]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"C\"", ",", "2"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["C", 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"C\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"C\"", HoldForm]],
       Annotation[#, 
        HoldForm["C"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"H\"", ",", "5"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["H", 5]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"H\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"H\"", HoldForm]],
       Annotation[#, 
        HoldForm["H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["5",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["5", HoldForm]],
       Annotation[#, 
        HoldForm[5], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mn\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.025],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"Mn\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mn"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQ7b/kUPsXeU6HJzXVikkarFD6q32YtaXR5D3/ofR7
e5g4hL4KpZ/aM6ABdHHZmFsrq4p+wdXDzIHJw+zBrh5mH6sDTJ0Hr8/d0GYm
uDsb36xKzTvLDudXhprsPm8gCFe/6zTnuzZxXrg8xHwuB5h7IOr44Xyxo8n/
b18VhquH2CfkgOp+UQz1MPsAFxmEQQ==
     "]]& ],
  AspectRatio->NCache[Rational[1, 4] 5^Rational[1, 2], 0.5590169943749475],
  FrameTicks->Automatic,
  ImageSize->{648.8000000000004, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.489159247473517*^9, 3.489159259313634*^9}, 
   3.489160700069565*^9, 3.4902180938101807`*^9, 3.492383515625842*^9, {
   3.492787497364929*^9, 3.49278751675386*^9}, 3.492787548883368*^9, 
   3.4927876486958847`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MoleculeToAtoms", "[", "%%", "]"}]], "Input",
 CellChangeTimes->{{3.4927875014725523`*^9, 3.492787509535851*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"C\"\>", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"Ca\"\>", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"H\"\>", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"Mn\"\>", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.492787510018409*^9, 3.4927875522657223`*^9, 
  3.492787651437561*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ParseMolecule", "[", "\"\<(Ca3H4(Ca4O3)4)2\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TreeForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.489160799310014*^9, 3.489160799819289*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Molecule", "[", 
    RowBox[{"SelfJoined", "[", 
     RowBox[{
      RowBox[{"Molecule", "[", 
       RowBox[{
        RowBox[{"SelfJoined", "[", 
         RowBox[{"\<\"Ca\"\>", ",", "3"}], "]"}], ",", 
        RowBox[{"SelfJoined", "[", 
         RowBox[{"\<\"H\"\>", ",", "4"}], "]"}], ",", 
        RowBox[{"SelfJoined", "[", 
         RowBox[{
          RowBox[{"Molecule", "[", 
           RowBox[{
            RowBox[{"SelfJoined", "[", 
             RowBox[{"\<\"Ca\"\>", ",", "4"}], "]"}], ",", 
            RowBox[{"SelfJoined", "[", 
             RowBox[{"\<\"O\"\>", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
         "]"}]}], "]"}], ",", "2"}], "]"}], "]"}], ",", "\<\"\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.48916080023202*^9, 3.490218094561947*^9, 
  3.492383516447468*^9, 3.492787542571299*^9}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQ7flp9oOqRawOEFrUQWp16wGXbiYoLQTnXzt+z0H2
BR+U/mdfYbmJYeNODgcIfcMepo4BCiDiP6DqXtjD+DD9MPWo6n5giC9vOKHw
/AK3A6o4hwN29S/g5sPcAfMfjA/zB0w9zHyYfHN71YaV/wVwqP9hDzMP1R0c
8PACAIzmjeE=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 21}, {2, 3}, {3, 4}, {3, 20}, {4, 5}, {4, 8}, {4, 
       11}, {5, 6}, {5, 7}, {8, 9}, {8, 10}, {11, 12}, {11, 19}, {12, 13}, {
       12, 16}, {13, 14}, {13, 15}, {16, 17}, {16, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{"SelfJoined", "[", 
                 RowBox[{
                   RowBox[{"Molecule", "[", 
                    RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"H\"", ",", "4"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
                    "]"}]}], "]"}], ",", "2"}], "]"}], "]"}], ",", "\"\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          $CellContext`Molecule[
           $CellContext`SelfJoined[
            $CellContext`Molecule[
             $CellContext`SelfJoined["Ca", 3], 
             $CellContext`SelfJoined["H", 4], 
             $CellContext`SelfJoined[
              $CellContext`Molecule[
               $CellContext`SelfJoined["Ca", 4], 
               $CellContext`SelfJoined["O", 3]], 4]], 2]], ""}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"SelfJoined", "[", 
             RowBox[{
               RowBox[{"Molecule", "[", 
                 RowBox[{
                   RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                   RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"H\"", ",", "4"}], "]"}], ",", 
                   RowBox[{"SelfJoined", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
                    "]"}]}], "]"}], ",", "2"}], "]"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined[
           $CellContext`Molecule[
            $CellContext`SelfJoined["Ca", 3], 
            $CellContext`SelfJoined["H", 4], 
            $CellContext`SelfJoined[
             $CellContext`Molecule[
              $CellContext`SelfJoined["Ca", 4], 
              $CellContext`SelfJoined["O", 3]], 4]], 2]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"H\"", ",", "4"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
                   "]"}]}], "]"}], ",", "2"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined[
          $CellContext`Molecule[
           $CellContext`SelfJoined["Ca", 3], 
           $CellContext`SelfJoined["H", 4], 
           $CellContext`SelfJoined[
            $CellContext`Molecule[
             $CellContext`SelfJoined["Ca", 4], 
             $CellContext`SelfJoined["O", 3]], 4]], 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"H\"", ",", "4"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{
                 RowBox[{"Molecule", "[", 
                   RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
               "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined["Ca", 3], 
          $CellContext`SelfJoined["H", 4], 
          $CellContext`SelfJoined[
           $CellContext`Molecule[
            $CellContext`SelfJoined["Ca", 4], 
            $CellContext`SelfJoined["O", 3]], 4]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"Ca\"", ",", "3"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["Ca", 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"H\"", ",", "4"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["H", 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"H\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"H\"", HoldForm]],
       Annotation[#, 
        HoldForm["H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
           "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined[
          $CellContext`Molecule[
           $CellContext`SelfJoined["Ca", 4], 
           $CellContext`SelfJoined["O", 3]], 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined["Ca", 4], 
          $CellContext`SelfJoined["O", 3]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"Ca\"", ",", "4"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["Ca", 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"O\"", ",", "3"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["O", 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"O\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\"O\"", HoldForm]],
       Annotation[#, 
        HoldForm["O"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.02666666666666667],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"\"", HoldForm]],
       Annotation[#, 
        HoldForm[""], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQ7flp9oOqRawOEFrUQWp16wGXbiYoLQTnXzt+z0H2
BR+U/mdfYbmJYeNODgcIfcMepo4BCiDiP6DqXtjD+DD9MPWo6n5giC9vOKHw
/AK3A6o4hwN29S/g5sPcAfMfjA/zB0w9zHyYfHN71YaV/wVwqP9hDzMP1R0c
8PACAIzmjeE=
     "]]& ],
  AspectRatio->NCache[2 Rational[2, 15]^Rational[1, 2], 0.7302967433402214],
  FrameTicks->Automatic,
  ImageSize->{536.8000000000002, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.48916080023202*^9, 3.490218094561947*^9, 
  3.492383516447468*^9, 3.492787542986528*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ParseMolecule", "[", "\"\<(Ca3H4(Ca4O3)4)2\>\"", "]"}], 
  "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"TreeForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.489160734265356*^9, 3.489160741499011*^9}}],

Cell[BoxData[
 RowBox[{"SelfJoined", "[", 
  RowBox[{
   RowBox[{"Molecule", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"SelfJoined", "[", 
        RowBox[{"\<\"Ca\"\>", ",", "3"}], "]"}], ",", 
       RowBox[{"SelfJoined", "[", 
        RowBox[{"\<\"H\"\>", ",", "4"}], "]"}]}], "]"}], ",", 
     RowBox[{"SelfJoined", "[", 
      RowBox[{
       RowBox[{"Molecule", "[", 
        RowBox[{
         RowBox[{"SelfJoined", "[", 
          RowBox[{"\<\"Ca\"\>", ",", "4"}], "]"}], ",", 
         RowBox[{"SelfJoined", "[", 
          RowBox[{"\<\"O\"\>", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
      "]"}]}], "]"}], ",", "2"}], "]"}]], "Output",
 CellChangeTimes->{{3.489160735903274*^9, 3.489160742022936*^9}, 
   3.490218094906002*^9, 3.492383516877653*^9}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBmIQvYVbMc1wEbvDQr+V+/d28TrYvYqxfL2WxQEmfvzE
DJ6lOz/aQ2hGqPh1ewj93Z4BCiD85/boNMTcv3D1qPRzNHOf2/PsMPvWaC/g
ABOHuQtVHztcPcy9MHdo6z6dVD6NC86HmCOIYT5MvvnmL6UTxsI41H+3h5kH
sxcA9E1xow==
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 19}, {2, 3}, {2, 10}, {3, 4}, {3, 7}, {4, 5}, {4, 
       6}, {7, 8}, {7, 9}, {10, 11}, {10, 18}, {11, 12}, {11, 15}, {12, 13}, {
       12, 14}, {15, 16}, {15, 17}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"Molecule", "[", 
                   RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
                   "]"}]}], "]"}], ",", "2"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined[
          $CellContext`Molecule[
           $CellContext`Molecule[
            $CellContext`SelfJoined["Ca", 3], 
            $CellContext`SelfJoined["H", 4]], 
           $CellContext`SelfJoined[
            $CellContext`Molecule[
             $CellContext`SelfJoined["Ca", 4], 
             $CellContext`SelfJoined["O", 3]], 4]], 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{
                 RowBox[{"Molecule", "[", 
                   RowBox[{
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                    RowBox[{"SelfJoined", "[", 
                    RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
               "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`Molecule[
           $CellContext`SelfJoined["Ca", 3], 
           $CellContext`SelfJoined["H", 4]], 
          $CellContext`SelfJoined[
           $CellContext`Molecule[
            $CellContext`SelfJoined["Ca", 4], 
            $CellContext`SelfJoined["O", 3]], 4]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"Ca\"", ",", "3"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"H\"", ",", "4"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined["Ca", 3], 
          $CellContext`SelfJoined["H", 4]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"Ca\"", ",", "3"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["Ca", 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"H\"", ",", "4"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["H", 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"H\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"H\"", HoldForm]],
       Annotation[#, 
        HoldForm["H"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
                 RowBox[{"SelfJoined", "[", 
                   RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], ",", "4"}], 
           "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined[
          $CellContext`Molecule[
           $CellContext`SelfJoined["Ca", 4], 
           $CellContext`SelfJoined["O", 3]], 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"Ca\"", ",", "4"}], "]"}], ",", 
             RowBox[{"SelfJoined", "[", 
               RowBox[{"\"O\"", ",", "3"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`SelfJoined["Ca", 4], 
          $CellContext`SelfJoined["O", 3]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"Ca\"", ",", "4"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["Ca", 4]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Ca\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"Ca\"", HoldForm]],
       Annotation[#, 
        HoldForm["Ca"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SelfJoined", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"SelfJoined", "[", 
           RowBox[{"\"O\"", ",", "3"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`SelfJoined["O", 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"O\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"O\"", HoldForm]],
       Annotation[#, 
        HoldForm["O"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.027586206896551724`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBmIQvYVbMc1wEbvDQr+V+/d28TrYvYqxfL2WxQEmfvzE
DJ6lOz/aQ2hGqPh1ewj93Z4BCiD85/boNMTcv3D1qPRzNHOf2/PsMPvWaC/g
ABOHuQtVHztcPcy9MHdo6z6dVD6NC86HmCOIYT5MvvnmL6UTxsI41H+3h5kH
sxcA9E1xow==
     "]]& ],
  AspectRatio->NCache[2 Rational[3, 29]^Rational[1, 2], 0.6432675209026769],
  FrameTicks->Automatic,
  ImageSize->{558.4000000000002, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.489160735903274*^9, 3.489160742022936*^9}, 
   3.490218094906002*^9, 3.492383517029904*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Miscellaneous", "Section",
 CellChangeTimes->{{3.490312153897463*^9, 3.49031215856841*^9}}],

Cell["\<\
One of the most human activities is to create a basis of infinite objects. \
BNF is a way to build basis for a particular language.\
\>", "Text",
 CellChangeTimes->{{3.490312165066028*^9, 3.4903122164884987`*^9}, {
  3.4933238990611773`*^9, 3.493323905485182*^9}}],

Cell["\<\
The works of Noam Chomsky a very influential to the theory of compilers (and \
syntactic and semantic analysis).\
\>", "Text",
 CellChangeTimes->{{3.4903122378169327`*^9, 3.4903123311366262`*^9}, {
   3.492845066466022*^9, 3.492845080908889*^9}, 3.493323914028241*^9}],

Cell["Using grammar structures to produce jokes [Pau80]", "Text",
 CellChangeTimes->{{3.493298786569035*^9, 3.493298805594676*^9}}],

Cell["\<\
This is the Interpreter design pattern presented in Gamma et al. [Gam94].\
\>", "Text",
 CellChangeTimes->{{3.489967654616086*^9, 3.489967714855041*^9}, {
  3.489967922327642*^9, 3.4899679299023*^9}, {3.489968063991185*^9, 
  3.489968100046338*^9}, {3.4901227928880777`*^9, 3.490122794900051*^9}}],

Cell[TextData[{
 StyleBox["NIntegrate", "Program"],
 "'s ",
 StyleBox["Method", "Program"],
 " option was implemented the technique described here."
}], "Text",
 CellChangeTimes->{{3.490312488649336*^9, 3.490312540264886*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exercises", "Section",
 CellChangeTimes->{{3.4880713860659103`*^9, 3.488071387681753*^9}}],

Cell["1. Write BNF rules for specifying a postal address.", "Text",
 CellChangeTimes->{{3.490149720891835*^9, 3.490149814892817*^9}, {
  3.490286558224559*^9, 3.490286558227173*^9}, {3.492685676481677*^9, 
  3.492685679062924*^9}, {3.492704625926889*^9, 3.4927046385354757`*^9}}],

Cell[TextData[{
 "2. Choose a function from ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " like ",
 StyleBox["NIntegrate", "Program"],
 " or ",
 StyleBox["NDSolve", "Program"],
 " and write BNF for its signature and options."
}], "Text",
 CellChangeTimes->{{3.490286559873365*^9, 3.490286613921096*^9}, {
  3.492703006332735*^9, 3.4927030076230593`*^9}}],

Cell["3. Write a program that generates random molecules. ", "Text",
 CellChangeTimes->{{3.492686039567178*^9, 3.492686137015239*^9}, {
  3.493165251706759*^9, 3.493165252009783*^9}, {3.493289389649736*^9, 
  3.4932893896538754`*^9}}],

Cell[TextData[{
 "4. Using Exercise 3, generate, say, ",
 Cell[BoxData[
  FormBox["200", TraditionalForm]]],
 " molecules and find the minimal, maximal, mean, and median number of \
terminal symbols in them."
}], "Text",
 CellChangeTimes->{{3.492686039567178*^9, 3.492686137015239*^9}, {
  3.493165251706759*^9, 3.493165252009783*^9}, {3.493289389649736*^9, 
  3.493289403648836*^9}, {3.493289844450962*^9, 3.4932898622005243`*^9}}],

Cell[TextData[{
 "5. Using random molecules from Exercise 3 measure how long it takes for \
each implementation of ",
 StyleBox["MoleculeToAtoms", "Program"],
 " to find the number of atoms of each element. Do timing measurements using \
one large molecule, and a certain number of small molecules."
}], "Text",
 CellChangeTimes->{{3.493083006921465*^9, 3.49308316101803*^9}, {
  3.493164023564445*^9, 3.493164096282073*^9}, {3.493165232289493*^9, 
  3.4931652336405067`*^9}, {3.493165273359604*^9, 3.4931653397447767`*^9}, {
  3.4931653715338907`*^9, 3.4931653715394278`*^9}, {3.493165459110487*^9, 
  3.4931655457563047`*^9}, {3.493165674696373*^9, 3.4931657141771173`*^9}, {
  3.4931659649493027`*^9, 3.493165965505842*^9}, {3.493289268385933*^9, 
  3.4932893116758223`*^9}, {3.4932898655292683`*^9, 3.493289871467855*^9}}],

Cell[TextData[{
 "6. Parse all the molecules from a class in ",
 StyleBox["ChemicalData", "Program"],
 ", and categorize them according to their syntactical structure."
}], "Text",
 CellChangeTimes->{{3.493083006921465*^9, 3.49308316101803*^9}, {
  3.493164023564445*^9, 3.493164096282073*^9}, {3.493165232289493*^9, 
  3.4931652336405067`*^9}, {3.493165273359604*^9, 3.4931653397447767`*^9}, {
  3.4931653715338907`*^9, 3.4931653715394278`*^9}, {3.493165459110487*^9, 
  3.4931655457563047`*^9}, {3.493165674696373*^9, 3.4931657141771173`*^9}, {
  3.4931659649493027`*^9, 3.493165965505842*^9}, {3.493289268385933*^9, 
  3.4932893116758223`*^9}, {3.4932898655292683`*^9, 3.4932898743052597`*^9}, {
  3.4932899061957617`*^9, 3.493289942265527*^9}}],

Cell[TextData[{
 "7. Define the functions ",
 StyleBox["CapitalLetterFirstQ", "Program"],
 ", ",
 StyleBox["DigitFirstQ", "Program"],
 ", ",
 StyleBox["LeftParethesisFirstQ", "Program"],
 ", ",
 StyleBox["RightParethesisFirstQ", "Program"],
 ", ",
 StyleBox["UnderscoreFirstQ", "Program"],
 " in the section \"Parser of chemical formulas\" using regular expressions."
}], "Text",
 CellChangeTimes->{{3.494616051728664*^9, 3.4946161482042313`*^9}}],

Cell[TextData[{
 "8. Using ",
 StyleBox["GraphPlot", "Program"],
 " create the plot shown on Figure 2.1."
}], "Text",
 CellChangeTimes->{{3.494649091359934*^9, 3.494649147460915*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solutions", "Section",
 CellChangeTimes->{{3.492680797571886*^9, 3.492680799925769*^9}}],

Cell[CellGroupData[{

Cell["Exercise 3: Program that generates random molecules", "Subsection",
 CellChangeTimes->{{3.492680806450089*^9, 3.492680836142811*^9}, {
  3.4926990848463078`*^9, 3.492699094901738*^9}, {3.4931636639855213`*^9, 
  3.493163667707034*^9}}],

Cell[TextData[{
 "The solution we present is to program a random selection of the symbol \
sequences for each rule in the BNF form. In this solution we do not restrict \
the recursion depth, instead we rely on ",
 StyleBox["Mathematica'",
  FontSlant->"Italic"],
 "s limiting of recursion process. (In other words, when ",
 StyleBox["$RecursionLimit", "Program"],
 " is exceeded we will get messages.)"
}], "Text",
 CellChangeTimes->{{3.4927001954760857`*^9, 3.492700236648273*^9}, {
  3.492700342189107*^9, 3.492700404118636*^9}, {3.49270048538151*^9, 
  3.492700494974416*^9}, {3.492700648622837*^9, 3.492700713502471*^9}, {
  3.492700753142398*^9, 3.492700787441601*^9}, {3.492700863002791*^9, 
  3.4927009323185453`*^9}, {3.4927014686627073`*^9, 3.492701487728416*^9}, {
  3.492702091770329*^9, 3.492702092624054*^9}, {3.492787104153482*^9, 
  3.492787109398552*^9}}],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.492699104042303*^9, 3.49269911277453*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "RandomMolecule", ",", "RandomElement", ",", "RandomReplicated", ",", 
   "RandomJoined"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elementNames", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ElementData", "[", 
      RowBox[{"#", ",", "\"\<Abbreviation\>\""}], "]"}], "&"}], "/@", 
    RowBox[{"ElementData", "[", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomMolecule", "[", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"First", "[", 
       RowBox[{"RandomSample", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "RandomElement", ",", "RandomReplicated", ",", "RandomJoined"}], 
          "}"}], ",", "1"}], "]"}], "]"}], "[", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomElement", "[", "]"}], ":=", 
   RowBox[{"First", "[", 
    RowBox[{"RandomSample", "[", 
     RowBox[{"elementNames", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomReplicated", "[", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Molecule", "[", 
    RowBox[{"Replicated", "[", 
     RowBox[{
      RowBox[{"RandomMolecule", "[", "]"}], ",", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "20"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomJoined", "[", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"RandomMolecule", "[", "]"}], ",", 
       RowBox[{"RandomMolecule", "[", "]"}]}], "]"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.492681549204934*^9, 3.492681618552347*^9}, {
   3.4926817328219223`*^9, 3.492681740167677*^9}, {3.492685326782197*^9, 
   3.4926853564953623`*^9}, {3.492685456111994*^9, 3.492685462047361*^9}, {
   3.4926862877585983`*^9, 3.492686333312634*^9}, {3.4926863707804613`*^9, 
   3.4926863758512363`*^9}, {3.492686557762587*^9, 3.492686566000868*^9}, 
   3.4927018559563313`*^9, {3.4928981686630087`*^9, 3.492898174009736*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Experiments", "Subsubsection",
 CellChangeTimes->{{3.4926991196811047`*^9, 3.492699123230132*^9}, 
   3.4927001822885923`*^9}],

Cell["Generate a random molecule:", "Text",
 CellChangeTimes->{{3.492701603348834*^9, 3.492701610286397*^9}, 
   3.492702441432564*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rm", "=", 
  RowBox[{"RandomMolecule", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.49268518556705*^9, 3.4926851903359203`*^9}, {
  3.492686213376528*^9, 3.492686213932629*^9}}],

Cell[BoxData[
 RowBox[{"Molecule", "[", 
  RowBox[{
   RowBox[{"Molecule", "[", 
    RowBox[{"Replicated", "[", 
     RowBox[{
      RowBox[{"Molecule", "[", 
       RowBox[{
        RowBox[{"Molecule", "[", 
         RowBox[{
          RowBox[{"Molecule", "[", 
           RowBox[{"\<\"Re\"\>", ",", 
            RowBox[{"Molecule", "[", 
             RowBox[{"Replicated", "[", 
              RowBox[{
               RowBox[{"Molecule", "[", 
                RowBox[{
                 RowBox[{"Molecule", "[", 
                  RowBox[{"\<\"Nb\"\>", ",", "\<\"Hs\"\>"}], "]"}], ",", 
                 RowBox[{"Molecule", "[", 
                  RowBox[{"\<\"Sr\"\>", ",", 
                   RowBox[{"Molecule", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{"\<\"Ca\"\>", ",", "\<\"Uuq\"\>"}], "]"}], 
                    ",", "\<\"Mn\"\>"}], "]"}], ",", 
                    RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\<\"Sn\"\>", ",", "10"}], "]"}], "]"}], ",", 
                    "2"}], "]"}], "]"}]}], "]"}], ",", "11"}], "]"}], "]"}], 
                    ",", "\<\"Fe\"\>"}], "]"}]}], "]"}]}], "]"}], ",", "18"}],
               "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Molecule", "[", 
           RowBox[{"Replicated", "[", 
            RowBox[{"\<\"Ra\"\>", ",", "18"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"Molecule", "[", 
         RowBox[{"Replicated", "[", 
          RowBox[{"\<\"V\"\>", ",", "18"}], "]"}], "]"}]}], "]"}], ",", "5"}],
      "]"}], "]"}], ",", "\<\"In\"\>"}], "]"}]], "Output",
 CellChangeTimes->{{3.492685770842719*^9, 3.492685803321932*^9}, {
   3.49268615133123*^9, 3.492686155075577*^9}, 3.492686214683428*^9, {
   3.4926992120271883`*^9, 3.492699214561928*^9}, {3.4926992484414597`*^9, 
   3.492699250215094*^9}, {3.492898310626635*^9, 3.4928983282239447`*^9}, {
   3.4928983782236223`*^9, 3.4928984000643787`*^9}, {3.493082692494368*^9, 
   3.493082706288686*^9}, {3.4930827623091917`*^9, 3.4930827630544252`*^9}, {
   3.493163379005888*^9, 3.4931633991096067`*^9}}]
}, Open  ]],

Cell["Convert the molecule structure to a string:", "Text",
 CellChangeTimes->{{3.492701616573164*^9, 3.492701622583343*^9}, {
   3.492701736350709*^9, 3.49270174848673*^9}, {3.49270230718264*^9, 
   3.492702309854507*^9}, 3.4927024391025763`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MoleculeToString", "[", "rm", "]"}]], "Input",
 CellChangeTimes->{{3.492685287657516*^9, 3.492685294247603*^9}, {
   3.492685721628056*^9, 3.492685726904372*^9}, {3.4926861433922853`*^9, 
   3.492686149140197*^9}, {3.4926862178051157`*^9, 3.492686230472063*^9}, {
   3.49268633777735*^9, 3.492686363409606*^9}, 3.492702287533454*^9}],

Cell[BoxData["\<\"At((Cu(P9)9)12)15\"\>"], "Output",
 CellChangeTimes->{
  3.4927023112979403`*^9, 3.492898330178277*^9, {3.492898379845252*^9, 
   3.49289840148289*^9}}]
}, Open  ]],

Cell["\<\
Find the depth of the expression tree and the number of terminal symbols:\
\>", "Text",
 CellChangeTimes->{{3.492702366953889*^9, 3.492702436839239*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Depth", "[", "rm", "]"}], ",", 
   RowBox[{"NumberOfTerminals", "[", "rm", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.492685287657516*^9, 3.492685294247603*^9}, {
  3.492685721628056*^9, 3.492685726904372*^9}, {3.4926861433922853`*^9, 
  3.492686149140197*^9}, {3.4926862178051157`*^9, 3.492686230472063*^9}, {
  3.49268633777735*^9, 3.492686363409606*^9}, {3.492702287533454*^9, 
  3.49270228941468*^9}, {3.492702423968261*^9, 3.49270242430373*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"11", ",", "7"}], "}"}]], "Output",
 CellChangeTimes->{
  3.49270231554849*^9, 3.4928983322659063`*^9, {3.492898381929497*^9, 
   3.492898402835032*^9}}]
}, Open  ]],

Cell["Show the tree of the expression representing the molecule", "Text",
 CellChangeTimes->{{3.492702447661729*^9, 3.492702477190477*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", "rm", "]"}]], "Input",
 CellChangeTimes->{{3.492685287657516*^9, 3.492685294247603*^9}, {
  3.492685721628056*^9, 3.492685726904372*^9}, {3.4926861433922853`*^9, 
  3.492686149140197*^9}, {3.4926862178051157`*^9, 3.492686230472063*^9}, {
  3.49268633777735*^9, 3.492686363409606*^9}, {3.492702287533454*^9, 
  3.49270228941468*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{0.917662935482247, 9.17662935482247}, {
    0.4588314677411235, 8.258966419340224}, {1.3764944032233704`, 
    8.258966419340224}, {1.3764944032233704`, 7.341303483857976}, {
    0.917662935482247, 6.4236405483757295`}, {0.917662935482247, 
    5.505977612893482}, {0.4588314677411235, 4.588314677411235}, {0., 
    3.670651741928989}, {0.917662935482247, 3.670651741928989}, {
    0.917662935482247, 2.7529888064467416`}, {0.4588314677411235, 
    1.8353258709644944`}, {0.4588314677411235, 0.9176629354822481}, {0., 
    0.}, {0.917662935482247, 0.}, {1.3764944032233704`, 
    1.8353258709644944`}, {1.3764944032233704`, 4.588314677411235}, {
    1.835325870964494, 6.4236405483757295`}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {3, 4}, {4, 5}, {4, 17}, {5, 6}, {6, 7}, {6, 
       16}, {7, 8}, {7, 9}, {9, 10}, {10, 11}, {10, 15}, {11, 12}, {12, 13}, {
       12, 14}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"\"At\"", ",", 
             RowBox[{"Molecule", "[", 
               RowBox[{"Replicated", "[", 
                 RowBox[{
                   RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{"\"Cu\"", ",", 
                    RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"P\"", ",", "9"}], "]"}], "]"}], ",", "9"}], 
                    "]"}], "]"}]}], "]"}], ",", "12"}], "]"}], "]"}], ",", 
                   "15"}], "]"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule["At", 
          $CellContext`Molecule[
           $CellContext`Replicated[
            $CellContext`Molecule[
             $CellContext`Replicated[
              $CellContext`Molecule["Cu", 
               $CellContext`Molecule[
                $CellContext`Replicated[
                 $CellContext`Molecule[
                  $CellContext`Replicated["P", 9]], 9]]], 12]], 15]]]], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"At\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"At\"", HoldForm]],
       Annotation[#, 
        HoldForm["At"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"Replicated", "[", 
             RowBox[{
               RowBox[{"Molecule", "[", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{"\"Cu\"", ",", 
                    RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"P\"", ",", "9"}], "]"}], "]"}], ",", "9"}], 
                    "]"}], "]"}]}], "]"}], ",", "12"}], "]"}], "]"}], ",", 
               "15"}], "]"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`Replicated[
           $CellContext`Molecule[
            $CellContext`Replicated[
             $CellContext`Molecule["Cu", 
              $CellContext`Molecule[
               $CellContext`Replicated[
                $CellContext`Molecule[
                 $CellContext`Replicated["P", 9]], 9]]], 12]], 15]]], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{"Replicated", "[", 
                 RowBox[{
                   RowBox[{"Molecule", "[", 
                    RowBox[{"\"Cu\"", ",", 
                    RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"P\"", ",", "9"}], "]"}], "]"}], ",", "9"}], 
                    "]"}], "]"}]}], "]"}], ",", "12"}], "]"}], "]"}], ",", 
             "15"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated[
          $CellContext`Molecule[
           $CellContext`Replicated[
            $CellContext`Molecule["Cu", 
             $CellContext`Molecule[
              $CellContext`Replicated[
               $CellContext`Molecule[
                $CellContext`Replicated["P", 9]], 9]]], 12]], 15]], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"Replicated", "[", 
             RowBox[{
               RowBox[{"Molecule", "[", 
                 RowBox[{"\"Cu\"", ",", 
                   RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"P\"", ",", "9"}], "]"}], "]"}], ",", "9"}], 
                    "]"}], "]"}]}], "]"}], ",", "12"}], "]"}], "]"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`Replicated[
           $CellContext`Molecule["Cu", 
            $CellContext`Molecule[
             $CellContext`Replicated[
              $CellContext`Molecule[
               $CellContext`Replicated["P", 9]], 9]]], 12]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{"\"Cu\"", ",", 
                 RowBox[{"Molecule", "[", 
                   RowBox[{"Replicated", "[", 
                    RowBox[{
                    RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"P\"", ",", "9"}], "]"}], "]"}], ",", "9"}], 
                    "]"}], "]"}]}], "]"}], ",", "12"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated[
          $CellContext`Molecule["Cu", 
           $CellContext`Molecule[
            $CellContext`Replicated[
             $CellContext`Molecule[
              $CellContext`Replicated["P", 9]], 9]]], 12]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"\"Cu\"", ",", 
             RowBox[{"Molecule", "[", 
               RowBox[{"Replicated", "[", 
                 RowBox[{
                   RowBox[{"Molecule", "[", 
                    RowBox[{"Replicated", "[", 
                    RowBox[{"\"P\"", ",", "9"}], "]"}], "]"}], ",", "9"}], 
                 "]"}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule["Cu", 
          $CellContext`Molecule[
           $CellContext`Replicated[
            $CellContext`Molecule[
             $CellContext`Replicated["P", 9]], 9]]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Cu\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"Cu\"", HoldForm]],
       Annotation[#, 
        HoldForm["Cu"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"Replicated", "[", 
             RowBox[{
               RowBox[{"Molecule", "[", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"\"P\"", ",", "9"}], "]"}], "]"}], ",", "9"}], 
             "]"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`Replicated[
           $CellContext`Molecule[
            $CellContext`Replicated["P", 9]], 9]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{
             RowBox[{"Molecule", "[", 
               RowBox[{"Replicated", "[", 
                 RowBox[{"\"P\"", ",", "9"}], "]"}], "]"}], ",", "9"}], "]"}],
          HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated[
          $CellContext`Molecule[
           $CellContext`Replicated["P", 9]], 9]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Molecule", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"Molecule", "[", 
           RowBox[{"Replicated", "[", 
             RowBox[{"\"P\"", ",", "9"}], "]"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Molecule[
          $CellContext`Replicated["P", 9]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Replicated", "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"Replicated", "[", 
           RowBox[{"\"P\"", ",", "9"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         $CellContext`Replicated["P", 9]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"P\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"P\"", HoldForm]],
       Annotation[#, 
        HoldForm["P"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["9",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["9", HoldForm]],
       Annotation[#, 
        HoldForm[9], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["9",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["9", HoldForm]],
       Annotation[#, 
        HoldForm[9], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["12",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["12", HoldForm]],
       Annotation[#, 
        HoldForm[12], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["15",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["15", HoldForm]],
       Annotation[#, 
        HoldForm[15], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{0.917662935482247, 9.17662935482247}, {
     0.4588314677411235, 8.258966419340224}, {1.3764944032233704`, 
     8.258966419340224}, {1.3764944032233704`, 7.341303483857976}, {
     0.917662935482247, 6.4236405483757295`}, {0.917662935482247, 
     5.505977612893482}, {0.4588314677411235, 4.588314677411235}, {0., 
     3.670651741928989}, {0.917662935482247, 3.670651741928989}, {
     0.917662935482247, 2.7529888064467416`}, {0.4588314677411235, 
     1.8353258709644944`}, {0.4588314677411235, 0.9176629354822481}, {0., 
     0.}, {0.917662935482247, 0.}, {1.3764944032233704`, 
     1.8353258709644944`}, {1.3764944032233704`, 4.588314677411235}, {
     1.835325870964494, 6.4236405483757295`}}]& ],
  AspectRatio->NCache[Rational[11, 5]^Rational[1, 2], 1.4832396974191326`],
  FrameTicks->Automatic,
  ImageSize->{168.5, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.492685297541953*^9, 3.492685313037826*^9}, {
   3.4926853618317966`*^9, 3.492685364988758*^9}, 3.492685465315868*^9, {
   3.492685496775428*^9, 3.492685499401875*^9}, {3.492685537237131*^9, 
   3.492685558299574*^9}, {3.4926856275631847`*^9, 3.492685641307332*^9}, {
   3.492685714058008*^9, 3.492685735077372*^9}, {3.492685776555581*^9, 
   3.492685805010724*^9}, 3.492686156395032*^9, 3.492686231313054*^9, {
   3.492686364249441*^9, 3.4926863795528803`*^9}, {3.492699215997541*^9, 
   3.492699251547838*^9}, 3.492702332156609*^9, 3.492898335244874*^9, {
   3.4928983843812437`*^9, 3.492898407117639*^9}}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exercise 4: Statistics over random molecules", "Subsection",
 CellChangeTimes->{{3.4926991298683*^9, 3.492699165430468*^9}, {
   3.493290170409193*^9, 3.493290172073227*^9}, {3.493290412832588*^9, 
   3.493290413209785*^9}, 3.493290445632596*^9, {3.493290503947741*^9, 
   3.4932905097603416`*^9}, {3.493290621764135*^9, 3.4932906280964518`*^9}, 
   3.493323921900614*^9}],

Cell[TextData[{
 "To find the number of terminal symbols we find all the strings and integers \
in a structure (using ",
 StyleBox["Cases", "Program"],
 ")."
}], "Text",
 CellChangeTimes->{{3.492701835637718*^9, 3.492701846646261*^9}, {
  3.492702000042366*^9, 3.4927020679983807`*^9}}],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.4932904521853724`*^9, 3.493290480769104*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "NumberOfTerminals", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfTerminals", "[", "m_String", "]"}], ":=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfTerminals", "[", "m_Molecule", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"Cases", "[", 
      RowBox[{"m", ",", "_String", ",", "\[Infinity]"}], "]"}], "]"}], "+", 
    RowBox[{"Length", "[", 
     RowBox[{"Cases", "[", 
      RowBox[{"m", ",", "_Integer", ",", "\[Infinity]"}], "]"}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.492681549204934*^9, 3.492681618552347*^9}, {
  3.4926817328219223`*^9, 3.492681740167677*^9}, {3.492685326782197*^9, 
  3.4926853564953623`*^9}, {3.492685456111994*^9, 3.492685462047361*^9}, {
  3.4926862877585983`*^9, 3.492686333312634*^9}, {3.4926863707804613`*^9, 
  3.4926863758512363`*^9}, {3.492686557762587*^9, 3.492686566000868*^9}, {
  3.4927018559563313`*^9, 3.4927018631073933`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Experiments", "Subsubsection",
 CellChangeTimes->{{3.493290489651391*^9, 3.4932904967208233`*^9}}],

Cell[TextData[{
 "Generate ",
 Cell[BoxData[
  FormBox["200", TraditionalForm]]],
 " random molecules:"
}], "Text",
 CellChangeTimes->{{3.492702506812499*^9, 3.4927025751346197`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rms", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomMolecule", "[", "]"}], ",", 
     RowBox[{"{", "200", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.492685845314012*^9, 3.492685908856537*^9}, {
  3.492686001327334*^9, 3.492686001970302*^9}, {3.4926994330709047`*^9, 
  3.492699433311256*^9}, {3.4927025123599873`*^9, 3.492702514025407*^9}, {
  3.492702548368108*^9, 3.492702548467106*^9}}],

Cell["\<\
Find descriptive statics on the depth and number of terminal symbols:\
\>", "Text",
 CellChangeTimes->{{3.492702583942896*^9, 3.492702616934503*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Min", ",", "Max", ",", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{"Mean", "[", "#", "]"}], "]"}], "&"}], ",", "Median", ",", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{"StandardDeviation", "[", "#", "]"}], "]"}], "&"}]}], "}"}], 
   "[", 
   RowBox[{"Depth", "/@", "rms"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Min", ",", "Max", ",", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{"Mean", "[", "#", "]"}], "]"}], "&"}], ",", "Median", ",", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{"StandardDeviation", "[", "#", "]"}], "]"}], "&"}]}], "}"}], 
   "[", 
   RowBox[{"NumberOfTerminals", "/@", "rms"}], "]"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.4926858847386923`*^9, 3.4926859910486803`*^9}, {
   3.492686248768455*^9, 3.492686254818035*^9}, {3.4926865237813797`*^9, 
   3.49268653492588*^9}, {3.492699388195606*^9, 3.492699425152722*^9}, {
   3.492699499446389*^9, 3.4926995543931026`*^9}, {3.492699625606346*^9, 
   3.492699655089863*^9}, {3.49269969463743*^9, 3.492699716962818*^9}, 
   3.492702581262829*^9, {3.49270262281009*^9, 3.4927026501145477`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "185", ",", "13.355`", ",", 
   FractionBox["7", "2"], ",", "29.94297721373262`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.492702650993285*^9, 3.492704596670549*^9, {3.492898346507474*^9, 
   3.492898362746804*^9}, 3.493165901341918*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1669", ",", "53.43`", ",", "3", ",", "227.47569332848818`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.492702650993285*^9, 3.492704596670549*^9, {3.492898346507474*^9, 
   3.492898362746804*^9}, 3.4931659015888033`*^9}]
}, Open  ]],

Cell["Visualize the depth distribution:", "Text",
 CellChangeTimes->{{3.492702662475486*^9, 3.4927026793374033`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{"Depth", "/@", "rms"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "184", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4926858847386923`*^9, 3.4926859910486803`*^9}, {
   3.492686248768455*^9, 3.492686254818035*^9}, {3.4926865237813797`*^9, 
   3.49268653492588*^9}, {3.492699388195606*^9, 3.492699425152722*^9}, {
   3.492699499446389*^9, 3.4926995543931026`*^9}, {3.492699625606346*^9, 
   3.492699655089863*^9}, {3.49269969463743*^9, 3.492699716962818*^9}, 
   3.492702581262829*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{1, 0}, {2, 65}]},
          
          ImageSizeCache->{{18.75, 
           23.124299550328608`}, {-142.84735183089205`, 
           146.87595205725782`}}]},
        StatusArea[#, 65]& ,
        TagBoxNote->"65"],
       StyleBox["65", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[65, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{2, 0}, {3, 8}]},
          
          ImageSizeCache->{{21.624299550328608`, 25.998599100657213`}, {
           109.90231465563937`, 146.87595205725782`}}]},
        StatusArea[#, 8]& ,
        TagBoxNote->"8"],
       StyleBox["8", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[8, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{3, 0}, {4, 27}]},
          
          ImageSizeCache->{{24.498599100657213`, 28.872898650985817`}, {
           25.652425826795564`, 146.87595205725782`}}]},
        StatusArea[#, 27]& ,
        TagBoxNote->"27"],
       StyleBox["27", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[27, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{4, 0}, {5, 11}]},
          
          ImageSizeCache->{{27.372898650985817`, 31.747198201314426`}, {
           96.59970063003246, 146.87595205725782`}}]},
        StatusArea[#, 11]& ,
        TagBoxNote->"11"],
       StyleBox["11", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[11, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{5, 0}, {6, 13}]},
          
          ImageSizeCache->{{30.247198201314426`, 34.621497751643034`}, {
           87.73129127962784, 146.87595205725782`}}]},
        StatusArea[#, 13]& ,
        TagBoxNote->"13"],
       StyleBox["13", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[13, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{6, 0}, {7, 8}]},
          
          ImageSizeCache->{{33.121497751643034`, 37.495797301971635`}, {
           109.90231465563937`, 146.87595205725782`}}]},
        StatusArea[#, 8]& ,
        TagBoxNote->"8"],
       StyleBox["8", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[8, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{7, 0}, {8, 5}]},
          
          ImageSizeCache->{{35.995797301971635`, 40.37009685230024}, {
           123.20492868124629`, 146.87595205725782`}}]},
        StatusArea[#, 5]& ,
        TagBoxNote->"5"],
       StyleBox["5", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[5, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{8, 0}, {9, 8}]},
          ImageSizeCache->{{38.87009685230024, 43.24439640262885}, {
           109.90231465563937`, 146.87595205725782`}}]},
        StatusArea[#, 8]& ,
        TagBoxNote->"8"],
       StyleBox["8", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[8, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{9, 0}, {10, 3}]},
          
          ImageSizeCache->{{41.74439640262885, 46.11869595295745}, {
           132.0733380316509, 146.87595205725782`}}]},
        StatusArea[#, 3]& ,
        TagBoxNote->"3"],
       StyleBox["3", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[3, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{10, 0}, {11, 5}]},
          
          ImageSizeCache->{{44.61869595295745, 48.99299550328606}, {
           123.20492868124629`, 146.87595205725782`}}]},
        StatusArea[#, 5]& ,
        TagBoxNote->"5"],
       StyleBox["5", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[5, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{11, 0}, {12, 1}]},
          
          ImageSizeCache->{{47.49299550328606, 51.86729505361467}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{12, 0}, {13, 2}]},
          
          ImageSizeCache->{{50.36729505361467, 54.74159460394327}, {
           136.5075427068532, 146.87595205725782`}}]},
        StatusArea[#, 2]& ,
        TagBoxNote->"2"],
       StyleBox["2", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[2, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{13, 0}, {14, 4}]},
          
          ImageSizeCache->{{53.24159460394327, 57.615894154271885`}, {
           127.63913335644861`, 146.87595205725782`}}]},
        StatusArea[#, 4]& ,
        TagBoxNote->"4"],
       StyleBox["4", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[4, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{14, 0}, {15, 2}]},
          
          ImageSizeCache->{{56.115894154271885`, 60.490193704600486`}, {
           136.5075427068532, 146.87595205725782`}}]},
        StatusArea[#, 2]& ,
        TagBoxNote->"2"],
       StyleBox["2", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[2, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{15, 0}, {16, 3}]},
          
          ImageSizeCache->{{58.990193704600486`, 63.36449325492909}, {
           132.0733380316509, 146.87595205725782`}}]},
        StatusArea[#, 3]& ,
        TagBoxNote->"3"],
       StyleBox["3", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[3, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{16, 0}, {17, 1}]},
          
          ImageSizeCache->{{61.86449325492909, 66.2387928052577}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{17, 0}, {18, 4}]},
          
          ImageSizeCache->{{64.7387928052577, 69.1130923555863}, {
           127.63913335644861`, 146.87595205725782`}}]},
        StatusArea[#, 4]& ,
        TagBoxNote->"4"],
       StyleBox["4", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[4, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{18, 0}, {19, 2}]},
          
          ImageSizeCache->{{67.6130923555863, 71.9873919059149}, {
           136.5075427068532, 146.87595205725782`}}]},
        StatusArea[#, 2]& ,
        TagBoxNote->"2"],
       StyleBox["2", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[2, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{20, 0}, {21, 1}]},
          
          ImageSizeCache->{{73.36169145624352, 77.73599100657212}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{23, 0}, {24, 2}]},
          
          ImageSizeCache->{{81.98459010722934, 86.35888965755794}, {
           136.5075427068532, 146.87595205725782`}}]},
        StatusArea[#, 2]& ,
        TagBoxNote->"2"],
       StyleBox["2", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[2, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{24, 0}, {25, 1}]},
          
          ImageSizeCache->{{84.85888965755794, 89.23318920788655}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{26, 0}, {27, 1}]},
          
          ImageSizeCache->{{90.60748875821515, 94.98178830854376}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{28, 0}, {29, 1}]},
          
          ImageSizeCache->{{96.35608785887237, 100.73038740920097`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{30, 0}, {31, 1}]},
          
          ImageSizeCache->{{102.10468695952957`, 106.47898650985819`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{33, 0}, {34, 1}]},
          
          ImageSizeCache->{{110.72758561051539`, 115.101885160844}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{37, 0}, {38, 1}]},
          
          ImageSizeCache->{{122.22478381182982`, 126.59908336215842`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{38, 0}, {39, 1}]},
          
          ImageSizeCache->{{125.09908336215842`, 129.473382912487}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{39, 0}, {40, 2}]},
          
          ImageSizeCache->{{127.97338291248701`, 132.34768246281564`}, {
           136.5075427068532, 146.87595205725782`}}]},
        StatusArea[#, 2]& ,
        TagBoxNote->"2"],
       StyleBox["2", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[2, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{42, 0}, {43, 1}]},
          
          ImageSizeCache->{{136.59628156347284`, 140.97058111380144`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{45, 0}, {46, 1}]},
          
          ImageSizeCache->{{145.21918021445867`, 149.59347976478728`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{48, 0}, {49, 1}]},
          
          ImageSizeCache->{{153.84207886544448`, 158.21637841577308`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{51, 0}, {52, 1}]},
          
          ImageSizeCache->{{162.4649775164303, 166.8392770667589}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{53, 0}, {54, 2}]},
          
          ImageSizeCache->{{168.2135766170875, 172.5878761674161}, {
           136.5075427068532, 146.87595205725782`}}]},
        StatusArea[#, 2]& ,
        TagBoxNote->"2"],
       StyleBox["2", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[2, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{58, 0}, {59, 1}]},
          
          ImageSizeCache->{{182.58507436873055`, 186.95937391905915`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{62, 0}, {63, 1}]},
          
          ImageSizeCache->{{194.08227257004498`, 198.45657212037358`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{70, 0}, {71, 1}]},
          
          ImageSizeCache->{{217.07666897267382`, 221.45096852300242`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{86, 0}, {87, 1}]},
          
          ImageSizeCache->{{263.0654617779315, 267.4397613282601}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{92, 0}, {93, 1}]},
          
          ImageSizeCache->{{280.31125907990315`, 284.68555863023175`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{169, 0}, {170, 1}]},
          
          ImageSizeCache->{{501.63232445520583`, 506.00662400553443`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{171, 0}, {172, 1}]},
          
          ImageSizeCache->{{507.38092355586303`, 511.75522310619164`}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{174, 0}, {175, 1}]},
          
          ImageSizeCache->{{516.0038222068488, 520.3781217571774}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}, {{}, 
     TagBox[
      TooltipBox[
       TagBox[
        {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
         EdgeForm[Opacity[0.7]], 
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{177, 0}, {178, 1}]},
          
          ImageSizeCache->{{524.6267208578346, 529.0010204081632}, {
           140.94174738205552`, 146.87595205725782`}}]},
        StatusArea[#, 1]& ,
        TagBoxNote->"1"],
       StyleBox["1", {
         GrayLevel[0]}, StripOnInput -> False]],
      Annotation[#, 
       Style[1, {
         GrayLevel[0]}], "Tooltip"]& ]}}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesOrigin->{1, 0},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.1]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.492685894038085*^9, 3.492685935126876*^9}, {
   3.4926859792543592`*^9, 3.49268600611825*^9}, {3.4926862502618628`*^9, 
   3.492686255474264*^9}, 3.492686539257146*^9, 3.492686570353381*^9, {
   3.492699380504266*^9, 3.4926993936875353`*^9}, {3.492699426357149*^9, 
   3.492699437546598*^9}, 3.492699517486717*^9, 3.492699555129471*^9, {
   3.492699636682955*^9, 3.492699656062701*^9}, 3.492699718526574*^9, 
   3.492699820793988*^9, 3.49270255091774*^9, 3.492704599457139*^9, {
   3.492898350777196*^9, 3.492898366141468*^9}, 3.4931659068870573`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Min", ",", "Max", ",", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{"Mean", "[", "#", "]"}], "]"}], "&"}], ",", "Median", ",", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{"StandardDeviation", "[", "#", "]"}], "]"}], "&"}]}], "}"}], 
   "[", 
   RowBox[{"NumberOfTerminals", "/@", "rms"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4926858847386923`*^9, 3.4926859910486803`*^9}, {
  3.492686248768455*^9, 3.492686254818035*^9}, {3.4926865237813797`*^9, 
  3.49268653492588*^9}, {3.492699388195606*^9, 3.492699471311749*^9}, {
  3.4926995881496*^9, 3.492699612647523*^9}, {3.4926997356337137`*^9, 
  3.49269974350008*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1669", ",", "53.43`", ",", "3", ",", "227.47569332848818`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.49269947178265*^9, {3.492699594659774*^9, 3.492699614533855*^9}, 
   3.492699744992909*^9, 3.492699824664372*^9, 3.492702555535734*^9, 
   3.49270460875937*^9, {3.492898354134658*^9, 3.492898368089464*^9}, 
   3.4931659130086184`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exercise 5: Profiling", "Subsection",
 CellChangeTimes->{{3.493163694448389*^9, 3.49316372628014*^9}, 
   3.4931657331762533`*^9, 3.493290689662921*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rm", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"(", 
     RowBox[{"290", "\[LessEqual]", " ", 
      RowBox[{"LeafCount", "[", "rm", "]"}], "\[LessEqual]", "300"}], ")"}]}],
    ",", 
   RowBox[{"rm", "=", 
    RowBox[{"RandomMolecule", "[", "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.4931637406657543`*^9, 3.493163786075089*^9}, {
  3.49316381720673*^9, 3.493163878889986*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MoleculeToAtoms", "/@", 
    RowBox[{"Table", "[", 
     RowBox[{"rm", ",", 
      RowBox[{"{", "100", "}"}]}], "]"}]}], ";"}], " ", "//", " ", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.4931631939630013`*^9, 3.493163213607836*^9}, {
   3.4931632988905773`*^9, 3.493163300634576*^9}, {3.4931634090752583`*^9, 
   3.4931634150677023`*^9}, {3.493163502258683*^9, 3.493163519540522*^9}, 
   3.4931638064344673`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.9634300000000167`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.4931633016044703`*^9, {3.4931634104312773`*^9, 3.493163416576754*^9}, {
   3.493163508283536*^9, 3.493163508960638*^9}, 3.493163587219914*^9, 
   3.4931638069079657`*^9, {3.4931638850540953`*^9, 3.493163903542132*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exercise 6: Grouping by syntactic analysis trees", "Subsection",
 CellChangeTimes->{{3.49329069629637*^9, 3.493290729064691*^9}, {
  3.493290765365402*^9, 3.493290777968609*^9}, {3.493300050539905*^9, 
  3.4933000658979177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cfs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ChemicalData", "[", 
      RowBox[{"#", ",", "\"\<CompoundFormulaString\>\""}], "]"}], "&"}], "/@", 
    RowBox[{"Apply", "[", 
     RowBox[{"Join", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"ChemicalData", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"ChemicalData", "[", "\"\<Classes\>\"", "]"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cfs", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.493290788634198*^9, 3.493290799473508*^9}, {
   3.4932908793871813`*^9, 3.493290904962159*^9}, {3.4932909773322067`*^9, 
   3.493290986235076*^9}, {3.493291018259489*^9, 3.4932910229013653`*^9}, 
   3.493291794514658*^9, {3.493291953102901*^9, 3.493291953762714*^9}, {
   3.493297827770216*^9, 3.493297829428693*^9}, 3.4938809921125383`*^9, {
   3.493881058409189*^9, 3.4938810758047237`*^9}, {3.493881238728381*^9, 
   3.493881262181161*^9}, 3.49388136287858*^9, {3.4938816042095346`*^9, 
   3.493881606649666*^9}, {3.493881657047936*^9, 3.493881658388568*^9}, {
   3.493881713972891*^9, 3.493881724781188*^9}, {3.493881762647361*^9, 
   3.493881792215714*^9}, {3.4938818289757137`*^9, 3.4938818807271137`*^9}, {
   3.4938823509413652`*^9, 3.4938823559646683`*^9}}],

Cell[BoxData["115486"], "Output",
 CellChangeTimes->{3.493882357797903*^9, 3.493882391746128*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pms", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"ParseMolecule", "[", "#", "]"}], "]"}], "&"}], "/@", "cfs"}],
      ",", 
     RowBox[{"First", "[", "$Failed", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"pms", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.493291027051895*^9, 3.4932910389535723`*^9}, {
   3.493291127410478*^9, 3.493291144793893*^9}, 3.49329117792619*^9, {
   3.493291969876595*^9, 3.4932920063067083`*^9}, {3.493881387895072*^9, 
   3.493881391451983*^9}}],

Cell[BoxData["113297"], "Output",
 CellChangeTimes->{
  3.493881392496518*^9, 3.493881609417993*^9, 3.493881660342696*^9, {
   3.493881715971717*^9, 3.49388172642789*^9}, {3.493881764723624*^9, 
   3.493881793804111*^9}, 3.493881847951365*^9, 3.4938819749265614`*^9, 
   3.493882436022184*^9, 3.493883227883493*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mpatterns", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"pms", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s_String", "\[Rule]", 
        RowBox[{"(", "String", ")"}]}], ",", 
       RowBox[{"n_Integer", "\[Rule]", 
        RowBox[{"(", "Integer", ")"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mpatterns", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.493292215030224*^9, 3.493292274866255*^9}, {
  3.4932923403307343`*^9, 3.4932923521709213`*^9}, {3.493296558592214*^9, 
  3.493296561395557*^9}}],

Cell[BoxData["113"], "Output",
 CellChangeTimes->{3.493296563456126*^9, 3.493297847975095*^9, 
  3.4938802355520906`*^9, 3.493913541546351*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pcounts", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Count", "[", 
     RowBox[{"pms", ",", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{"mpatterns", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"String", "\[Rule]", "_String"}], ",", 
       RowBox[{"Integer", "\[Rule]", "_Integer"}]}], "}"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.4932923609695473`*^9, 3.493292390041991*^9}, {
  3.493292735663932*^9, 3.493292778492137*^9}, {3.493296576638547*^9, 
  3.4932966174432507`*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "486", ",", "186", ",", "38", ",", "473", ",", "442", ",", "1153", ",", 
   "5584", ",", "73", ",", "277", ",", "371", ",", "273", ",", "156", ",", 
   "275", ",", "9210", ",", "18696", ",", "28", ",", "58", ",", "66", ",", 
   "48", ",", "104", ",", "132", ",", "182", ",", "177", ",", "23", ",", "79",
    ",", "334", ",", "276", ",", "10601", ",", "14224", ",", "8683", ",", 
   "10693", ",", "9", ",", "9", ",", "6", ",", "22", ",", "3", ",", "19", ",",
    "9", ",", "59", ",", "14", ",", "27", ",", "25", ",", "21", ",", "6", ",",
    "6", ",", "22", ",", "59", ",", "31", ",", "62", ",", "49", ",", "54", 
   ",", "4178", ",", "4393", ",", "4347", ",", "2729", ",", "1889", ",", 
   "1366", ",", "2560", ",", "1448", ",", "11", ",", "14", ",", "11", ",", 
   "2", ",", "8", ",", "10", ",", "7", ",", "8", ",", "3", ",", "4", ",", "5",
    ",", "401", ",", "400", ",", "645", ",", "232", ",", "371", ",", "162", 
   ",", "481", ",", "196", ",", "116", ",", "76", ",", "355", ",", "88", ",", 
   "199", ",", "38", ",", "219", ",", "212", ",", "8", ",", "82", ",", "22", 
   ",", "12", ",", "67", ",", "1", ",", "4", ",", "48", ",", "6", ",", "41", 
   ",", "6", ",", "24", ",", "4", ",", "13", ",", "17", ",", "2", ",", "6", 
   ",", "5", ",", "3", ",", "1", ",", "8", ",", "6", ",", "14", ",", "9", ",",
    "7", ",", "6", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.4932923909872103`*^9, 3.4932927417565107`*^9, 
  3.493292779395361*^9, 3.493296618005834*^9, 3.493297854838661*^9, 
  3.493880237345697*^9, 3.49391354705651*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pos", "=", 
  RowBox[{"Reverse", "@", 
   RowBox[{"Ordering", "[", 
    RowBox[{"pcounts", ",", 
     RowBox[{"-", "4"}]}], "]"}]}]}], "\n", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "pcounts", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
         RowBox[{
          RowBox[{"TreeForm", "[", 
           RowBox[{"#", ",", 
            RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], "&"}], "/@", 
         RowBox[{
         "mpatterns", "\[LeftDoubleBracket]", "pos", 
          "\[RightDoubleBracket]"}]}]}], "}"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"#", ",", "Bold", ",", "Italic"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"\"\<Number of formulas\>\"", ",", "\"\<Pattern\>\""}], 
       "}"}]}]}], "]"}], ",", 
   RowBox[{"Dividers", "->", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "True"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"False", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "pos", "]"}], "-", "1"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"{", "True", "}"}]}], "]"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.493913983140576*^9, 3.4939139982355013`*^9}, {
  3.493914039874137*^9, 3.493914051123728*^9}, {3.4939144401658983`*^9, 
  3.493914509775392*^9}, {3.493914543974218*^9, 3.4939145683255053`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15", ",", "29", ",", "31", ",", "28"}], "}"}]], "Output",
 CellChangeTimes->{
  3.493914020572381*^9, 3.493914069354319*^9, {3.493914103314734*^9, 
   3.4939141354166393`*^9}, {3.493914256881384*^9, 3.493914266768846*^9}, {
   3.493914320041786*^9, 3.493914441657792*^9}, {3.4939145003903503`*^9, 
   3.493914510477627*^9}, {3.493914544643662*^9, 3.493914569155508*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"Number of formulas\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic], 
     StyleBox["\<\"Pattern\"\>",
      StripOnInput->False,
      FontWeight->Bold,
      FontSlant->Italic]},
    {"18696", 
     GraphicsBox[
      TagBox[
       GraphicsComplexBox[{{1.7437145811572892`, 1.3949716649258315`}, {
        0.34874291623145787`, 0.6974858324629157}, {0., 0.}, {
        0.6974858324629157, 0.}, {1.7437145811572892`, 0.6974858324629157}, {
        1.3949716649258315`, 0.}, {2.092457497388747, 0.}, {
        3.1386862460831204`, 0.6974858324629157}, {2.789943329851663, 0.}, {
        3.4874291623145783`, 0.}}, {
         {RGBColor[0.55, 0.45, 0.45], 
          LineBox[{{1, 2}, {1, 5}, {1, 8}, {2, 3}, {2, 4}, {5, 6}, {5, 7}, {8,
            9}, {8, 10}}]}, {
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Molecule", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 1],
            TagBox[
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}], ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}], ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}]}], "]"}], 
             HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Molecule[
              $CellContext`Replicated[String, Integer], 
              $CellContext`Replicated[String, Integer], 
              $CellContext`Replicated[String, Integer]]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 2],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 3],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 4],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 5],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 6],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 7],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 8],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 9],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 10],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ]}}],
       Annotation[#, 
        VertexCoordinateRules -> {{1.7437145811572892`, 
         1.3949716649258315`}, {0.34874291623145787`, 0.6974858324629157}, {
         0., 0.}, {0.6974858324629157, 0.}, {1.7437145811572892`, 
         0.6974858324629157}, {1.3949716649258315`, 0.}, {2.092457497388747, 
         0.}, {3.1386862460831204`, 0.6974858324629157}, {2.789943329851663, 
         0.}, {3.4874291623145783`, 0.}}]& ],
      AspectRatio->NCache[Rational[2, 13]^Rational[1, 2], 0.3922322702763681],
      
      FrameTicks->Automatic,
      ImageSize->400,
      PlotRange->All,
      PlotRangePadding->Scaled[0.1],
      ImageCache->GraphicsData["CompressedBitmap", "\<\
eJztfQ14ZFd12MvuSrvrfxJsU9txXHDIFpwpUAoqITFTIqhDHS0lhCoWpV4X
JfpSwiyhVKJ0605ViraU7lCWTFXD8CMBQiB7ZMOA5bFsyViy5bHMyPbY8ljI
P/LP2B7jMfZgD+bmnHPPue/M7J03u3G+1v1if5/W8+4775x7zz1/975zz7vw
4o//2Yc/cvHHhy65+Jx3f+zixJ8NXfKX57zrox+Dpu2/EgTb+oMgeOKcYAf8
NvBT/+P+uwj/+f+p4Wz839vNpZdeeg7++n336yjaznzJodiODW+FHxvbHBC1
ne9pa4Hb5uC2N7e91dMWwr1M/qVE/vV4K9gB/66bamXFVOCvVt/Y5enBuQS6
3dSrqwRWrZWCV3ngHMr6GsFVAL5hWlFuC1EeQf10zxjO81Df5YE710/99E4s
6DK14qhhA0V/I9n5YKdnfK8h+G5jGnNmUMEHg4dMzWyc5nnkdfIIjDM/skeR
6TULlfWdbVnj79VpnnG/PrpX3Z5HXhPdq9Pas6ybmVyplkyDGV2tb3TxHJl6
ydTr63R1Frdt5YcAxbCpMslWFp0mz0Jn6vB8gwUD2xq1NZjvNWrrFrjqlIlB
Z/MV+xT+W4O5rsGzeHWKh0YX87QBMFXoX726YrYqq6ZOrSxf2PfGBl2d6fpU
MpMDgYmlZlslgn6d7hn3Dk+fuj282CbPNqBP1TV83va9ZbKE5TVkOcKSbK91
edh2lodFvvk/3TPk7Z7udHvYIHB6asJuHyEwXQqtBAHb6N8uk5icxccRgv4K
6X6+twP+7TGp3Bxwdtb0BYDAPhIE+0y5wY/YWwQcQF+DwXFpI1Lx9Jypl0ct
xl0mVVijx6qljEkO7jUDiWGTTvaaIHbA6YlXbHB6V1s6j/3pNyXoyWZuKBAS
k+UVkx0UXYL7ddvTWumwiQdubAPJw6ZCY14xkyM9dmwnmL7EqCnVeGy1eTM5
ts8MDPSb1PRhkwCMY8urdK++NYWKHnJqj0lmpmAMNEk7uH8yXNNG7br4Tnl5
qsnMoA3IltesdILM1+fNWF94O9Y3ZBY2S2idmNQOE0/NujmE9i5qPpl6ANxx
j/q5UzKF6QNmcGCvSYwdNGm4H2+jbCKNlcJ4y2zs5i6smYx0NX7Q1Bq5UBYA
px3SLhQzNVoWs1a+nqD4uhElN3SvnBveLtMR7zfThaVmwd2uBderkt18JzU2
3DwdA6Nmq7Eh08GS5G6LKPmno2SmB7n5FJrYQi2SRVGi177TIGswe80z0m3l
r5027gjF08qXNIt4NTH1hJCppq3I8D2lUTtCjTqauWhjul5JTiMI9prliu1X
tXiIhCNfDe0QzkkGOlivLZmF6WEzmBwH57JuarVVk0uChx3JmAr8huDFTuVp
ZLhr6D6r8yaJ/j03D79XyD8h2s38fiAzZDZZTfKEZoIsZr182DJ15ICZzuzn
+RxtZ8fsPL0R0K8CV1Ej95sy/K5WS46lhD6RIfSNrQyNMLcZ3p9EsUmMg8is
gc0YNyODw6TBhVQPdbMg3CnPmFSi30yW1mg6xmLwXKzfZKYPmkTMykKqgJZs
iYYdA05VcTIAb2nhEEzrfsKLXC+pvmKkAb4q8AWoMlNky0bG0b1Sn5fTqKaj
Tk1rhWGa/FINfNxmzmSS+0wqv0jOqVadM8lYD9i+FXKx1dq6nalT6XYFooXq
Zgbc6h4HUmt0Zl0xY1UjmT5k0iO99LsvHWXg3sgueCUUHJyqmpWKVvybecui
zXonYYxmd4REmcamvZdeWLR9ALw5gBkcy7QTcm+E3s3TNAY2biy/6PQf+9WX
yXUUtQ7T1ADSFZLw/TCMDNxCqVnzTksz29pKaYSpfiOwd5WUF59NZOdIuzia
ilTeKEmMZnVbcbLhU6QmdpqmNubveOJ6Kr/iPHxja4KCy+nNdSVxe8xyLYyl
i9CVWIpmNAgD1TWTBlaNFdY4iNxt6sUDTX6UnhuT4ZBWuThZYNutI3ZquIBw
Mp3jmvDa/vZgf3lMayZl+2XBz7RdRSHsGza5fMZks+Mmm5sw+fwU2CKIt8sH
ySOUJBI187T0IrtWswo4khk3+dw4PZvLw7MLs2yXNngoo7T8OK6tPTvebJXm
wGWHAXI5u0+WDxxsOfa5ZQcNJ95rlutqycRDLtQ3HOvbs2SFFDK5vOpYvwBS
w7CtrKdfu/S0M9w2EZ+Qdjj2IJxyLT4yXZ14yKKxjcGVZJjydD8FdZMwXTRt
2QxM24RZKC5u071k4dzdVr+Pg0f18mSFJCIMNJzQdEUwHtU8npxRDDkpkiER
guWzRDsV6WbV6m6nWsIELTrC9gjeabEQtodSEakt0Wxvs8NwnKkUwfAP9ISB
cN8Bs+VmI0csLDbczkMxDaCDh5tW9Gh4LVtWmy2OEr/CGIjS2ExocZIzTuwb
OBvMoyiLU2tncVLs0xq5FouzTv1KFUva4tjAHBYdqWGTTO43Y0m7TgGWs78Y
UhxYMSMoGMU10haKsgeGwLXuN0lwrwnGtVATIRslwQJr4rU43WyqlyeHTV88
3BEazORCdpRCq7VDszgOLF5YCq1Nw1mTZmvjZcciLTCAFY4OTkks1dnaFLzW
JkeWQ2LzemmUpqZ6pOQ0WZso/rFYWBIna6kwW7y8HUhCRINTBo/b5VlopLVk
RpkbU1+CMKDfxGOyvINI0wXgTmK6Ijhf95qb9hyJkKpO5ibVpFfd7fTKJzvC
92jmObkQcxOKRaSqOHPjZXubKKeLOGw7MwpGbMoUy0vMwleaLYiTR0YshYGR
/dTZZGqc93Ag0KrMm+kRNlWDo6ZQnDGZ1EFTFn2vr5jN0oxdSRdWRZCQZGna
8iAJvmZrc8oMoNdbsMFWdfmAvTc9ZUqFjN3cjQ2ZYqUUbY4KoTmytM4DnVsx
Wdrp3WtypSVTzh8gU086WJ01KYg/MaiLD7IOjAyH63ByC70mW1whqStm7fIg
iwFg3W46xxIHYdizJsNsGJzEPZVVklDcwijD8qUBAj6ZCCju3qLYdgXszT63
6zS9nDP5yVFY6K/4dt+72FRiWItdH4PgYGF51mxWwkXqQmYYVgs9JBsJEKvk
yJDJyEoD7m/Bs8m41a9EZsIUFg6b1OQMhdYUUFUWgdWHgRXWfLmpimIfPEfh
fdBvsjCEhWnLnljiMK60jtGEncfbC5alZegP0e07RH2MlsRodkeIkzEVG9Mn
gBe4qq1tTpAoyqosQsLbr5DOMFnczIrvo4BiuTBnF56ms8R1niq8P0/SEx+b
2c6mLopzEYJ6tKbOTtBvd9DbDkLYgdERghSth9GT1Hmb60y2gMNOF0wlY/oG
DpJFr4C8pFN2yAlAmcmMmvTkhNtoySZsyJBIQ/g3JpuBPSa/tc5O55Brg+Vo
EO4u5+yswIq+Ly6B3rAp10UfukHXRq1biPWC7O+1QpOciLKA5G0C620smle4
nWgkFZPoJj1lI/zqnJlODxOZvpEDMLyDJp0GQamsO3lcnpR9/hNpGJll2Y7E
JfGMGemzLBhMYvRgZ7FYtxsc6cEefvY4Gl6RfXF52lq/OAjlMgzT9WtyLsoC
bhWnYPkz48iXJ/tNXzpHM1jIHjKpkb1sIWGm0qMgTNxV5nYQ22cWwB+NCMd5
lmnDmGcyFh/CPRdnASPZx6FDdsxapjgEUiODdnMiXVyLsICnmZIODJ00gRAD
nUHGQVJTsC8/oiXRsdvNlOI2scovTFZ/YMUx4HawjzODqQnHlggBjzKAaTCA
01vhPkO6DwQHt2M6CVynmYL7AzwLick5p07tmedULkJW7cKprSV0IWhTbNlG
faOE0T5+ijA8XGw4hkfKk6ijnafjW7Qxcq4628HjqeM4L7FBmLvJA3ZpEFNL
CFje4C5woUEssK+kNudNxa7nA18aQJdMUGPNDPbtNX0c4/cNwO9BesMT7Gph
9FihpF7Arrv3y7/RFj9E4ZUc4R1JHzKZMWtcYioKLw5TZIh28URB3Vg15fIS
tZ3uUVR5MVUtTVF3Y8zNgQHQoOm53Q5NyJVThVwD31hvGAl32618ljPDFFll
pg+Z5ICdPHnZqbghzG5UIQDbXA2Z3eZV2vTYEPUyYH0fAMZPl9d2e5jR7enx
8R7eR7zolsE0KnNmMrXfJBL7aUAZFV6axhKo/WGcbsd+WOigCsUzc63sb5Yc
3ETGbbBcxuThL4fbYvlZCvJlROX8IZO3IVTwWx5cssjfKmbM2Mg+MzI2aiYz
ByDwXgoX+VtTEK7N05X0sbpsAw1YDEeKSB1jriz2bYL6mYP+LpRWQhFxo7fd
azNvpN7ZUTOSGDKpDHAQhBksyjbPKKWHhTEb51Y7iES5MGWyubCH2NtSdX23
Z/BhD4+Y6l93c4fB3ij2xjt353va5NlGZRb8mGWGj6fne0ZxtlibZRsKN9qM
9vz2Xf+7nfP2MvmXyf/fJ///POH3nfS/7eaJRx81s1/9qvnFL34R/CG3FZeX
zcr8PF39W2778dKSWbnuOrq6kNt++ctfmu9/85vm4fvuc3DU9o1vmIfvv9/h
++kTT5grMhnTeP55phv8Pt9a/N73zHqxSFf/nNt+/uyzZuZLXzLPPP108BFu
e65eN5dD28+eesqRv2993Vzz3e/SlcDdf889Zu4732nq5o9+8ANTWl2lqxby
1cceM1d85SvmF42GI3/bjTeaWxYW6OovuG3tppvMzddeS1fvkZG+8IL53uSk
eeTBB4OPclvuW9+Cpf9mE9yTioalC+t1e+sG6Nldt91GV3/AbfVnnqHRP/uz
nzm0z//85zT62k9/6tD+5K67zLWXX05XAvfAxob54be/3UR+8fvfN3f/+Md0
1UL+p48/bucFeibkb73hBnPr4iJdJbjtjpUVs3zNNXR1Abe9AKO/6utfN5WH
HgIfa9t+ODVFXdBwT1QqJsvyZekG7+JbN/7wh+bOW2+lq3/GbTBqGj1wwaF9
/vnnzeVf/rJ56sknHdp777zTzGezdCVwWz/5ifkBTIAmv3DVVeaetTW6aiH/
VLVKaAG9I4/zftuPfkRXH+M27CJ2Fa/erUZ/5de+Zh5/+OHgL7ntahC7+8vl
Jji4T3AvwOgtXXdrCRiKjMUr6RJIPI0eNMChBaWhSQIlcs/ec/vt5vorr6Qr
gQMlJGUEBXRw183OmnvvuEPRcLdAlEikQLQcedTvH4Pu49XHuQ3FE8U0ZOB2
nEuaU7Adwb/jtmtmZszm+noTHMiGuRJkBLjFdB2jbwJlWrv5ZiWV21G3qUvP
QZcELSiNyYLygKI6tGgv0G7glcCBEpIyglI6ONSODdCScEIceUeqXnfkdZc+
4SH1Tk+X/r2H1Ds9XbJ0nVRqRv9Tz4QIWs1oQasnROA0owVOT0gLeRKzyy4j
MRPyWhyHPWIW94jjiEfMBE6Lo6XrTIxWsndwm1ZGQauVTNBqZRS4xx95xMyy
kgmcVsYW8s+igYXRo4kR8toUfZLbtIk5n9u0KfoP3KZNjMBpU2TpOnusDezv
cZs2xIKWDOzEhKlsbTm0OEFLbIgFrioGFp4VOG2IW8jXxbmCexHy2g19itu0
e/ldGb1yQ/+R27R7Ebgj3ZBzrhhG3HL99XT1dhmBcpCClpwrhBGPPPCAQ4vK
eRM7YYF7kjmHzwrckU44DC0gjKDR12qOvA5BDnCbDi1+h9t0CPKfuE2HFgKn
QxBL10UiGFjdzIHV27hNB2CCFoOoHCjPQxBYCVq0FxKACdxTHFih1rxNPSsB
2IXN5J/j+cMRCDjqN+o5Xl0qIwDFuXp6mq7+iXAO5Qa0BoOy/8xtS1dfbe4s
FJrgNu++m0wPXjF5CQNvh/lbzufpqofbnIMEy5Xkth+A9KICaTi0FxKUCfna
k09am/Hccw6O5Aa05lEIyv6wmTyAOekVcNRv1HO8EvIPou5CF/DqrdxWZ5sB
tiP4L9yGQ7md/YXAbZRK5torrqArJt/Ht+4ARi3NzdHVW7gNdJt0HEc/ym3I
+AfuvbcJDu0F2g28EvJPK28pcGQxOSjrayaPlusKtFzVqgPPg37/BOYLr4Q8
iByJHtrtf8xtz0hQBv7iv3IbinGRXZjAoQ9AX4BXTH4v30Il+RHb7TdzG+g2
6Tg6yE9z2xwo3X3stQSO/AUE5Xgl5H9Wq9HoQaEdHNh/5y/2NpNHn42KAubC
gWtSn/Z06R/J6IHUDJP6b9IlMGFoyvBK4NAHoC/AKyb/Xr51NxjXxVyOrt7k
YfRnPBMicCuK0UJeT4jAuVihUmG6jjxFLHALXIUDJzFjBynktTi+URitxGxM
ieMqi6PAoQ9AX4BXTP5f8K11xZg3cJtWsoPchsq4wcoocDeBkklQJuS1Mgoc
TTD4EFhsMV1HHsUCwwMIExw4kn6QTYyQ16boH3KbC8rAxPx3blsFU1RgUyRw
JN4clDH59/GtMioFB1ExbntAGdjPcps2xAKH9uKOW26hKyGvDbHA6aDsfc3k
JYh6DEyCgLNraSKv3dBvcxsGZVdwUPY/uE3vAwgc+gD0BXjF5P+Ib2mDeB63
odLNsXP9HLdpJyxwGJSVOCgT8toJC5wOyv6omfwvOYhCd/B6aQMHKaHF/+Q2
HYIInA7KBE7vAwjc7bg6ZrfG5N/Pt7QzfB23oX7nObA6xG06ABO4G8Be3M1t
Ql4HYAInTv1paHt/M3kdCvyDVo5AWJnyjFTgkCNZ5ojA6X0AgSsqjjD5P+Zb
OhDaI/KggurPq3mW4FvgFpQ8CHk9zwL3HAd04A+YbvABkXIVBr62VRvARfwv
kXIMI1DHQcp/i9seZ23AJYXA6aWHwFE4y9rQQl4HwUK+DPottuAL3KYXXgKH
MGW2BUJe67jA6Z0ySzf4l3xLLwHOldGjJYRRweiCw9yml52/yW2PKUsocHrZ
KXBkCXkp00JeL4CEPM7nAi+mv8htetEtcNoPCHm96Ba4Z2WnDPyApRv08y29
/Hu1B8VfcZveB3gNtz3KXhBjgL9SXZd9AIHDka/yMraFvF78CnnU5Rs4Bkhz
m94HELg82AuJAYS83gcQOB0DWLrBn/AtvfQ/R8SHIyDQ9eB/Cwq1D/D3uc1F
QNB1gdP7AAKHUi8RUAt5vfEh5EtKecYFhdoHEDi0F/eB3cArIa/3AQROx3+W
bnAR39J7MWdzm45+/48WH94H+A1uewjsBXpHvBI4vQ8gcGjx0PLhVQt5vRcj
5NGHS+x/Gbetqn0AgdOxv5DX+wACp2N/rkQywLf0XsxZMnq18vkSt+l9gF/n
tgfRZHFQJnB6H0DgaOXDJquFvN6LEfK0bmcH+WVu0/sAAqfXfUJe7wMInF73
WbrBB/mW3os5g9v0qjfDbXof4Exu06tegdP7AAKnV70t5PVejJDXL1O+otpk
H+DvyUjVmv8rnjbBp9f8lm7wr/iW3ot5lWekX/VwRMjrkQqc5ojA6R2PFvJ6
L0bI65cpX+M2vQ9wumeev+6Rh9M9NCzd4EOenp3GbVrKBa3WBkGrpVzg9BJF
4DSHW8jreRHyeq9vgtv0PsCp3KZfpkxym16gCZyWL0s3+NcilbhUYKl8Jbdp
Cydon+cwArrr0GoLJ3B6eSpwWrtayGudFPLavn+D2/Q+wK+p0Yt9/ya36cW5
wGnbYukGF/MtvRfzq9ymvZug1fsAglZ7N4HT+wACpy1rC3ltj4W89u3f4ja9
D/AK6ZLy7VPcpvcBBO4x9CsclFm6wT6+pfdiTuE2HdkIWr0PIGh1ZCNweh9A
4HARh4s5vGohr32xkNdx3beFlNoHOFlPCAdl09ymN+UE7lGMKTgos3SDS0TM
1F7MSSKOKqoVtHofQNDqqFbg9D6AwFFExRPSQl7HYUJex/Tf4Ta9OXYit1FQ
BlqDMf13uU3vAwgcLOBoIYfKaOkG/4Zv6b2YE7jtKVFGMEWCVu8DCFq9ohE4
vQ8gcBiU3c9BWQt5vRcj5PV6bobb9D7A8dxG6zngHK7nLuc2vQ8gcLiIy/Fa
wtK1Lzr+BNMZBj2/3nGsQJSegatXm+RBQPTrjz1tBLf9ZRQdUKDZpOzhxhoY
lCWzxX/V+ga9qWlF9UqGr9dWCM4+s0IJbT54h5+qhYX4K9U1Cx/drXpZTh9g
qvIeM5ZfiuzWckqShveYWHwfpUa371Y3Vd5KMP54fI+JJ+jY2dvb90xSWXWx
JSmsRBnxaSpJE2bS1tcITtfGsvWl1h1rjqaG1g6Nr0YVWGz2aMvITvY86+pV
8anaVGk9kNpdNVtOwEEIHI3N6IPo0XWyfGOL6p9+tvWooeaf5TPhbOFBc32u
TgWxdjSNjco9qMOFR0xzFw8AC1VIFrqceh2jfHlbiKacGw62Sza7KnVTxPol
wV4zILn18Hu6aE8H1oujga20tN1kiq7WjqsCRNWw+FhYNtkrJXFGbN6owfIr
6QE+67DTxAf7OSl9rzuYzrWGostWqSI7IHvL6X5Xlirey7nivTjmbs8sdjN7
MBNX1xvBWiR0MINOexIxx56Q2po97ebIYMb+AVdAC1jnSmEJ3ppjWVh/qFGZ
wYIf7nROrN9kS1xnqzyuai3tMYkRNguJ8WMqJdVlmkpJ2YJHjqt9wPlYOPgo
PiUSNqN/cHKeqBTStkM4Fqboyi9pkraSYK9JJnqFagJuUVZ6Yx5Nl3BKyhvU
lHAJpzbzBwKZ8zjMQpnFpDi5T6QIZdeefAtaCzxFV3jqahL7alEL3nZ9LEod
4GijbReQwuJRhFzZzqOti9JP9Zs61ldJ2/MCY3iub2veTGOhL6z1hAdzqPie
lAEKQE5WxCibTsWcbB/s2b16fdUUssOEF62BPZHdY3KbMI3w/CSd4cPzKi+u
+lJ12ZYSS07PgqFbMQsZKz7J/KIqP9QqZheY2tYs4bTHl5foRDhVVWp0qjEj
B7P7Tb64aDZLE7aWzoA9gtmor1I/ciPgVpNcn0cqUEWWWLKli/BMYxn4Xasg
j/a4yk5YWwBpVMB4V4RmbL8T0L9ZSaR16CePpbQENOdMakDOEZUi+bcM8jSS
nbOFuvjgI5Y7anQowSQFP+Mjh0wZoptizh7YTWStrGLRylC+5sD5hfIVxT+R
+RGUA+ARHv8YpDOnc0bKemD9olAuQUZAfl9UraKGLVwSg7FswpxtFWzdOjxr
5wKCKDV+hbHnsHrwRBE4u4OWFJ8CjK5UwiIxMqViFnvKZkwVtdFFcXTxHCmk
sk23xYldgZwRk4gynZ+jKaiVx6k/hSNrCnEccbLpVFSIVMuWSAhxBBZHe3ED
PlXxzBedYzILYz0mrG4XTc83VlsmRJ99by7qs8PDO8en2owtOlrdcHwqkTkd
MsubWLytBL6iv6kg27EX/7F8TeRXHNktx/pINpUmh/EQmcGSOiOkhfbUZ6da
Q7a4y15TdiHmTrNMlW/CA7ialV0RLCLv0lSvaacTFbQKW+hN6oukkXpajrVY
T71k1WWhtuGbxaNUPn00E33VdMl69E5FT2zljbBwFy6PBtooH058Uy2ZprP2
ofLF0zl3IJxCwmQYgJTzB81ATEU+ve0r7ZxsOlXaod7r+lQQP9v5WI2Ur0Z1
TnHLcmOT1TCKnshOciEctbW4vbTwdFVxfGqoKu20qmF2KzxCjyXbxlITHPGt
mGyKai84jvUpjQwL5BxdfRwrvQPT864D5BZsp6IYVs42VzodyEj90ehyPHWO
ZrGEjyhkHutctCiklG3oimBWKdNrmusxd5nS9AF32ry+OWPGBmX10c2FK/nQ
f1jS5mgq2lS2bNVaMI9NhY6OVidPY4cIvr2EOybzMIu9FJ+QsY+sK7FqprnK
90Bq3BQKEybZ52rw+lRyu4hZc+Ua23wu2FJeeORslEzRmCqHsrV82KSnp8Dz
gz5lh8JevohKM7aCI4wIVqHF0qzJJGSdsdpeyk4FtcyRBypBcLQFI0licJic
6kwOniNYYHg6N2MKYGRoKpMTbmdAq6RwrKWCjGXub5LNSsXtgf58aRG6MsEH
/OVg+arJZ/B0PK4blqjadmArOb2ooi+lyX6eqRno1jgXiO/t4C1PJW+ZyOZo
t62Yt96Eao11oFfkihZB336TL8yCjPbLLDXZdFHOHVFsO5dqkMikY0gs4Wmc
dZ1O0aYPmQLEF1Uuw2IXni+mDAsPMTYEy5g5V4YF1sY7OynpcUai1mJDrMRB
t9AzYZEJqVstJQ9qHOD2JWBueQUdHxjGghDhRpRHQVsKq0i5NTpCnQlLb8f6
9pp4rN/Fp1sLspY/AZaHXH3j6IqguJ2SlhooWB47wZXjBoDV8U66uZsoogWV
hQZF7fGwFklYcqWZXJ4X5YOgDAOso4lUBhVJeHVkJcou4ytv4hhWmzepwbDa
YN8APO/KoqyCjEsFlxMpGsyVbSx0lOVIvNVfqELG9DB7iB5wdEMSvERxrTwt
gWwYnCSlWkITud0hubrdoY6BT02nWEVje01mYVHt1661VEuMZhnu0oQhYg8N
Y3B6jmVpxgzGQjHHqktbjciiIDxNJ0ZXBYHgOMNlb7GwVHpsr+kbmwk6KuZO
Wi1bDcNiIryTN3hYxdRtyj9APCVaJ6GELvfxCse+6LIdYVsY5baf5m6znLem
bxB0aZDrtSTzS9s9qE/gtmUVT4QhYlje41ddW1ir42TX5ooyRnYriXuQff3g
kPZxaXf8ZMhGyIVVT+B1ZBc6Fd9wG/KqomHHEKmb9u9xrUvVJ+BvoTCPJE4R
ca6H5e5lzRiuPsJCHL/GbUeWmthh9FcGxqLsW5fZ3FyEJZmtg4EVJ4qbqywu
O5q+7gJLSeGVLrURTldYN+Mksfvl0O5H2osus7A8w7UuxmlRu1XjOib8Qi2n
PgCDS7SorugCGfIOS7ZMY9F6KN8mQT20n+dRa2VVSCP82BB/FajhF8izZD5o
52uFPw20Lih1fY3XuKmTjw3Rl4GisOJepWCthVVmj8S63YEC8ajxvzTe1L6M
glD87aUTdAKyB1m6KLkNM5UxzwqTnTC9QxIkv/VFSpGmq8sYHlOFMIkGc3gw
RRwTpiwuPh3SRZnHmKyCyUuYQYT5Mpd5UI4LykaDspIwMRpzLzALyeLiIxdd
lM6LuXGYEYRp2ZgXM+5BmWZ4TFTHNC/Ms8LcGkztsbj4HEMX5cjOz85SQgrm
uWNGV9qD8osMj5kimNyGSS2YXYL5MhYXHw7ooqyd66+6iniDCSSYIvdFD8ov
MDzmQGLGGCagYLoOJqFYXJxx30WlCzDhD3mDPEKUX/Cg/LygrNcpDQuzgTD/
CU9kWFycxt5FtSCQJ8gbTInGDJ3Pe1AeYnhM8MfcJkyxwYQyPOZgcXFueBcV
17jx6qspjwjzjDED75AH5ecYHpMCMWHou4ASM/Tw7IDFxQnXXZQ/hOc8kDeY
xIVpbZ/zoPwsw2OmHaJClJjyiMlAFhdnMXchLyhpGnmDPMJcsc96UB5keExf
wwHjwJEBmMRncXFqcBelnREIoMQ0U0zAOuhB+RnVBZyWy7kLmBlncXG6rx0I
Hu2aUQP5jAflpxWjlphRtzOjLC7OoQ3ZPaPY/WkPylE9nSDiKOoo8ighFhcn
pnqE4qmn3PFNjTLJ8FUtdKCYWIbF4uJsz1B0L1eim/SgvJThMUsMzYVWDYuL
Uyj9CnapB+UBhicFBqNGCgxGDhPQLC7OS/SbgQMelJ9ieDzJgcmEZGbuuIMs
l8XFyX5+Y/UpD8pPMjwmhuIJDcxFxJw2RGlxcQad36R+0oNymOEx0xYz7DDB
D09toMm2uDgrLjT8mJh3PRv+YQ/KTzA8JvJj/jBmzWESNzoWiyvIMghmQyJP
kDfIIzxe8AkPSlsHZAehwWxoPNL0wMaGzWMMrhRsL7xA7EAfgb4C07g/7sG2
n+ExsR09Hh6SwbFvbW4GNjE0+J6AAEr0YOjJMBsYc+A/5kH5UQ1/11108gQ9
IB56s8dRg5yiinmM6G+RPeB/XY0bjfIjalSYiIqp2Zi8iKcIba5ocDWzBY9Y
IVvw74F77/0LD7Y/VxzHxE7kOCaCYrK3RRNcwyAUEOC8YUAAHcV5+3MPyiEl
aujsUNQwsxZTWy2u4FoGoYAA2KcDgiEPyj9leExJxaxYVAh0fqgQFldwHYM0
BQSsA3/qQflhhke1xQMT6KEwSR+PIFlcwQKDUECgNRWU/8MelJcISjAumGBL
xmVujs71WFzBDQzisyeXeFBezPBor/B4J6LEdHI8HmBxBTcyCAUEoNFXKKt3
sQflhxjeGWpAiTnaaKgtrmCZQZ702OYPeVB+kOEx3xYPnZE7uf56OtZhcQU3
M4jPg3zQg/IihseSS5hFTE4P/o+Fpyyu4BYG8fm5izwo+xkej8xj7xAl9hYP
IFhcwa0MIt54Rnnjfg/KDzA8BgTIQ4SXgMDiCm4TEAkIVMzwAQ/K9zM8nlnA
mUaUOPM4KosrKMpAVGSzygHB+z0o3yeMAt7j+SDiPcgnBmMWV3C7sBtm8FaO
vwocELzPg/K9IiGPP05agxJyJ4eMFldwp5IzjIB0lPheD8o+hq9yYItyjLqO
534truAuBtGx7M0cEPR5UF7I8Hg2Y6El/La4gnVBiQrGAcEyBwQXelC+h+HR
JlzHi4R7eJFgcQVlBqGAAGJeCgiA7RgQvMeD8gKGJ8sFhhwN+r28lLG4gg0G
oYAA2CwBARYUuMCD8t0M37TgAveD9tXiCjYZRAICZDeyHSs0vNuDspfhfctC
iyu4X1BiQICGHwMCNPwQEPR6UNpiUC1uqlx+wGJ7kLFRLMCeaZ490zs92N7B
8D4/umVRPiQoMSBA16kCgrgH5e8JSoDfbPH2D1uUjygQCQiuYZDzPSjfrrvA
MUmeu/CoRVlRA7mvZSC/60H5Ns2olqDpMYvyCeH0vffqgOB3PNh69CS2RHUW
TfCkFoWWgKDHg/ItLaKmY0+LK3iKQR7yBARv8aB8M8P7ImSLK3iaQTAobg0I
3uxB+SaG98XxFlfwDINUWkN3UP43eVC+geF9qw2LK6gziAQEsyogeIMHZUxQ
epbzFlfwHIP4lkExD8rzGL7uMdQWV9BgEN9i7TwPytcxvLiTGeVOLK7gBQbx
BQSv86Dcw/Di9GaU07O4AsMgvoBgjwflaxnet5w3CuU2hvOt0V/rwXtuBLxC
aH/viOjEuR7kr44YpEJof3dHMO3VHuTnREyKQmh/74qY5HM8yM+OECKF0P4+
joGdUMIwRSjP9iA/i+FR6BdahF4htL9PYOCfe+KIszzIz2B4LD1xHSvpPayk
CqH9fRID+yKKMzzIX8Xwbj8A3T/vByiEikV/gLu1dLn7GG7R5vK7jGw4/50F
cidx6ASQPVHkXp2qkzNdTXDNp33q8JycupF3mfpkz66j6Ug3o7Svhm1CW3m6
X84QYOYWnpFIxPSX0/tNnl/k1+W75XyaxuhTOc3HE/jISHi6Q50ZwbeD2ZEe
dy/OGRF9eLDCnrU44jvdTYdFkKA7uaG+nNJx5G8zYc6+TZ/IJShdydTNos3h
Txwym8B6zNnJJu2ZCMrKijjXEH1eIjov3745l7z7eTxuBPeGOREgKp89Mk/+
GHiy28QoQW+JPhk8WS6ZctrmhdhxUUJhS05qS67SEVm8HT6TGSZBuy831Gep
KfwUY+vn2Xx557s6JSYfExv6+mCKCvzGGUSikOm1bOCkunzlyARS/HKPLzdQ
2BCZBhwmoQp4Uw5qyyd4FUt8SWKaIxGZocfAkZPMQN9+SvhJ5jJmJL7XjI30
mPiYPW9GH4PGzJmtVTr4QYJrE9zaM+S0Dkll0fl/laJLmoVhrphlzKOLdeZI
dDreMcmIzbnpB8OxYZbHbCqU/aoUdmkOuRWeyBrAvCKbfdI+f3R3dC6PTbly
qVEu5aqxaDMvYQYohTHDXwEaPNTKjuZ0pW5Jf3LkOP1p59GzYad9LpERp8C4
6EiF+9CKLydIZ6+4zA2VDXPKsXQim50wJZV3V8TzG7kpU5FkiMCfzPIquefJ
6ziqDsiBWZ2lcYbx5kQcFb6XYsjytwL0N4sa/bfov4te4g3Br/w1tj2dGA==
\
\>"]]},
    {"14224", 
     GraphicsBox[
      TagBox[
       GraphicsComplexBox[{{1.7460757394239457`, 1.3968605915391565`}, {
        0.34921514788478913`, 0.6984302957695783}, {0., 0.}, {
        0.6984302957695783, 0.}, {1.7460757394239457`, 0.6984302957695783}, {
        1.3968605915391565`, 0.}, {2.095290887308735, 0.}, {
        2.4445060351935237`, 0.6984302957695783}, {3.142936330963102, 
        0.6984302957695783}, {2.793721183078313, 0.}, {3.4921514788478913`, 
        0.}}, {
         {RGBColor[0.55, 0.45, 0.45], 
          LineBox[{{1, 2}, {1, 5}, {1, 8}, {1, 9}, {2, 3}, {2, 4}, {5, 6}, {5,
            7}, {9, 10}, {9, 11}}]}, {
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Molecule", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 1],
            TagBox[
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}], ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}], ",", "String", 
                 ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}]}], "]"}], 
             HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Molecule[
              $CellContext`Replicated[String, Integer], 
              $CellContext`Replicated[String, Integer], String, 
              $CellContext`Replicated[String, Integer]]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 2],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 3],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 4],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 5],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 6],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 7],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 8],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 9],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 10],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.020512820512820513`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 11],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ]}}],
       Annotation[#, 
        VertexCoordinateRules -> {{1.7460757394239457`, 
         1.3968605915391565`}, {0.34921514788478913`, 0.6984302957695783}, {
         0., 0.}, {0.6984302957695783, 0.}, {1.7460757394239457`, 
         0.6984302957695783}, {1.3968605915391565`, 0.}, {2.095290887308735, 
         0.}, {2.4445060351935237`, 0.6984302957695783}, {3.142936330963102, 
         0.6984302957695783}, {2.793721183078313, 0.}, {3.4921514788478913`, 
         0.}}]& ],
      AspectRatio->NCache[Rational[2, 13]^Rational[1, 2], 0.3922322702763681],
      
      FrameTicks->Automatic,
      ImageSize->400,
      PlotRange->All,
      PlotRangePadding->Scaled[0.1]]},
    {"10693", 
     GraphicsBox[
      TagBox[
       GraphicsComplexBox[{{2.0793098402510157`, 1.1881770515720091`}, {
        0.2970442628930023, 0.5940885257860046}, {0., 0.}, {
        0.5940885257860046, 0.}, {1.4852213144650113`, 0.5940885257860046}, {
        1.1881770515720091`, 0.}, {1.7822655773580136`, 0.}, {
        2.6733983660370204`, 0.5940885257860046}, {2.3763541031440183`, 0.}, {
        2.9704426289300225`, 0.}, {3.8615754176090293`, 0.5940885257860046}, {
        3.564531154716027, 0.}, {4.1586196805020315`, 0.}}, {
         {RGBColor[0.55, 0.45, 0.45], 
          LineBox[{{1, 2}, {1, 5}, {1, 8}, {1, 11}, {2, 3}, {2, 4}, {5, 6}, {
           5, 7}, {8, 9}, {8, 10}, {11, 12}, {11, 13}}]}, {
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Molecule", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 1],
            TagBox[
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}], ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}], ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}], ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}]}], "]"}], 
             HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Molecule[
              $CellContext`Replicated[String, Integer], 
              $CellContext`Replicated[String, Integer], 
              $CellContext`Replicated[String, Integer], 
              $CellContext`Replicated[String, Integer]]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 2],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 3],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 4],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 5],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 6],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 7],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 8],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 9],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 10],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 11],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 12],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.015384615384615385`],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 13],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ]}}],
       Annotation[#, 
        VertexCoordinateRules -> {{2.0793098402510157`, 
         1.1881770515720091`}, {0.2970442628930023, 0.5940885257860046}, {0., 
         0.}, {0.5940885257860046, 0.}, {1.4852213144650113`, 
         0.5940885257860046}, {1.1881770515720091`, 0.}, {1.7822655773580136`,
          0.}, {2.6733983660370204`, 0.5940885257860046}, {
         2.3763541031440183`, 0.}, {2.9704426289300225`, 0.}, {
         3.8615754176090293`, 0.5940885257860046}, {3.564531154716027, 0.}, {
         4.1586196805020315`, 0.}}]& ],
      AspectRatio->NCache[Rational[3, 26]^Rational[1, 2], 0.3396831102433787],
      
      FrameTicks->Automatic,
      ImageSize->400,
      PlotRange->All,
      PlotRangePadding->Scaled[0.1]]},
    {"10601", 
     GraphicsBox[
      TagBox[
       GraphicsComplexBox[{{1.6666666666666667`, 1.3333333333333333`}, {
        0.3333333333333333, 0.6666666666666666}, {0., 0.}, {
        0.6666666666666666, 0.}, {1.6666666666666667`, 0.6666666666666666}, {
        1.3333333333333333`, 0.}, {2., 0.}, {2.3333333333333335`, 
        0.6666666666666666}, {3., 0.6666666666666666}}, {
         {RGBColor[0.55, 0.45, 0.45], 
          LineBox[{{1, 2}, {1, 5}, {1, 8}, {1, 9}, {2, 3}, {2, 4}, {5, 6}, {5,
            7}}]}, {
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Molecule", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.025],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 1],
            TagBox[
             RowBox[{"Molecule", "[", 
               RowBox[{
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}], ",", 
                 RowBox[{"Replicated", "[", 
                   RowBox[{"String", ",", "Integer"}], "]"}], ",", "String", 
                 ",", "String"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Molecule[
              $CellContext`Replicated[String, Integer], 
              $CellContext`Replicated[String, Integer], String, String]], 
            "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.025],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 2],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.025],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 3],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.025],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 4],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox["Replicated", "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.025],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 5],
            TagBox[
             RowBox[{"Replicated", "[", 
               RowBox[{"String", ",", "Integer"}], "]"}], HoldForm]],
           Annotation[#, 
            HoldForm[
             $CellContext`Replicated[String, Integer]], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.025],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 6],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["Integer",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.025],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 7],
            TagBox["Integer", HoldForm]],
           Annotation[#, 
            HoldForm[Integer], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.025],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 8],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ], 
          TagBox[
           TooltipBox[InsetBox[
             FrameBox[
              StyleBox[
               TagBox["String",
                HoldForm], "StandardForm", "Output",
               StripOnInput->False,
               FrontFaceColor->GrayLevel[0],
               BackFaceColor->GrayLevel[0],
               GraphicsColor->GrayLevel[0],
               FontSize->Scaled[0.025],
               FontColor->GrayLevel[0]],
              Background->RGBColor[1., 1., 0.871],
              FrameStyle->GrayLevel[0.5],
              StripOnInput->False], 9],
            TagBox["String", HoldForm]],
           Annotation[#, 
            HoldForm[String], "Tooltip"]& ]}}],
       Annotation[#, 
        VertexCoordinateRules -> {{1.6666666666666667`, 
         1.3333333333333333`}, {0.3333333333333333, 0.6666666666666666}, {0., 
         0.}, {0.6666666666666666, 0.}, {1.6666666666666667`, 
         0.6666666666666666}, {1.3333333333333333`, 0.}, {2., 0.}, {
         2.3333333333333335`, 0.6666666666666666}, {3., 
         0.6666666666666666}}]& ],
      AspectRatio->NCache[Rational[1, 4] 3^Rational[1, 2], 0.4330127018922193],
      FrameTicks->Automatic,
      ImageSize->400,
      PlotRange->All,
      PlotRangePadding->Scaled[0.1]]}
   },
   AutoDelete->False,
   GridBoxDividers->{
    "Columns" -> {{True}}, "Rows" -> {True, True, False, False, False, True}},
   
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.493914020572381*^9, 3.493914069354319*^9, {3.493914103314734*^9, 
   3.4939141354166393`*^9}, {3.493914256881384*^9, 3.493914266768846*^9}, {
   3.493914320041786*^9, 3.493914441657792*^9}, {3.4939145003903503`*^9, 
   3.493914510477627*^9}, {3.493914544643662*^9, 3.4939145693086*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BarChart", "[", 
  RowBox[{
   RowBox[{"Sort", "@", "pcounts"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.493292783271881*^9, 3.4932927973458843`*^9}, {
   3.493292845274254*^9, 3.493292877818643*^9}, {3.493292919501861*^9, 
   3.493292982083169*^9}, 3.493293103469276*^9, {3.4932936498608932`*^9, 
   3.493293666098467*^9}, {3.493914160405387*^9, 3.49391423716049*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0., 0.}, {1., 1.}]},
          
          ImageSizeCache->{{43.75000000000001, 49.149043675441206`}, {
           143.90909410700812`, 145.4251023385105}}],
         StatusArea[#, 1]& ,
         TagBoxNote->"1"],
        StyleBox["1", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[1, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{1.1, 0.}, {2.1, 1.}]},
          
          ImageSizeCache->{{48.038948042985325`, 53.437991718426524`}, {
           143.90909410700812`, 145.4251023385105}}],
         StatusArea[#, 1]& ,
         TagBoxNote->"1"],
        StyleBox["1", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[1, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{2.2, 0.}, {3.2, 2.}]},
          
          ImageSizeCache->{{52.32789608597064, 57.72693976141184}, {
           143.89308587550576`, 145.4251023385105}}],
         StatusArea[#, 2]& ,
         TagBoxNote->"2"],
        StyleBox["2", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[2, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{3.3000000000000003`, 0.}, {4.300000000000001, 2.}]},
          
          ImageSizeCache->{{56.61684412895596, 62.01588780439717}, {
           143.89308587550576`, 145.4251023385105}}],
         StatusArea[#, 2]& ,
         TagBoxNote->"2"],
        StyleBox["2", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[2, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{4.4, 0.}, {5.4, 3.}]},
          
          ImageSizeCache->{{60.905792171941286`, 66.30483584738248}, {
           143.87707764400338`, 145.4251023385105}}],
         StatusArea[#, 3]& ,
         TagBoxNote->"3"],
        StyleBox["3", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[3, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{5.5, 0.}, {6.5, 3.}]},
          
          ImageSizeCache->{{65.1947402149266, 70.5937838903678}, {
           143.87707764400338`, 145.4251023385105}}],
         StatusArea[#, 3]& ,
         TagBoxNote->"3"],
        StyleBox["3", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[3, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{6.6, 0.}, {7.6, 3.}]},
          
          ImageSizeCache->{{69.48368825791192, 74.88273193335311}, {
           143.87707764400338`, 145.4251023385105}}],
         StatusArea[#, 3]& ,
         TagBoxNote->"3"],
        StyleBox["3", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[3, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{7.699999999999999, 0.}, {8.7, 3.}]},
          
          ImageSizeCache->{{73.77263630089723, 79.17167997633842}, {
           143.87707764400338`, 145.4251023385105}}],
         StatusArea[#, 3]& ,
         TagBoxNote->"3"],
        StyleBox["3", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[3, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{8.799999999999999, 0.}, {9.799999999999999, 4.}]},
          
          ImageSizeCache->{{78.06158434388254, 83.46062801932375}, {
           143.86106941250102`, 145.4251023385105}}],
         StatusArea[#, 4]& ,
         TagBoxNote->"4"],
        StyleBox["4", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[4, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{9.899999999999999, 0.}, {10.899999999999999`, 4.}]},
          
          ImageSizeCache->{{82.35053238686787, 87.74957606230906}, {
           143.86106941250102`, 145.4251023385105}}],
         StatusArea[#, 4]& ,
         TagBoxNote->"4"],
        StyleBox["4", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[4, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{10.999999999999998`, 0.}, {11.999999999999998`, 4.}]},
          
          ImageSizeCache->{{86.63948042985318, 92.03852410529439}, {
           143.86106941250102`, 145.4251023385105}}],
         StatusArea[#, 4]& ,
         TagBoxNote->"4"],
        StyleBox["4", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[4, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{12.099999999999998`, 0.}, {13.099999999999998`, 5.}]},
          
          ImageSizeCache->{{90.9284284728385, 96.3274721482797}, {
           143.84506118099864`, 145.4251023385105}}],
         StatusArea[#, 5]& ,
         TagBoxNote->"5"],
        StyleBox["5", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[5, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{13.199999999999998`, 0.}, {14.199999999999998`, 5.}]},
          
          ImageSizeCache->{{95.21737651582382, 100.61642019126501`}, {
           143.84506118099864`, 145.4251023385105}}],
         StatusArea[#, 5]& ,
         TagBoxNote->"5"],
        StyleBox["5", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[5, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{14.299999999999997`, 0.}, {15.299999999999997`, 6.}]},
          
          ImageSizeCache->{{99.50632455880913, 104.90536823425033`}, {
           143.82905294949626`, 145.4251023385105}}],
         StatusArea[#, 6]& ,
         TagBoxNote->"6"],
        StyleBox["6", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[6, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{15.399999999999997`, 0.}, {16.4, 6.}]},
          
          ImageSizeCache->{{103.79527260179445`, 109.19431627723566`}, {
           143.82905294949626`, 145.4251023385105}}],
         StatusArea[#, 6]& ,
         TagBoxNote->"6"],
        StyleBox["6", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[6, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{16.5, 0.}, {17.5, 6.}]},
          
          ImageSizeCache->{{108.08422064477978`, 113.48326432022097`}, {
           143.82905294949626`, 145.4251023385105}}],
         StatusArea[#, 6]& ,
         TagBoxNote->"6"],
        StyleBox["6", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[6, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{17.6, 0.}, {18.6, 6.}]},
          
          ImageSizeCache->{{112.37316868776512`, 117.77221236320631`}, {
           143.82905294949626`, 145.4251023385105}}],
         StatusArea[#, 6]& ,
         TagBoxNote->"6"],
        StyleBox["6", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[6, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{18.700000000000003`, 0.}, {19.700000000000003`, 6.}]},
          
          ImageSizeCache->{{116.66211673075043`, 122.06116040619162`}, {
           143.82905294949626`, 145.4251023385105}}],
         StatusArea[#, 6]& ,
         TagBoxNote->"6"],
        StyleBox["6", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[6, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{19.800000000000004`, 0.}, {20.800000000000004`, 6.}]},
          
          ImageSizeCache->{{120.95106477373574`, 126.35010844917696`}, {
           143.82905294949626`, 145.4251023385105}}],
         StatusArea[#, 6]& ,
         TagBoxNote->"6"],
        StyleBox["6", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[6, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{20.900000000000006`, 0.}, {21.900000000000006`, 6.}]},
          ImageSizeCache->{{125.24001281672108`, 130.63905649216227`}, {
           143.82905294949626`, 145.4251023385105}}],
         StatusArea[#, 6]& ,
         TagBoxNote->"6"],
        StyleBox["6", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[6, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{22.000000000000007`, 0.}, {23.000000000000007`, 6.}]},
          
          ImageSizeCache->{{129.5289608597064, 134.9280045351476}, {
           143.82905294949626`, 145.4251023385105}}],
         StatusArea[#, 6]& ,
         TagBoxNote->"6"],
        StyleBox["6", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[6, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{23.10000000000001, 0.}, {24.10000000000001, 7.}]},
          
          ImageSizeCache->{{133.81790890269173`, 139.21695257813292`}, {
           143.8130447179939, 145.4251023385105}}],
         StatusArea[#, 7]& ,
         TagBoxNote->"7"],
        StyleBox["7", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[7, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{24.20000000000001, 0.}, {25.20000000000001, 7.}]},
          
          ImageSizeCache->{{138.10685694567704`, 143.50590062111826`}, {
           143.8130447179939, 145.4251023385105}}],
         StatusArea[#, 7]& ,
         TagBoxNote->"7"],
        StyleBox["7", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[7, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{25.30000000000001, 0.}, {26.30000000000001, 8.}]},
          
          ImageSizeCache->{{142.39580498866238`, 147.79484866410357`}, {
           143.79703648649152`, 145.4251023385105}}],
         StatusArea[#, 8]& ,
         TagBoxNote->"8"],
        StyleBox["8", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[8, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{26.400000000000013`, 0.}, {27.400000000000013`, 8.}]},
          
          ImageSizeCache->{{146.6847530316477, 152.08379670708888`}, {
           143.79703648649152`, 145.4251023385105}}],
         StatusArea[#, 8]& ,
         TagBoxNote->"8"],
        StyleBox["8", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[8, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{27.500000000000014`, 0.}, {28.500000000000014`, 8.}]},
          
          ImageSizeCache->{{150.97370107463303`, 156.37274475007422`}, {
           143.79703648649152`, 145.4251023385105}}],
         StatusArea[#, 8]& ,
         TagBoxNote->"8"],
        StyleBox["8", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[8, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{28.600000000000016`, 0.}, {29.600000000000016`, 8.}]},
          
          ImageSizeCache->{{155.26264911761834`, 160.66169279305953`}, {
           143.79703648649152`, 145.4251023385105}}],
         StatusArea[#, 8]& ,
         TagBoxNote->"8"],
        StyleBox["8", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[8, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{29.700000000000017`, 0.}, {30.700000000000017`, 9.}]},
          
          ImageSizeCache->{{159.55159716060368`, 164.95064083604487`}, {
           143.78102825498917`, 145.4251023385105}}],
         StatusArea[#, 9]& ,
         TagBoxNote->"9"],
        StyleBox["9", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[9, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{30.80000000000002, 0.}, {31.80000000000002, 9.}]},
          
          ImageSizeCache->{{163.840545203589, 169.23958887903018`}, {
           143.78102825498917`, 145.4251023385105}}],
         StatusArea[#, 9]& ,
         TagBoxNote->"9"],
        StyleBox["9", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[9, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{31.90000000000002, 0.}, {32.90000000000002, 9.}]},
          
          ImageSizeCache->{{168.1294932465743, 173.5285369220155}, {
           143.78102825498917`, 145.4251023385105}}],
         StatusArea[#, 9]& ,
         TagBoxNote->"9"],
        StyleBox["9", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[9, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{33.00000000000002, 0.}, {34.00000000000002, 9.}]},
          
          ImageSizeCache->{{172.41844128955964`, 177.81748496500083`}, {
           143.78102825498917`, 145.4251023385105}}],
         StatusArea[#, 9]& ,
         TagBoxNote->"9"],
        StyleBox["9", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[9, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{34.10000000000002, 0.}, {35.10000000000002, 10.}]},
          
          ImageSizeCache->{{176.70738933254495`, 182.10643300798614`}, {
           143.76502002348678`, 145.4251023385105}}],
         StatusArea[#, 10]& ,
         TagBoxNote->"10"],
        StyleBox["10", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[10, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{35.200000000000024`, 0.}, {36.200000000000024`, 
            11.}]},
          
          ImageSizeCache->{{180.9963373755303, 186.39538105097148`}, {
           143.7490117919844, 145.4251023385105}}],
         StatusArea[#, 11]& ,
         TagBoxNote->"11"],
        StyleBox["11", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[11, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{36.300000000000026`, 0.}, {37.300000000000026`, 
            11.}]},
          
          ImageSizeCache->{{185.2852854185156, 190.6843290939568}, {
           143.7490117919844, 145.4251023385105}}],
         StatusArea[#, 11]& ,
         TagBoxNote->"11"],
        StyleBox["11", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[11, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{37.40000000000003, 0.}, {38.40000000000003, 12.}]},
          
          ImageSizeCache->{{189.5742334615009, 194.97327713694213`}, {
           143.73300356048205`, 145.4251023385105}}],
         StatusArea[#, 12]& ,
         TagBoxNote->"12"],
        StyleBox["12", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[12, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{38.50000000000003, 0.}, {39.50000000000003, 13.}]},
          
          ImageSizeCache->{{193.86318150448625`, 199.26222517992744`}, {
           143.71699532897966`, 145.4251023385105}}],
         StatusArea[#, 13]& ,
         TagBoxNote->"13"],
        StyleBox["13", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[13, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{39.60000000000003, 0.}, {40.60000000000003, 14.}]},
          
          ImageSizeCache->{{198.15212954747156`, 203.55117322291278`}, {
           143.7009870974773, 145.4251023385105}}],
         StatusArea[#, 14]& ,
         TagBoxNote->"14"],
        StyleBox["14", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[14, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{40.70000000000003, 0.}, {41.70000000000003, 14.}]},
          
          ImageSizeCache->{{202.4410775904569, 207.8401212658981}, {
           143.7009870974773, 145.4251023385105}}],
         StatusArea[#, 14]& ,
         TagBoxNote->"14"],
        StyleBox["14", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[14, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{41.80000000000003, 0.}, {42.80000000000003, 14.}]},
          
          ImageSizeCache->{{206.7300256334422, 212.12906930888343`}, {
           143.7009870974773, 145.4251023385105}}],
         StatusArea[#, 14]& ,
         TagBoxNote->"14"],
        StyleBox["14", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[14, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{42.900000000000034`, 0.}, {43.900000000000034`, 
            17.}]},
          
          ImageSizeCache->{{211.01897367642755`, 216.41801735186874`}, {
           143.6529624029702, 145.4251023385105}}],
         StatusArea[#, 17]& ,
         TagBoxNote->"17"],
        StyleBox["17", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[17, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{44.000000000000036`, 0.}, {45.000000000000036`, 
            19.}]},
          
          ImageSizeCache->{{215.30792171941286`, 220.70696539485405`}, {
           143.62094593996545`, 145.4251023385105}}],
         StatusArea[#, 19]& ,
         TagBoxNote->"19"],
        StyleBox["19", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[19, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{45.10000000000004, 0.}, {46.10000000000004, 21.}]},
          
          ImageSizeCache->{{219.5968697623982, 224.9959134378394}, {
           143.5889294769607, 145.4251023385105}}],
         StatusArea[#, 21]& ,
         TagBoxNote->"21"],
        StyleBox["21", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[21, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{46.20000000000004, 0.}, {47.20000000000004, 22.}]},
          
          ImageSizeCache->{{223.8858178053835, 229.2848614808247}, {
           143.57292124545833`, 145.4251023385105}}],
         StatusArea[#, 22]& ,
         TagBoxNote->"22"],
        StyleBox["22", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[22, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{47.30000000000004, 0.}, {48.30000000000004, 22.}]},
          
          ImageSizeCache->{{228.17476584836885`, 233.57380952381004`}, {
           143.57292124545833`, 145.4251023385105}}],
         StatusArea[#, 22]& ,
         TagBoxNote->"22"],
        StyleBox["22", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[22, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{48.40000000000004, 0.}, {49.40000000000004, 22.}]},
          
          ImageSizeCache->{{232.46371389135416`, 237.86275756679535`}, {
           143.57292124545833`, 145.4251023385105}}],
         StatusArea[#, 22]& ,
         TagBoxNote->"22"],
        StyleBox["22", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[22, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{49.50000000000004, 0.}, {50.50000000000004, 23.}]},
          
          ImageSizeCache->{{236.75266193433947`, 242.1517056097807}, {
           143.55691301395595`, 145.4251023385105}}],
         StatusArea[#, 23]& ,
         TagBoxNote->"23"],
        StyleBox["23", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[23, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{50.600000000000044`, 0.}, {51.600000000000044`, 
            24.}]},
          
          ImageSizeCache->{{241.0416099773248, 246.440653652766}, {
           143.5409047824536, 145.4251023385105}}],
         StatusArea[#, 24]& ,
         TagBoxNote->"24"],
        StyleBox["24", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[24, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{51.700000000000045`, 0.}, {52.700000000000045`, 
            25.}]},
          
          ImageSizeCache->{{245.33055802031012`, 250.72960169575134`}, {
           143.5248965509512, 145.4251023385105}}],
         StatusArea[#, 25]& ,
         TagBoxNote->"25"],
        StyleBox["25", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[25, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{52.80000000000005, 0.}, {53.80000000000005, 27.}]},
          
          ImageSizeCache->{{249.61950606329546`, 255.01854973873665`}, {
           143.49288008794647`, 145.4251023385105}}],
         StatusArea[#, 27]& ,
         TagBoxNote->"27"],
        StyleBox["27", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[27, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{53.90000000000005, 0.}, {54.90000000000005, 28.}]},
          
          ImageSizeCache->{{253.90845410628077`, 259.30749778172196`}, {
           143.4768718564441, 145.4251023385105}}],
         StatusArea[#, 28]& ,
         TagBoxNote->"28"],
        StyleBox["28", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[28, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{55.00000000000005, 0.}, {56.00000000000005, 31.}]},
          
          ImageSizeCache->{{258.1974021492661, 263.5964458247073}, {
           143.42884716193697`, 145.4251023385105}}],
         StatusArea[#, 31]& ,
         TagBoxNote->"31"],
        StyleBox["31", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[31, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{56.10000000000005, 0.}, {57.10000000000005, 38.}]},
          
          ImageSizeCache->{{262.48635019225145`, 267.88539386769264`}, {
           143.31678954142038`, 145.4251023385105}}],
         StatusArea[#, 38]& ,
         TagBoxNote->"38"],
        StyleBox["38", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[38, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{57.20000000000005, 0.}, {58.20000000000005, 38.}]},
          
          ImageSizeCache->{{266.7752982352368, 272.174341910678}, {
           143.31678954142038`, 145.4251023385105}}],
         StatusArea[#, 38]& ,
         TagBoxNote->"38"],
        StyleBox["38", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[38, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{58.300000000000054`, 0.}, {59.300000000000054`, 
            41.}]},
          
          ImageSizeCache->{{271.0642462782221, 276.46328995366326`}, {
           143.26876484691326`, 145.4251023385105}}],
         StatusArea[#, 41]& ,
         TagBoxNote->"41"],
        StyleBox["41", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[41, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{59.400000000000055`, 0.}, {60.400000000000055`, 
            48.}]},
          
          ImageSizeCache->{{275.3531943212074, 280.7522379966486}, {
           143.15670722639666`, 145.4251023385105}}],
         StatusArea[#, 48]& ,
         TagBoxNote->"48"],
        StyleBox["48", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[48, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{60.50000000000006, 0.}, {61.50000000000006, 48.}]},
          
          ImageSizeCache->{{279.64214236419275`, 285.04118603963394`}, {
           143.15670722639666`, 145.4251023385105}}],
         StatusArea[#, 48]& ,
         TagBoxNote->"48"],
        StyleBox["48", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[48, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{61.60000000000006, 0.}, {62.60000000000006, 49.}]},
          
          ImageSizeCache->{{283.93109040717803`, 289.3301340826193}, {
           143.1406989948943, 145.4251023385105}}],
         StatusArea[#, 49]& ,
         TagBoxNote->"49"],
        StyleBox["49", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[49, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{62.70000000000006, 0.}, {63.70000000000006, 54.}]},
          
          ImageSizeCache->{{288.2200384501634, 293.61908212560456`}, {
           143.06065783738245`, 145.4251023385105}}],
         StatusArea[#, 54]& ,
         TagBoxNote->"54"],
        StyleBox["54", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[54, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{63.80000000000006, 0.}, {64.80000000000007, 58.}]},
          
          ImageSizeCache->{{292.5089864931487, 297.90803016858996`}, {
           142.99662491137295`, 145.4251023385105}}],
         StatusArea[#, 58]& ,
         TagBoxNote->"58"],
        StyleBox["58", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[58, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{64.90000000000006, 0.}, {65.90000000000006, 59.}]},
          
          ImageSizeCache->{{296.79793453613405`, 302.19697821157524`}, {
           142.9806166798706, 145.4251023385105}}],
         StatusArea[#, 59]& ,
         TagBoxNote->"59"],
        StyleBox["59", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[59, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{66.00000000000006, 0.}, {67.00000000000006, 59.}]},
          ImageSizeCache->{{301.08688257911933`, 306.4859262545605}, {
           142.9806166798706, 145.4251023385105}}],
         StatusArea[#, 59]& ,
         TagBoxNote->"59"],
        StyleBox["59", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[59, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{67.10000000000005, 0.}, {68.10000000000005, 62.}]},
          
          ImageSizeCache->{{305.3758306221046, 310.7748742975458}, {
           142.93259198536347`, 145.4251023385105}}],
         StatusArea[#, 62]& ,
         TagBoxNote->"62"],
        StyleBox["62", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[62, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{68.20000000000005, 0.}, {69.20000000000005, 66.}]},
          
          ImageSizeCache->{{309.6647786650899, 315.0638223405311}, {
           142.86855905935397`, 145.4251023385105}}],
         StatusArea[#, 66]& ,
         TagBoxNote->"66"],
        StyleBox["66", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[66, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{69.30000000000004, 0.}, {70.30000000000004, 67.}]},
          
          ImageSizeCache->{{313.9537267080752, 319.3527703835164}, {
           142.85255082785162`, 145.4251023385105}}],
         StatusArea[#, 67]& ,
         TagBoxNote->"67"],
        StyleBox["67", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[67, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{70.40000000000003, 0.}, {71.40000000000003, 73.}]},
          
          ImageSizeCache->{{318.2426747510605, 323.6417184265017}, {
           142.75650143883738`, 145.4251023385105}}],
         StatusArea[#, 73]& ,
         TagBoxNote->"73"],
        StyleBox["73", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[73, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{71.50000000000003, 0.}, {72.50000000000003, 76.}]},
          
          ImageSizeCache->{{322.5316227940458, 327.930666469487}, {
           142.70847674433026`, 145.4251023385105}}],
         StatusArea[#, 76]& ,
         TagBoxNote->"76"],
        StyleBox["76", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[76, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{72.60000000000002, 0.}, {73.60000000000002, 79.}]},
          
          ImageSizeCache->{{326.8205708370311, 332.2196145124723}, {
           142.66045204982316`, 145.4251023385105}}],
         StatusArea[#, 79]& ,
         TagBoxNote->"79"],
        StyleBox["79", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[79, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{73.70000000000002, 0.}, {74.70000000000002, 82.}]},
          
          ImageSizeCache->{{331.10951888001637`, 336.50856255545756`}, {
           142.61242735531604`, 145.4251023385105}}],
         StatusArea[#, 82]& ,
         TagBoxNote->"82"],
        StyleBox["82", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[82, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{74.80000000000001, 0.}, {75.80000000000001, 88.}]},
          
          ImageSizeCache->{{335.3984669230017, 340.7975105984429}, {
           142.5163779663018, 145.4251023385105}}],
         StatusArea[#, 88]& ,
         TagBoxNote->"88"],
        StyleBox["88", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[88, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{75.9, 0.}, {76.9, 104.}]},
          
          ImageSizeCache->{{339.687414965987, 345.0864586414282}, {
           142.26024626226388`, 145.4251023385105}}],
         StatusArea[#, 104]& ,
         TagBoxNote->"104"],
        StyleBox["104", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[104, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{77., 0.}, {78., 116.}]},
          
          ImageSizeCache->{{343.97636300897227`, 349.37540668441346`}, {
           142.0681474842354, 145.4251023385105}}],
         StatusArea[#, 116]& ,
         TagBoxNote->"116"],
        StyleBox["116", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[116, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{78.1, 0.}, {79.1, 132.}]},
          
          ImageSizeCache->{{348.26531105195755`, 353.66435472739875`}, {
           141.81201578019747`, 145.4251023385105}}],
         StatusArea[#, 132]& ,
         TagBoxNote->"132"],
        StyleBox["132", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[132, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{79.19999999999999, 0.}, {80.19999999999999, 156.}]},
          
          ImageSizeCache->{{352.5542590949429, 357.9533027703841}, {
           141.42781822414054`, 145.4251023385105}}],
         StatusArea[#, 156]& ,
         TagBoxNote->"156"],
        StyleBox["156", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[156, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{80.29999999999998, 0.}, {81.29999999999998, 162.}]},
          
          ImageSizeCache->{{356.8432071379282, 362.24225081336937`}, {
           141.33176883512633`, 145.4251023385105}}],
         StatusArea[#, 162]& ,
         TagBoxNote->"162"],
        StyleBox["162", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[162, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{81.39999999999998, 0.}, {82.39999999999998, 177.}]},
          
          ImageSizeCache->{{361.13215518091346`, 366.53119885635465`}, {
           141.09164536259075`, 145.4251023385105}}],
         StatusArea[#, 177]& ,
         TagBoxNote->"177"],
        StyleBox["177", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[177, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{82.49999999999997, 0.}, {83.49999999999997, 182.}]},
          
          ImageSizeCache->{{365.42110322389874`, 370.82014689933993`}, {
           141.0116042050789, 145.4251023385105}}],
         StatusArea[#, 182]& ,
         TagBoxNote->"182"],
        StyleBox["182", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[182, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{83.59999999999997, 0.}, {84.59999999999997, 186.}]},
          
          ImageSizeCache->{{369.710051266884, 375.10909494232527`}, {
           140.9475712790694, 145.4251023385105}}],
         StatusArea[#, 186]& ,
         TagBoxNote->"186"],
        StyleBox["186", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[186, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{84.69999999999996, 0.}, {85.69999999999996, 196.}]},
          
          ImageSizeCache->{{373.99899930986936`, 379.39804298531055`}, {
           140.78748896404568`, 145.4251023385105}}],
         StatusArea[#, 196]& ,
         TagBoxNote->"196"],
        StyleBox["196", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[196, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{85.79999999999995, 0.}, {86.79999999999995, 199.}]},
          
          ImageSizeCache->{{378.28794735285464`, 383.68699102829584`}, {
           140.7394642695386, 145.4251023385105}}],
         StatusArea[#, 199]& ,
         TagBoxNote->"199"],
        StyleBox["199", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[199, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{86.89999999999995, 0.}, {87.89999999999995, 212.}]},
          
          ImageSizeCache->{{382.5768953958399, 387.9759390712811}, {
           140.53135726000775`, 145.4251023385105}}],
         StatusArea[#, 212]& ,
         TagBoxNote->"212"],
        StyleBox["212", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[212, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{87.99999999999994, 0.}, {88.99999999999994, 219.}]},
          
          ImageSizeCache->{{386.8658434388252, 392.26488711426646`}, {
           140.41929963949116`, 145.4251023385105}}],
         StatusArea[#, 219]& ,
         TagBoxNote->"219"],
        StyleBox["219", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[219, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{89.09999999999994, 0.}, {90.09999999999994, 232.}]},
          
          ImageSizeCache->{{391.15479148181055`, 396.55383515725174`}, {
           140.21119262996032`, 145.4251023385105}}],
         StatusArea[#, 232]& ,
         TagBoxNote->"232"],
        StyleBox["232", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[232, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{90.19999999999993, 0.}, {91.19999999999993, 273.}]},
          
          ImageSizeCache->{{395.44373952479583`, 400.842783200237}, {
           139.55485513836308`, 145.4251023385105}}],
         StatusArea[#, 273]& ,
         TagBoxNote->"273"],
        StyleBox["273", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[273, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{91.29999999999993, 0.}, {92.29999999999993, 275.}]},
          
          ImageSizeCache->{{399.7326875677811, 405.1317312432223}, {
           139.52283867535834`, 145.4251023385105}}],
         StatusArea[#, 275]& ,
         TagBoxNote->"275"],
        StyleBox["275", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[275, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{92.39999999999992, 0.}, {93.39999999999992, 276.}]},
          
          ImageSizeCache->{{404.0216356107664, 409.4206792862076}, {
           139.506830443856, 145.4251023385105}}],
         StatusArea[#, 276]& ,
         TagBoxNote->"276"],
        StyleBox["276", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[276, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{93.49999999999991, 0.}, {94.49999999999991, 277.}]},
          
          ImageSizeCache->{{408.31058365375173`, 413.7096273291929}, {
           139.4908222123536, 145.4251023385105}}],
         StatusArea[#, 277]& ,
         TagBoxNote->"277"],
        StyleBox["277", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[277, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{94.59999999999991, 0.}, {95.59999999999991, 334.}]},
          
          ImageSizeCache->{{412.599531696737, 417.9985753721782}, {
           138.57835301671844`, 145.4251023385105}}],
         StatusArea[#, 334]& ,
         TagBoxNote->"334"],
        StyleBox["334", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[334, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{95.6999999999999, 0.}, {96.6999999999999, 355.}]},
          
          ImageSizeCache->{{416.8884797397223, 422.2875234151635}, {
           138.24218015516863`, 145.4251023385105}}],
         StatusArea[#, 355]& ,
         TagBoxNote->"355"],
        StyleBox["355", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[355, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{96.7999999999999, 0.}, {97.7999999999999, 371.}]},
          
          ImageSizeCache->{{421.1774277827076, 426.5764714581488}, {
           137.9860484511307, 145.4251023385105}}],
         StatusArea[#, 371]& ,
         TagBoxNote->"371"],
        StyleBox["371", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[371, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{97.89999999999989, 0.}, {98.89999999999989, 371.}]},
          
          ImageSizeCache->{{425.4663758256929, 430.8654195011341}, {
           137.9860484511307, 145.4251023385105}}],
         StatusArea[#, 371]& ,
         TagBoxNote->"371"],
        StyleBox["371", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[371, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{98.99999999999989, 0.}, {99.99999999999989, 400.}]},
          
          ImageSizeCache->{{429.7553238686782, 435.1543675441194}, {
           137.5218097375619, 145.4251023385105}}],
         StatusArea[#, 400]& ,
         TagBoxNote->"400"],
        StyleBox["400", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[400, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{100.09999999999988`, 0.}, {101.09999999999988`, 
            401.}]},
          
          ImageSizeCache->{{434.0442719116635, 439.4433155871047}, {
           137.50580150605956`, 145.4251023385105}}],
         StatusArea[#, 401]& ,
         TagBoxNote->"401"],
        StyleBox["401", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[401, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{101.19999999999987`, 0.}, {102.19999999999987`, 
            442.}]},
          
          ImageSizeCache->{{438.33321995464877`, 443.73226363008996`}, {
           136.8494640144623, 145.4251023385105}}],
         StatusArea[#, 442]& ,
         TagBoxNote->"442"],
        StyleBox["442", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[442, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{102.29999999999987`, 0.}, {103.29999999999987`, 
            473.}]},
          
          ImageSizeCache->{{442.6221679976341, 448.0212116730753}, {
           136.3532088378888, 145.4251023385105}}],
         StatusArea[#, 473]& ,
         TagBoxNote->"473"],
        StyleBox["473", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[473, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{103.39999999999986`, 0.}, {104.39999999999986`, 
            481.}]},
          
          ImageSizeCache->{{446.9111160406194, 452.3101597160606}, {
           136.22514298586984`, 145.4251023385105}}],
         StatusArea[#, 481]& ,
         TagBoxNote->"481"],
        StyleBox["481", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[481, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{104.49999999999986`, 0.}, {105.49999999999986`, 
            486.}]},
          
          ImageSizeCache->{{451.2000640836047, 456.59910775904586`}, {
           136.14510182835798`, 145.4251023385105}}],
         StatusArea[#, 486]& ,
         TagBoxNote->"486"],
        StyleBox["486", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[486, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{105.59999999999985`, 0.}, {106.59999999999985`, 
            645.}]},
          
          ImageSizeCache->{{455.48901212658996`, 460.88805580203115`}, {
           133.5997930194809, 145.4251023385105}}],
         StatusArea[#, 645]& ,
         TagBoxNote->"645"],
        StyleBox["645", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[645, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{106.69999999999985`, 0.}, {107.69999999999985`, 
            1153.}]},
          
          ImageSizeCache->{{459.77796016957524`, 465.1770038450165}, {
           125.46761141627621`, 145.4251023385105}}],
         StatusArea[#, 1153]& ,
         TagBoxNote->"1153"],
        StyleBox["1153", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[1153, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{107.79999999999984`, 0.}, {108.79999999999984`, 
            1366.}]},
          
          ImageSizeCache->{{464.0669082125606, 469.46595188800177`}, {
           122.05785810627108`, 145.4251023385105}}],
         StatusArea[#, 1366]& ,
         TagBoxNote->"1366"],
        StyleBox["1366", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[1366, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{108.89999999999984`, 0.}, {109.89999999999984`, 
            1448.}]},
          
          ImageSizeCache->{{468.35585625554586`, 473.75489993098705`}, {
           120.74518312307663`, 145.4251023385105}}],
         StatusArea[#, 1448]& ,
         TagBoxNote->"1448"],
        StyleBox["1448", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[1448, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{109.99999999999983`, 0.}, {110.99999999999983`, 
            1889.}]},
          
          ImageSizeCache->{{472.64480429853114`, 478.04384797397233`}, {
           113.68555303053081`, 145.4251023385105}}],
         StatusArea[#, 1889]& ,
         TagBoxNote->"1889"],
        StyleBox["1889", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[1889, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{111.09999999999982`, 0.}, {112.09999999999982`, 
            2560.}]},
          
          ImageSizeCache->{{476.9337523415164, 482.3327960169577}, {
           102.94402969243956`, 145.4251023385105}}],
         StatusArea[#, 2560]& ,
         TagBoxNote->"2560"],
        StyleBox["2560", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[2560, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{112.19999999999982`, 0.}, {113.19999999999982`, 
            2729.}]},
          
          ImageSizeCache->{{481.22270038450176`, 486.62174405994296`}, {
           100.23863856853879`, 145.4251023385105}}],
         StatusArea[#, 2729]& ,
         TagBoxNote->"2729"],
        StyleBox["2729", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[2729, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{113.29999999999981`, 0.}, {114.29999999999981`, 
            4178.}]},
          
          ImageSizeCache->{{485.51164842748705`, 490.91069210292824`}, {
           77.04271112160255, 145.4251023385105}}],
         StatusArea[#, 4178]& ,
         TagBoxNote->"4178"],
        StyleBox["4178", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[4178, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{114.3999999999998, 0.}, {115.3999999999998, 4347.}]},
          
          
          ImageSizeCache->{{489.8005964704723, 495.1996401459135}, {
           74.33731999770177, 145.4251023385105}}],
         StatusArea[#, 4347]& ,
         TagBoxNote->"4347"],
        StyleBox["4347", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[4347, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{115.4999999999998, 0.}, {116.4999999999998, 4393.}]},
          
          
          ImageSizeCache->{{494.0895445134576, 499.48858818889886`}, {
           73.60094134859268, 145.4251023385105}}],
         StatusArea[#, 4393]& ,
         TagBoxNote->"4393"],
        StyleBox["4393", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[4393, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{116.5999999999998, 0.}, {117.5999999999998, 5584.}]},
          
          
          ImageSizeCache->{{498.37849255644295`, 503.77753623188414`}, {
           54.53513762926828, 145.4251023385105}}],
         StatusArea[#, 5584]& ,
         TagBoxNote->"5584"],
        StyleBox["5584", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[5584, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{117.69999999999979`, 0.}, {118.69999999999979`, 
            8683.}]},
          
          ImageSizeCache->{{502.66744059942823`, 508.0664842748694}, {
           4.925628203419137, 145.4251023385105}}],
         StatusArea[#, 8683]& ,
         TagBoxNote->"8683"],
        StyleBox["8683", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[8683, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{118.79999999999978`, 0.}, {119.79999999999978`, 
            9210.}]},
          
          ImageSizeCache->{{506.9563886424135, 
           512.3554323178547}, {-3.5107097983306232`, 145.4251023385105}}],
         StatusArea[#, 9210]& ,
         TagBoxNote->"9210"],
        StyleBox["9210", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[9210, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{119.89999999999978`, 0.}, {120.89999999999978`, 
            10601.}]},
          
          ImageSizeCache->{{511.2453366853988, 
           516.64438036084}, {-25.778159818129325`, 145.4251023385105}}],
         StatusArea[#, 10601]& ,
         TagBoxNote->"10601"],
        StyleBox["10601", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[10601, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{120.99999999999977`, 0.}, {121.99999999999977`, 
            10693.}]},
          
          ImageSizeCache->{{515.5342847283841, 
           520.9333284038254}, {-27.250917116347495`, 145.4251023385105}}],
         StatusArea[#, 10693]& ,
         TagBoxNote->"10693"],
        StyleBox["10693", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[10693, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{122.09999999999977`, 0.}, {123.09999999999977`, 
            14224.}]},
          
          ImageSizeCache->{{519.8232327713695, 
           525.2222764468106}, {-83.77598255122112, 145.4251023385105}}],
         StatusArea[#, 14224]& ,
         TagBoxNote->"14224"],
        StyleBox["14224", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[14224, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{123.19999999999976`, 0.}, {124.19999999999976`, 
            18696.}]},
          
          ImageSizeCache->{{524.1121808143547, 
           529.511224489796}, {-155.36479382982628`, 145.4251023385105}}],
         StatusArea[#, 18696]& ,
         TagBoxNote->"18696"],
        StyleBox["18696", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[18696, {
          GrayLevel[0]}], "Tooltip"]& ]}}, {}, {}}, {}, GraphicsGroupBox[
    StyleBox[
     LineBox[{{{0., 0}, Offset[{0, -4}, {0., 0}]}, {{124.19999999999976`, 0}, 
        Offset[{0, -4}, {124.19999999999976`, 0}]}}],
     Antialiasing->False]]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  PlotRangePadding->Scaled[0.02],
  Ticks->{None, Automatic}]], "Output",
 CellChangeTimes->{{3.493914188544279*^9, 3.4939142387549467`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BarChart", "[", 
  RowBox[{
   RowBox[{"Sort", "@", 
    RowBox[{"Log", "@", "pcounts"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.493292783271881*^9, 3.4932927973458843`*^9}, {
   3.493292845274254*^9, 3.493292877818643*^9}, {3.493292919501861*^9, 
   3.493292982083169*^9}, 3.493293103469276*^9, {3.4932936498608932`*^9, 
   3.493293666098467*^9}, {3.493914160405387*^9, 3.49391423716049*^9}, {
   3.493914621103547*^9, 3.493914625983706*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0., 0.}, {1., 0.}]},
          
          ImageSizeCache->{{18.75, 24.346223996845122`}, {154.91586880048277`,
            156.41586880048277`}}],
         StatusArea[#, 0]& ,
         TagBoxNote->"0"],
        StyleBox["0", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[0, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{1.1, 0.}, {2.1, 0.}]},
          
          ImageSizeCache->{{23.255846396529634`, 28.852070393374753`}, {
           154.91586880048277`, 156.41586880048277`}}],
         StatusArea[#, 0]& ,
         TagBoxNote->"0"],
        StyleBox["0", {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[0, {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{2.2, 0.}, {3.2, 0.6931471805599453}]},
          
          ImageSizeCache->{{27.761692793059268`, 33.35791678990439}, {
           132.75831923245278`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[2]]& ,
         TagBoxNote->"Log[2]"],
        StyleBox[
         RowBox[{"Log", "[", "2", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[2], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{3.3000000000000003`, 0.}, {4.300000000000001, 
            0.6931471805599453}]},
          
          ImageSizeCache->{{32.2675391895889, 37.86376318643403}, {
           132.75831923245278`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[2]]& ,
         TagBoxNote->"Log[2]"],
        StyleBox[
         RowBox[{"Log", "[", "2", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[2], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{4.4, 0.}, {5.4, 1.0986122886681098`}]},
          
          ImageSizeCache->{{36.773385586118536`, 42.369609582963655`}, {
           119.79698362728496`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[3]]& ,
         TagBoxNote->"Log[3]"],
        StyleBox[
         RowBox[{"Log", "[", "3", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[3], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{5.5, 0.}, {6.5, 1.0986122886681098`}]},
          
          ImageSizeCache->{{41.27923198264817, 46.87545597949329}, {
           119.79698362728496`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[3]]& ,
         TagBoxNote->"Log[3]"],
        StyleBox[
         RowBox[{"Log", "[", "3", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[3], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{6.6, 0.}, {7.6, 1.0986122886681098`}]},
          
          ImageSizeCache->{{45.785078379177804`, 51.381302376022916`}, {
           119.79698362728496`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[3]]& ,
         TagBoxNote->"Log[3]"],
        StyleBox[
         RowBox[{"Log", "[", "3", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[3], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{7.699999999999999, 0.}, {8.7, 1.0986122886681098`}]},
          
          
          ImageSizeCache->{{50.29092477570743, 55.88714877255255}, {
           119.79698362728496`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[3]]& ,
         TagBoxNote->"Log[3]"],
        StyleBox[
         RowBox[{"Log", "[", "3", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[3], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{8.799999999999999, 0.}, {9.799999999999999, 
            1.3862943611198906`}]},
          
          ImageSizeCache->{{54.796771172237065`, 60.392995169082184`}, {
           110.60076966442277`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[4]]& ,
         TagBoxNote->"Log[4]"],
        StyleBox[
         RowBox[{"Log", "[", "4", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[4], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{9.899999999999999, 0.}, {10.899999999999999`, 
            1.3862943611198906`}]},
          
          ImageSizeCache->{{59.30261756876669, 64.89884156561182}, {
           110.60076966442277`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[4]]& ,
         TagBoxNote->"Log[4]"],
        StyleBox[
         RowBox[{"Log", "[", "4", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[4], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{10.999999999999998`, 0.}, {11.999999999999998`, 
            1.3862943611198906`}]},
          
          ImageSizeCache->{{63.808463965296326`, 69.40468796214145}, {
           110.60076966442277`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[4]]& ,
         TagBoxNote->"Log[4]"],
        StyleBox[
         RowBox[{"Log", "[", "4", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[4], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{12.099999999999998`, 0.}, {13.099999999999998`, 
            1.6094379124341003`}]},
          
          ImageSizeCache->{{68.31431036182596, 73.91053435867107}, {
           103.46763194461457`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[5]]& ,
         TagBoxNote->"Log[5]"],
        StyleBox[
         RowBox[{"Log", "[", "5", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[5], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{13.199999999999998`, 0.}, {14.199999999999998`, 
            1.6094379124341003`}]},
          
          ImageSizeCache->{{72.8201567583556, 78.41638075520072}, {
           103.46763194461457`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[5]]& ,
         TagBoxNote->"Log[5]"],
        StyleBox[
         RowBox[{"Log", "[", "5", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[5], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{14.299999999999997`, 0.}, {15.299999999999997`, 
            1.791759469228055}]},
          
          ImageSizeCache->{{77.32600315488523, 82.92222715173034}, {
           97.63943405925497, 156.41586880048277`}}],
         StatusArea[#, 
          Log[6]]& ,
         TagBoxNote->"Log[6]"],
        StyleBox[
         RowBox[{"Log", "[", "6", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[6], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{15.399999999999997`, 0.}, {16.4, 1.791759469228055}]},
          
          ImageSizeCache->{{81.83184955141485, 87.42807354825999}, {
           97.63943405925497, 156.41586880048277`}}],
         StatusArea[#, 
          Log[6]]& ,
         TagBoxNote->"Log[6]"],
        StyleBox[
         RowBox[{"Log", "[", "6", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[6], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{16.5, 0.}, {17.5, 1.791759469228055}]},
          ImageSizeCache->{{86.3376959479445, 91.93391994478962}, {
           97.63943405925497, 156.41586880048277`}}],
         StatusArea[#, 
          Log[6]]& ,
         TagBoxNote->"Log[6]"],
        StyleBox[
         RowBox[{"Log", "[", "6", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[6], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{17.6, 0.}, {18.6, 1.791759469228055}]},
          
          ImageSizeCache->{{90.84354234447414, 96.43976634131926}, {
           97.63943405925497, 156.41586880048277`}}],
         StatusArea[#, 
          Log[6]]& ,
         TagBoxNote->"Log[6]"],
        StyleBox[
         RowBox[{"Log", "[", "6", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[6], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{18.700000000000003`, 0.}, {19.700000000000003`, 
            1.791759469228055}]},
          
          ImageSizeCache->{{95.34938874100378, 100.9456127378489}, {
           97.63943405925497, 156.41586880048277`}}],
         StatusArea[#, 
          Log[6]]& ,
         TagBoxNote->"Log[6]"],
        StyleBox[
         RowBox[{"Log", "[", "6", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[6], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{19.800000000000004`, 0.}, {20.800000000000004`, 
            1.791759469228055}]},
          
          ImageSizeCache->{{99.85523513753341, 105.45145913437854`}, {
           97.63943405925497, 156.41586880048277`}}],
         StatusArea[#, 
          Log[6]]& ,
         TagBoxNote->"Log[6]"],
        StyleBox[
         RowBox[{"Log", "[", "6", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[6], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{20.900000000000006`, 0.}, {21.900000000000006`, 
            1.791759469228055}]},
          
          ImageSizeCache->{{104.36108153406306`, 109.95730553090817`}, {
           97.63943405925497, 156.41586880048277`}}],
         StatusArea[#, 
          Log[6]]& ,
         TagBoxNote->"Log[6]"],
        StyleBox[
         RowBox[{"Log", "[", "6", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[6], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{22.000000000000007`, 0.}, {23.000000000000007`, 
            1.791759469228055}]},
          
          ImageSizeCache->{{108.8669279305927, 114.46315192743782`}, {
           97.63943405925497, 156.41586880048277`}}],
         StatusArea[#, 
          Log[6]]& ,
         TagBoxNote->"Log[6]"],
        StyleBox[
         RowBox[{"Log", "[", "6", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[6], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{23.10000000000001, 0.}, {24.10000000000001, 
            1.9459101490553132`}]},
          
          ImageSizeCache->{{113.37277432712234`, 118.96899832396745`}, {
           92.71176295993841, 156.41586880048277`}}],
         StatusArea[#, 
          Log[7]]& ,
         TagBoxNote->"Log[7]"],
        StyleBox[
         RowBox[{"Log", "[", "7", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[7], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{24.20000000000001, 0.}, {25.20000000000001, 
            1.9459101490553132`}]},
          
          ImageSizeCache->{{117.87862072365198`, 123.4748447204971}, {
           92.71176295993841, 156.41586880048277`}}],
         StatusArea[#, 
          Log[7]]& ,
         TagBoxNote->"Log[7]"],
        StyleBox[
         RowBox[{"Log", "[", "7", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[7], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{25.30000000000001, 0.}, {26.30000000000001, 
            2.0794415416798357`}]},
          
          ImageSizeCache->{{122.38446712018161`, 127.98069111702674`}, {
           88.44322009639278, 156.41586880048277`}}],
         StatusArea[#, 
          Log[8]]& ,
         TagBoxNote->"Log[8]"],
        StyleBox[
         RowBox[{"Log", "[", "8", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[8], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{26.400000000000013`, 0.}, {27.400000000000013`, 
            2.0794415416798357`}]},
          
          ImageSizeCache->{{126.89031351671126`, 132.48653751355636`}, {
           88.44322009639278, 156.41586880048277`}}],
         StatusArea[#, 
          Log[8]]& ,
         TagBoxNote->"Log[8]"],
        StyleBox[
         RowBox[{"Log", "[", "8", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[8], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{27.500000000000014`, 0.}, {28.500000000000014`, 
            2.0794415416798357`}]},
          
          ImageSizeCache->{{131.3961599132409, 136.992383910086}, {
           88.44322009639278, 156.41586880048277`}}],
         StatusArea[#, 
          Log[8]]& ,
         TagBoxNote->"Log[8]"],
        StyleBox[
         RowBox[{"Log", "[", "8", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[8], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{28.600000000000016`, 0.}, {29.600000000000016`, 
            2.0794415416798357`}]},
          
          ImageSizeCache->{{135.9020063097705, 141.49823030661565`}, {
           88.44322009639278, 156.41586880048277`}}],
         StatusArea[#, 
          Log[8]]& ,
         TagBoxNote->"Log[8]"],
        StyleBox[
         RowBox[{"Log", "[", "8", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[8], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{29.700000000000017`, 0.}, {30.700000000000017`, 
            2.1972245773362196`}]},
          
          ImageSizeCache->{{140.40785270630016`, 146.0040767031453}, {
           84.67809845408715, 156.41586880048277`}}],
         StatusArea[#, 
          Log[9]]& ,
         TagBoxNote->"Log[9]"],
        StyleBox[
         RowBox[{"Log", "[", "9", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[9], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{30.80000000000002, 0.}, {31.80000000000002, 
            2.1972245773362196`}]},
          ImageSizeCache->{{144.9136991028298, 150.50992309967492`}, {
           84.67809845408715, 156.41586880048277`}}],
         StatusArea[#, 
          Log[9]]& ,
         TagBoxNote->"Log[9]"],
        StyleBox[
         RowBox[{"Log", "[", "9", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[9], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{31.90000000000002, 0.}, {32.90000000000002, 
            2.1972245773362196`}]},
          
          ImageSizeCache->{{149.41954549935946`, 155.01576949620457`}, {
           84.67809845408715, 156.41586880048277`}}],
         StatusArea[#, 
          Log[9]]& ,
         TagBoxNote->"Log[9]"],
        StyleBox[
         RowBox[{"Log", "[", "9", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[9], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{33.00000000000002, 0.}, {34.00000000000002, 
            2.1972245773362196`}]},
          
          ImageSizeCache->{{153.92539189588908`, 159.52161589273422`}, {
           84.67809845408715, 156.41586880048277`}}],
         StatusArea[#, 
          Log[9]]& ,
         TagBoxNote->"Log[9]"],
        StyleBox[
         RowBox[{"Log", "[", "9", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[9], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{34.10000000000002, 0.}, {35.10000000000002, 
            2.302585092994046}]},
          
          ImageSizeCache->{{158.43123829241873`, 164.02746228926384`}, {
           81.31008237658456, 156.41586880048277`}}],
         StatusArea[#, 
          Log[10]]& ,
         TagBoxNote->"Log[10]"],
        StyleBox[
         RowBox[{"Log", "[", "10", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[10], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{35.200000000000024`, 0.}, {36.200000000000024`, 
            2.3978952727983707`}]},
          
          ImageSizeCache->{{162.93708468894837`, 168.5333086857935}, {
           78.2633412333166, 156.41586880048277`}}],
         StatusArea[#, 
          Log[11]]& ,
         TagBoxNote->"Log[11]"],
        StyleBox[
         RowBox[{"Log", "[", "11", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[11], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{36.300000000000026`, 0.}, {37.300000000000026`, 
            2.3978952727983707`}]},
          
          ImageSizeCache->{{167.442931085478, 173.03915508232313`}, {
           78.2633412333166, 156.41586880048277`}}],
         StatusArea[#, 
          Log[11]]& ,
         TagBoxNote->"Log[11]"],
        StyleBox[
         RowBox[{"Log", "[", "11", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[11], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{37.40000000000003, 0.}, {38.40000000000003, 
            2.4849066497880004`}]},
          
          ImageSizeCache->{{171.94877748200764`, 177.54500147885275`}, {
           75.48188449122496, 156.41586880048277`}}],
         StatusArea[#, 
          Log[12]]& ,
         TagBoxNote->"Log[12]"],
        StyleBox[
         RowBox[{"Log", "[", "12", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[12], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{38.50000000000003, 0.}, {39.50000000000003, 
            2.5649493574615367`}]},
          
          ImageSizeCache->{{176.4546238785373, 182.0508478753824}, {
           72.92319232226455, 156.41586880048277`}}],
         StatusArea[#, 
          Log[13]]& ,
         TagBoxNote->"Log[13]"],
        StyleBox[
         RowBox[{"Log", "[", "13", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[13], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{39.60000000000003, 0.}, {40.60000000000003, 
            2.6390573296152584`}]},
          
          ImageSizeCache->{{180.96047027506694`, 186.55669427191205`}, {
           70.55421339190842, 156.41586880048277`}}],
         StatusArea[#, 
          Log[14]]& ,
         TagBoxNote->"Log[14]"],
        StyleBox[
         RowBox[{"Log", "[", "14", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[14], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{40.70000000000003, 0.}, {41.70000000000003, 
            2.6390573296152584`}]},
          
          ImageSizeCache->{{185.46631667159656`, 191.0625406684417}, {
           70.55421339190842, 156.41586880048277`}}],
         StatusArea[#, 
          Log[14]]& ,
         TagBoxNote->"Log[14]"],
        StyleBox[
         RowBox[{"Log", "[", "14", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[14], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{41.80000000000003, 0.}, {42.80000000000003, 
            2.6390573296152584`}]},
          
          ImageSizeCache->{{189.9721630681262, 195.56838706497132`}, {
           70.55421339190842, 156.41586880048277`}}],
         StatusArea[#, 
          Log[14]]& ,
         TagBoxNote->"Log[14]"],
        StyleBox[
         RowBox[{"Log", "[", "14", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[14], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{42.900000000000034`, 0.}, {43.900000000000034`, 
            2.833213344056216}]},
          
          ImageSizeCache->{{194.47800946465586`, 200.07423346150097`}, {
           64.34770828799763, 156.41586880048277`}}],
         StatusArea[#, 
          Log[17]]& ,
         TagBoxNote->"Log[17]"],
        StyleBox[
         RowBox[{"Log", "[", "17", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[17], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{44.000000000000036`, 0.}, {45.000000000000036`, 
            2.9444389791664403`}]},
          
          ImageSizeCache->{{198.98385586118548`, 204.58007985803062`}, {
           60.792204359958106`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[19]]& ,
         TagBoxNote->"Log[19]"],
        StyleBox[
         RowBox[{"Log", "[", "19", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[19], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{45.10000000000004, 0.}, {46.10000000000004, 
            3.044522437723423}]},
          ImageSizeCache->{{203.48970225771512`, 209.08592625456023`}, {
           57.5928777867406, 156.41586880048277`}}],
         StatusArea[#, 
          Log[21]]& ,
         TagBoxNote->"Log[21]"],
        StyleBox[
         RowBox[{"Log", "[", "21", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[21], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{46.20000000000004, 0.}, {47.20000000000004, 
            3.091042453358316}]},
          
          ImageSizeCache->{{207.99554865424477`, 213.59177265108988`}, {
           56.10579166528659, 156.41586880048277`}}],
         StatusArea[#, 
          Log[22]]& ,
         TagBoxNote->"Log[22]"],
        StyleBox[
         RowBox[{"Log", "[", "22", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[22], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{47.30000000000004, 0.}, {48.30000000000004, 
            3.091042453358316}]},
          
          ImageSizeCache->{{212.5013950507744, 218.09761904761953`}, {
           56.10579166528659, 156.41586880048277`}}],
         StatusArea[#, 
          Log[22]]& ,
         TagBoxNote->"Log[22]"],
        StyleBox[
         RowBox[{"Log", "[", "22", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[22], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{48.40000000000004, 0.}, {49.40000000000004, 
            3.091042453358316}]},
          
          ImageSizeCache->{{217.00724144730404`, 222.60346544414915`}, {
           56.10579166528659, 156.41586880048277`}}],
         StatusArea[#, 
          Log[22]]& ,
         TagBoxNote->"Log[22]"],
        StyleBox[
         RowBox[{"Log", "[", "22", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[22], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{49.50000000000004, 0.}, {50.50000000000004, 
            3.1354942159291497`}]},
          
          ImageSizeCache->{{221.5130878438337, 227.1093118406788}, {
           54.68482053509476, 156.41586880048277`}}],
         StatusArea[#, 
          Log[23]]& ,
         TagBoxNote->"Log[23]"],
        StyleBox[
         RowBox[{"Log", "[", "23", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[23], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{50.600000000000044`, 0.}, {51.600000000000044`, 
            3.1780538303479458`}]},
          
          ImageSizeCache->{{226.0189342403633, 231.61515823720845`}, {
           53.324334923194954`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[24]]& ,
         TagBoxNote->"Log[24]"],
        StyleBox[
         RowBox[{"Log", "[", "24", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[24], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{51.700000000000045`, 0.}, {52.700000000000045`, 
            3.2188758248682006`}]},
          
          ImageSizeCache->{{230.52478063689296`, 236.12100463373807`}, {
           52.01939508874638, 156.41586880048277`}}],
         StatusArea[#, 
          Log[25]]& ,
         TagBoxNote->"Log[25]"],
        StyleBox[
         RowBox[{"Log", "[", "25", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[25], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{52.80000000000005, 0.}, {53.80000000000005, 
            3.295836866004329}]},
          
          ImageSizeCache->{{235.0306270334226, 240.62685103026772`}, {
           49.55921328088935, 156.41586880048277`}}],
         StatusArea[#, 
          Log[27]]& ,
         TagBoxNote->"Log[27]"],
        StyleBox[
         RowBox[{"Log", "[", "27", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[27], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{53.90000000000005, 0.}, {54.90000000000005, 
            3.332204510175204}]},
          
          ImageSizeCache->{{239.53647342995222`, 245.13269742679736`}, {
           48.39666382387841, 156.41586880048277`}}],
         StatusArea[#, 
          Log[28]]& ,
         TagBoxNote->"Log[28]"],
        StyleBox[
         RowBox[{"Log", "[", "28", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[28], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{55.00000000000005, 0.}, {56.00000000000005, 
            3.4339872044851463`}]},
          
          ImageSizeCache->{{244.04231982648187`, 249.63854382332698`}, {
           45.14301848333423, 156.41586880048277`}}],
         StatusArea[#, 
          Log[31]]& ,
         TagBoxNote->"Log[31]"],
        StyleBox[
         RowBox[{"Log", "[", "31", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[31], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{56.10000000000005, 0.}, {57.10000000000005, 
            3.6375861597263857`}]},
          
          ImageSizeCache->{{248.54816622301152`, 254.14439021985663`}, {
           38.6346547919281, 156.41586880048277`}}],
         StatusArea[#, 
          Log[38]]& ,
         TagBoxNote->"Log[38]"],
        StyleBox[
         RowBox[{"Log", "[", "38", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[38], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{57.20000000000005, 0.}, {58.20000000000005, 
            3.6375861597263857`}]},
          
          ImageSizeCache->{{253.05401261954114`, 258.6502366163863}, {
           38.6346547919281, 156.41586880048277`}}],
         StatusArea[#, 
          Log[38]]& ,
         TagBoxNote->"Log[38]"],
        StyleBox[
         RowBox[{"Log", "[", "38", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[38], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{58.300000000000054`, 0.}, {59.300000000000054`, 
            3.713572066704308}]},
          
          ImageSizeCache->{{257.5598590160708, 263.15608301291593`}, {
           36.205644694859075`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[41]]& ,
         TagBoxNote->"Log[41]"],
        StyleBox[
         RowBox[{"Log", "[", "41", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[41], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{59.400000000000055`, 0.}, {60.400000000000055`, 
            3.871201010907891}]},
          
          ImageSizeCache->{{262.06570541260044`, 267.6619294094455}, {
           31.16678535516496, 156.41586880048277`}}],
         StatusArea[#, 
          Log[48]]& ,
         TagBoxNote->"Log[48]"],
        StyleBox[
         RowBox[{"Log", "[", "48", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[48], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{60.50000000000006, 0.}, {61.50000000000006, 
            3.871201010907891}]},
          
          ImageSizeCache->{{266.57155180913, 272.1677758059752}, {
           31.16678535516496, 156.41586880048277`}}],
         StatusArea[#, 
          Log[48]]& ,
         TagBoxNote->"Log[48]"],
        StyleBox[
         RowBox[{"Log", "[", "48", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[48], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{61.60000000000006, 0.}, {62.60000000000006, 
            3.8918202981106265`}]},
          
          ImageSizeCache->{{271.07739820565973`, 276.6736222025048}, {
           30.507657119394054`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[49]]& ,
         TagBoxNote->"Log[49]"],
        StyleBox[
         RowBox[{"Log", "[", "49", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[49], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{62.70000000000006, 0.}, {63.70000000000006, 
            3.9889840465642745`}]},
          
          ImageSizeCache->{{275.5832446021893, 281.17946859903446`}, {
           27.401663712859346`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[54]]& ,
         TagBoxNote->"Log[54]"],
        StyleBox[
         RowBox[{"Log", "[", "54", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[54], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{63.80000000000006, 0.}, {64.80000000000007, 
            4.060443010546419}]},
          
          ImageSizeCache->{{280.089090998719, 285.6853149955641}, {
           25.117364532365883`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[58]]& ,
         TagBoxNote->"Log[58]"],
        StyleBox[
         RowBox[{"Log", "[", "58", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[58], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{64.90000000000006, 0.}, {65.90000000000006, 
            4.07753744390572}]},
          
          ImageSizeCache->{{284.5949373952486, 290.19116139209376`}, {
           24.57091384322061, 156.41586880048277`}}],
         StatusArea[#, 
          Log[59]]& ,
         TagBoxNote->"Log[59]"],
        StyleBox[
         RowBox[{"Log", "[", "59", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[59], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{66.00000000000006, 0.}, {67.00000000000006, 
            4.07753744390572}]},
          
          ImageSizeCache->{{289.1007837917782, 294.69700778862335`}, {
           24.57091384322061, 156.41586880048277`}}],
         StatusArea[#, 
          Log[59]]& ,
         TagBoxNote->"Log[59]"],
        StyleBox[
         RowBox[{"Log", "[", "59", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[59], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{67.10000000000005, 0.}, {68.10000000000005, 
            4.127134385045092}]},
          
          ImageSizeCache->{{293.60663018830786`, 299.20285418515294`}, {
           22.98546891530424, 156.41586880048277`}}],
         StatusArea[#, 
          Log[62]]& ,
         TagBoxNote->"Log[62]"],
        StyleBox[
         RowBox[{"Log", "[", "62", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[62], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{68.20000000000005, 0.}, {69.20000000000005, 
            4.189654742026425}]},
          
          ImageSizeCache->{{298.11247658483745`, 303.7087005816826}, {
           20.986906492088792`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[66]]& ,
         TagBoxNote->"Log[66]"],
        StyleBox[
         RowBox[{"Log", "[", "66", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[66], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{69.30000000000004, 0.}, {70.30000000000004, 
            4.204692619390966}]},
          
          ImageSizeCache->{{302.61832298136704`, 308.2145469782122}, {
           20.506196878823715`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[67]]& ,
         TagBoxNote->"Log[67]"],
        StyleBox[
         RowBox[{"Log", "[", "67", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[67], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{70.40000000000003, 0.}, {71.40000000000003, 
            4.290459441148391}]},
          
          ImageSizeCache->{{307.1241693778967, 312.7203933747418}, {
           17.76452431968937, 156.41586880048277`}}],
         StatusArea[#, 
          Log[73]]& ,
         TagBoxNote->"Log[73]"],
        StyleBox[
         RowBox[{"Log", "[", "73", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[73], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{71.50000000000003, 0.}, {72.50000000000003, 
            4.330733340286331}]},
          
          ImageSizeCache->{{311.6300157744263, 317.2262397712714}, {
           16.477105223898093`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[76]]& ,
         TagBoxNote->"Log[76]"],
        StyleBox[
         RowBox[{"Log", "[", "76", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[76], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{72.60000000000002, 0.}, {73.60000000000002, 
            4.3694478524670215`}]},
          
          ImageSizeCache->{{316.1358621709559, 321.732086167801}, {
           15.239534406755354`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[79]]& ,
         TagBoxNote->"Log[79]"],
        StyleBox[
         RowBox[{"Log", "[", "79", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[79], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{73.70000000000002, 0.}, {74.70000000000002, 
            4.406719247264253}]},
          
          ImageSizeCache->{{320.6417085674855, 326.2379325643306}, {
           14.048095126829082`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[82]]& ,
         TagBoxNote->"Log[82]"],
        StyleBox[
         RowBox[{"Log", "[", "82", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[82], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{74.80000000000001, 0.}, {75.80000000000001, 
            4.477336814478207}]},
          
          ImageSizeCache->{{325.1475549640151, 330.74377896086025`}, {
           11.79069252922659, 156.41586880048277`}}],
         StatusArea[#, 
          Log[88]]& ,
         TagBoxNote->"Log[88]"],
        StyleBox[
         RowBox[{"Log", "[", "88", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[88], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{75.9, 0.}, {76.9, 4.6443908991413725`}]},
          
          ImageSizeCache->{{329.6534013605447, 335.24962535738985`}, {
           6.4505436181745495`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[104]]& ,
         TagBoxNote->"Log[104]"],
        StyleBox[
         RowBox[{"Log", "[", "104", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[104], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{77., 0.}, {78., 4.7535901911063645`}]},
          
          ImageSizeCache->{{334.15924775707435`, 339.75547175391944`}, {
           2.959814964335891, 156.41586880048277`}}],
         StatusArea[#, 
          Log[116]]& ,
         TagBoxNote->"Log[116]"],
        StyleBox[
         RowBox[{"Log", "[", "116", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[116], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{78.1, 0.}, {79.1, 4.882801922586371}]},
          
          ImageSizeCache->{{338.66509415360395`, 
           344.2613181504491}, {-1.1706430759412, 156.41586880048277`}}],
         StatusArea[#, 
          Log[132]]& ,
         TagBoxNote->"Log[132]"],
        StyleBox[
         RowBox[{"Log", "[", "132", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[132], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{79.19999999999999, 0.}, {80.19999999999999, 
            5.049856007249537}]},
          
          ImageSizeCache->{{343.17094055013354`, 
           348.7671645469787}, {-6.51079198699324, 156.41586880048277`}}],
         StatusArea[#, 
          Log[156]]& ,
         TagBoxNote->"Log[156]"],
        StyleBox[
         RowBox[{"Log", "[", "156", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[156], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{80.29999999999998, 0.}, {81.29999999999998, 
            5.087596335232384}]},
          
          ImageSizeCache->{{347.6767869466632, 
           353.27301094350827`}, {-7.717221460338436, 156.41586880048277`}}],
         StatusArea[#, 
          Log[162]]& ,
         TagBoxNote->"Log[162]"],
        StyleBox[
         RowBox[{"Log", "[", "162", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[162], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{81.39999999999998, 0.}, {82.39999999999998, 
            5.176149732573829}]},
          
          ImageSizeCache->{{352.1826333431928, 
           357.7788573400379}, {-10.547971329977173`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[177]]& ,
         TagBoxNote->"Log[177]"],
        StyleBox[
         RowBox[{"Log", "[", "177", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[177], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{82.49999999999997, 0.}, {83.49999999999997, 
            5.204006687076795}]},
          
          ImageSizeCache->{{356.68847973972237`, 
           362.2847037365675}, {-11.43846308630981, 156.41586880048277`}}],
         StatusArea[#, 
          Log[182]]& ,
         TagBoxNote->"Log[182]"],
        StyleBox[
         RowBox[{"Log", "[", "182", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[182], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{83.59999999999997, 0.}, {84.59999999999997, 
            5.225746673713202}]},
          
          ImageSizeCache->{{361.194326136252, 
           366.7905501330971}, {-12.133416257893572`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[186]]& ,
         TagBoxNote->"Log[186]"],
        StyleBox[
         RowBox[{"Log", "[", "186", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[186], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{84.69999999999996, 0.}, {85.69999999999996, 
            5.278114659230517}]},
          
          ImageSizeCache->{{365.7001725327816, 
           371.29639652962675`}, {-13.80744201666593, 156.41586880048277`}}],
         StatusArea[#, 
          Log[196]]& ,
         TagBoxNote->"Log[196]"],
        StyleBox[
         RowBox[{"Log", "[", "196", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[196], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{85.79999999999995, 0.}, {86.79999999999995, 
            5.293304824724492}]},
          
          ImageSizeCache->{{370.2060189293112, 
           375.80224292615634`}, {-14.293019761651408`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[199]]& ,
         TagBoxNote->"Log[199]"],
        StyleBox[
         RowBox[{"Log", "[", "199", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[199], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{86.89999999999995, 0.}, {87.89999999999995, 
            5.356586274672012}]},
          
          ImageSizeCache->{{374.71186532584085`, 
           380.30808932268593`}, {-16.315911729294243`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[212]]& ,
         TagBoxNote->"Log[212]"],
        StyleBox[
         RowBox[{"Log", "[", "212", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[212], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{87.99999999999994, 0.}, {88.99999999999994, 
            5.389071729816501}]},
          
          ImageSizeCache->{{379.21771172237044`, 
           384.8139357192156}, {-17.354360853508467`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[219]]& ,
         TagBoxNote->"Log[219]"],
        StyleBox[
         RowBox[{"Log", "[", "219", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[219], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{89.09999999999994, 0.}, {90.09999999999994, 
            5.44673737166631}]},
          
          ImageSizeCache->{{383.72355811890003`, 
           389.31978211574517`}, {-19.19773460369413, 156.41586880048277`}}],
         StatusArea[#, 
          Log[232]]& ,
         TagBoxNote->"Log[232]"],
        StyleBox[
         RowBox[{"Log", "[", "232", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[232], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{90.19999999999993, 0.}, {91.19999999999993, 
            5.60947179518496}]},
          ImageSizeCache->{{388.2294045154297, 
           393.82562851227476`}, {-24.3997986914776, 156.41586880048277`}}],
         StatusArea[#, 
          Log[273]]& ,
         TagBoxNote->"Log[273]"],
        StyleBox[
         RowBox[{"Log", "[", "273", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[273], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{91.29999999999993, 0.}, {92.29999999999993, 
            5.616771097666572}]},
          
          ImageSizeCache->{{392.73525091195927`, 
           398.3314749088044}, {-24.63313247841981, 156.41586880048277`}}],
         StatusArea[#, 
          Log[275]]& ,
         TagBoxNote->"Log[275]"],
        StyleBox[
         RowBox[{"Log", "[", "275", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[275], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{92.39999999999992, 0.}, {93.39999999999992, 
            5.62040086571715}]},
          
          ImageSizeCache->{{397.24109730848886`, 
           402.837321305334}, {-24.749163774163037`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[276]]& ,
         TagBoxNote->"Log[276]"],
        StyleBox[
         RowBox[{"Log", "[", "276", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[276], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{93.49999999999991, 0.}, {94.49999999999991, 
            5.6240175061873385`}]},
          
          ImageSizeCache->{{401.7469437050185, 
           407.3431677018636}, {-24.864775425967224`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[277]]& ,
         TagBoxNote->"Log[277]"],
        StyleBox[
         RowBox[{"Log", "[", "277", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[277], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{94.59999999999991, 0.}, {95.59999999999991, 
            5.811140992976701}]},
          
          ImageSizeCache->{{406.2527901015481, 
           411.84901409839324`}, {-30.846474623716944`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[334]]& ,
         TagBoxNote->"Log[334]"],
        StyleBox[
         RowBox[{"Log", "[", "334", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[334], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{95.6999999999999, 0.}, {96.6999999999999, 
            5.872117789475416}]},
          
          ImageSizeCache->{{410.7586364980777, 
           416.35486049492283`}, {-32.79569468666014, 156.41586880048277`}}],
         StatusArea[#, 
          Log[355]]& ,
         TagBoxNote->"Log[355]"],
        StyleBox[
         RowBox[{"Log", "[", "355", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[355], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{96.7999999999999, 0.}, {97.7999999999999, 
            5.916202062607435}]},
          
          ImageSizeCache->{{415.26448289460734`, 
           420.8607068914524}, {-34.2049184337786, 156.41586880048277`}}],
         StatusArea[#, 
          Log[371]]& ,
         TagBoxNote->"Log[371]"],
        StyleBox[
         RowBox[{"Log", "[", "371", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[371], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{97.89999999999989, 0.}, {98.89999999999989, 
            5.916202062607435}]},
          
          ImageSizeCache->{{419.77032929113693`, 
           425.3665532879821}, {-34.2049184337786, 156.41586880048277`}}],
         StatusArea[#, 
          Log[371]]& ,
         TagBoxNote->"Log[371]"],
        StyleBox[
         RowBox[{"Log", "[", "371", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[371], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{98.99999999999989, 0.}, {99.99999999999989, 
            5.991464547107982}]},
          
          ImageSizeCache->{{424.2761756876665, 
           429.87239968451166`}, {-36.61080318337363, 156.41586880048277`}}],
         StatusArea[#, 
          Log[400]]& ,
         TagBoxNote->"Log[400]"],
        StyleBox[
         RowBox[{"Log", "[", "400", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[400], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{100.09999999999988`, 0.}, {101.09999999999988`, 
            5.993961427306569}]},
          
          ImageSizeCache->{{428.78202208419617`, 
           434.37824608104125`}, {-36.69061992117085, 156.41586880048277`}}],
         StatusArea[#, 
          Log[401]]& ,
         TagBoxNote->"Log[401]"],
        StyleBox[
         RowBox[{"Log", "[", "401", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[401], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{101.19999999999987`, 0.}, {102.19999999999987`, 
            6.091309882077698}]},
          
          ImageSizeCache->{{433.28786848072576`, 
           438.8840924775709}, {-39.80251775825059, 156.41586880048277`}}],
         StatusArea[#, 
          Log[442]]& ,
         TagBoxNote->"Log[442]"],
        StyleBox[
         RowBox[{"Log", "[", "442", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[442], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{102.29999999999987`, 0.}, {103.29999999999987`, 
            6.159095388491933}]},
          
          ImageSizeCache->{{437.79371487725535`, 
           443.3899388741005}, {-41.96938903824929, 156.41586880048277`}}],
         StatusArea[#, 
          Log[473]]& ,
         TagBoxNote->"Log[473]"],
        StyleBox[
         RowBox[{"Log", "[", "473", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[473], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{103.39999999999986`, 0.}, {104.39999999999986`, 
            6.175867270105761}]},
          
          ImageSizeCache->{{442.299561273785, 
           447.8957852706301}, {-42.5055288489996, 156.41586880048277`}}],
         StatusArea[#, 
          Log[481]]& ,
         TagBoxNote->"Log[481]"],
        StyleBox[
         RowBox[{"Log", "[", "481", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[481], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{104.49999999999986`, 0.}, {105.49999999999986`, 
            6.186208623900494}]},
          
          ImageSizeCache->{{446.8054076703146, 
           452.40163166715973`}, {-42.83610663353625, 156.41586880048277`}}],
         StatusArea[#, 
          Log[486]]& ,
         TagBoxNote->"Log[486]"],
        StyleBox[
         RowBox[{"Log", "[", "486", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[486], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{105.59999999999985`, 0.}, {106.59999999999985`, 
            6.4692503167957724`}]},
          
          ImageSizeCache->{{451.3112540668442, 
           456.9074780636893}, {-51.88398350014913, 156.41586880048277`}}],
         StatusArea[#, 
          Log[645]]& ,
         TagBoxNote->"Log[645]"],
        StyleBox[
         RowBox[{"Log", "[", "645", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[645], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{106.69999999999985`, 0.}, {107.69999999999985`, 
            7.050122520269059}]},
          
          ImageSizeCache->{{455.81710046337383`, 
           461.4133244602189}, {-70.45248525868303, 156.41586880048277`}}],
         StatusArea[#, 
          Log[1153]]& ,
         TagBoxNote->"Log[1153]"],
        StyleBox[
         RowBox[{"Log", "[", "1153", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[1153], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{107.79999999999984`, 0.}, {108.79999999999984`, 
            7.2196420401307355`}]},
          
          ImageSizeCache->{{460.3229468599034, 
           465.91917085674856`}, {-75.87144571820536, 156.41586880048277`}}],
         StatusArea[#, 
          Log[1366]]& ,
         TagBoxNote->"Log[1366]"],
        StyleBox[
         RowBox[{"Log", "[", "1366", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[1366], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{108.89999999999984`, 0.}, {109.89999999999984`, 
            7.277938572945661}]},
          
          ImageSizeCache->{{464.828793256433, 
           470.42501725327816`}, {-77.73498689923929, 156.41586880048277`}}],
         StatusArea[#, 
          Log[1448]]& ,
         TagBoxNote->"Log[1448]"],
        StyleBox[
         RowBox[{"Log", "[", "1448", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[1448], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{109.99999999999983`, 0.}, {110.99999999999983`, 
            7.543802867501509}]},
          
          ImageSizeCache->{{469.33463965296266`, 
           474.93086364980775`}, {-86.23376096946154, 156.41586880048277`}}],
         StatusArea[#, 
          Log[1889]]& ,
         TagBoxNote->"Log[1889]"],
        StyleBox[
         RowBox[{"Log", "[", "1889", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[1889], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{111.09999999999982`, 0.}, {112.09999999999982`, 
            7.847762537473608}]},
          
          ImageSizeCache->{{473.84048604949226`, 
           479.4367100463374}, {-95.95031416765545, 156.41586880048277`}}],
         StatusArea[#, 
          Log[2560]]& ,
         TagBoxNote->"Log[2560]"],
        StyleBox[
         RowBox[{"Log", "[", "2560", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[2560], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{112.19999999999982`, 0.}, {113.19999999999982`, 
            7.911690520708339}]},
          
          ImageSizeCache->{{478.34633244602185`, 
           483.942556442867}, {-97.99387359779473, 156.41586880048277`}}],
         StatusArea[#, 
          Log[2729]]& ,
         TagBoxNote->"Log[2729]"],
        StyleBox[
         RowBox[{"Log", "[", "2729", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[2729], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{113.29999999999981`, 0.}, {114.29999999999981`, 
            8.33758794211651}]},
          
          ImageSizeCache->{{482.8521788425515, 
           488.4484028393966}, {-111.60836052122755`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[4178]]& ,
         TagBoxNote->"Log[4178]"],
        StyleBox[
         RowBox[{"Log", "[", "4178", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[4178], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{114.3999999999998, 0.}, {115.3999999999998, 
            8.377241230988792}]},
          
          ImageSizeCache->{{487.3580252390811, 
           492.9542492359262}, {-112.87594082504302`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[4347]]& ,
         TagBoxNote->"Log[4347]"],
        StyleBox[
         RowBox[{"Log", "[", "4347", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[4347], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{115.4999999999998, 0.}, {116.4999999999998, 
            8.38776764397578}]},
          
          ImageSizeCache->{{491.8638716356107, 
           497.4600956324558}, {-113.21243432032679`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[4393]]& ,
         TagBoxNote->"Log[4393]"],
        StyleBox[
         RowBox[{"Log", "[", "4393", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[4393], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{116.5999999999998, 0.}, {117.5999999999998, 
            8.627660644442209}]},
          
          ImageSizeCache->{{496.3697180321403, 
           501.9659420289854}, {-120.8809947616524, 156.41586880048277`}}],
         StatusArea[#, 
          Log[5584]]& ,
         TagBoxNote->"Log[5584]"],
        StyleBox[
         RowBox[{"Log", "[", "5584", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[5584], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{117.69999999999979`, 0.}, {118.69999999999979`, 
            9.069122370060645}]},
          
          ImageSizeCache->{{500.8755644286699, 
           506.47178842551506`}, {-134.9930193678502, 156.41586880048277`}}],
         StatusArea[#, 
          Log[8683]]& ,
         TagBoxNote->"Log[8683]"],
        StyleBox[
         RowBox[{"Log", "[", "8683", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[8683], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{118.79999999999978`, 0.}, {119.79999999999978`, 
            9.128045129249353}]},
          
          ImageSizeCache->{{505.3814108251995, 
           510.97763482204465`}, {-136.87657886866816`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[9210]]& ,
         TagBoxNote->"Log[9210]"],
        StyleBox[
         RowBox[{"Log", "[", "9210", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[9210], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{119.89999999999978`, 0.}, {120.89999999999978`, 
            9.268703615273097}]},
          
          ImageSizeCache->{{509.88725722172916`, 
           515.4834812185743}, {-141.37295058256223`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[10601]]& ,
         TagBoxNote->"Log[10601]"],
        StyleBox[
         RowBox[{"Log", "[", "10601", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[10601], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{120.99999999999977`, 0.}, {121.99999999999977`, 
            9.277344600756656}]},
          
          ImageSizeCache->{{514.3931036182587, 
           519.9893276151039}, {-141.6491733957517, 156.41586880048277`}}],
         StatusArea[#, 
          Log[10693]]& ,
         TagBoxNote->"Log[10693]"],
        StyleBox[
         RowBox[{"Log", "[", "10693", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[10693], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{122.09999999999977`, 0.}, {123.09999999999977`, 
            9.562685957753686}]},
          
          ImageSizeCache->{{518.8989500147884, 
           524.4951740116335}, {-150.7705626746681, 156.41586880048277`}}],
         StatusArea[#, 
          Log[14224]]& ,
         TagBoxNote->"Log[14224]"],
        StyleBox[
         RowBox[{"Log", "[", "14224", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[14224], {
          GrayLevel[0]}], "Tooltip"]& ]}, 
     {RGBColor[0.798413061722744, 0.824719615472648, 0.968322270542458], 
      EdgeForm[Opacity[0.7]], {}, 
      TagBox[
       TooltipBox[
        TagBox[
         DynamicBox[{
           FrontEnd`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           
           RectangleBox[{123.19999999999976`, 0.}, {124.19999999999976`, 
            9.836064876218694}]},
          
          ImageSizeCache->{{523.404796411318, 
           529.0010204081631}, {-159.50955362295343`, 156.41586880048277`}}],
         StatusArea[#, 
          Log[18696]]& ,
         TagBoxNote->"Log[18696]"],
        StyleBox[
         RowBox[{"Log", "[", "18696", "]"}], {
          GrayLevel[0]}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Log[18696], {
          GrayLevel[0]}], "Tooltip"]& ]}}, {}, {}}, {}, GraphicsGroupBox[
    StyleBox[
     LineBox[{{{0., 0}, Offset[{0, -4}, {0., 0}]}, {{124.19999999999976`, 0}, 
        Offset[{0, -4}, {124.19999999999976`, 0}]}}],
     Antialiasing->False]]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  PlotRangePadding->Scaled[0.02],
  Ticks->{None, Automatic}]], "Output",
 CellChangeTimes->{3.4939146276686907`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exercise 7: Regular expressions matchings", "Subsection",
 CellChangeTimes->{{3.494733565136025*^9, 3.494733590758951*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DigitFirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{"RegularExpression", "[", "\"\<^\\\\d.*\>\"", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.494319660109632*^9, 3.494319743930101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CapitalLetterFirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{"RegularExpression", "[", "\"\<^[A-Z].*\>\"", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.494319660109632*^9, 3.494319743930101*^9}, {
  3.4943197828889513`*^9, 3.4943197964819393`*^9}, {3.4943198938275337`*^9, 
  3.494319909834494*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LeftParethesisFirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{"RegularExpression", "[", "\"\<^\\\\(.*\>\"", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.494319660109632*^9, 3.494319743930101*^9}, {
  3.4943197828889513`*^9, 3.4943197964819393`*^9}, {3.4943198938275337`*^9, 
  3.494319909834494*^9}, {3.494319971574535*^9, 3.494320017785997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RightParethesisFirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{"RegularExpression", "[", "\"\<^\\\\).*\>\"", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.494319660109632*^9, 3.494319743930101*^9}, {
  3.4943197828889513`*^9, 3.4943197964819393`*^9}, {3.4943198938275337`*^9, 
  3.494319909834494*^9}, {3.494319971574535*^9, 3.494320038106146*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UnderscoreFirstQ", "[", "s_String", "]"}], ":=", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"s", ",", 
     RowBox[{"RegularExpression", "[", "\"\<^\\\\_.*\>\"", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.494319660109632*^9, 3.494319743930101*^9}, {
  3.4943197828889513`*^9, 3.4943197964819393`*^9}, {3.4943198938275337`*^9, 
  3.494319909834494*^9}, {3.494319971574535*^9, 3.494320038106146*^9}, {
  3.494320069005789*^9, 3.494320082028425*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["References", "Section",
 CellChangeTimes->{{3.488071372106266*^9, 3.488071377522324*^9}}],

Cell[TextData[{
 "[Kle01] Klein, U. (2001). ",
 StyleBox["Tools and modes of representation in the laboratory sciences",
  FontSlant->"Italic"],
 ". pp. 47- \"",
 StyleBox["Conventionalities in formula writing",
  FontSlant->"Italic"],
 "\". Kluwer, \
http://www.pierrelaszlo.com/articles/history-of-chemistry/54-\
conventionalities-in-formula-writing"
}], "Text",
 CellChangeTimes->{{3.490115434061903*^9, 3.490115439022626*^9}, {
   3.4901157089111567`*^9, 3.490115786217057*^9}, {3.490115842908931*^9, 
   3.490115857385316*^9}, {3.490115891266857*^9, 3.490115989537909*^9}, {
   3.490116280531023*^9, 3.49011628129136*^9}, {3.490121094520048*^9, 
   3.490121167522231*^9}, {3.490121211087976*^9, 3.4901212208165293`*^9}, {
   3.490121548956078*^9, 3.490121612429174*^9}, {3.490121674122239*^9, 
   3.490121712222376*^9}, 3.490312665762926*^9}],

Cell[TextData[{
 "[Gam94] Gamma, E., Helm, R., Johnson, R., and Vlissides, J (1994). ",
 StyleBox["Design Patterns: Elements of Reusable Object-Oriented Software",
  FontSlant->"Italic"],
 ". Addison-Wesley."
}], "Text",
 CellChangeTimes->{{3.490116016257251*^9, 3.490116041601089*^9}, {
  3.4901161255918093`*^9, 3.490116131324655*^9}, {3.4901162664785643`*^9, 
  3.490116268066195*^9}, {3.490121213017172*^9, 3.490121249156479*^9}, {
  3.4901218140022182`*^9, 3.490121907349287*^9}}],

Cell[TextData[{
 "[Wat89] Watson, D. (1989). ",
 StyleBox["High Level Languages and Their Compilers",
  FontSlant->"Italic"],
 ". Addison-Wesley."
}], "Text",
 CellChangeTimes->{{3.4903123453935957`*^9, 3.490312458136818*^9}, 
   3.4903126675616817`*^9, {3.493288077524624*^9, 3.493288077895364*^9}}],

Cell[TextData[{
 "[Pau80] Paulos, J. A. (1980). ",
 StyleBox["Mathematics and Humor",
  FontSlant->"Italic"],
 ", ",
 StyleBox["The University of Chicago Press",
  FontSize->18],
 "."
}], "Text",
 CellChangeTimes->{{3.493298275192614*^9, 3.493298308618437*^9}, {
  3.4932986234593163`*^9, 3.493298626289707*^9}, {3.493298657699668*^9, 
  3.4932986819785557`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Section hyperlinks", "Section",
 CellChangeTimes->{{3.485353070347357*^9, 3.485353083727057*^9}, {
   3.485355500308876*^9, 3.485355503983049*^9}, 3.492904600191969*^9},
 FontSlant->"Italic"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hyperlink", "[", 
  RowBox[{
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Everything is an expression\>\"", ",", "\"\<Text\>\"", ",", 
     RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
   "\"\<paclet:tutorial/EverythingIsAnExpression\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.485352095929475*^9, 3.4853521259369373`*^9}, {
   3.485352163650888*^9, 3.485352210541203*^9}, {3.485352948054144*^9, 
   3.48535299108145*^9}, 3.492904600192778*^9}],

Cell[BoxData[
 TagBox[
  ButtonBox[
   PaneSelectorBox[{False->
    StyleBox["\<\"Everything is an expression\"\>", "Text",
     StripOnInput->False,
     FontSize->12], True->
    StyleBox[
     StyleBox["\<\"Everything is an expression\"\>", "Text",
      StripOnInput->False,
      FontSize->12], "HyperlinkActive"]}, Dynamic[
     CurrentValue["MouseOver"]],
    BaseStyle->{"Hyperlink"},
    BaselinePosition->Baseline,
    FrameMargins->0,
    ImageSize->Automatic],
   BaseStyle->"Link",
   ButtonData->"paclet:tutorial/EverythingIsAnExpression",
   ButtonNote->"paclet:tutorial/EverythingIsAnExpression"],
  Annotation[#, "paclet:tutorial/EverythingIsAnExpression", 
   "Hyperlink"]& ]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.485352090131234*^9, 3.485352126492825*^9}, {
   3.485352165196126*^9, 3.485352210944434*^9}, {3.4853529597516937`*^9, 
   3.485352991262547*^9}, 3.492904600195362*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hyperlink", "[", 
  RowBox[{
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Expressions\>\"", ",", "\"\<Text\>\"", ",", 
     RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
   "\"\<paclet:guide/Expressions\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.485352095929475*^9, 3.4853521259369373`*^9}, {
   3.485352163650888*^9, 3.485352210541203*^9}, {3.485352494551867*^9, 
   3.4853525141209784`*^9}, {3.48535302612949*^9, 3.4853530418168993`*^9}, 
   3.492904600196742*^9}],

Cell[BoxData[
 TagBox[
  ButtonBox[
   PaneSelectorBox[{False->
    StyleBox["\<\"Expressions\"\>", "Text",
     StripOnInput->False,
     FontSize->12], True->
    StyleBox[
     StyleBox["\<\"Expressions\"\>", "Text",
      StripOnInput->False,
      FontSize->12], "HyperlinkActive"]}, Dynamic[
     CurrentValue["MouseOver"]],
    BaseStyle->{"Hyperlink"},
    BaselinePosition->Baseline,
    FrameMargins->0,
    ImageSize->Automatic],
   BaseStyle->"Link",
   ButtonData->"paclet:guide/Expressions",
   ButtonNote->"paclet:guide/Expressions"],
  Annotation[#, "paclet:guide/Expressions", "Hyperlink"]& ]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.485352509925057*^9, 3.485352514443326*^9}, 
   3.485353042296403*^9, 3.492904600197295*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hyperlink", "[", 
  RowBox[{
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Tally\>\"", ",", "\"\<Program\>\""}], "]"}], ",", 
   "\"\<paclet:ref/Tally\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.485352095929475*^9, 3.4853521259369373`*^9}, {
   3.485352163650888*^9, 3.485352210541203*^9}, {3.485352494551867*^9, 
   3.4853525141209784`*^9}, {3.48535302612949*^9, 3.4853530418168993`*^9}, {
   3.485353640381893*^9, 3.485353661874166*^9}, {3.485354034705617*^9, 
   3.4853540593255653`*^9}, {3.48535409811581*^9, 3.485354116666267*^9}, {
   3.492904336418384*^9, 3.492904377272974*^9}, {3.492904448105538*^9, 
   3.492904484588662*^9}, 3.4929046002022457`*^9}],

Cell[BoxData[
 TagBox[
  ButtonBox[
   PaneSelectorBox[{False->
    StyleBox["\<\"Tally\"\>", "Program",
     StripOnInput->False], True->
    StyleBox[
     StyleBox["\<\"Tally\"\>", "Program",
      StripOnInput->False], "HyperlinkActive"]}, Dynamic[
     CurrentValue["MouseOver"]],
    BaseStyle->{"Hyperlink"},
    BaselinePosition->Baseline,
    FrameMargins->0,
    ImageSize->Automatic],
   BaseStyle->"Link",
   ButtonData->"paclet:ref/Tally",
   ButtonNote->"paclet:ref/Tally"],
  Annotation[#, "paclet:ref/Tally", "Hyperlink"]& ]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.48535411704497*^9, {3.4929043452899227`*^9, 3.492904377775836*^9}, {
   3.4929044496532516`*^9, 3.49290448502775*^9}, 3.4929046002058477`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Misc code",
 FontSlant->"Italic"]], "Section",
 CellChangeTimes->{{3.49477076150633*^9, 3.494770767384821*^9}}],

Cell[CellGroupData[{

Cell["The basic idea", "Subsection",
 CellChangeTimes->{{3.4947707886261263`*^9, 3.494770808240505*^9}}],

Cell["\<\
<molecule>
<connected>  /  by the rule <molecule>
<molecule><molecule>  /  by the rule <connected>
<connected><connected> / by the rule <molecule>
<molecule><molecule><molecule><molecule>  / by the rule <connected>
<element><element><element><replicated>   / by the rule <molecule>
<element><element><element><element><number> / by the rule <replicated>\
\>", "Program",
 CellChangeTimes->{{3.493919101807075*^9, 3.4939192663303633`*^9}, {
  3.493919311937258*^9, 3.493919380763006*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1447, 1193},
WindowMargins->{{74, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.5, 1.5 Inherited],
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"Article"}, "Preprint.nb", CharacterEncoding -> 
       "UTF-8"]]], 
   Cell[
    StyleData["Text"], MenuSortingValue -> 10000, FontSize -> 16], 
   Cell[
    StyleData["Item"], MenuSortingValue -> 10000, FontSize -> 16], 
   Cell[
    StyleData["Item1Numbered"], MenuSortingValue -> 10000, FontSize -> 16], 
   Cell[
    StyleData["Item1"], FontSize -> 16]}, Visible -> False, FrontEndVersion -> 
  "11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 10, 2017)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 478, 7, 115, "Title",ExpressionUUID->"fe29a8b4-bfba-4785-9e17-594ac790e331"],
Cell[CellGroupData[{
Cell[1070, 33, 210, 4, 55, "Author",ExpressionUUID->"54be9971-6d7f-4c93-ac9d-bb35f72ef6c7"],
Cell[1283, 39, 162, 3, 19, "Institution",ExpressionUUID->"999786cd-ce9b-469e-92d3-30df2ce67127"],
Cell[1448, 44, 221, 4, 19, "Institution",ExpressionUUID->"837312c6-3ed2-4486-b4ce-60802b7cdeae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1706, 53, 159, 3, 101, "Section",ExpressionUUID->"17dd523d-f607-4051-8552-0fe8b8cda95b"],
Cell[1868, 58, 1090, 17, 46, "Text",ExpressionUUID->"a1fb6244-16fa-46bf-b45a-58650b0fb238"],
Cell[2961, 77, 560, 18, 30, "Equation",ExpressionUUID->"200b325c-51d3-448d-87c3-d6b64a7333fc"],
Cell[3524, 97, 167, 3, 46, "Text",ExpressionUUID->"ff10da11-2711-44e5-b601-da21894a03c1"],
Cell[3694, 102, 622, 19, 31, "EquationNumbered",ExpressionUUID->"572e066b-b6bc-447a-afe1-0a2745a3633e"],
Cell[4319, 123, 703, 17, 46, "Text",ExpressionUUID->"64292ef0-f966-4553-b611-c2b79d5add37"],
Cell[5025, 142, 2076, 30, 217, "Text",ExpressionUUID->"4b700c57-e084-4936-8727-f6a77cfc49fa"],
Cell[7104, 174, 253, 6, 46, "Text",ExpressionUUID->"f79994f7-c602-42bc-9468-dbed79ba7a3e"],
Cell[CellGroupData[{
Cell[7382, 184, 169, 3, 52, "Subsection",ExpressionUUID->"562e33d1-5304-41bc-9db6-43deb22842b2"],
Cell[7554, 189, 2006, 34, 103, "Text",ExpressionUUID->"d8f3495f-fdbf-4208-ae1c-0dc910992a57"],
Cell[CellGroupData[{
Cell[9585, 227, 2901, 67, 993690, "Input",ExpressionUUID->"d70d9b82-9d5f-4cc5-921a-97cbaffe437d"],
Cell[12489, 296, 3003, 72, 231, "Output",ExpressionUUID->"fb7de257-daf7-4b0c-bbee-6091182b0961"]
}, {2}]],
Cell[15504, 371, 511, 9, 75, "Text",ExpressionUUID->"bc5f7097-3c50-4264-b2c6-93ae355ffe3b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16052, 385, 160, 3, 52, "Subsection",ExpressionUUID->"b1ac6e64-becf-41d8-ac17-01b7678a83bf"],
Cell[16215, 390, 1408, 21, 160, "Text",ExpressionUUID->"b23b69a3-4a2e-4aca-a09a-5d1f8a03c1d7"],
Cell[17626, 413, 1192, 19, 132, "Text",ExpressionUUID->"6a384a8a-89df-4593-ba10-8ba4462d5e50"],
Cell[18821, 434, 781, 13, 75, "Text",ExpressionUUID->"17cd53ee-fe41-4ec9-9dae-00a407739f15"],
Cell[CellGroupData[{
Cell[19627, 451, 629, 11, 36, "Item1",ExpressionUUID->"39eeff8c-0053-4c5e-a058-55456c042dba"],
Cell[20259, 464, 698, 12, 36, "Item1",ExpressionUUID->"14f775e1-c20a-4846-a162-c17559fb2079"],
Cell[20960, 478, 828, 13, 62, "Item1",ExpressionUUID->"ae04c2f7-c00b-4a4a-88a4-7005629b97b8"],
Cell[21791, 493, 448, 9, 36, "Item1",ExpressionUUID->"6aac949b-e57c-4582-802f-05691ce786b3"]
}, Open  ]],
Cell[22254, 505, 349, 7, 75, "Text",ExpressionUUID->"6a536fcf-4689-42b3-877a-ccb8cd763aea"]
}, Open  ]],
Cell[22618, 515, 175, 3, 52, "Subsection",ExpressionUUID->"85d86543-7bd2-4143-a6a0-ba2b218e5df8"],
Cell[CellGroupData[{
Cell[22818, 522, 213, 4, 38, "Subsection",ExpressionUUID->"f43e66fb-79a1-478f-960b-91ea40e9dc0d"],
Cell[CellGroupData[{
Cell[23056, 530, 102, 1, 681, "Subsubsection",ExpressionUUID->"4c618334-7337-4e92-bf61-7b12e9ab915e"],
Cell[23161, 533, 98, 1, 505, "Text",ExpressionUUID->"fab3954a-add5-4822-aba9-2cbaf8dcaee3"],
Cell[23262, 536, 174, 2, 505, "Text",ExpressionUUID->"56bd557f-9a69-4315-9d3c-ed14c73221d0"],
Cell[23439, 540, 202, 2, 505, "Text",ExpressionUUID->"e939d0e5-ffec-437f-85d7-c5d5306a2953"],
Cell[23644, 544, 103, 1, 505, "Text",ExpressionUUID->"7fb8e4cf-097e-4252-b831-f77e14292df4"],
Cell[23750, 547, 119, 1, 505, "Text",ExpressionUUID->"dad73d83-84da-4221-93ab-273cabf99d7b"],
Cell[23872, 550, 164, 2, 505, "Text",ExpressionUUID->"3e2060a1-50e6-4808-83eb-d068b6b6e36e"],
Cell[24039, 554, 166, 3, 505, "Text",ExpressionUUID->"d603fe31-0040-4067-9cbc-4faa50d5e457"],
Cell[24208, 559, 772, 17, 1156, "Text",ExpressionUUID->"95d52d7c-10d8-4103-a887-5268f7c82f99"],
Cell[24983, 578, 258, 7, 505, "Text",ExpressionUUID->"20199e1d-02cc-4c98-8e66-19bbb9ad5863"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25278, 590, 108, 1, 681, "Subsubsection",ExpressionUUID->"1b7392ce-94ac-45a2-a2bd-84127825ce9a"],
Cell[25389, 593, 100, 1, 505, "Text",ExpressionUUID->"032f6bca-1c0b-4110-aea0-06d382c54add"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25526, 599, 279, 3, 681, "Subsubsection",ExpressionUUID->"c94bbfc4-bc07-44fc-8425-3f4439797f8f"],
Cell[25808, 604, 550, 9, 838, "Text",ExpressionUUID->"f168b81c-6eeb-4f1e-9948-32e9a1cb3523"],
Cell[26361, 615, 292, 6, 505, "Text",ExpressionUUID->"e27e1543-ac6e-43f0-93a2-a98e575b80e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26690, 626, 116, 1, 681, "Subsubsection",ExpressionUUID->"3b63c47d-ce54-4bd1-b40e-b17ffaef1cd5"],
Cell[26809, 629, 1369, 20, 2187, "Program",ExpressionUUID->"443df606-65c0-4cea-8ea8-5fba6a0edca5"],
Cell[28181, 651, 262, 4, 621, "Program",ExpressionUUID->"c9ba05a9-0c65-4e2c-bf81-82d765a6275e"],
Cell[28446, 657, 174, 2, 621, "Program",ExpressionUUID->"82dcef9a-8f0f-4f61-8d48-a5a328ff3350"],
Cell[28623, 661, 656, 10, 621, "Program",ExpressionUUID->"3ec14f8b-f176-486d-aa04-d163184a84d1"],
Cell[29282, 673, 537, 9, 621, "Program",ExpressionUUID->"190e5891-b7ea-4509-90f9-29876d089527"],
Cell[29822, 684, 353, 5, 621, "Program",ExpressionUUID->"182455b5-cc0f-4d2c-ac99-258cf21c35ae"],
Cell[30178, 691, 639, 10, 636, "Program",ExpressionUUID->"bdc6168a-9bd3-47aa-a63a-7816a7bc27c2"],
Cell[30820, 703, 664, 11, 636, "Program",ExpressionUUID->"f2e511cb-7e14-45ab-b514-e80ed354cbc3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31521, 719, 123, 1, 681, "Subsubsection",ExpressionUUID->"a6fca66b-d11f-44ab-9cc4-cad9d813ce1a"],
Cell[31647, 722, 335, 10, 1734, "Program",ExpressionUUID->"94b35c9d-8843-45aa-af31-25c144d108a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32019, 737, 174, 2, 681, "Subsubsection",ExpressionUUID->"a6f6d826-8ace-4fc3-9973-cadb58a8c698"],
Cell[32196, 741, 607, 13, 1734, "Program",ExpressionUUID->"148bb2d4-5e93-4e34-9acd-98871bd5c850"]
}, Open  ]],
Cell[32818, 757, 179, 2, 681, "Subsubsection",ExpressionUUID->"a65d4c2d-30e6-43dd-b4c7-85eb1fdcc14f"],
Cell[CellGroupData[{
Cell[33022, 763, 116, 1, 549, "Subsubsection",ExpressionUUID->"1700cbf7-cdc8-47be-bb29-728cae8a741a"],
Cell[33141, 766, 213, 4, 106575, "Input",ExpressionUUID->"ae9695f6-7879-409f-909f-f43495d8e493"],
Cell[CellGroupData[{
Cell[33379, 774, 1080, 30, 236512, "Input",ExpressionUUID->"89025f9f-0fd5-4c93-9930-2b86c982677b"],
Cell[34462, 806, 436, 11, 106575, "Output",ExpressionUUID->"c207a5c1-d760-4f00-968d-b7b2929a2ebc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34935, 822, 1184, 31, 236512, "Input",ExpressionUUID->"28b61b3e-16ca-4c7a-87c9-35a078af367c"],
Cell[36122, 855, 525, 13, 106575, "Output",ExpressionUUID->"41738bec-d469-4ab7-9cdd-b48f08b390d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36684, 873, 1236, 32, 236512, "Input",ExpressionUUID->"89f4016c-242c-4ed5-af12-cd26d8b308e2"],
Cell[37923, 907, 521, 13, 106575, "Output",ExpressionUUID->"844488f7-48c8-4c6c-9205-b90343afe345"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38481, 925, 355, 10, 170788, "Input",ExpressionUUID->"a11b3ff5-c38d-4eed-becb-fbc313d63f1a"],
Cell[38839, 937, 575, 9, 106575, "Output",ExpressionUUID->"7d762a82-1606-4e4f-a131-d57d0e15c882"],
Cell[39417, 948, 94, 1, 106575, "Output",ExpressionUUID->"3b483f98-fc17-4ab9-a57e-d83bc5deb678"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[39560, 955, 151, 2, 549, "Subsubsection",ExpressionUUID->"fe539f56-0bfd-4757-95a4-6e6a43f3d8b5"],
Cell[39714, 959, 170, 3, 838, "Text",ExpressionUUID->"f170c3a7-eff8-41cd-8cd3-bcb98b89bf60"],
Cell[39887, 964, 270, 5, 838, "Text",ExpressionUUID->"c9b4b441-07f7-4f28-ae11-7fb7b4538930"],
Cell[40160, 971, 514, 9, 838, "Text",ExpressionUUID->"0ae29cec-7c65-4e71-96ad-c5d685e0fb6d"],
Cell[40677, 982, 1053, 16, 838, "Text",ExpressionUUID->"fa29469f-d9eb-427d-9a15-ce2a134e2921"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[41779, 1004, 194, 4, 38, "Subsection",ExpressionUUID->"6c44ce4b-bf3e-49a6-b422-cfc46bd31bea"],
Cell[CellGroupData[{
Cell[41998, 1012, 434, 11, 34282, "Input",ExpressionUUID->"0754f0d4-be10-4fc8-b198-5e3bbb391aeb"],
Cell[42435, 1025, 215, 4, 34282, "Output",ExpressionUUID->"d3fe1874-9ffd-4aca-b81d-1c3ce7b360ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42687, 1034, 458, 12, 34282, "Input",ExpressionUUID->"a3af7829-6826-487d-89e6-8eb8f56328f2"],
Cell[43148, 1048, 131, 2, 34282, "Output",ExpressionUUID->"1e5fb845-940a-4695-a162-0fe32ced8db2"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43340, 1057, 321, 5, 101, "Section",ExpressionUUID->"b9378c19-8aa7-4aa1-aab5-c494ef22a05d"],
Cell[43664, 1064, 2095, 54, 189, "Text",ExpressionUUID->"09c8ca70-fb98-4ca2-beb7-433f0fab9194"],
Cell[45762, 1120, 466, 9, 75, "Text",ExpressionUUID->"c4322ba0-b3c4-48fa-a2e7-3a96fc58c7f8"],
Cell[46231, 1131, 377, 6, 46, "Text",ExpressionUUID->"25c59ac5-1de5-4d37-b90e-2447006b9160"],
Cell[CellGroupData[{
Cell[46633, 1141, 6809, 168, 24814, "Input",ExpressionUUID->"fb0aecd0-b8fd-419c-a6ae-481e17db4846"],
Cell[53445, 1311, 4227, 101, 471, "Output",ExpressionUUID->"dd30f17a-beed-4fbe-805a-8f9394af56b2"]
}, {2}]],
Cell[57684, 1415, 632, 11, 75, "Text",ExpressionUUID->"465d880e-e94f-40c2-9ca6-369de01775a2"],
Cell[CellGroupData[{
Cell[58341, 1430, 6653, 162, 23923, "Input",ExpressionUUID->"50fd5d47-c8da-4ec7-8b7f-4ec6669a8f81"],
Cell[64997, 1594, 3588, 87, 281, "Output",ExpressionUUID->"683dd1b6-c1e9-4f6f-a7a0-da4e23163c10"]
}, {2}]],
Cell[68597, 1684, 917, 15, 132, "Text",ExpressionUUID->"e94ac8d5-436b-4002-a32e-dba95c9eefc8"],
Cell[69517, 1701, 765, 17, 75, "Text",ExpressionUUID->"c3e81473-7749-43ac-8296-03cdd7a8d075"],
Cell[CellGroupData[{
Cell[70307, 1722, 463, 13, 34282, "Input",ExpressionUUID->"cb380eb0-dcd4-4a47-b133-89c1d9282684"],
Cell[70773, 1737, 5804, 161, 390, "Output",ExpressionUUID->"0869d1c1-a926-498e-a4f8-91ce7e4d080a"]
}, {2}]],
Cell[76589, 1901, 1057, 21, 103, "Text",ExpressionUUID->"1e5b1330-a7be-402d-9d33-9f12c342362e"],
Cell[CellGroupData[{
Cell[77671, 1926, 1547, 38, 97897, "Input",ExpressionUUID->"9672eaca-9fce-4609-90ac-a73a59ed4871"],
Cell[79221, 1966, 6010, 162, 373, "Output",ExpressionUUID->"639b5ba3-ec97-4d91-a07b-9cfc60139f31"]
}, {2}]],
Cell[85243, 2131, 508, 11, 46, "Text",ExpressionUUID->"9e3231e5-4700-414f-8b4e-379f4454f978"],
Cell[85754, 2144, 398, 8, 75, "Text",ExpressionUUID->"d8d8bfe2-b661-4784-853b-754437175c97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86189, 2157, 285, 5, 101, "Section",ExpressionUUID->"0116b08c-c62f-4f33-be5e-0b32378da58f"],
Cell[86477, 2164, 1550, 23, 160, "Text",ExpressionUUID->"499815d3-a3a6-45f7-a388-e6fb2c10fa94"],
Cell[88030, 2189, 235, 4, 61, "Program",ExpressionUUID->"79d06807-25e7-4de2-9204-ed785a46c6dd"],
Cell[88268, 2195, 1037, 22, 132, "Text",ExpressionUUID->"5bc2a3a2-3b61-4fe1-b46a-06a0013c7217"],
Cell[89308, 2219, 1651, 26, 110, "Text",ExpressionUUID->"590fbbbb-5006-4c5a-bbb3-ca4ea53a5e65"],
Cell[90962, 2247, 1559, 24, 233, "Program",ExpressionUUID->"a6d7037e-69f5-4c29-b334-b9d47b86993b",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[92524, 2273, 889, 15, 82, "Text",ExpressionUUID->"15fe43f3-0552-4441-bb20-9528e4120cfe"],
Cell[93416, 2290, 367, 6, 61, "Program",ExpressionUUID->"7b21e883-188c-4841-bb4a-bbc7be0fe920"],
Cell[93786, 2298, 618, 11, 53, "Text",ExpressionUUID->"e5795d14-c040-4387-84cc-9c79e9e05fbd"],
Cell[94407, 2311, 280, 4, 61, "Program",ExpressionUUID->"88321047-233e-4404-aba9-cdf5f743a59b"],
Cell[94690, 2317, 834, 13, 103, "Text",ExpressionUUID->"c8b62cf3-7546-42a4-9de5-614053c479a7"],
Cell[95527, 2332, 854, 14, 61, "Program",ExpressionUUID->"1bb02d7f-fead-461c-abf0-b003926175ce"],
Cell[96384, 2348, 1117, 30, 82, "Text",ExpressionUUID->"21f8aeaa-0b20-47cc-b1f4-de3e9a42bcf4"],
Cell[97504, 2380, 290, 6, 75, "Text",ExpressionUUID->"5fd046ce-c545-43c1-9f53-c7a6d8c87208"],
Cell[97797, 2388, 773, 11, 61, "Program",ExpressionUUID->"a6e3d249-3ef8-4133-9128-e257647ca816"],
Cell[98573, 2401, 267, 6, 46, "Text",ExpressionUUID->"c4c34d22-ecd6-43a2-9198-adcf3a4039ea"],
Cell[98843, 2409, 809, 13, 61, "Program",ExpressionUUID->"3b73bbad-b700-46c1-be5b-a049397b1366"],
Cell[99655, 2424, 273, 6, 46, "Text",ExpressionUUID->"eed6cbea-8a38-4fb3-a0da-af7473c69be0"],
Cell[99931, 2432, 558, 10, 46, "Text",ExpressionUUID->"0b84f425-485a-49e8-b92a-3f7344019868"],
Cell[100492, 2444, 608, 10, 61, "Program",ExpressionUUID->"8ff5c066-9d11-4700-8550-7377ebd1a07b"],
Cell[101103, 2456, 360, 7, 46, "Text",ExpressionUUID->"d00bb392-23fa-4a5f-9e62-c4d1acf5f269"],
Cell[101466, 2465, 409, 6, 61, "Program",ExpressionUUID->"c7e90f34-438f-4547-9733-9f4fb154ca2b"],
Cell[101878, 2473, 409, 8, 46, "Text",ExpressionUUID->"a2668d30-b140-4586-8846-f5d568d0066a"],
Cell[102290, 2483, 821, 14, 61, "Program",ExpressionUUID->"598a4928-bf9f-42ae-ae2c-a8bc72e6e3ad"],
Cell[103114, 2499, 459, 8, 75, "Text",ExpressionUUID->"26ad27d2-1c9c-433d-90d6-5df0b0842339"],
Cell[103576, 2509, 488, 10, 53, "Text",ExpressionUUID->"0b78a245-6257-4115-a9bc-f84b29b71ecd"],
Cell[104067, 2521, 755, 13, 61, "Program",ExpressionUUID->"c44271d9-1b70-45e2-85db-2280011733ce"],
Cell[104825, 2536, 362, 8, 75, "Text",ExpressionUUID->"c85bc834-f043-414c-a627-9a561c3f90f8"],
Cell[105190, 2546, 315, 5, 61, "Program",ExpressionUUID->"993ecdc7-c8a9-4061-8247-f7345f8a0bfa"],
Cell[105508, 2553, 311, 6, 46, "Text",ExpressionUUID->"8b77dc73-de85-4874-b37f-7ced194a0f96"],
Cell[105822, 2561, 808, 12, 61, "Program",ExpressionUUID->"f350fd81-607e-4d40-8924-d4fc57ef5a9e"],
Cell[CellGroupData[{
Cell[106655, 2577, 208, 4, 52, "Subsection",ExpressionUUID->"84756167-16d0-4e41-be84-dc65969e3c1b"],
Cell[106866, 2583, 182, 4, 112, "Text",ExpressionUUID->"c8c4775b-ab8f-484a-ad7a-01fdc6fdb1c7"],
Cell[107051, 2589, 16, 0, 69, "Text",ExpressionUUID->"7dc9b780-5eab-4b4b-8448-36c1f94159ba"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[107116, 2595, 283, 4, 101, "Section",ExpressionUUID->"054b668c-3a16-496b-95e0-e6799aed1a99"],
Cell[107402, 2601, 430, 8, 75, "Text",ExpressionUUID->"389ee05e-d796-4fea-88b7-be40aecb854f"],
Cell[107835, 2611, 902, 17, 75, "Text",ExpressionUUID->"7a91f5b8-6916-434f-91f6-4fe0d4508053"],
Cell[108740, 2630, 323, 8, 47, "Input",ExpressionUUID->"8ac23b6f-dd7f-4821-abef-71aab32e205a"],
Cell[109066, 2640, 466, 10, 82, "Text",ExpressionUUID->"de8e5454-5486-482a-887e-a4fc0bb8bdde"],
Cell[109535, 2652, 431, 9, 47, "Input",ExpressionUUID->"cb6f6863-fdc3-4fa4-8450-9c8c694bfe2a"],
Cell[109969, 2663, 787, 13, 75, "Text",ExpressionUUID->"bc36efc8-7900-4f13-b9b1-e336121d8a63"],
Cell[110759, 2678, 417, 9, 47, "Input",ExpressionUUID->"fb737d59-2ea4-46d4-a178-74a9dc141aed"],
Cell[111179, 2689, 750, 20, 89, "Text",ExpressionUUID->"6bb2e938-30af-4a04-9409-648340897fb6"],
Cell[111932, 2711, 403, 8, 47, "Input",ExpressionUUID->"2c8671d4-c159-4058-9853-a30450a24420"],
Cell[112338, 2721, 738, 18, 82, "Text",ExpressionUUID->"2e5d6567-1147-4391-9e6e-78191e20b4c9"],
Cell[113079, 2741, 634, 15, 47, "Input",ExpressionUUID->"a7920a38-e101-45fd-8a04-f1b29c07c88b"],
Cell[113716, 2758, 715, 14, 110, "Text",ExpressionUUID->"75ef6b66-5b6b-41aa-8531-673021747588"],
Cell[114434, 2774, 980, 25, 106, "Input",ExpressionUUID->"5b7181c2-1a8a-4083-854c-49d80bc8052a"],
Cell[CellGroupData[{
Cell[115439, 2803, 317, 7, 47, "Input",ExpressionUUID->"547180b3-2d61-40db-b9e4-05ca18945d4d"],
Cell[115759, 2812, 214, 3, 47, "Output",ExpressionUUID->"ceee8bd0-15bb-4a89-b5cd-ca1612d81f72"]
}, Open  ]],
Cell[115988, 2818, 382, 7, 75, "Text",ExpressionUUID->"c36c5399-2e9c-46e9-9095-b20e6ded7636"],
Cell[116373, 2827, 198, 5, 47, "Input",ExpressionUUID->"afc76b36-a80e-4afa-8dd4-42b4005665cc"],
Cell[116574, 2834, 181, 2, 46, "Text",ExpressionUUID->"7c2102cc-a697-42d3-be0e-45bf782eb375"],
Cell[CellGroupData[{
Cell[116780, 2840, 317, 7, 47, "Input",ExpressionUUID->"502ad7c2-3a4a-42a3-a22f-9bc44b619371"],
Cell[117100, 2849, 295, 5, 47, "Output",ExpressionUUID->"56819aef-a85f-4950-a613-d02c4e067ffd"]
}, Open  ]],
Cell[117410, 2857, 226, 4, 75, "Text",ExpressionUUID->"adebbf58-5e17-4d15-a57d-6c478ccfe113"],
Cell[117639, 2863, 435, 9, 89, "Text",ExpressionUUID->"f411cbe5-6449-4f05-b4e4-b3c5d8afea6e"],
Cell[118077, 2874, 1325, 33, 106, "Input",ExpressionUUID->"d344353f-d400-42d0-8a45-da22b200faaa"],
Cell[119405, 2909, 164, 2, 46, "Text",ExpressionUUID->"bad38d2f-de79-4c7c-8c46-1e1c9968e737"],
Cell[CellGroupData[{
Cell[119594, 2915, 367, 7, 47, "Input",ExpressionUUID->"986001bc-4b60-4dd3-914c-dc2a67860c0a"],
Cell[119964, 2924, 276, 4, 47, "Output",ExpressionUUID->"45ebb4c3-6139-4026-8ead-f471142d97e9"]
}, Open  ]],
Cell[120255, 2931, 238, 3, 46, "Text",ExpressionUUID->"401f0d67-9bf0-441e-8e40-39f98b0d955f"],
Cell[CellGroupData[{
Cell[120518, 2938, 480, 11, 47, "Input",ExpressionUUID->"27cc0d8a-e6a1-4030-a95f-ff9c685525b6"],
Cell[121001, 2951, 177, 2, 47, "Output",ExpressionUUID->"27176d68-15ec-4fb0-b289-48172890c96c"]
}, Open  ]],
Cell[121193, 2956, 908, 15, 110, "Text",ExpressionUUID->"c7f7fa0d-50ef-4956-aad0-4f4b2a53a1c4"],
Cell[122104, 2973, 310, 8, 47, "Input",ExpressionUUID->"8046e97e-5a8d-46c4-9a11-3938e8f59b0a"],
Cell[122417, 2983, 88, 1, 46, "Text",ExpressionUUID->"4e8c99a2-8a1c-4121-aee3-af9bb46385c2"],
Cell[122508, 2986, 343, 8, 47, "Input",ExpressionUUID->"080d7928-f474-4240-a603-7f6cc841975c"],
Cell[122854, 2996, 94, 1, 46, "Text",ExpressionUUID->"d1a54cd4-d0f2-4d6a-9f57-6063b8cc4fa6"],
Cell[122951, 2999, 289, 6, 47, "Input",ExpressionUUID->"cccbc398-70a1-4ca3-8500-b273af121e6b"],
Cell[123243, 3007, 966, 19, 75, "Text",ExpressionUUID->"18db7f7f-9147-4f44-a16b-2362eb51b20f"],
Cell[124212, 3028, 396, 10, 47, "Input",ExpressionUUID->"7011510d-9213-4aed-9569-696d773cd496"],
Cell[124611, 3040, 324, 9, 53, "Text",ExpressionUUID->"8d364da5-8cb9-4cb3-b560-3fe7634b441b"],
Cell[CellGroupData[{
Cell[124960, 3053, 763, 19, 47, "Input",ExpressionUUID->"332c30cf-7ced-4d67-801c-65f934d5937d"],
Cell[125726, 3074, 663, 17, 47, "Output",ExpressionUUID->"90427fed-0aae-4eeb-b8da-01e320fe19bb"]
}, Open  ]],
Cell[126404, 3094, 296, 8, 53, "Text",ExpressionUUID->"5c26e796-71de-48ee-b5bc-1ae7f05e9cc8"],
Cell[CellGroupData[{
Cell[126725, 3106, 239, 5, 47, "Input",ExpressionUUID->"f5e55496-be91-4483-bfee-c0abe79d1f1e"],
Cell[126967, 3113, 378, 6, 47, "Output",ExpressionUUID->"ed5eb757-d99b-4735-92ae-28f257885844"]
}, Open  ]],
Cell[127360, 3122, 428, 10, 53, "Text",ExpressionUUID->"eae85721-6039-4130-b0be-56d836ad837e"],
Cell[CellGroupData[{
Cell[127813, 3136, 124, 2, 47, "Input",ExpressionUUID->"62d77e0e-e482-4e0d-a41b-326978070f2a"],
Cell[127940, 3140, 367, 10, 47, "Output",ExpressionUUID->"d9cefea6-1753-40d8-b590-97922d1d6683"]
}, Open  ]],
Cell[128322, 3153, 223, 5, 46, "Text",ExpressionUUID->"65d4d724-474f-4c43-8fe5-cccb1913fb91"],
Cell[128548, 3160, 1401, 32, 222, "Input",ExpressionUUID->"a6f03be6-4553-4352-bacb-f7ab314c67cf"],
Cell[129952, 3194, 147, 2, 46, "Text",ExpressionUUID->"2f9e516e-3092-41b4-990f-d89e469fef48"],
Cell[CellGroupData[{
Cell[130124, 3200, 751, 16, 47, "Input",ExpressionUUID->"56b004af-a109-4e24-9214-6a0abf136a88"],
Cell[130878, 3218, 739, 16, 47, "Output",ExpressionUUID->"baa3d5b9-447a-4942-9563-2fc6b4eba1d4"]
}, Open  ]],
Cell[131632, 3237, 295, 6, 46, "Text",ExpressionUUID->"8be594e1-7a57-4dd1-bf51-483371dcc2d8"],
Cell[131930, 3245, 582, 13, 89, "Text",ExpressionUUID->"55cc9764-e73b-4bdf-b6cd-250e9587b62b"],
Cell[132515, 3260, 2516, 59, 164, "Input",ExpressionUUID->"eaafa042-8225-4284-a5b5-12f6c3209170"],
Cell[CellGroupData[{
Cell[135056, 3323, 693, 15, 47, "Input",ExpressionUUID->"2888334b-0c69-4ac4-98dd-6d427027a9e8"],
Cell[135752, 3340, 447, 12, 47, "Output",ExpressionUUID->"5c8231d3-d341-41ae-954c-844bfc9b400c"]
}, Open  ]],
Cell[136214, 3355, 966, 15, 75, "Text",ExpressionUUID->"a1ab49a9-8d0c-4fb7-a086-96c0535d546b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137217, 3375, 123, 1, 101, "Section",ExpressionUUID->"7b35c445-c1aa-48f9-9b61-10f997029629"],
Cell[137343, 3378, 620, 13, 117, "Text",ExpressionUUID->"35d93740-466e-4d8a-af33-302a428e98d3"],
Cell[137966, 3393, 304, 6, 46, "Text",ExpressionUUID->"c6f0e12d-09ec-4336-bbca-e150f83e3109"],
Cell[138273, 3401, 834, 20, 135, "Input",ExpressionUUID->"f69b1c70-3c99-4888-a2c3-3c3bed4a97fc"],
Cell[139110, 3423, 284, 6, 53, "Text",ExpressionUUID->"83599d07-0039-461c-a97d-44c888263dd9"],
Cell[CellGroupData[{
Cell[139419, 3433, 913, 23, 135, "Input",ExpressionUUID->"b7f7cb67-e044-4af6-af87-7c5749abb6a3"],
Cell[140335, 3458, 312, 6, 47, "Output",ExpressionUUID->"93c98b35-1c16-409a-9a88-2459212063c9"]
}, Open  ]],
Cell[140662, 3467, 154, 3, 46, "Text",ExpressionUUID->"f53d54a6-a0f0-4351-9bce-79ef6707eb6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140853, 3475, 108, 1, 101, "Section",ExpressionUUID->"800f7a61-d0bb-49fb-becb-43dcd8029b00"],
Cell[140964, 3478, 497, 8, 75, "Text",ExpressionUUID->"d68927c7-96f1-45fe-ba58-a87ad9d88635"],
Cell[141464, 3488, 1162, 17, 189, "Text",ExpressionUUID->"cb11d75e-ab35-40b3-ad64-b39984c585db"],
Cell[142629, 3507, 1016, 15, 132, "Text",ExpressionUUID->"b0209153-52ef-4b5f-bd1a-4348a6acd892"],
Cell[143648, 3524, 429, 8, 82, "Text",ExpressionUUID->"58269100-4d6c-4345-b21a-786d639bdecf"],
Cell[144080, 3534, 164, 3, 46, "Text",ExpressionUUID->"d5182b4c-dba8-45db-a822-840d642017d1"],
Cell[144247, 3539, 7081, 160, 750, "Output",ExpressionUUID->"cf7792e8-03bf-4463-a098-57389da7207b"],
Cell[151331, 3701, 166, 2, 46, "Text",ExpressionUUID->"a75127bb-e688-43ea-8c4a-da13edbb9597"],
Cell[151500, 3705, 106, 1, 46, "Text",ExpressionUUID->"a6185801-c144-482a-a11c-67c280d3dd89"],
Cell[151609, 3708, 106, 1, 46, "Text",ExpressionUUID->"ff48d57a-331c-493a-8c95-90521f08fba4"],
Cell[CellGroupData[{
Cell[151740, 3713, 136, 2, 52, "Subsection",ExpressionUUID->"56920060-f19f-4feb-bda1-834c8575dd3a"],
Cell[151879, 3717, 179, 3, 29431, "Input",ExpressionUUID->"9c5a5df0-0be7-4397-97ea-2b929999ed59"],
Cell[152061, 3722, 930, 25, 111192, "Input",ExpressionUUID->"9ade4da1-c2cd-4329-ae54-6d5574126918"],
Cell[CellGroupData[{
Cell[153016, 3751, 2506, 66, 78417, "Input",ExpressionUUID->"77ab2368-b327-442a-b2cc-56e10edc3047"],
Cell[155525, 3819, 9528, 216, 67110, "Output",ExpressionUUID->"9daf1ea7-d48f-4319-b1bb-4ea63ca53f47"]
}, Open  ]],
Cell[165068, 4038, 2263, 56, 176937, "Input",ExpressionUUID->"c612df2d-392f-409e-bd0b-e0f2e3ff4f65"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[167380, 4100, 223, 3, 101, "Section",ExpressionUUID->"066a1578-edc4-4862-a4ad-272901e063ae"],
Cell[CellGroupData[{
Cell[167628, 4107, 103, 1, 52, "Subsection",ExpressionUUID->"a87aff3b-7594-42bf-8e4b-4a7465277e34"],
Cell[167734, 4110, 100, 1, 46, "Text",ExpressionUUID->"43f690c0-4aa1-4b55-b408-d954d5f6095c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167871, 4116, 126, 1, 52, "Subsection",ExpressionUUID->"8eced38d-fdda-43c2-92cc-d80f7b93505b"],
Cell[168000, 4119, 102, 1, 46, "Text",ExpressionUUID->"3695de4e-53e8-4740-956c-135acf9ba54f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168139, 4125, 108, 1, 52, "Subsection",ExpressionUUID->"c2d0ff0a-6d42-4a9a-9865-84c4b384089d"],
Cell[168250, 4128, 169, 2, 225, "Text",ExpressionUUID->"0a2ab638-d86e-4206-bde6-760673578cc0"],
Cell[CellGroupData[{
Cell[168444, 4134, 254, 5, 202, "Input",ExpressionUUID->"16ae7c44-34ed-4b10-9bda-e526f722d7fc"],
Cell[168701, 4141, 101, 2, 202, "Output",ExpressionUUID->"0f27f8b3-65b5-409f-8148-069a9c33181b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[168851, 4149, 123, 1, 38, "Subsection",ExpressionUUID->"6182f24c-66e6-4a17-bd34-0c6bc84b82a7"],
Cell[CellGroupData[{
Cell[168999, 4154, 6804, 154, 134803, "Input",ExpressionUUID->"69dd1031-7953-41aa-a778-5dcb137dadea"],
Cell[175806, 4310, 4065, 80, 2782, "Output",ExpressionUUID->"066d62a6-8fa3-4e0c-b908-c8bf0cf08fc7"]
}, {2}]],
Cell[CellGroupData[{
Cell[179905, 4395, 285, 6, 324, "Input",ExpressionUUID->"41836745-0751-4d0a-898a-84a63e5b3d5c"],
Cell[180193, 4403, 407, 8, 202, "Output",ExpressionUUID->"c7f11269-ec90-456c-8a8c-c189dceb29b2"],
Cell[180603, 4413, 122, 2, 202, "Output",ExpressionUUID->"c5a20ec2-863b-424d-9237-2f8db2665a87"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[180774, 4421, 111, 1, 38, "Subsection",ExpressionUUID->"ca54838b-52b7-4fec-81d7-88ab608942b9"],
Cell[180888, 4424, 12220, 272, 2965, "Output",ExpressionUUID->"9d55af0f-a1a6-4170-82fc-a92b79747801"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[193157, 4702, 237, 3, 101, "Section",ExpressionUUID->"387ff175-84f3-4015-976a-c27c17fcc75b"],
Cell[CellGroupData[{
Cell[193419, 4709, 102, 1, 52, "Subsection",ExpressionUUID->"8abcc9ba-2ad2-40cf-b3de-2b0089ee8c6a"],
Cell[193524, 4712, 634, 10, 75, "Text",ExpressionUUID->"e49363bb-a183-49f1-88a5-88905d0c002e"],
Cell[194161, 4724, 911, 14, 103, "Text",ExpressionUUID->"f33850e8-6bd4-44d5-a9c7-c3337f914b6d"],
Cell[195075, 4740, 771, 18, 75, "Text",ExpressionUUID->"61764d15-fea8-4f9e-8d68-5a83d8311ef9"],
Cell[195849, 4760, 722, 16, 36, "TableTitle",ExpressionUUID->"35fb7885-af98-4123-9fb3-f9e9c0c1ebe0"],
Cell[196574, 4778, 5996, 154, 264, "Figure",ExpressionUUID->"48f92e07-8391-435c-966b-c824f9033a94"],
Cell[202573, 4934, 458, 8, 82, "Text",ExpressionUUID->"71850216-de3a-4560-be9f-06b8ca0ea515"],
Cell[CellGroupData[{
Cell[203056, 4946, 150, 2, 32, "TableTitle",ExpressionUUID->"f4d90af4-c45d-4d44-835d-f5f891c44f2c",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[203209, 4950, 2189, 60, 222, "Input",ExpressionUUID->"427b038d-ebed-485b-86d3-6684945c34fd",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[205401, 5012, 1388, 35, 239, "Output",ExpressionUUID->"7e900066-6c2b-4e8e-bdbb-52d518313768",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[206804, 5050, 1335, 21, 167, "Text",ExpressionUUID->"8e36d8bc-581d-47d0-8000-b133f93e472d"],
Cell[CellGroupData[{
Cell[208164, 5075, 306, 8, 47, "Input",ExpressionUUID->"60ec4a64-143b-420c-af6c-b9a8520e135e"],
Cell[208473, 5085, 184, 4, 47, "Output",ExpressionUUID->"5c8fd8e5-a8c4-42ea-acce-c476364db4fb"]
}, Open  ]],
Cell[208672, 5092, 397, 10, 89, "Text",ExpressionUUID->"8d18f8aa-10cd-45ba-a99a-9fda22ee5f37"],
Cell[CellGroupData[{
Cell[209094, 5106, 262, 7, 47, "Input",ExpressionUUID->"3104dbbe-9fca-4276-b7f8-c89eeecbe1e9"],
Cell[209359, 5115, 243, 5, 47, "Output",ExpressionUUID->"ee640859-c2fd-43a3-850a-c3fd7bc1db1b"]
}, Open  ]],
Cell[209617, 5123, 216, 4, 46, "Text",ExpressionUUID->"3fc40466-f62c-4ebb-9fc2-41a0dec70616"],
Cell[CellGroupData[{
Cell[209858, 5131, 126, 2, 47, "Input",ExpressionUUID->"9b262756-1a04-4615-8bed-6283874ad599"],
Cell[209987, 5135, 5533, 150, 250, "Output",ExpressionUUID->"332c8fbf-6c34-44a0-9e93-232372b704d8"]
}, Open  ]],
Cell[215535, 5288, 812, 12, 75, "Text",ExpressionUUID->"92cf671a-5ad2-4033-8ca7-7cf95a077b20"],
Cell[216350, 5302, 691, 12, 53, "Text",ExpressionUUID->"c2720f7a-23bd-4a76-9f43-d8d22600cecc"],
Cell[217044, 5316, 299, 9, 57, "Text",ExpressionUUID->"acd4a4d9-aa60-45cf-aee6-14dc7e36a81b"],
Cell[217346, 5327, 432, 8, 75, "Text",ExpressionUUID->"1d068426-cdfa-4b92-9c6c-3ef4d0f983b2"],
Cell[217781, 5337, 377, 8, 53, "Text",ExpressionUUID->"7bdf849f-acf6-4800-bfdb-37e288e80b6d"],
Cell[218161, 5347, 330, 8, 53, "Text",ExpressionUUID->"045233cb-c202-44b9-a7a4-28a1fc89bee3"],
Cell[218494, 5357, 358, 6, 75, "Text",ExpressionUUID->"5b99d0d1-08f9-45a2-bebc-eaadc501e618"],
Cell[218855, 5365, 247, 5, 75, "Text",ExpressionUUID->"a3f10abe-6842-4547-aad7-6a42e3852485"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219139, 5375, 126, 1, 52, "Subsection",ExpressionUUID->"ce0075db-78eb-4159-8c83-39af285d7f02"],
Cell[219268, 5378, 216, 4, 46, "Text",ExpressionUUID->"66634b3b-cb1f-45c2-931e-b262dcdb4771"],
Cell[CellGroupData[{
Cell[219509, 5386, 286, 7, 47, "Input",ExpressionUUID->"9f13b7a1-5e74-463d-8a99-640463a34bce"],
Cell[219798, 5395, 2514, 37, 135, "Output",ExpressionUUID->"59e974bc-00d4-459a-ae62-50abec1b309d"]
}, Open  ]],
Cell[222327, 5435, 562, 12, 110, "Text",ExpressionUUID->"722dd443-8f4c-4d4c-9bc1-0173569f864b"],
Cell[CellGroupData[{
Cell[222914, 5451, 485, 9, 47, "Input",ExpressionUUID->"5af2a6ec-1004-4ed7-83ee-3ff8da44da56"],
Cell[223402, 5462, 412, 8, 47, "Output",ExpressionUUID->"b7a45334-c813-4097-8501-585f3196fda9"]
}, Open  ]],
Cell[223829, 5473, 448, 9, 82, "Text",ExpressionUUID->"d461b28b-51d3-404a-a966-3ad93bee05b5"],
Cell[CellGroupData[{
Cell[224302, 5486, 636, 15, 77, "Input",ExpressionUUID->"36849814-58fe-4d42-84ed-43b603563f3b"],
Cell[224941, 5503, 4784, 117, 599, "Output",ExpressionUUID->"c25d2809-d536-4302-800e-a04fe68a5b14"]
}, Open  ]],
Cell[229740, 5623, 135, 1, 46, "Text",ExpressionUUID->"d919a8fb-feec-4ada-8258-2c647b9175b6"],
Cell[CellGroupData[{
Cell[229900, 5628, 2194, 57, 251, "Input",ExpressionUUID->"a3c3ec92-b3f3-4b63-a738-713212614e84"],
Cell[232097, 5687, 966, 17, 77, "Output",ExpressionUUID->"2a7863fd-36fe-4f0f-9b62-da8a5fe025e9"]
}, Open  ]],
Cell[233078, 5707, 186, 2, 46, "Text",ExpressionUUID->"c788921b-bbf9-4ce3-b8ac-f17a95f768ad"],
Cell[CellGroupData[{
Cell[233289, 5713, 247, 5, 47, "Input",ExpressionUUID->"6f7b0f1b-ca76-449c-aa07-8bdd9fe36c14"],
Cell[233539, 5720, 365, 5, 77, "Output",ExpressionUUID->"7e43ded0-4b07-4d36-8592-2fff056ff6ff"]
}, Open  ]],
Cell[233919, 5728, 242, 6, 53, "Text",ExpressionUUID->"247499af-c7f6-438f-9cd4-8c66846f8a62"],
Cell[CellGroupData[{
Cell[234186, 5738, 732, 18, 47, "Input",ExpressionUUID->"851355bc-8d5b-4162-8fa7-3cf4b93cf947"],
Cell[234921, 5758, 364, 7, 47, "Output",ExpressionUUID->"78f26b7b-02e5-4bf5-aa5e-4aa94aa76e24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235322, 5770, 412, 10, 47, "Input",ExpressionUUID->"4555c806-b8c8-4a98-89dc-763efb2ef0bf"],
Cell[235737, 5782, 821, 20, 47, "Output",ExpressionUUID->"c24b832f-ad59-4cac-93bc-de8d4ba34a7f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[236595, 5807, 1329, 35, 555, "Input",ExpressionUUID->"5d061d50-441d-4b70-a3cb-9323f659bee7"],
Cell[237927, 5844, 1702, 44, 179, "Output",ExpressionUUID->"46c01928-79bb-481f-b0c8-5121c85e68e1"]
}, {2}]],
Cell[239641, 5891, 230, 5, 46, "Text",ExpressionUUID->"bd850387-1ad2-450a-a50d-d3495d792e66"],
Cell[239874, 5898, 589, 12, 164, "Input",ExpressionUUID->"76582d9d-7f1e-4ca6-b6e4-0372f39e1889"],
Cell[CellGroupData[{
Cell[240488, 5914, 243, 4, 47, "Input",ExpressionUUID->"dfe0a1c0-ec87-485b-892f-b99cb6f83eca"],
Cell[240734, 5920, 293, 6, 47, "Output",ExpressionUUID->"4ec52e4c-f097-4b65-bdbc-7c75c4a552b1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[241076, 5932, 105, 1, 52, "Subsection",ExpressionUUID->"8bdaf744-30a7-4224-a37b-5dedd6aada96"],
Cell[241184, 5935, 327, 5, 75, "Text",ExpressionUUID->"6591b5ad-6b80-4e8a-950e-0d6bb4d1317e"],
Cell[241514, 5942, 439, 8, 75, "Text",ExpressionUUID->"d41dd522-e505-4f95-8397-e1adfd31aff1"],
Cell[CellGroupData[{
Cell[241978, 5954, 326, 6, 36, "Item",ExpressionUUID->"23683311-5f4e-4482-808c-fe10f8bd636e"],
Cell[242307, 5962, 234, 3, 36, "Item",ExpressionUUID->"63e244a0-91a4-4305-8b1d-2f9e18a59e5a"],
Cell[242544, 5967, 181, 2, 36, "Item",ExpressionUUID->"eae99c08-8e0a-4a6e-a7d1-bdbfc62f551c"],
Cell[242728, 5971, 170, 3, 36, "Item",ExpressionUUID->"ea699ab5-46a2-4c85-bf8d-ee9a26d6984f"],
Cell[242901, 5976, 378, 6, 62, "Item",ExpressionUUID->"e6d920d8-b129-4a7f-a677-72aebf65aebe"],
Cell[243282, 5984, 209, 2, 36, "Item",ExpressionUUID->"3d1b5d06-1452-4831-9c97-4ac7fb084fff"]
}, Open  ]],
Cell[243506, 5989, 810, 12, 75, "Text",ExpressionUUID->"e260935f-67bd-4d6e-9664-8b0ff0f2feb5"],
Cell[CellGroupData[{
Cell[244341, 6005, 252, 5, 32, "TableTitle",ExpressionUUID->"7546d8a7-ae45-43cc-bec4-526ecbfa190c"],
Cell[244596, 6012, 5370, 152, 387, "Output",ExpressionUUID->"b6bf7026-f208-472b-9962-7d9b3b2ece88"]
}, Open  ]],
Cell[249981, 6167, 229, 4, 46, "Text",ExpressionUUID->"d645cb1c-8816-4764-ae2c-4e4487a2ece8"],
Cell[CellGroupData[{
Cell[250235, 6175, 661, 11, 32, "TableTitle",ExpressionUUID->"60588d14-f277-4805-acb9-2a4f19a6f859"],
Cell[250899, 6188, 3132, 102, 249, "Output",ExpressionUUID->"ba82bed3-16ec-4ee7-880b-739e330c60ed"]
}, Open  ]],
Cell[254046, 6293, 920, 14, 160, "Text",ExpressionUUID->"dc0f491a-37f3-41b8-9786-a1b6ad65415e"],
Cell[CellGroupData[{
Cell[254991, 6311, 443, 8, 54, "TableTitle",ExpressionUUID->"04c7c6a1-7e09-4fab-abe8-fe7c6be904e6"],
Cell[255437, 6321, 9091, 196, 609, "Output",ExpressionUUID->"8db7c733-91f9-4250-93f6-4633f2f169ce"]
}, Open  ]],
Cell[264543, 6520, 919, 14, 132, "Text",ExpressionUUID->"1bc63a6d-95ff-41c4-806d-05ae24f69ffa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265499, 6539, 108, 1, 52, "Subsection",ExpressionUUID->"3a88a820-db10-40d1-a8ba-5a73887c3c03"],
Cell[CellGroupData[{
Cell[265632, 6544, 170, 2, 37, "Subsubsection",ExpressionUUID->"69995a69-e044-489e-be64-4e1b238b524a"],
Cell[265805, 6548, 356, 7, 75, "Text",ExpressionUUID->"ffd2b1a5-8f7a-44ed-8ef5-fadafdda3cf5"],
Cell[266164, 6557, 1513, 41, 164, "Input",ExpressionUUID->"08825fda-f11b-4b50-8763-1502ed83cb4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267714, 6603, 171, 2, 37, "Subsubsection",ExpressionUUID->"9338e024-d845-49fe-8f48-9c928ce462c2"],
Cell[267888, 6607, 1014, 16, 167, "Text",ExpressionUUID->"f18dab16-0f8a-4f8d-b5f8-7207d12abf1c"],
Cell[268905, 6625, 5578, 112, 773, "Input",ExpressionUUID->"615e6437-d70a-4a99-a6a0-061dbc9151bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[274520, 6742, 117, 1, 37, "Subsubsection",ExpressionUUID->"2c487586-4d14-4be1-9053-b587c852c13e"],
Cell[274640, 6745, 352, 7, 82, "Text",ExpressionUUID->"11f88180-e0b4-4190-a987-00ec55b68bd1"],
Cell[274995, 6754, 705, 18, 124, "Text",ExpressionUUID->"1072eae4-77ba-4617-a3bf-77b79180599a"],
Cell[275703, 6774, 811, 15, 146, "Text",ExpressionUUID->"f04b999d-3a24-4295-842e-b768350d30e0"],
Cell[276517, 6791, 2084, 43, 396, "Input",ExpressionUUID->"c1ac3194-192b-49bd-b04d-a5bfb7b89ef1"],
Cell[278604, 6836, 1030, 18, 196, "Text",ExpressionUUID->"d362b95b-7a8b-49cf-8b54-a75f6b3df4ca"],
Cell[279637, 6856, 4412, 90, 657, "Input",ExpressionUUID->"6acf44cb-8115-44cc-814b-c296e5f5b718"]
}, Open  ]],
Cell[CellGroupData[{
Cell[284086, 6951, 166, 2, 37, "Subsubsection",ExpressionUUID->"cd6cefb3-852d-498f-a242-2fa698310312"],
Cell[284255, 6955, 449, 8, 75, "Text",ExpressionUUID->"68f10ad9-ae65-413d-8abc-97fbf83736fb"],
Cell[284707, 6965, 668, 11, 132, "Text",ExpressionUUID->"1b624cf7-71a8-499b-8a05-252cee1d0373"],
Cell[285378, 6978, 6184, 132, 918, "Input",ExpressionUUID->"ce1b699b-6568-4431-aafb-52d60f5f4e99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[291599, 7115, 103, 1, 82, "Subsubsection",ExpressionUUID->"2e03de2a-5383-472b-909a-f3aa582bae4c"],
Cell[291705, 7118, 470, 8, 229, "Text",ExpressionUUID->"e8edbdae-d93c-4974-9e76-e925faf6a23c"],
Cell[292178, 7128, 2347, 51, 888, "Input",ExpressionUUID->"99fb4839-ae16-4c4d-bdfc-e515696a120b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[294574, 7185, 104, 1, 117, "Subsection",ExpressionUUID->"b49870c3-a645-46bb-80e1-54449f72617c"],
Cell[CellGroupData[{
Cell[294703, 7190, 200, 3, 103, "Input",ExpressionUUID->"f2d548ff-e858-40b6-824e-e261a4b11452"],
Cell[294906, 7195, 523, 14, 103, "Output",ExpressionUUID->"d5844a67-6627-481d-a669-2ebfb19c24bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[295466, 7214, 196, 4, 103, "Input",ExpressionUUID->"56044351-3149-4ac5-8090-599145de240c"],
Cell[295665, 7220, 7670, 207, 793, "Output",ExpressionUUID->"f74b2c14-82c2-4ad2-a27f-aaa4581d778e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[303384, 7433, 135, 2, 117, "Subsection",ExpressionUUID->"eb8b4d77-8cf3-4de3-957a-4f47829efc78"],
Cell[CellGroupData[{
Cell[303544, 7439, 118, 1, 1531, "Subsubsection",ExpressionUUID->"dfd52ca9-7ee9-483f-8cb5-6b9935359f9d"],
Cell[CellGroupData[{
Cell[303687, 7444, 7114, 168, 28977, "Input",ExpressionUUID->"d30985d1-7a85-4475-9977-a3c377194900"],
Cell[310804, 7614, 5370, 152, 21214, "Output",ExpressionUUID->"5cfc46ed-d795-4a5f-878a-5cd905e03caf"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[316223, 7772, 130, 1, 1234, "Subsubsection",ExpressionUUID->"cf8608a4-e439-49a0-8f75-620167a5276f"],
Cell[CellGroupData[{
Cell[316378, 7777, 4224, 113, 22356, "Input",ExpressionUUID->"a91af8f4-ffb8-4175-a0e9-1480480ed52d"],
Cell[320605, 7892, 3132, 102, 12912, "Output",ExpressionUUID->"bfcbd9d8-80c6-431f-ba36-30a1ce38ef9d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[323786, 8000, 124, 1, 1234, "Subsubsection",ExpressionUUID->"b67a2f7e-956a-4f7c-b90b-b536d862a834"],
Cell[CellGroupData[{
Cell[323935, 8005, 627, 16, 3694, "Input",ExpressionUUID->"1df57e38-6639-4ed5-b6e0-0163b44e51e4"],
Cell[324565, 8023, 854, 21, 8518, "Output",ExpressionUUID->"3bdd326f-7b70-4225-ad89-2150b7ac8613"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[325492, 8052, 186, 2, 225, "Section",ExpressionUUID->"e28dab75-f5a7-4b2b-9098-fd26e79bbd68"],
Cell[325681, 8056, 656, 10, 294, "Text",ExpressionUUID->"bd245198-d8c3-45e6-9a45-024d18896e25"],
Cell[326340, 8068, 515, 8, 166, "Text",ExpressionUUID->"d692fc9d-e76e-47eb-81e7-8109ff1c7791"],
Cell[CellGroupData[{
Cell[326880, 8080, 100, 1, 69, "TableTitle",ExpressionUUID->"4d57efff-f98e-408f-91e3-ab843c5e8882"],
Cell[326983, 8083, 9799, 214, 1482, "Output",ExpressionUUID->"5a34402b-7660-4ae5-ae48-0fd8ea605d07"]
}, Open  ]],
Cell[336797, 8300, 1517, 21, 679, "Text",ExpressionUUID->"2c63e8d2-a3d8-470b-8e62-186737182b58"],
Cell[CellGroupData[{
Cell[338339, 8325, 128, 1, 117, "Subsection",ExpressionUUID->"c8c54e88-cdb9-4126-8365-996ed754e819"],
Cell[338470, 8328, 854, 20, 342, "Text",ExpressionUUID->"4058034e-34bf-4175-b2e9-f8a248c4ea91"],
Cell[CellGroupData[{
Cell[339349, 8352, 120, 1, 82, "Subsubsection",ExpressionUUID->"07572d56-757d-4a46-aa65-b6c08d64d478"],
Cell[339472, 8355, 570, 12, 261, "Text",ExpressionUUID->"6a2d4310-9602-4047-8fcf-56245265871b"],
Cell[340045, 8369, 762, 19, 171, "Input",ExpressionUUID->"c91f0e46-dba3-4cb1-b1fd-93ecfb5fd2ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[340844, 8393, 111, 1, 82, "Subsubsection",ExpressionUUID->"3add0664-50e2-482e-bf86-5e6c247ffd57"],
Cell[340958, 8396, 768, 12, 294, "Text",ExpressionUUID->"865dcc2f-a205-4d76-8a36-a6c1673620b7"],
Cell[341729, 8410, 3315, 73, 1149, "Input",ExpressionUUID->"406eee5c-ed7d-47b1-9800-8c6fa4f7d268"]
}, Open  ]],
Cell[CellGroupData[{
Cell[345081, 8488, 110, 1, 82, "Subsubsection",ExpressionUUID->"aabb989f-df0a-4528-866d-3859772b5ab8"],
Cell[345194, 8491, 560, 9, 294, "Text",ExpressionUUID->"82ccbaea-527d-49a3-9380-35b8a19322d7"],
Cell[345757, 8502, 2805, 63, 1084, "Input",ExpressionUUID->"c0217dab-65fc-40a8-912f-b130d0d5448c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[348599, 8570, 152, 2, 82, "Subsubsection",ExpressionUUID->"6bd8135d-7851-4946-8442-66d36c252aea"],
Cell[348754, 8574, 575, 11, 244, "Text",ExpressionUUID->"55368bc1-43b9-4fce-9320-6d1b96dc250f"],
Cell[349332, 8587, 2049, 43, 627, "Input",ExpressionUUID->"e61c6870-f202-4735-ae0d-bde5ae97b8df"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[351430, 8636, 213, 3, 117, "Subsection",ExpressionUUID->"75a5ab56-0e79-45a6-82de-8080780f8d25"],
Cell[351646, 8641, 5362, 122, 3483, "Input",ExpressionUUID->"4b0c0d97-52a0-4879-bfe7-a325ddf07f0c"]
}, Closed]],
Cell[CellGroupData[{
Cell[357045, 8768, 130, 1, 85, "Subsection",ExpressionUUID->"1f98bb83-e2ed-452a-b0a4-18217e43ff2a"],
Cell[CellGroupData[{
Cell[357200, 8773, 163, 3, 103, "Input",ExpressionUUID->"ea3ab559-1bf7-4a76-81ec-1f863a0f4ea0"],
Cell[357366, 8778, 784, 21, 171, "Output",ExpressionUUID->"92feeaf6-c6e6-412a-b8f8-f42ee844488c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[358187, 8804, 313, 5, 103, "Input",ExpressionUUID->"5b51e5b8-1cf8-4bef-8c0f-b55ff9222891"],
Cell[358503, 8811, 982, 24, 171, "Output",ExpressionUUID->"3500e296-e0e1-434b-90a1-bf40804139dc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[359522, 8840, 199, 4, 103, "Input",ExpressionUUID->"7f644c9d-eeca-4ac6-8f24-ce5bb0147357"],
Cell[359724, 8846, 15819, 415, 841, "Output",ExpressionUUID->"51621e01-8191-4a86-9b05-f31a481cd821"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[375604, 9268, 158, 2, 225, "Section",ExpressionUUID->"cd7102f6-f0c3-4842-8751-13fd6b54ac1e"],
Cell[CellGroupData[{
Cell[375787, 9274, 99, 1, 117, "Subsection",ExpressionUUID->"a9dd8d3d-f451-4805-a6ba-a5934959a706"],
Cell[375889, 9277, 472, 14, 105, "Input",ExpressionUUID->"bdafb71f-dd45-4204-88d2-0608d12c83fb"],
Cell[376364, 9293, 649, 15, 171, "Input",ExpressionUUID->"3ee07491-1a87-44cd-8921-0b6f7099ba6c"],
Cell[377016, 9310, 6035, 150, 1476, "Input",ExpressionUUID->"9cce7d19-79a3-4fa1-82ef-0d3c43fa1c57"],
Cell[CellGroupData[{
Cell[383076, 9464, 337, 5, 103, "Input",ExpressionUUID->"b88840d9-9626-40fc-bb7e-6e1341da9437"],
Cell[383416, 9471, 674, 15, 103, "Output",ExpressionUUID->"1b02f504-c914-4afb-a497-5652cce29077"]
}, Open  ]],
Cell[CellGroupData[{
Cell[384127, 9491, 578, 9, 171, "Input",ExpressionUUID->"c1fae4e5-b191-41bb-9968-9208e634d5f6"],
Cell[384708, 9502, 977, 19, 103, "Output",ExpressionUUID->"1c49cf40-24ea-4143-b571-c59045269f2f"],
Cell[385688, 9523, 1368, 29, 171, "Output",ExpressionUUID->"86d634f7-f965-4987-b7fb-dc444459f7b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[387093, 9557, 193, 4, 28156, "Input",ExpressionUUID->"e2268a66-24fd-4a5f-a75d-31737f5c4b5c"],
Cell[387289, 9563, 18287, 488, 283351, "Output",ExpressionUUID->"73931dfe-d977-4cae-8286-f19186fab9e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[405613, 10056, 196, 4, 28156, "Input",ExpressionUUID->"46575921-2a41-445d-85e1-df8154f65ee2"],
Cell[405812, 10062, 390, 11, 28156, "Output",ExpressionUUID->"0b1aab0a-b88c-4e9b-b481-5fa951fe879d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[406239, 10078, 456, 9, 45522, "Input",ExpressionUUID->"88dee5e7-a69c-45c2-a182-ee01a909822f"],
Cell[406698, 10089, 388, 11, 28156, "Output",ExpressionUUID->"599216bd-55be-4409-982e-4b39e51d3ca6"],
Cell[407089, 10102, 154, 2, 28156, "Output",ExpressionUUID->"740fd41b-5af0-48bb-a3ee-03cebca5c4db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[407280, 10109, 151, 3, 28156, "Input",ExpressionUUID->"b8373e2e-685b-43f2-9ee4-eacb6ae787e3"],
Cell[407434, 10114, 13794, 375, 376435, "Output",ExpressionUUID->"4d0e1283-ae9b-4feb-8bf2-9c7fc46629cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[421265, 10494, 262, 5, 28156, "Input",ExpressionUUID->"5e9fd56d-c6ee-4e12-882d-6dd1f28e8126"],
Cell[421530, 10501, 1249, 33, 61035, "Output",ExpressionUUID->"3c75abb0-4488-48ed-a16a-6f3f00ccdef9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[422816, 10539, 61, 1, 28156, "Input",ExpressionUUID->"ee12fb88-572b-4f9e-8578-a1ab45e8f7c6"],
Cell[422880, 10542, 23459, 638, 296722, "Output",ExpressionUUID->"1e901cf4-894a-48a0-9606-a73e5a086a47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[446376, 11185, 361, 6, 44289, "Input",ExpressionUUID->"55624339-77aa-4190-a2f9-6d9742001d5e"],
Cell[446740, 11193, 922, 24, 44289, "Output",ExpressionUUID->"df6fe29c-b558-4a05-bf58-637ab67a445a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[447699, 11222, 61, 1, 28156, "Input",ExpressionUUID->"bf2f2060-9822-4540-a2cb-809f1f5f4c9b"],
Cell[447763, 11225, 16504, 459, 495829, "Output",ExpressionUUID->"bf295958-8e32-4817-9020-fa265f22327e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[464304, 11689, 295, 6, 44289, "Input",ExpressionUUID->"ad932faf-c6d7-4037-b21e-6b2964844ec9"],
Cell[464602, 11697, 926, 24, 171, "Output",ExpressionUUID->"69d5e340-ebe9-4d83-98a0-8fbd8ee5f8d3"],
Cell[465531, 11723, 16606, 461, 1273, "Output",ExpressionUUID->"25dec5c1-cae8-4490-a770-dcff1320fce7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[482174, 12189, 137, 2, 103, "Input",ExpressionUUID->"b555f921-f058-43fc-bedd-01e22a6a0471"],
Cell[482314, 12193, 416, 12, 103, "Output",ExpressionUUID->"50f63049-7ce4-4141-9351-22cd7e394448"]
}, Open  ]],
Cell[CellGroupData[{
Cell[482767, 12210, 222, 4, 171, "Input",ExpressionUUID->"94f59b24-996a-416e-89b3-dc718f777c65"],
Cell[482992, 12216, 871, 23, 171, "Output",ExpressionUUID->"377b7574-6485-40ae-a933-24656a1eb226"],
Cell[483866, 12241, 19508, 521, 1372, "Output",ExpressionUUID->"91c35125-80a5-4487-ba97-cd3a406652af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[503411, 12767, 292, 6, 171, "Input",ExpressionUUID->"08a11717-fa3a-49a4-aa24-4906c167f85d"],
Cell[503706, 12775, 796, 21, 171, "Output",ExpressionUUID->"e24daa7f-82dc-4060-83bf-729b9333bf0c"],
Cell[504505, 12798, 16444, 444, 1261, "Output",ExpressionUUID->"33986f10-20a7-4f0f-a006-a59010cffea9"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[521010, 13249, 97, 1, 118, "Section",ExpressionUUID->"f194a44d-b697-4342-a344-a10988a29749"],
Cell[521110, 13252, 274, 5, 166, "Text",ExpressionUUID->"68842b3c-ae81-49da-a188-e70810cee1b9"],
Cell[521387, 13259, 278, 5, 100, "Text",ExpressionUUID->"d1b581f8-09a7-4214-9d5c-7313cff02f92"],
Cell[521668, 13266, 131, 1, 100, "Text",ExpressionUUID->"15d5a98e-5d73-4947-9b1b-64df939c5bd6"],
Cell[521802, 13269, 307, 5, 100, "Text",ExpressionUUID->"c24f705d-4bc9-45ca-bb66-ccbf9e9f08d4"],
Cell[522112, 13276, 226, 6, 117, "Text",ExpressionUUID->"daf17bcf-1670-4187-91c6-0375836a6c49"]
}, Open  ]],
Cell[CellGroupData[{
Cell[522375, 13287, 96, 1, 225, "Section",ExpressionUUID->"430d6046-da8a-4b78-942a-8bb7d038bd4a"],
Cell[522474, 13290, 279, 3, 100, "Text",ExpressionUUID->"ed62e458-c18e-438b-b020-f1ecb471479a"],
Cell[522756, 13295, 362, 11, 117, "Text",ExpressionUUID->"24cd5e2d-e512-4e08-b1ee-64103f99ced1"],
Cell[523121, 13308, 234, 3, 100, "Text",ExpressionUUID->"300ff61e-8481-4988-b58e-b45fe6b11f26"],
Cell[523358, 13313, 432, 9, 166, "Text",ExpressionUUID->"2164fa7e-2743-49b0-9865-58332aee611f"],
Cell[523793, 13324, 826, 13, 244, "Text",ExpressionUUID->"32a9732d-80dd-4a2e-8e6d-b42400e95d22"],
Cell[524622, 13339, 748, 12, 117, "Text",ExpressionUUID->"7168b2e2-7d27-45bf-a09f-c866c9a84b17"],
Cell[525373, 13353, 447, 13, 261, "Text",ExpressionUUID->"c9a9176d-7bb4-4d25-941e-6b7ef8f13b67"],
Cell[525823, 13368, 183, 5, 117, "Text",ExpressionUUID->"47ec6e17-5dc1-4ced-9e15-c2164b9c2bf0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[526043, 13378, 94, 1, 225, "Section",ExpressionUUID->"c4e62769-8f99-49b9-af1c-77b4b3bba39d"],
Cell[CellGroupData[{
Cell[526162, 13383, 241, 3, 117, "Subsection",ExpressionUUID->"b0dd519a-4d70-417a-a4e7-f38ef05d58e5"],
Cell[526406, 13388, 871, 16, 47974, "Text",ExpressionUUID->"61104a72-1445-47f3-9eb0-a76c2aa3d0c5"],
Cell[CellGroupData[{
Cell[527302, 13408, 101, 1, 28156, "Subsubsection",ExpressionUUID->"1be3c347-5506-4c20-be36-4c17c10f875d"],
Cell[527406, 13411, 2359, 61, 150490, "Input",ExpressionUUID->"2b9d4fdd-91eb-42d9-bb79-5ab1ab49f439"]
}, Open  ]],
Cell[CellGroupData[{
Cell[529802, 13477, 132, 2, 28156, "Subsubsection",ExpressionUUID->"d3332cf3-6c9c-43cb-84e2-236a429710a5"],
Cell[529937, 13481, 135, 2, 21231, "Text",ExpressionUUID->"e0f339d9-cb65-4e67-b462-d8a97cc92008"],
Cell[CellGroupData[{
Cell[530097, 13487, 202, 4, 18699, "Input",ExpressionUUID->"7ebb8db3-234f-4f06-8783-d729dd52692e"],
Cell[530302, 13493, 2542, 55, 62835, "Output",ExpressionUUID->"3918731c-ee34-47f8-8304-519444cdd34b"]
}, Open  ]],
Cell[532859, 13551, 247, 3, 21231, "Text",ExpressionUUID->"16c96b6d-ddfc-46b8-839e-d0c133668a56"],
Cell[CellGroupData[{
Cell[533131, 13558, 357, 5, 18699, "Input",ExpressionUUID->"0da0bace-242a-4d5c-90c1-7d49b1bde06c"],
Cell[533491, 13565, 170, 3, 18699, "Output",ExpressionUUID->"287e55d9-46fc-49f8-a673-688bcc67f1f6"]
}, Open  ]],
Cell[533676, 13571, 163, 3, 21231, "Text",ExpressionUUID->"371c7420-a54b-45a4-b436-b7ea0ea7e021"],
Cell[CellGroupData[{
Cell[533864, 13578, 507, 9, 18699, "Input",ExpressionUUID->"5b91c7da-1b8d-4287-a0d3-25c9469ad8e4"],
Cell[534374, 13589, 192, 5, 18699, "Output",ExpressionUUID->"8f7cafba-9a4c-48fa-b45c-9482e991cf45"]
}, Open  ]],
Cell[534581, 13597, 139, 1, 21231, "Text",ExpressionUUID->"59f46176-962c-4e15-b92e-32058426328e"],
Cell[CellGroupData[{
Cell[534745, 13602, 372, 6, 18699, "Input",ExpressionUUID->"66f6502f-be5a-4cdb-bbbc-45fe4821eb2a"],
Cell[535120, 13610, 18780, 486, 187852, "Output",ExpressionUUID->"5ecd8b38-63c0-498c-af92-01b58760267e"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[553961, 14103, 378, 5, 85, "Subsection",ExpressionUUID->"d4526c2a-e50b-4293-8738-76538d3395c9"],
Cell[554342, 14110, 286, 7, 21231, "Text",ExpressionUUID->"68159475-208a-4d26-a74a-a13970cd3dbf"],
Cell[CellGroupData[{
Cell[554653, 14121, 104, 1, 28156, "Subsubsection",ExpressionUUID->"acd98a1b-a605-4ad7-a3f4-506a9fde1944"],
Cell[554760, 14124, 1041, 23, 53419, "Input",ExpressionUUID->"e0907e93-fe79-4525-b7c3-e88c3bfc2d48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[555838, 14152, 104, 1, 28156, "Subsubsection",ExpressionUUID->"cfbb145a-ad19-44a6-8ae3-d360edb95a3e"],
Cell[555945, 14155, 183, 6, 21231, "Text",ExpressionUUID->"a199a202-e8aa-407f-b35e-e89f6bcc0cec"],
Cell[556131, 14163, 457, 10, 18699, "Input",ExpressionUUID->"579b2a02-36cf-4a63-99b7-6f9388c64adb"],
Cell[556591, 14175, 159, 3, 21231, "Text",ExpressionUUID->"0f255f71-a4e2-462a-b35e-64cd54bd4a06"],
Cell[CellGroupData[{
Cell[556775, 14182, 1282, 31, 40965, "Input",ExpressionUUID->"85a8676c-3816-4fda-9d0c-68ad1bef37f0"],
Cell[558060, 14215, 289, 6, 29431, "Output",ExpressionUUID->"d093c430-5c06-40b9-b230-3193d8f8fde8"],
Cell[558352, 14223, 276, 7, 18699, "Output",ExpressionUUID->"6721bc78-b8f0-4ebc-aaa6-b67f5c52c31c"]
}, Open  ]],
Cell[558643, 14233, 117, 1, 21231, "Text",ExpressionUUID->"f50d0ed9-45f9-4e0d-ae74-8a500ba7ae2f"],
Cell[CellGroupData[{
Cell[558785, 14238, 650, 13, 18699, "Input",ExpressionUUID->"2fc5ebac-2bc5-4df6-a21f-c1a3de2fd052"],
Cell[559438, 14253, 33335, 985, 172633, "Output",ExpressionUUID->"1deda0ff-220a-406c-9a70-18851b6fd7b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[592810, 15243, 726, 17, 18699, "Input",ExpressionUUID->"09a22cd4-e929-4071-b760-7e123ef9db54"],
Cell[593539, 15262, 394, 9, 18699, "Output",ExpressionUUID->"1eb54794-dbf3-4c36-a5ec-42ec68810776"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[593994, 15278, 158, 2, 85, "Subsection",ExpressionUUID->"adfcd319-8220-499a-b062-48f312d6a3ac"],
Cell[594155, 15282, 506, 14, 3687, "Input",ExpressionUUID->"354811c7-6093-4494-b514-1fd4d3edd221"],
Cell[CellGroupData[{
Cell[594686, 15300, 463, 11, 2296, "Input",ExpressionUUID->"8697fe66-b59c-4c8a-a08d-3f323260e1da"],
Cell[595152, 15313, 337, 6, 2296, "Output",ExpressionUUID->"a38f0c13-c6ee-4682-84f8-32d763cfd035"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[595538, 15325, 235, 3, 85, "Subsection",ExpressionUUID->"b106f1a5-880a-449c-a7ec-f0f48de83d15"],
Cell[CellGroupData[{
Cell[595798, 15332, 1280, 25, 2458, "Input",ExpressionUUID->"6d8d751b-efa3-4c48-b835-72442751595d"],
Cell[597081, 15359, 97, 1, 1531, "Output",ExpressionUUID->"1e3806af-0797-4ed8-b28f-946bca5423c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[597215, 15365, 618, 16, 2458, "Input",ExpressionUUID->"da791a4e-0885-4e47-aebc-003180ae8035"],
Cell[597836, 15383, 315, 5, 1531, "Output",ExpressionUUID->"c1c2da44-bc01-456a-b6c1-19bc068a2f35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[598188, 15393, 578, 15, 2463, "Input",ExpressionUUID->"ac1740d7-49b1-4884-9dad-b314ed2aa74b"],
Cell[598769, 15410, 143, 2, 1531, "Output",ExpressionUUID->"fdd81548-be0e-41ac-9dcd-29fd4dfb710b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[598949, 15417, 551, 16, 1639, "Input",ExpressionUUID->"4154ca6c-4323-4b2d-95a2-397d520790fd"],
Cell[599503, 15435, 1583, 23, 4212, "Output",ExpressionUUID->"97477128-3128-430e-9633-f86deb5cb397"]
}, Open  ]],
Cell[CellGroupData[{
Cell[601123, 15463, 1666, 47, 4212, "Input",ExpressionUUID->"5fec6c83-f6de-44cb-9038-1c848d9d9783"],
Cell[602792, 15512, 410, 7, 1531, "Output",ExpressionUUID->"fa3f1ad7-26c7-4125-a421-caade81f00ad"],
Cell[603205, 15521, 53312, 1192, 39051, "Output",ExpressionUUID->"4a76d693-4bf2-4d5b-8a46-8f964ad7e697"]
}, Open  ]],
Cell[CellGroupData[{
Cell[656554, 16718, 444, 8, 1531, "Input",ExpressionUUID->"06dfab6b-c9d6-444b-8652-1d59059e6612"],
Cell[657001, 16728, 92464, 2663, 12912, "Output",ExpressionUUID->"59a14617-2828-4ae7-aca8-607b9845e1cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[749502, 19396, 521, 10, 1531, "Input",ExpressionUUID->"6db7b768-da89-4e5b-9b32-3d627662aada"],
Cell[750026, 19408, 104068, 3137, 13743, "Output",ExpressionUUID->"9313a0b1-e6ea-4bba-9e00-b6a4c50d2203"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[854143, 22551, 129, 1, 85, "Subsection",ExpressionUUID->"8e3dc095-06f6-4419-a325-2367320803aa"],
Cell[854275, 22554, 310, 8, 103, "Input",ExpressionUUID->"6b26fd64-8e2d-4089-812d-fa031bee538a"],
Cell[854588, 22564, 422, 10, 103, "Input",ExpressionUUID->"9c0d4b8a-cd63-4f81-948d-f0f07d65d151"],
Cell[855013, 22576, 469, 10, 103, "Input",ExpressionUUID->"bc216339-34ca-4ea6-a29c-802fd97edc32"],
Cell[855485, 22588, 470, 10, 103, "Input",ExpressionUUID->"8c0ce7f6-182c-4fa2-b614-fd542fbbff67"],
Cell[855958, 22600, 514, 11, 103, "Input",ExpressionUUID->"ec719843-1211-4918-b7e6-0716528e3b04"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[856521, 22617, 95, 1, 225, "Section",ExpressionUUID->"d780a091-c11a-4d6f-b5d7-d473056cf6a4"],
Cell[856619, 22620, 847, 17, 229, "Text",ExpressionUUID->"98bec6a3-cf88-4ae8-8800-a6ed6768eb1a"],
Cell[857469, 22639, 485, 9, 166, "Text",ExpressionUUID->"2c86add8-fcab-499c-ad0c-d7174b5ace8e"],
Cell[857957, 22650, 300, 7, 100, "Text",ExpressionUUID->"91daaf01-f6c5-41ea-94c3-f21645553821"],
Cell[858260, 22659, 363, 11, 109, "Text",ExpressionUUID->"d9af41bd-bcf6-461f-82a9-421ad744c4ea"]
}, Closed]],
Cell[CellGroupData[{
Cell[858660, 22675, 197, 3, 118, "Section",ExpressionUUID->"7ff20e33-80ae-43ab-8021-4a7921524088"],
Cell[CellGroupData[{
Cell[858882, 22682, 478, 9, 171, "Input",ExpressionUUID->"b5894fde-6c6e-473c-8d7c-eb9d85587660"],
Cell[859363, 22693, 945, 25, 105, "Output",ExpressionUUID->"772199de-95e5-4598-b48a-bf6c5a4e844f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[860345, 22723, 500, 10, 103, "Input",ExpressionUUID->"f21f12a5-e2b2-4136-80ec-2b9ddb36e310"],
Cell[860848, 22735, 785, 23, 105, "Output",ExpressionUUID->"803af41e-4e89-479d-9f8c-a49fcae9114d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[861670, 22763, 684, 12, 103, "Input",ExpressionUUID->"0647cf44-9d82-4b9e-8106-fac23ac4df13"],
Cell[862357, 22777, 769, 22, 105, "Output",ExpressionUUID->"b5fb1825-3b0a-446c-a48d-3f5392018e10"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[863175, 22805, 135, 2, 118, "Section",ExpressionUUID->"e9e09cb4-2102-4f0d-83cf-d1abee672928"],
Cell[CellGroupData[{
Cell[863335, 22811, 104, 1, 117, "Subsection",ExpressionUUID->"81082b56-472d-4477-beee-234e1c25406a"],
Cell[863442, 22814, 497, 10, 465, "Program",ExpressionUUID->"62436d5b-9bd7-477f-bcd9-42a43261a072"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

