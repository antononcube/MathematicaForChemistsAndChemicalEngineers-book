(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    207264,       6060]
NotebookOptionsPosition[    189347,       5498]
NotebookOutlinePosition[    190530,       5535]
CellTagsIndexPosition[    190487,       5532]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Chemical Equation Balancing", "Title",
 CellChangeTimes->{{3.441484301148834*^9, 3.441484328702744*^9}, {
  3.441484387080965*^9, 3.4414843950954037`*^9}, {3.460916213295959*^9, 
  3.460916216250139*^9}, {3.4728595615922403`*^9, 3.4728595779679317`*^9}, {
  3.488069501708211*^9, 3.488069519569338*^9}, {3.4880695792795467`*^9, 
  3.488069587618034*^9}, {3.490191124085116*^9, 3.490191126597048*^9}, {
  3.494367726326689*^9, 3.494367735432961*^9}}],

Cell[CellGroupData[{

Cell["Anton Antonov", "Author",
 CellChangeTimes->{{3.4449300945702057`*^9, 3.444930101932673*^9}}],

Cell["book for Wiley 2009-2010", "Institution",
 CellChangeTimes->{{3.44493010505249*^9, 3.444930142250931*^9}, {
  3.460320667598672*^9, 3.460320702010445*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.494366379538574*^9, 3.49436638329675*^9}, 
   3.49512615785741*^9}],

Cell["\<\
In the previous chapter we outlined a method and procedure for parsing a \
chemical equation and the chemicals within it.  The goal of this chapter is \
to take an unbalanced equation which is of limited use, and find the \
coefficients that allow the number of each type of atoms to be the same for \
the reactants as it is for the products.\
\>", "Text",
 CellChangeTimes->{{3.494366922719599*^9, 3.4943670454655848`*^9}, {
   3.494367142634097*^9, 3.494367224369272*^9}, {3.4946354860913563`*^9, 
   3.4946354895205708`*^9}, {3.494636058907886*^9, 3.494636091022848*^9}, {
   3.494637124249434*^9, 3.49463721000806*^9}, {3.4946408175125723`*^9, 
   3.494640868901783*^9}, 3.495126157857689*^9}],

Cell["\<\
When balancing chemical equations, the stoichiometric coefficients w,x,y, and \
z are the variables and the chemicals are the constants; therefore, the \
chemical formulas should not change.  Chemists usually approach equation \
balancing using a trial and error method.  For the following example:\
\>", "Text",
 CellChangeTimes->{{3.494366922719599*^9, 3.4943670454655848`*^9}, {
   3.494367142634097*^9, 3.494367224369272*^9}, {3.4946354860913563`*^9, 
   3.4946354895205708`*^9}, {3.494636058907886*^9, 3.494636091022848*^9}, {
   3.494637124249434*^9, 3.49463721000806*^9}, {3.4946408175125723`*^9, 
   3.494640868901783*^9}, {3.4946410082034807`*^9, 3.4946411075896053`*^9}, {
   3.494641249103856*^9, 3.494641260813241*^9}, 3.495126157857945*^9}],

Cell["w C3H8 + x O2 \[RightArrow] y CO2 + z H2O", "Text",
 CellChangeTimes->{{3.494640959536353*^9, 3.494640981301178*^9}, 
   3.495126157858205*^9}],

Cell["\<\
a typical approach would be view that there is 3 carbons in the reactants, \
and only 1 in the product and that therefore try setting: w = 1, y = 3.  If w \
= 1 then there are 8 hydrogens in the reactants, and therefore z = 4 makes 8 \
hydrogens in the products.  Finally, with y = 3 and z = 4 there are ten total \
hydrogens in the product, making x = 5.  This makes the stoichiometric \
coefficients {w,x,y,z} = {1,5,3,4}, therefore the balanced equation is:\
\>", "Text",
 CellChangeTimes->{{3.494641265876691*^9, 3.4946412769160423`*^9}, {
   3.494641310378405*^9, 3.4946415704450903`*^9}, {3.494641629673675*^9, 
   3.4946416650066977`*^9}, 3.495126157858425*^9}],

Cell["1 C3H8 + 5 O2 \[RightArrow] 3 CO2 + 4 H2O", "Text",
 CellChangeTimes->{{3.494641577909767*^9, 3.4946415875427933`*^9}, 
   3.495126157858646*^9}],

Cell["\<\
With checking, we confirm that on both the left-hand side and the right-hand \
side of the reaction that element tally is {{\"C\", 3}, {\"H\", 8}, {\"O\", \
10}}.\
\>", "Text",
 CellChangeTimes->{{3.494641609593668*^9, 3.4946416138411016`*^9}, {
   3.494641672645954*^9, 3.494641754217581*^9}, 3.495126157858865*^9}],

Cell["\<\
The trial and error method of equation balancing employed by chemists is time \
consuming, and can be more reliably solved if the equations are treated as a \
system of linear equations.  First, we can define an equation that \
corresponds to each element that is present.  Referring to our initial \
unbalanced equation we can see that for propane, oxygen, carbon dioxide, and \
water, there are respectively 3,0,1,0 carbons present for each molecule.  If \
we consider the equation \"C3H8 + O2 = CO2 + H2O\" then \"C3H8 + O2 - CO2 - \
H2O = 0\", making the equation become: 3,0,-1,0.   If we repeat this for \
hydrogen and oxygen we obtain the following matrix:\
\>", "Text",
 CellChangeTimes->{{3.494641609593668*^9, 3.4946416138411016`*^9}, {
   3.494641672645954*^9, 3.494641754217581*^9}, {3.49464182849549*^9, 
   3.494641892725944*^9}, {3.494642036476159*^9, 3.494642052472892*^9}, {
   3.494642117247903*^9, 3.494642212679941*^9}, {3.494642370344585*^9, 
   3.494642440147743*^9}, 3.4951261578591347`*^9, {3.495126555285227*^9, 
   3.4951265793379517`*^9}}],

Cell[BoxData[
 RowBox[{"(", GridBox[{
    {"\"\<w\>\"", "\"\<x\>\"", "\"\<y\>\"", "\"\<z\>\""},
    {"3", "0", 
     RowBox[{"-", "1"}], "0"},
    {"8", "0", "0", 
     RowBox[{"-", "2"}]},
    {"0", "2", 
     RowBox[{"-", "2"}], 
     RowBox[{"-", "1"}]}
   }], ")"}]], "Input",
 CellChangeTimes->{{3.4946426951594963`*^9, 3.494642718084166*^9}, 
   3.495126157860796*^9}],

Cell[CellGroupData[{

Cell["Continuation by Anton", "Subsubsection",
 CellChangeTimes->{{3.495326178248753*^9, 3.4953261812618713`*^9}, {
  3.495326509364358*^9, 3.495326514525958*^9}}],

Cell[TextData[{
 "We have ",
 Cell[BoxData[
  FormBox["118", TraditionalForm]]],
 " chemical elements with each element is associated an integer that is \
element's place in the Periodic table. (That coincides with its atomic \
number.) "
}], "Text",
 CellChangeTimes->{{3.497130958951172*^9, 3.497131027928117*^9}, {
  3.497131096856406*^9, 3.497131175975904*^9}, {3.497131226761054*^9, 
  3.497131255151965*^9}, {3.497131319410468*^9, 3.497131324992296*^9}, {
  3.497131465364436*^9, 3.4971315008484507`*^9}, {3.497131955040616*^9, 
  3.497131978937792*^9}, {3.497132053362199*^9, 3.497132150600257*^9}, {
  3.4971321862188*^9, 3.497132228943673*^9}, {3.49713235028511*^9, 
  3.497132370135668*^9}, {3.497132940812098*^9, 3.497133029183675*^9}, {
  3.497133231896028*^9, 3.497133237609159*^9}}],

Cell[TextData[{
 "Consider a linear vector space of dimension ",
 Cell[BoxData[
  FormBox["118", TraditionalForm]]],
 " denoted as ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckCapitalR]", "118"], TraditionalForm]]],
 ". With each element we associate a coordinate (or axis) in that vector \
space. With ",
 Cell[BoxData[
  FormBox[
   StyleBox["H",
    FontSlant->"Plain"], TraditionalForm]]],
 " we associate the first coordinate, with ",
 Cell[BoxData[
  FormBox["He", TraditionalForm]]],
 " we associate the second, and so forth. We can say that the atomic number \
of the element ",
 Cell[BoxData[
  FormBox[
   StyleBox["el",
    FontSlant->"Italic"], TraditionalForm]]],
 " is the coordinate or axis to which ",
 Cell[BoxData[
  FormBox[
   StyleBox["el",
    FontSlant->"Italic"], TraditionalForm]]],
 " corresponds to."
}], "Text",
 CellChangeTimes->{{3.497133269968709*^9, 3.497133271199779*^9}, {
  3.497133335875113*^9, 3.497133367777815*^9}, {3.49713487300422*^9, 
  3.497134949312367*^9}, {3.497135512203601*^9, 3.497135521473041*^9}, {
  3.4971366570589*^9, 3.497136692520506*^9}, {3.497138109110694*^9, 
  3.4971381783153753`*^9}, {3.497138218827734*^9, 3.497138219865973*^9}, {
  3.497138252305688*^9, 3.497138410144906*^9}, {3.497138648763513*^9, 
  3.497138651658527*^9}, {3.497138714517292*^9, 3.497138716999054*^9}, {
  3.4971422271648397`*^9, 3.4971422420462723`*^9}, {3.497143563316724*^9, 
  3.49714356530619*^9}, {3.497143631338211*^9, 3.497143633353945*^9}}],

Cell[TextData[{
 "Each chemical compound ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]]],
 " can be represented as a vector in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckCapitalR]", "118"], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"v", "(", "c", ")"}], "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "118"]}], TraditionalForm]]],
 ". If the compound has ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "i"], TraditionalForm]]],
 " atoms of the ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]]],
 "-th element (in the Periodic Table) then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"v", "(", "c", ")"}], "i"], "=", 
    SubscriptBox["n", "i"]}], TraditionalForm]]],
 ". For example, for the chemical compound ",
 Cell[BoxData[
  FormBox["C3H8O", TraditionalForm]]],
 " we have"
}], "Text",
 CellChangeTimes->{{3.49713843666825*^9, 3.497138440760583*^9}, {
  3.4971385357953978`*^9, 3.497138539073388*^9}, {3.497138722389475*^9, 
  3.497138743129739*^9}, {3.497139788294282*^9, 3.497139857308668*^9}, {
  3.497139895038623*^9, 3.497139963346484*^9}, {3.4971401399473133`*^9, 
  3.497140195042799*^9}, {3.497143570150659*^9, 3.4971435836673822`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"v", "(", "C3H8O", ")"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "8", ",", "0", ",", "0", ",", "0", ",", "0", ",", "3", ",", "0", ",", 
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "."}]}],
   TraditionalForm]], "Equation",
 CellChangeTimes->{{3.497140199034391*^9, 3.497140214267293*^9}, 
   3.4971403844292192`*^9, 3.4971405088647738`*^9}],

Cell[TextData[{
 "In this example, we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"v", "(", "C3H8O", ")"}], "1"], "=", "8"}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"v", "(", "C3H8O", ")"}], "6"], "=", "3"}], TraditionalForm]]],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"v", "(", "C3H8O", ")"}], "8"], "=", "1"}], TraditionalForm]]],
 ", because ",
 Cell[BoxData[
  FormBox[
   StyleBox["H",
    FontSlant->"Plain"], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   StyleBox["C",
    FontSlant->"Plain"], TraditionalForm]]],
 ", and ",
 Cell[BoxData[
  FormBox[
   StyleBox["O",
    FontSlant->"Plain"], TraditionalForm]]],
 ", have the atomic numbers ",
 Cell[BoxData[
  FormBox["1", TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox["6", TraditionalForm]]],
 ", and ",
 Cell[BoxData[
  FormBox["8", TraditionalForm]]],
 " respectively. Note that if with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["e", "i"], "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "118"]}], TraditionalForm]]],
 " we denote the unit basis vector along the ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]]],
 "-th axis, then we can write ",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "(", "C3H8O", ")"}], TraditionalForm]]],
 " as"
}], "Text",
 CellChangeTimes->{{3.497140544384528*^9, 3.497140707994096*^9}, 
   3.4971417742685757`*^9, {3.4971422149431963`*^9, 3.497142219233316*^9}, {
   3.497142263305715*^9, 3.4971423142335777`*^9}, {3.497142378146089*^9, 
   3.497142512850546*^9}, {3.497143091482328*^9, 3.4971430982366467`*^9}, {
   3.497143589076404*^9, 3.497143592949728*^9}, {3.497143786895542*^9, 
   3.497143788116037*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"v", "(", "C3H8O", ")"}], "=", 
   RowBox[{
    RowBox[{"8", " ", 
     SuperscriptBox["e", "1"]}], "+", 
    RowBox[{"3", 
     SuperscriptBox["e", "6"]}], "+", 
    RowBox[{"1", 
     RowBox[{
      SuperscriptBox["e", "8"], "."}]}]}]}], TraditionalForm]], "Equation",
 CellChangeTimes->{{3.497142471337797*^9, 3.497142488227069*^9}, {
  3.4971425211100903`*^9, 3.4971425660177813`*^9}, {3.497143101157228*^9, 
  3.497143113006188*^9}}],

Cell["\<\
As we can see from the example above, while balancing a chemical equation \
instead of using all chemical elements from the Periodic Table, we can use \
only the elements in that are present in the compounds forming the equation.\
\>", "Text",
 CellChangeTimes->{{3.49714072793427*^9, 3.497140738120974*^9}, {
   3.4971417632709417`*^9, 3.497141858433888*^9}, {3.4971419093166103`*^9, 
   3.4971419560894423`*^9}, {3.497142611558799*^9, 3.4971426350014*^9}, {
   3.4971435198061447`*^9, 3.497143554057231*^9}, 3.4971435977784643`*^9, 
   3.497143638693918*^9}],

Cell["Let use return to the equation ", "Text",
 CellChangeTimes->{{3.497141991881383*^9, 3.49714201323202*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"C3H8", " ", "+", " ", "O2"}], " ", "\[Rule]", " ", 
   RowBox[{"CO2", " ", "+", " ", 
    RowBox[{"H2O", "."}]}]}], TraditionalForm]], "Equation",
 CellChangeTimes->{{3.497141991881383*^9, 3.497142022253069*^9}, 
   3.497142588218602*^9}],

Cell[TextData[{
 "Since this equation has three chemical elements, H, C, and O we can \
consider each term to be a vector in a linear vector space of dimension \
three, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckCapitalR]", "3"], TraditionalForm]]],
 ", with basis vectors {1,0,0}, {0,1,0}, and {0,0,1} that correspond to H, C, \
and O respectively. Then the balancing problem is cast as:"
}], "Text",
 CellChangeTimes->{{3.495325090897067*^9, 3.4953252643414717`*^9}, {
   3.495325419445272*^9, 3.495325432445828*^9}, 3.495326754815296*^9, {
   3.497130951192706*^9, 3.497130954058371*^9}, {3.497142045694476*^9, 
   3.4971420957565603`*^9}, {3.4971431503337917`*^9, 3.497143170525758*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"8"},
       {"3"},
       {"0"}
      }], "\[NoBreak]", ")"}]}], "+", 
   RowBox[{"x", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0"},
       {"0"},
       {"2"}
      }], "\[NoBreak]", ")"}]}]}], "=", 
  RowBox[{
   RowBox[{"y", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0"},
       {"1"},
       {"2"}
      }], "\[NoBreak]", ")"}]}], "+", 
   RowBox[{"z", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"2"},
       {"0"},
       {"1"}
      }], "\[NoBreak]", ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.4953246601108828`*^9, 3.4953248797126293`*^9}, 
   3.495325311421082*^9, {3.495326767473687*^9, 3.4953267723135157`*^9}, {
   3.49714210169489*^9, 3.497142120783032*^9}}],

Cell["This equation can be also written in a matrix form:", "Text",
 CellChangeTimes->{{3.495325413330495*^9, 3.495325458157693*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"8", "0", "0", 
        RowBox[{"-", "2"}]},
       {"3", "0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "2", 
        RowBox[{"-", "2"}], 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ".", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"w"},
       {"x"},
       {"y"},
       {"z"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], "==", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.4953246601108828`*^9, 3.4953248797126293`*^9}, {
   3.495324916508263*^9, 3.495325015023622*^9}, {3.495325586522521*^9, 
   3.495325587680881*^9}, {3.497142133327902*^9, 3.497142153063178*^9}, 
   3.497142185802884*^9}],

Cell["\<\
There are several ways to solve that system of quations. First, because it is \
homogenious we can just find the kernel (null space) of the matrix:\
\>", "Text",
 CellChangeTimes->{{3.495325486861349*^9, 3.4953254968771544`*^9}, {
  3.4953256275975657`*^9, 3.495325745989265*^9}, {3.495326219721349*^9, 
  3.4953262197234173`*^9}, {3.495326261717825*^9, 3.495326264845932*^9}, {
  3.495349991067896*^9, 3.495349991518626*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NullSpace", "[", 
  FormBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"8", "0", "0", 
       RowBox[{"-", "2"}]},
      {"3", "0", 
       RowBox[{"-", "1"}], "0"},
      {"0", "2", 
       RowBox[{"-", "2"}], 
       RowBox[{"-", "1"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   TraditionalForm], "]"}]], "Input",
 CellChangeTimes->{{3.495326221462964*^9, 3.4953262341100273`*^9}, {
  3.4971421650140057`*^9, 3.497142189312501*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1", ",", "5", ",", "3", ",", "4"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.495326235104903*^9, {3.497142168844062*^9, 3.497142189778921*^9}, 
   3.4971429781819677`*^9}]
}, Open  ]],

Cell["\<\
The kernel is of dimension one (it has only one basis vector). From this \
vector we get the solutions {x \[Rule] 5 w, y \[Rule] 3 w, z \[Rule] 4 w}.\
\>", "Text",
 CellChangeTimes->{{3.495326254280451*^9, 3.4953263262377157`*^9}, {
  3.4953263848506613`*^9, 3.495326388894285*^9}}],

Cell["Second, we can evaluate the equation symbolically and get", "Text",
 CellChangeTimes->{{3.495325486861349*^9, 3.4953254968771544`*^9}, {
   3.4953256275975657`*^9, 3.495325745989265*^9}, 3.495326219721349*^9, {
   3.495326779988635*^9, 3.495326780717699*^9}, {3.49532689371049*^9, 
   3.495326899982443*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{
        RowBox[{"8", " ", "w"}], "-", 
        RowBox[{"2", " ", "z"}]}]},
      {
       RowBox[{
        RowBox[{"3", " ", "w"}], "-", "y"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", 
        RowBox[{"2", " ", "y"}], "-", "z"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], "==", 
  FormBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   TraditionalForm]}]], "Input",
 CellChangeTimes->{{3.495325540364162*^9, 3.4953255927038*^9}, {
  3.497142867733725*^9, 3.497142881233199*^9}}],

Cell["The last expression if evaluted gives", "Text",
 CellChangeTimes->{{3.495325908797804*^9, 3.495325954901062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"8", " ", "w"}], "-", 
      RowBox[{"2", " ", "z"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"3", " ", "w"}], "-", "y"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", " ", "x"}], "-", 
      RowBox[{"2", " ", "y"}], "-", "z"}], "}"}]}], "}"}], "\[Equal]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.497143033501067*^9}],

Cell[TextData[{
 "So we convert it to a proper system of equations using ",
 StyleBox["Thread", "Program"],
 " (",
 StyleBox["Flatten", "Program"],
 " is used to convert the matrices into vectors)."
}], "Text",
 CellChangeTimes->{{3.495325965024308*^9, 3.4953259825172157`*^9}, {
  3.496641531627426*^9, 3.49664159092841*^9}, {3.4966418540276814`*^9, 
  3.496641879576789*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          RowBox[{"8", " ", "w"}], "-", 
          RowBox[{"2", " ", "z"}]}]},
        {
         RowBox[{
          RowBox[{"3", " ", "w"}], "-", "y"}]},
        {
         RowBox[{
          RowBox[{"2", " ", "x"}], "-", 
          RowBox[{"2", " ", "y"}], "-", "z"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], "]"}], "\[Equal]", 
   RowBox[{"Flatten", "[", 
    FormBox[
     RowBox[{"(", GridBox[{
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
     TraditionalForm], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.495325540364162*^9, 3.4953255927038*^9}, {
  3.4953257562692327`*^9, 3.495325901378994*^9}, {3.496641597043796*^9, 
  3.4966416053479633`*^9}, {3.4966416602312803`*^9, 3.496641702818591*^9}, {
  3.496641745924656*^9, 3.496641824164082*^9}, {3.497142895646418*^9, 
  3.497142901403607*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"8", " ", "w"}], "-", 
     RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "x"}], "-", 
     RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.496641824765815*^9, 3.497142901935061*^9}]
}, Open  ]],

Cell[TextData[{
 "The last system of equations can be solved using ",
 StyleBox["Solve", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.4953259887200413`*^9, 3.495326014598872*^9}, {
  3.495326082074316*^9, 3.495326086158249*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"8", " ", "w"}], "-", 
       RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "x"}], "-", 
       RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.495326024673387*^9, 3.495326048063389*^9}, {
  3.495326377457944*^9, 3.4953263935860167`*^9}, {3.4971429071780157`*^9, 
  3.49714291766374*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"w", "\[Rule]", 
     FractionBox["z", "4"]}], ",", 
    RowBox[{"x", "\[Rule]", 
     FractionBox[
      RowBox[{"5", " ", "z"}], "4"]}], ",", 
    RowBox[{"y", "\[Rule]", 
     FractionBox[
      RowBox[{"3", " ", "z"}], "4"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.495326049354782*^9, {3.4953263783576107`*^9, 3.495326394425035*^9}, 
   3.4971429183772306`*^9}]
}, Open  ]],

Cell[TextData[{
 "or ",
 StyleBox["Reduce", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.4953260946926937`*^9, 3.495326100180023*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"8", " ", "w"}], "-", 
       RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "x"}], "-", 
       RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"w", ",", "x", ",", "y", ",", "z"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.495326024673387*^9, 3.495326037823812*^9}, 
   3.496641502027357*^9, 3.4966419038756533`*^9, {3.4971429243844233`*^9, 
   3.497142925669776*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "\[Equal]", 
   RowBox[{"5", " ", "w"}]}], "&&", 
  RowBox[{"y", "\[Equal]", 
   RowBox[{"3", " ", "w"}]}], "&&", 
  RowBox[{"z", "\[Equal]", 
   RowBox[{"4", " ", "w"}]}]}]], "Output",
 CellChangeTimes->{{3.4953260317113953`*^9, 3.495326038389226*^9}, 
   3.496641502448237*^9, 3.496641904931367*^9, 3.497142926315628*^9}]
}, Open  ]],

Cell[TextData[{
 "Note that we want positive solutions, so ",
 StyleBox["Reduce", "Program"],
 " should be also given the inequalities"
}], "Text",
 CellChangeTimes->{{3.495326530922511*^9, 3.495326574301208*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"w", ">", "0"}], ",", 
   RowBox[{"x", ">", "0"}], ",", 
   RowBox[{"y", ">", "0"}], ",", 
   RowBox[{"z", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4953265924538307`*^9}],

Cell["\<\
and that the solutions needed have to be integer, or in other words\
\>", "Text",
 CellChangeTimes->{{3.495326604430015*^9, 3.495326609669177*^9}, {
  3.496641248340918*^9, 3.496641272192546*^9}, {3.496641315161943*^9, 
  3.49664131750465*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"8", " ", "w"}], "-", 
       RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "x"}], "-", 
       RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}], ",", 
     RowBox[{"w", " ", ">", " ", "0"}], ",", " ", 
     RowBox[{"x", " ", ">", " ", "0"}], ",", " ", 
     RowBox[{"y", " ", ">", " ", "0"}], ",", " ", 
     RowBox[{"z", " ", ">", " ", "0"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"w", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], "}"}], ",", 
   "Integers"}], "]"}]], "Input",
 CellChangeTimes->{{3.495326614687698*^9, 3.495326620325989*^9}, {
   3.496641274911212*^9, 3.4966412927592363`*^9}, 3.496641461248152*^9, {
   3.496641911380865*^9, 3.496641914128729*^9}, {3.49714293474622*^9, 
   3.497142939860717*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}], "&&", 
  RowBox[{
   RowBox[{"C", "[", "1", "]"}], "\[GreaterEqual]", "1"}], "&&", 
  RowBox[{"w", "\[Equal]", 
   RowBox[{"C", "[", "1", "]"}]}], "&&", 
  RowBox[{"x", "\[Equal]", 
   RowBox[{"5", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}], "&&", 
  RowBox[{"y", "\[Equal]", 
   RowBox[{"3", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}], "&&", 
  RowBox[{"z", "\[Equal]", 
   RowBox[{"4", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}]}]], "Output",
 CellChangeTimes->{3.49664191564799*^9, 3.496641998809461*^9, 
  3.4971429413533983`*^9}]
}, Open  ]],

Cell[TextData[{
 "We can format the last result into a more familiar outlook using the \
function ",
 StyleBox["TraditionalForm", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.496641922703821*^9, 3.496641992600595*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.495326614687698*^9, 3.495326620325989*^9}, {
   3.496641274911212*^9, 3.4966412927592363`*^9}, 3.496641461248152*^9, {
   3.496641911380865*^9, 3.496641914128729*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TagBox["c",
      C], "1"], "\[Element]", 
    TagBox["\[DoubleStruckCapitalZ]",
     Function[{}, Integers]]}], "\[And]", 
   RowBox[{
    SubscriptBox[
     TagBox["c",
      C], "1"], "\[GreaterEqual]", "1"}], "\[And]", 
   RowBox[{"w", "\[LongEqual]", 
    SubscriptBox[
     TagBox["c",
      C], "1"]}], "\[And]", 
   RowBox[{"x", "\[LongEqual]", 
    RowBox[{"5", " ", 
     SubscriptBox[
      TagBox["c",
       C], "1"]}]}], "\[And]", 
   RowBox[{"y", "\[LongEqual]", 
    RowBox[{"3", " ", 
     SubscriptBox[
      TagBox["c",
       C], "1"]}]}], "\[And]", 
   RowBox[{"z", "\[LongEqual]", 
    RowBox[{"4", " ", 
     SubscriptBox[
      TagBox["c",
       C], "1"]}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.495326624160018*^9, {3.496641278733273*^9, 3.496641293064848*^9}, 
   3.496641461633294*^9, 3.496642000047843*^9, 3.497142945783224*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kristen version...", "Subsubsection",
 CellChangeTimes->{{3.495326188350217*^9, 3.495326197485298*^9}}],

Cell[TextData[{
 "We can make these equations more algebraically manageable by using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "'s RowReduce function to perform a Gauss-Jordan elimination:"
}], "Text",
 CellChangeTimes->{{3.4946425878292913`*^9, 3.494642658663433*^9}, 
   3.4951261578610687`*^9, {3.495126588871801*^9, 3.495126642206653*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RowReduce", "[", "\.0b", "]"}], "//", "TraditionalForm"}]], "Input",\

 CellChangeTimes->{{3.494642100201024*^9, 3.4946421032492647`*^9}, {
   3.4946422267469587`*^9, 3.494642306747559*^9}, {3.4946424995089912`*^9, 
   3.494642509433515*^9}, {3.4946428997959642`*^9, 3.494642904684875*^9}, 
   3.495126157861597*^9, 3.495754909016815*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "4"]}]},
     {"0", "1", "0", 
      RowBox[{"-", 
       FractionBox["5", "4"]}]},
     {"0", "0", "1", 
      RowBox[{"-", 
       FractionBox["3", "4"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.49464250235445*^9, 3.494642510546797*^9}, 
   3.494642905556234*^9, 3.495126157862254*^9}]
}, Open  ]],

Cell["Which we may also view as:", "Text",
 CellChangeTimes->{{3.49464280388708*^9, 3.494642807190391*^9}, 
   3.495126157875854*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"w", "0", "0", 
      FractionBox[
       RowBox[{"-", "z"}], "4"]},
     {"0", "x", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "5"}], "z"}], "4"]},
     {"0", "0", 
      RowBox[{"-", "y"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", "z"}], "4"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.4946428108935013`*^9, 3.494642851430152*^9}, {
   3.494642909092525*^9, 3.4946429194840384`*^9}, 3.495126157876498*^9}],

Cell["and obtain the following equations:", "Text",
 CellChangeTimes->{{3.494642741479595*^9, 3.494642780701583*^9}, {
   3.4946428570608883`*^9, 3.4946428733466873`*^9}, {3.494642970373604*^9, 
   3.4946429744932957`*^9}, 3.495126157876748*^9}],

Cell[TextData[{
 "w = ",
 Cell[BoxData[
  FormBox[
   FractionBox["z", "4"], TraditionalForm]], "Input",
  CellChangeTimes->{{3.4946428108935013`*^9, 3.494642851430152*^9}, {
   3.494642909092525*^9, 3.4946429194840384`*^9}}],
 "; x = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"5", "z"}], "4"], ";", " ", 
    RowBox[{"y", " ", "=", " ", 
     FractionBox[
      RowBox[{"3", "z"}], "4"]}]}], TraditionalForm]]],
 ";"
}], "Text",
 CellChangeTimes->{{3.494642980071198*^9, 3.494643094975648*^9}, 
   3.49512615787878*^9}],

Cell["\<\
Since the common denominator for all equations is 4, we set z = 4 and obtain \
1,5,3,4 as the stoichiometric coefficients.\
\>", "Text",
 CellChangeTimes->{{3.494643103445891*^9, 3.4946431591307907`*^9}, 
   3.495126157879467*^9}],

Cell[TextData[{
 "These equations can be solved in a single step using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " functions FindInstance or NullSpace:"
}], "Text",
 CellChangeTimes->{{3.495126708695456*^9, 3.495126734668157*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindInstance", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "*", "3"}], "\[Equal]", "c"}], ",", 
     RowBox[{
      RowBox[{"a", "*", "8"}], "\[Equal]", 
      RowBox[{"d", "*", "2"}]}], ",", 
     RowBox[{
      RowBox[{"b", "*", "2"}], "\[Equal]", 
      RowBox[{
       RowBox[{"c", "*", "2"}], "+", "d"}]}], ",", 
     RowBox[{"a", ">", "0"}], ",", 
     RowBox[{"b", ">", "0"}], ",", 
     RowBox[{"c", ">", "0"}], ",", 
     RowBox[{"d", ">", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", "\[Rule]", "1"}], ",", 
    RowBox[{"b", "\[Rule]", "5"}], ",", 
    RowBox[{"c", "\[Rule]", "3"}], ",", 
    RowBox[{"d", "\[Rule]", "4"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.495126449645589*^9, 3.495126739876889*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NullSpace", "[", 
  RowBox[{"(", GridBox[{
     {"3", "0", 
      RowBox[{"-", "1"}], "0"},
     {"8", "0", "0", 
      RowBox[{"-", "2"}]},
     {"0", "2", 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "1"}]}
    }], ")"}], "]"}]], "Input",
 CellChangeTimes->{{3.495126755062339*^9, 3.4951267575904818`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1", ",", "5", ",", "3", ",", "4"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.495126758457727*^9}]
}, Open  ]],

Cell["\<\
Of course, prior to applying these functions we first must manipulate the \
data-structure of our parsed chemical equations to obtain either the \
appropriate matrix or system of linear equations.\
\>", "Text",
 CellChangeTimes->{{3.495126802613165*^9, 3.495126856353319*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Code",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.4971404770049877`*^9, 3.497140477544924*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"elems", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ElementData", "[", 
      RowBox[{"#", ",", "\"\<Abbreviation\>\""}], "]"}], "&"}], "/@", 
    RowBox[{"ElementData", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemRules", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"elems", "\[Rule]", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "elems", "]"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.497130915986203*^9, 3.497130940649234*^9}, {
  3.49713136240198*^9, 3.497131386937686*^9}, {3.497132375621529*^9, 
  3.497132377060907*^9}, {3.497140221757139*^9, 3.497140256736519*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReplacePart", "[", 
  RowBox[{
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "118"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\"\<C\>\"", "/.", "elemRules"}], ")"}], "\[Rule]", "3"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\"\<H\>\"", "/.", "elemRules"}], ")"}], "\[Rule]", "8"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\"\<O\>\"", "/.", "elemRules"}], ")"}], "\[Rule]", "1"}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.497140268951386*^9, 3.497140375852819*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "8", ",", "0", ",", "0", ",", "0", ",", "0", ",", "3", ",", "0", ",", "1", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.497140285974786*^9, 3.497140376378643*^9}]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"First", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"8", "0", "0", 
           RowBox[{"-", "2"}]},
          {"3", "0", 
           RowBox[{"-", "1"}], "0"},
          {"0", "2", 
           RowBox[{"-", "2"}], 
           RowBox[{"-", "1"}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ".", 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"w"},
          {"x"},
          {"y"},
          {"z"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
      ")"}]}], "\[Equal]", 
    RowBox[{"First", "/@", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
   "]"}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.49714267817132*^9, 3.497142711811309*^9}, {
  3.497142786757299*^9, 3.4971428069689827`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"List", "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"8", " ", "w"}], "-", 
       RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "x"}], "-", 
       RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.497142838369095*^9, 3.4971428527489853`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"8", " ", "w"}], "-", 
        RowBox[{"2", " ", "z"}]}], "\[Equal]", "0"}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"3", " ", "w"}], "-", "y"}], "\[Equal]", "0"}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", 
        RowBox[{"2", " ", "y"}], "-", "z"}], "\[Equal]", "0"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.497142853277583*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["From chemical equations to Diophantine equations", "Section",
 CellChangeTimes->{{3.495405212390325*^9, 3.495405250279579*^9}, 
   3.495421108175516*^9, 3.4958380602681847`*^9}],

Cell["\<\
In the previous chapter we developed a parser for chemical equations. \
\>", "Text",
 CellChangeTimes->{{3.49541672694154*^9, 3.495416744961958*^9}, {
   3.495416806969865*^9, 3.495416818386238*^9}, 3.690037648264978*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", 
  RowBox[{"First", "@", 
   RowBox[{
   "ChemicalEquationParser", "[", "\"\<C3H8 + O2 \[Rule] CO2 + H2O\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495416835640905*^9, 3.495416853883771*^9}, {
  3.495417234462421*^9, 3.495417241388398*^9}, {3.495418132839121*^9, 
  3.495418145148471*^9}}],

Cell[BoxData[
 RowBox[{"Equation", "[", 
  RowBox[{
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"C\"\>", ",", "3"}], "]"}], ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "8"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"O\"\>", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"C\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "2"}], "]"}], ",", "\<\"O\"\>"}], "]"}]}], 
    "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.4954168551199217`*^9, 3.4954171455810833`*^9, {3.495417236783175*^9, 
   3.495417241751844*^9}, 3.495417407147848*^9, 3.495418145782239*^9, 
   3.496095034742488*^9, 3.49659957115958*^9, 3.496600407227724*^9}]
}, Open  ]],

Cell[TextData[{
 "We also explained a function called ",
 StyleBox["MoleculeToAtoms", "Program"],
 " that gives the number of atoms for each element in a molecule. Using these \
functions we are going to construct symbolically the equations that have to \
be satisfied in order the law of conservation of  mass to be satisfied. "
}], "Text",
 CellChangeTimes->{{3.4954177212441874`*^9, 3.495417738810566*^9}, {
   3.495417874910048*^9, 3.495417940289591*^9}, {3.495417994641822*^9, 
   3.4954180002584133`*^9}, {3.495418044810351*^9, 3.495418106938589*^9}, 
   3.6900376527670527`*^9}],

Cell["\<\
First, let us find (symbolically) all elements in the equation:\
\>", "Text",
 CellChangeTimes->{{3.495418110056603*^9, 3.4954181559622803`*^9}, {
  3.495418193725607*^9, 3.49541819856999*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqElements", "=", 
  RowBox[{"Union", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{"eq", ",", "_String", ",", "\[Infinity]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.4954181576079817`*^9, 3.495418183196916*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"O\"\>"}], "}"}]], "Output",\

 CellChangeTimes->{{3.495418178065284*^9, 3.4954181837656307`*^9}, 
   3.4960950366467133`*^9, 3.4965995726027327`*^9, 3.496600407423726*^9}]
}, Open  ]],

Cell[TextData[{
 "Now using the function ",
 StyleBox["MoleculeToAtoms", "Program"],
 " we can find the element break-down of each molecule on each side of the \
equation."
}], "Text",
 CellChangeTimes->{{3.49541821425664*^9, 3.4954182398422823`*^9}, {
  3.495418467004652*^9, 3.4954185012502537`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsElements", "=", 
  RowBox[{"MoleculeToAtoms", "/@", 
   RowBox[{"Apply", "[", 
    RowBox[{"List", ",", 
     RowBox[{"eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495418305948895*^9, 3.495418357323029*^9}, {
  3.495420630293433*^9, 3.495420635996826*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", "8"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"O\"\>", ",", "2"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.49541832918228*^9, 3.495418336451461*^9}, 
   3.495418369984632*^9, 3.4954206364679537`*^9, 3.495420977583152*^9, 
   3.496095037764824*^9, 3.496599575105858*^9, 3.496600407470512*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhsElements", "=", 
  RowBox[{"MoleculeToAtoms", "/@", 
   RowBox[{"Apply", "[", 
    RowBox[{"List", ",", 
     RowBox[{"eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495418305948895*^9, 3.495418385869486*^9}, {
  3.495420643514264*^9, 3.4954206493823147`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.495418386033373*^9, 3.495420649799245*^9, 
  3.495420979083603*^9, 3.4960950395198708`*^9, 3.496599576693963*^9, 
  3.496600407520109*^9}]
}, Open  ]],

Cell[TextData[{
 "Now to/with each molecule-to-atoms break-down we associate an unknown \
coefficient. With the molecules on the LHS we associates ",
 StyleBox["x", "Program"],
 " variables, with the molecules on the RHS we associate ",
 StyleBox["y", "Program"],
 " variables."
}], "Text",
 CellChangeTimes->{{3.495418439757112*^9, 3.495418458634206*^9}, {
  3.4954185088963337`*^9, 3.4954185769216337`*^9}, {3.4954196830723553`*^9, 
  3.495419776266054*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsVars", " ", "=", " ", 
  RowBox[{"ToExpression", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\"\<x\>\"", "<>", 
      RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", 
      RowBox[{"eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495419823361812*^9, 3.495419857821168*^9}, {
  3.495420116673645*^9, 3.4954201170148993`*^9}, {3.496600342580851*^9, 
  3.496600376139502*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "x2"}], "}"}]], "Output",
 CellChangeTimes->{{3.4954198347826242`*^9, 3.495419859049403*^9}, 
   3.4954201178997993`*^9, {3.495420969085347*^9, 3.4954209802490883`*^9}, 
   3.496095040773307*^9, 3.496599579516121*^9, {3.496600367442556*^9, 
   3.4966003766634398`*^9}, 3.496600407587208*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhsVars", " ", "=", " ", 
  RowBox[{"ToExpression", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\"\<y\>\"", "<>", 
      RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", 
      RowBox[{"eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495419823361812*^9, 3.495419857821168*^9}, {
  3.495420116673645*^9, 3.4954201170148993`*^9}, {3.496600342580851*^9, 
  3.4966003986771603`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"y1", ",", "y2"}], "}"}]], "Output",
 CellChangeTimes->{{3.496600388987144*^9, 3.496600407671636*^9}}]
}, Open  ]],

Cell["\<\
Using these variable we multiply the number of atoms in the molecules on each \
side:\
\>", "Text",
 CellChangeTimes->{{3.495420416907255*^9, 3.495420463633919*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsElements", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "*", "#2"}]}],
        "}"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"lhsElements", ",", "lhsVars"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495420465545752*^9, 3.495420469873938*^9}, {
  3.49542051679699*^9, 3.49542062047856*^9}, {3.495420731021122*^9, 
  3.495420731414871*^9}, {3.495420765297761*^9, 3.4954207655593863`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", 
       RowBox[{"3", " ", "x1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", 
       RowBox[{"8", " ", "x1"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"O\"\>", ",", 
      RowBox[{"2", " ", "x2"}]}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.495420593577929*^9, 3.495420621249489*^9}, 
   3.4954206530504293`*^9, 3.495420735866302*^9, {3.4954209620188017`*^9, 
   3.4954209826026373`*^9}, 3.496095043713204*^9, 3.496599583982019*^9, 
   3.49660040774734*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhsElements", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "*", "#2"}]}],
        "}"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"rhsElements", ",", "rhsVars"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495420465545752*^9, 3.495420469873938*^9}, {
   3.49542051679699*^9, 3.49542062047856*^9}, {3.495420655093485*^9, 
   3.4954206612306347`*^9}, 3.495420734183166*^9, {3.495420768512493*^9, 
   3.4954207717801323`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "y1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", 
       RowBox[{"2", " ", "y1"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", 
       RowBox[{"2", " ", "y2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", "y2"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.495420661685028*^9, 3.495420735150128*^9, 3.495420771999271*^9, {
   3.495420963084959*^9, 3.495420983849923*^9}, 3.496095044595851*^9, 
   3.496599585159093*^9, 3.496600407827383*^9}]
}, Open  ]],

Cell["\<\
Because of the law of conservation of mass for each element the number of \
atoms on LHS equals the number of atoms on the RHS. This means that\
\>", "Text",
 CellChangeTimes->{{3.49542027013306*^9, 3.49542030697044*^9}, {
  3.495420355258182*^9, 3.4954203857946672`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"massConservationEquations", "=", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Plus", ",", 
       RowBox[{"Cases", "[", 
        RowBox[{"lhsElements", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e", ",", "n_"}], "}"}], "\[RuleDelayed]", "n"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "==", 
     RowBox[{"Apply", "[", 
      RowBox[{"Plus", ",", 
       RowBox[{"Cases", "[", 
        RowBox[{"rhsElements", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e", ",", "n_"}], "}"}], "\[RuleDelayed]", "n"}], ",", 
         "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"e", ",", "eqElements"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495420778754594*^9, 3.495420868187973*^9}, {
  3.495420902647745*^9, 3.4954209585341463`*^9}, {3.495420996874688*^9, 
  3.4954210822627583`*^9}, {3.4954211283121023`*^9, 3.495421142836052*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"3", " ", "x1"}], "\[Equal]", "y1"}], ",", 
   RowBox[{
    RowBox[{"8", " ", "x1"}], "\[Equal]", 
    RowBox[{"2", " ", "y2"}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x2"}], "\[Equal]", 
    RowBox[{
     RowBox[{"2", " ", "y1"}], "+", "y2"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.495420868601994*^9, {3.4954209157677927`*^9, 3.495421083015793*^9}, {
   3.4954211407353573`*^9, 3.495421143486823*^9}, 3.496095046100089*^9, 
   3.496599587579749*^9, 3.496600407913197*^9}]
}, Open  ]],

Cell["\<\
To these equations we add the requiredment the variables on to be greater \
than zero:\
\>", "Text",
 CellChangeTimes->{{3.495421147640998*^9, 3.4954211902346287`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"positivityOfMass", "=", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", ">", "0"}], "&"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{"lhsVars", ",", "rhsVars"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4954212017581453`*^9, 3.495421248285624*^9}, {
  3.4965999430613213`*^9, 3.49659994848275*^9}, {3.496600164014103*^9, 
  3.4966001679310083`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x1", ">", "0"}], ",", 
   RowBox[{"x2", ">", "0"}], ",", 
   RowBox[{"y1", ">", "0"}], ",", 
   RowBox[{"y2", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.495421225216002*^9, 3.495421249416527*^9}, 
   3.4960950476043663`*^9, 3.496599589602054*^9, 3.49660017031991*^9, 
   3.496600407990089*^9}]
}, Open  ]],

Cell["Finaly, we add the requirement the variables to be integer:", "Text",
 CellChangeTimes->{{3.496599960537601*^9, 3.4965999972733383`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"integersNeeded", "=", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Element]", "Integers"}], "&"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{"lhsVars", ",", "rhsVars"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.496600004780957*^9, 3.496600050773039*^9}, {
  3.496600095282174*^9, 3.496600149963078*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x1", "\[Element]", "Integers"}], ",", 
   RowBox[{"x2", "\[Element]", "Integers"}], ",", 
   RowBox[{"y1", "\[Element]", "Integers"}], ",", 
   RowBox[{"y2", "\[Element]", "Integers"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4966000523681107`*^9, {3.496600136218194*^9, 3.496600150676168*^9}, 
   3.4966004080636177`*^9}]
}, Open  ]],

Cell["We have the system of linear Diophantine equations:", "Text",
 CellChangeTimes->{{3.4954212620076303`*^9, 3.495421285858735*^9}, {
   3.4965995205056477`*^9, 3.496599562233697*^9}, 3.4965997700902576`*^9, {
   3.496640827573894*^9, 3.496640852288423*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Column", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
    "massConservationEquations", ",", "positivityOfMass", ",", " ", 
     "integersNeeded"}], "]"}], "]"}], "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.4966002138922777`*^9, 3.496600218578376*^9}, {
  3.496600435115163*^9, 3.496600705395866*^9}, {3.496600754418243*^9, 
  3.496600856260215*^9}}],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"3", " ", "x1"}], "\[LongEqual]", "y1"}]},
     {
      RowBox[{
       RowBox[{"8", " ", "x1"}], "\[LongEqual]", 
       RowBox[{"2", " ", "y2"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "x2"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"2", " ", "y1"}], "+", "y2"}]}]},
     {
      RowBox[{"x1", ">", "0"}]},
     {
      RowBox[{"x2", ">", "0"}]},
     {
      RowBox[{"y1", ">", "0"}]},
     {
      RowBox[{"y2", ">", "0"}]},
     {
      RowBox[{"x1", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"x2", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"y1", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"y2", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{3.496600857454558*^9}],

Cell[TextData[{
 "We can solve that system using ",
 StyleBox["Reduce", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.49659977391887*^9, 3.496599791201297*^9}, {
  3.496599845809026*^9, 3.496599847417221*^9}, {3.496640713056571*^9, 
  3.4966407134648867`*^9}, {3.496640863348989*^9, 3.4966408692327147`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
    "massConservationEquations", ",", "positivityOfMass", ",", 
     "integersNeeded"}], "]"}], ",", 
   RowBox[{"Join", "[", 
    RowBox[{"lhsVars", ",", "rhsVars"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.495421292787361*^9, 3.4954213290455217`*^9}, {
  3.496599762332799*^9, 3.496599765491088*^9}, {3.496600183592149*^9, 
  3.4966001931561213`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}], "&&", 
  RowBox[{
   RowBox[{"C", "[", "1", "]"}], "\[GreaterEqual]", "1"}], "&&", 
  RowBox[{"x1", "\[Equal]", 
   RowBox[{"C", "[", "1", "]"}]}], "&&", 
  RowBox[{"x2", "\[Equal]", 
   RowBox[{"5", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}], "&&", 
  RowBox[{"y1", "\[Equal]", 
   RowBox[{"3", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}], "&&", 
  RowBox[{"y2", "\[Equal]", 
   RowBox[{"4", " ", 
    RowBox[{"C", "[", "1", "]"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.495421329862859*^9, 3.496095050020131*^9, 3.496599594195408*^9, 
   3.49659979893467*^9, {3.4966001903509407`*^9, 3.4966001940754957`*^9}, 
   3.496600408209393*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["Reduce", "Program"],
 " would return not one but a family of solutions, that is why we can use ",
 StyleBox["FindInstance", "Program"],
 " which will produce only one solution."
}], "Text",
 CellChangeTimes->{{3.495421346324171*^9, 3.495421404658679*^9}, {
  3.4965998823134537`*^9, 3.4965998860608473`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"First", "@", 
   RowBox[{"FindInstance", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"massConservationEquations", ",", "positivityOfMass"}], "]"}], 
     ",", 
     RowBox[{"Join", "[", 
      RowBox[{"lhsVars", ",", "rhsVars"}], "]"}], ",", "Integers"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495421292787361*^9, 3.4954213290455217`*^9}, {
  3.495421406998412*^9, 3.495421414501018*^9}, {3.495421533057827*^9, 
  3.495421535949613*^9}, {3.496599813549547*^9, 3.496599861308826*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x1", "\[Rule]", "2"}], ",", 
   RowBox[{"x2", "\[Rule]", "10"}], ",", 
   RowBox[{"y1", "\[Rule]", "6"}], ",", 
   RowBox[{"y2", "\[Rule]", "8"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.495421415572214*^9, 3.495421536466007*^9, 3.496095050850281*^9, {
   3.496599817403079*^9, 3.496599830449354*^9}, 3.496599862165299*^9, 
   3.496600408408493*^9}]
}, Open  ]],

Cell["\<\
Now we need to place the balancing coefficients found in the original \
equation.\
\>", "Text",
 CellChangeTimes->{{3.495421482139614*^9, 3.495421522396523*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "@", 
  RowBox[{"Riffle", "[", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "#1", "]"}], "<>", 
        RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lhsVars", "/.", "sol"}], ",", 
        RowBox[{"List", "@@", 
         RowBox[{
         "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
       "}"}]}], "]"}], ",", "\"\<+\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495421581052917*^9, 3.495421738837151*^9}}],

Cell[BoxData["\<\"2C3H8+10O2\"\>"], "Output",
 CellChangeTimes->{{3.495421586418426*^9, 3.4954216373687468`*^9}, 
   3.495421703718257*^9, 3.495421739935006*^9, 3.49609505306262*^9, 
   3.496599864884748*^9, 3.496600408477839*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "@", 
  RowBox[{"Riffle", "[", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "#1", "]"}], "<>", 
        RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rhsVars", "/.", "sol"}], ",", 
        RowBox[{"List", "@@", 
         RowBox[{
         "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       "}"}]}], "]"}], ",", "\"\<+\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495421581052917*^9, 3.495421749700992*^9}}],

Cell[BoxData["\<\"6CO2+8H2O\"\>"], "Output",
 CellChangeTimes->{3.495421749899062*^9, 3.496095053899395*^9, 
  3.496599865722805*^9, 3.49660040855505*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "[", 
  RowBox[{"%%", ",", "\"\<->\>\"", ",", "%"}], "]"}]], "Input",
 CellChangeTimes->{{3.4954217575577583`*^9, 3.495421775180483*^9}}],

Cell[BoxData["\<\"2C3H8+10O2->6CO2+8H2O\"\>"], "Output",
 CellChangeTimes->{3.495421775734027*^9, 3.496095055193503*^9, 
  3.496599866337627*^9, 3.496600408649581*^9}]
}, Open  ]],

Cell["\<\
In the following sub-section we are going to encapsulate the steps above into \
a equation balancing function.\
\>", "Text",
 CellChangeTimes->{{3.495421949557976*^9, 3.495421990954748*^9}}],

Cell[CellGroupData[{

Cell["Definition of BalanceEquation", "Subsection",
 CellChangeTimes->{{3.495495325467733*^9, 3.495495365471527*^9}}],

Cell["\<\
In this definition if the non-integer solutions are turned into integer ones \
by finding the Least Common Multiplier (LCM) of the denominators of the \
coefficients found.\
\>", "Text",
 CellChangeTimes->{{3.495422036567007*^9, 3.4954220860194197`*^9}, {
  3.496097432800542*^9, 3.496097451667461*^9}, {3.496097532045644*^9, 
  3.496097553939334*^9}, {3.496097960727977*^9, 3.496097976291526*^9}, {
  3.496098159191964*^9, 3.496098249643773*^9}, {3.4960982861280518`*^9, 
  3.496098305339786*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "FormBalancedEquation", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormBalancedEquation", "[", 
    RowBox[{"eq_", ",", "solRules_", ",", "lhsVars_", ",", "rhsVars_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t1", ",", "t2"}], "}"}], ",", 
     RowBox[{
      RowBox[{"t1", "=", 
       RowBox[{"StringJoin", "@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#1", "\[Equal]", "1"}], ",", "\"\<\>\"", ",", 
                RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
              RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"lhsVars", "/.", "solRules"}], ",", 
              RowBox[{"List", "@@", 
               RowBox[{
               "eq", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
          "\"\< + \>\""}], "]"}]}]}], ";", 
      RowBox[{"t2", "=", 
       RowBox[{"StringJoin", "@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#1", "==", "1"}], ",", "\"\<\>\"", ",", 
                RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
              RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"rhsVars", "/.", "solRules"}], ",", 
              RowBox[{"List", "@@", 
               RowBox[{
               "eq", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
          "\"\< + \>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"t1", ",", "\"\< \[Rule] \>\"", ",", "t2"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4989357345957003`*^9, 3.498935820581505*^9}, {
  3.4989359782568617`*^9, 3.4989359876537943`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "BalanceEquation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BalanceEquation", "[", 
    RowBox[{"eqStr_String", ",", 
     RowBox[{"nInstances_Integer:", "1"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eq", ",", "eqElements", ",", "lhsElements", ",", "rhsElements", ",", 
       "lhsVars", ",", "rhsVars", ",", "x", ",", "y", ",", 
       "massConservationEquations", ",", "positivityOfMass", ",", "sol", ",", 
       "t1", ",", "t2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eq", "=", 
       RowBox[{"First", "@", 
        RowBox[{"ChemicalEquationParser", "[", "eqStr", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eqElements", "=", 
       RowBox[{"Union", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"eq", ",", "_String", ",", "\[Infinity]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lhsElements", "=", 
       RowBox[{"MoleculeToAtoms", "/@", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], ";", 
      RowBox[{"rhsElements", "=", 
       RowBox[{"MoleculeToAtoms", "/@", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lhsVars", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Length", "[", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhsVars", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{"y", ",", " ", 
         RowBox[{"Length", "[", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]}
         ], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lhsElements", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#1", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"#1", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
              "#2"}]}], "}"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"lhsElements", ",", "lhsVars"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rhsElements", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#1", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"#1", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
              "#2"}]}], "}"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"rhsElements", ",", "rhsVars"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"massConservationEquations", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Plus", ",", 
            RowBox[{"Cases", "[", 
             RowBox[{"lhsElements", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"e", ",", "n_"}], "}"}], "\[RuleDelayed]", "n"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "==", 
          RowBox[{"Apply", "[", 
           RowBox[{"Plus", ",", 
            RowBox[{"Cases", "[", 
             RowBox[{"rhsElements", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"e", ",", "n_"}], "}"}], "\[RuleDelayed]", "n"}], ",",
               "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"e", ",", "eqElements"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"positivityOfMass", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"lhsVars", ">", "0"}], "]"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"rhsVars", ">", "0"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"FindInstance", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"massConservationEquations", ",", "positivityOfMass"}], 
          "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{"lhsVars", ",", "rhsVars"}], "]"}], ",", "nInstances"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sol", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LCM", "@@", 
            RowBox[{"Denominator", "/@", 
             RowBox[{"sol", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "All", ",", "2"}], 
              "\[RightDoubleBracket]"}]}]}], ")"}], "*", 
          RowBox[{"sol", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}]}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "sol", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FormBalancedEquation", "[", 
         RowBox[{"eq", ",", "#", ",", "lhsVars", ",", "rhsVars"}], "]"}], 
        "&"}], "/@", "sol"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4960954824045773`*^9, 3.496095508795272*^9}, {
   3.496095807549089*^9, 3.49609583649327*^9}, {3.496095960941073*^9, 
   3.496095979918174*^9}, {3.496096021168044*^9, 3.496096040670946*^9}, {
   3.496096312090186*^9, 3.496096419911319*^9}, {3.496096527069859*^9, 
   3.496096592005118*^9}, {3.496096829587666*^9, 3.496096834630939*^9}, {
   3.496097010650621*^9, 3.496097076056238*^9}, {3.496097131115601*^9, 
   3.496097203827115*^9}, {3.496097803574456*^9, 3.496097810833424*^9}, {
   3.49893557494065*^9, 3.49893571338476*^9}, 3.498935767494238*^9, {
   3.498935835672823*^9, 3.4989358582630568`*^9}, {3.4989359006404743`*^9, 
   3.4989359169240437`*^9}, 3.498935961423913*^9, {3.49893612764958*^9, 
   3.498936174304598*^9}}],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.496096467103195*^9, 3.496096474419446*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<C3H8 + O2 \[Rule] CO2 + H2O\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}}],

Cell[BoxData["\<\"C3H8 + 5O2 \[Rule] 3CO2 + 4H2O\"\>"], "Output",
 CellChangeTimes->{
  3.49609650457718*^9, {3.49609658022738*^9, 3.496096597096369*^9}, 
   3.4960967656115503`*^9, 3.496097209372184*^9, 3.4960978150947237`*^9, 
   3.4966004087752542`*^9, 3.498142730221587*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<HCl + CaCO3 \[Rule] CaCl2 + H2CO3\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}, 
   3.496096622809504*^9, {3.496096691320332*^9, 3.496096733869132*^9}}],

Cell[BoxData["\<\"2HCl + CaCO3 \[Rule] CaCl2 + H2CO3\"\>"], "Output",
 CellChangeTimes->{{3.4960967383914843`*^9, 3.4960967667158537`*^9}, 
   3.4960968373514767`*^9, 3.496097080250703*^9, 3.4960971262343597`*^9, 
   3.496097205579286*^9, 3.4960978139305573`*^9, 3.496600408838656*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<C6H12O6 \[Rule] CO2 + C2H5OH\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}, 
   3.496096622809504*^9, {3.496096691320332*^9, 3.496096733869132*^9}, 
   3.4960976497132607`*^9, {3.4960976909062147`*^9, 3.496097728677278*^9}}],

Cell[BoxData["\<\"C6H12O6 \[Rule] 2CO2 + 2C2H5OH\"\>"], "Output",
 CellChangeTimes->{3.496097729128039*^9, 3.496097816853401*^9, 
  3.4966004089049587`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix method", "Section",
 CellChangeTimes->{{3.494366504100418*^9, 3.494366516252037*^9}}],

Cell["\<\
We are going to repeat some of derivations in the previous section.\
\>", "Text",
 CellChangeTimes->{{3.495421576838735*^9, 3.495421578340529*^9}, {
  3.495494672419786*^9, 3.495494693898367*^9}, {3.495495302034006*^9, 
  3.495495312614584*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", 
  RowBox[{"First", "@", 
   RowBox[{
   "ChemicalEquationParser", "[", "\"\<C3H8 + O2 \[Rule] CO2 + H2O\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495416835640905*^9, 3.495416853883771*^9}, {
  3.495417234462421*^9, 3.495417241388398*^9}, {3.495418132839121*^9, 
  3.495418145148471*^9}}],

Cell[BoxData[
 RowBox[{"Equation", "[", 
  RowBox[{
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"C\"\>", ",", "3"}], "]"}], ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "8"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"O\"\>", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"C\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "2"}], "]"}], ",", "\<\"O\"\>"}], "]"}]}], 
    "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.4954168551199217`*^9, 3.4954171455810833`*^9, {3.495417236783175*^9, 
   3.495417241751844*^9}, 3.495417407147848*^9, 3.495418145782239*^9, 
   3.495495396797106*^9, 3.4965649667750263`*^9, 3.498142788071718*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", 
  RowBox[{"First", "@", 
   RowBox[{
   "ChemicalEquationParser", "[", "\"\<H20+C2O4+MnO4=MnO2+CO2+OH\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{3.498129160468346*^9}],

Cell[BoxData[
 RowBox[{"Equation", "[", 
  RowBox[{
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"H\"\>", ",", "20"}], "]"}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"C\"\>", ",", "2"}], "]"}], ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "4"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Mn\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "4"}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Mn\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"C\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"O\"\>", ",", "\<\"H\"\>"}], "]"}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.498129161020534*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "=", 
  RowBox[{"First", "@", 
   RowBox[{
   "ChemicalEquationParser", "[", "\"\<SiH4 + O2 + H2 -> SiO2 + H2O\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.498140298449381*^9, 3.49814030115057*^9}}],

Cell[BoxData[
 RowBox[{"Equation", "[", 
  RowBox[{
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Si\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "4"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"O\"\>", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{"Replicated", "[", 
       RowBox[{"\<\"H\"\>", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"Mixture", "[", 
    RowBox[{
     RowBox[{"Molecule", "[", 
      RowBox[{"\<\"Si\"\>", ",", 
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"O\"\>", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"Molecule", "[", 
      RowBox[{
       RowBox[{"Replicated", "[", 
        RowBox[{"\<\"H\"\>", ",", "2"}], "]"}], ",", "\<\"O\"\>"}], "]"}]}], 
    "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.498140301639464*^9}]
}, Open  ]],

Cell[TextData[{
 "We also explained a function called ",
 StyleBox["MoleculeToAtoms", "Program"],
 " that gives the number of atoms for each element in a molecule. Using these \
functions we are going to construct symbolically the equations that have to \
be satisfied in order the law of conservation of  mass to be satisfiied. "
}], "Text",
 CellChangeTimes->{{3.4954177212441874`*^9, 3.495417738810566*^9}, {
  3.495417874910048*^9, 3.495417940289591*^9}, {3.495417994641822*^9, 
  3.4954180002584133`*^9}, {3.495418044810351*^9, 3.495418106938589*^9}}],

Cell["\<\
First, let us find (symbolically) all elements in the equation:\
\>", "Text",
 CellChangeTimes->{{3.495418110056603*^9, 3.4954181559622803`*^9}, {
  3.495418193725607*^9, 3.49541819856999*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqElements", "=", 
  RowBox[{"Union", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{"eq", ",", "_String", ",", "\[Infinity]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.4954181576079817`*^9, 3.495418183196916*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>", ",", "\<\"O\"\>"}], "}"}]], "Output",\

 CellChangeTimes->{{3.495418178065284*^9, 3.4954181837656307`*^9}, 
   3.498129163732888*^9, 3.498140303710039*^9, 3.4981427904007483`*^9}]
}, Open  ]],

Cell[TextData[{
 "Now using the function ",
 StyleBox["MoleculeToAtoms", "Program"],
 " we can find the element break-down of each molecule on each side of the \
equation."
}], "Text",
 CellChangeTimes->{{3.49541821425664*^9, 3.4954182398422823`*^9}, {
  3.495418467004652*^9, 3.4954185012502537`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsElements", "=", 
  RowBox[{"MoleculeToAtoms", "/@", 
   RowBox[{"Apply", "[", 
    RowBox[{"List", ",", 
     RowBox[{"eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495418305948895*^9, 3.495418357323029*^9}, {
  3.495420630293433*^9, 3.495420635996826*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", "8"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"O\"\>", ",", "2"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.49541832918228*^9, 3.495418336451461*^9}, 
   3.495418369984632*^9, 3.4954206364679537`*^9, 3.495420977583152*^9, 
   3.49549561056009*^9, 3.498129166082026*^9, 3.498140305516716*^9, {
   3.4981427638643627`*^9, 3.498142791583263*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhsElements", "=", 
  RowBox[{"MoleculeToAtoms", "/@", 
   RowBox[{"Apply", "[", 
    RowBox[{"List", ",", 
     RowBox[{"eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.4954954786335793`*^9, 3.495495484329453*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"C\"\>", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"H\"\>", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"O\"\>", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.495495484644*^9, 3.4954956118798447`*^9, 
  3.498129166734185*^9, 3.498140307697613*^9, 3.4981427925343513`*^9}]
}, Open  ]],

Cell["Let us convert the sides ", "Text",
 CellChangeTimes->{{3.495495500167162*^9, 3.495495511158165*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsElements", "=", 
  RowBox[{"lhsElements", "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"eqElements", "\[Rule]", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495495551276478*^9, 3.4954956054388237`*^9}, {
  3.495495724641716*^9, 3.495495725017829*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "8"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.495495606351377*^9, 3.495495613192547*^9}, 
   3.4954957263214083`*^9, 3.498129168196216*^9, 3.4981403096512136`*^9, {
   3.498142777582094*^9, 3.4981427946145887`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhsElements", "=", 
  RowBox[{"rhsElements", "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"eqElements", "\[Rule]", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.495495551276478*^9, 3.4954956054388237`*^9}, {
  3.495495724641716*^9, 3.495495725017829*^9}, {3.495495866775941*^9, 
  3.4954958727428083`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.495495877329627*^9, 3.498129169296269*^9, 3.4981403109319057`*^9, {
   3.498142778231637*^9, 3.498142795598016*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"zeroVector", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"lhsMat", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"zeroVector", ",", 
       RowBox[{"Rule", "@@@", "#"}]}], "]"}], "&"}], ",", "lhsElements"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rhsMat", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"zeroVector", ",", 
       RowBox[{"Rule", "@@@", "#"}]}], "]"}], "&"}], ",", "rhsElements"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.495495676473526*^9, 3.495495818849799*^9}, {
  3.495495849017317*^9, 3.495495864505928*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4954957140729218`*^9, 3.495495728002872*^9}, 
   3.495495821992504*^9, 3.495495878959988*^9, 3.4981291706682367`*^9, 
   3.498140312400374*^9, {3.498142778817659*^9, 3.498142797023776*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4954957140729218`*^9, 3.495495728002872*^9}, 
   3.495495821992504*^9, 3.495495878959988*^9, 3.4981291706682367`*^9, 
   3.498140312400374*^9, {3.498142778817659*^9, 3.498142797028288*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"lhsMat", ",", 
      RowBox[{"-", "rhsMat"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.495495922019548*^9, 3.495495964608276*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3", "0", 
      RowBox[{"-", "1"}], "0"},
     {"8", "0", "0", 
      RowBox[{"-", "2"}]},
     {"0", "2", 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.49549594370861*^9, 3.4954959652290077`*^9}, 
   3.498129174650301*^9, 3.4981403134342937`*^9, 3.498142798400269*^9}]
}, Open  ]],

Cell[TextData[{
 "We can obtain the space of solutions using ",
 StyleBox["NullSpace", "Program"],
 ":"
}], "Text",
 CellChangeTimes->{{3.495496108151918*^9, 3.495496161203802*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sols", "=", 
  RowBox[{"NullSpace", "[", "mat", "]"}]}]], "Input",
 CellChangeTimes->{{3.4954959707532587`*^9, 3.495495974545376*^9}, {
  3.495496272503681*^9, 3.4954962761218767`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1", ",", "5", ",", "3", ",", "4"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.49549597486364*^9, 3.495496277859447*^9, {3.4981291775886307`*^9, 
   3.498129200213973*^9}, 3.498140316016857*^9, 3.498141799633803*^9, 
   3.498142799882223*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ToString", "[", "#1", "]"}], "<>", 
     RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        ",", 
       RowBox[{"Length", "[", 
        RowBox[{"eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], "]"}], ",", 
     RowBox[{"List", "@@", 
      RowBox[{
      "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.495496285648231*^9, 3.495496452800445*^9}, {
  3.498129272687306*^9, 3.498129274139357*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"1H20\"\>", ",", "\<\"0C2O4\"\>", ",", "\<\"10MnO4\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.495496308874506*^9, 3.495496376680428*^9}, 
   3.495496453387167*^9, 3.4981291870160217`*^9, 3.4981292325805073`*^9, 
   3.498129274865857*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq", "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.495496531326077*^9, 3.4954965388795443`*^9}, {
  3.498129251476913*^9, 3.498129255201706*^9}}],

Cell[BoxData[
 RowBox[{"Mixture", "[", 
  RowBox[{
   RowBox[{"Molecule", "[", 
    RowBox[{"Replicated", "[", 
     RowBox[{"\<\"H\"\>", ",", "20"}], "]"}], "]"}], ",", 
   RowBox[{"Molecule", "[", 
    RowBox[{
     RowBox[{"Replicated", "[", 
      RowBox[{"\<\"C\"\>", ",", "2"}], "]"}], ",", 
     RowBox[{"Replicated", "[", 
      RowBox[{"\<\"O\"\>", ",", "4"}], "]"}]}], "]"}], ",", 
   RowBox[{"Molecule", "[", 
    RowBox[{"\<\"Mn\"\>", ",", 
     RowBox[{"Replicated", "[", 
      RowBox[{"\<\"O\"\>", ",", "4"}], "]"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.495496531733202*^9, 3.495496539412776*^9}, {
  3.498129229957087*^9, 3.498129278013998*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "@", 
  RowBox[{"Riffle", "[", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#1", "\[Equal]", "1"}], ",", "\"\<\>\"", ",", 
          RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
        RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{
          "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"List", "@@", 
         RowBox[{
         "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
       "}"}]}], "]"}], ",", "\"\<+\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495496475686346*^9, 3.495496509073731*^9}, {
  3.495496544484913*^9, 3.495496564796657*^9}, {3.495496624255774*^9, 
  3.495496674948168*^9}}],

Cell[BoxData["\<\"0SiH4+O2+2H2\"\>"], "Output",
 CellChangeTimes->{{3.495496479734684*^9, 3.4954965111397057`*^9}, {
   3.4954965465099993`*^9, 3.495496565845693*^9}, 3.4954966485100527`*^9, 
   3.49549667929247*^9, 3.498129280656152*^9, 3.498142606316839*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "@", 
  RowBox[{"Riffle", "[", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#1", "\[Equal]", "1"}], ",", "\"\<\>\"", ",", 
          RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
        RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{
          "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Length", "[", 
            RowBox[{
            "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}]}]}], "]"}], ",", 
        RowBox[{"List", "@@", 
         RowBox[{
         "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       "}"}]}], "]"}], ",", "\"\<+\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.495496475686346*^9, 3.495496509073731*^9}, {
   3.495496544484913*^9, 3.495496589873445*^9}, 3.495496646271204*^9, 
   3.495496686309737*^9}],

Cell[BoxData["\<\"0SiO2+2H2O\"\>"], "Output",
 CellChangeTimes->{3.4954965904594088`*^9, 3.495496646675235*^9, 
  3.495496686726308*^9, 3.498142607270081*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%%", "<>", "\"\<->\>\"", "<>", "%"}]], "Input",
 CellChangeTimes->{{3.495496593717875*^9, 3.4954966167117023`*^9}}],

Cell[BoxData["\<\"0SiH4+O2+2H2->0SiO2+2H2O\"\>"], "Output",
 CellChangeTimes->{3.495496617293756*^9, 3.49549665024536*^9, 
  3.495496689044094*^9, 3.498142609318158*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition of BalanceEquation", "Subsection",
 CellChangeTimes->{{3.498141545749675*^9, 3.498141580953578*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "FormBalancedEquation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormBalancedEquation", "[", 
    RowBox[{
     RowBox[{"solArg_", "?", "VectorQ"}], ",", "eq_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t1", ",", "t2", ",", 
       RowBox[{"sol", "=", "solArg"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"sol", ",", 
           RowBox[{"{", 
            RowBox[{"_Integer", "..."}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LCM", "@@", 
            RowBox[{"Denominator", "/@", "sol"}]}], ")"}], "*", "sol"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"StringJoin", "@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#1", "\[Equal]", "1"}], ",", "\"\<\>\"", ",", 
                RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
              RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"sol", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "]"}]}], "]"}], ",", 
              RowBox[{"List", "@@", 
               RowBox[{
               "eq", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
          "\"\<+\>\""}], "]"}]}]}], ";", 
      RowBox[{"t2", "=", 
       RowBox[{"StringJoin", "@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#1", "\[Equal]", "1"}], ",", "\"\<\>\"", ",", 
                RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "<>", 
              RowBox[{"MoleculeToString", "[", "#2", "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"sol", ",", 
                RowBox[{"-", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                  "eq", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"List", "@@", 
               RowBox[{
               "eq", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
          "\"\<+\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"t1", ",", "\"\< \[Rule] \>\"", ",", "t2"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.498143490656204*^9, 3.498143552813102*^9}, {
  3.498143588892838*^9, 3.498143638142383*^9}, {3.498159516461771*^9, 
  3.498159554743582*^9}, {3.4981596226164913`*^9, 3.498159651649144*^9}, {
  3.498161561745451*^9, 3.498161606986003*^9}, {3.498161685939777*^9, 
  3.49816176379178*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BalanceEquation", "[", "eqStr_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eq", ",", "eqElements", ",", "lhsElements", ",", "rhsElements", ",", 
       "zeroVector", ",", "lhsMat", ",", "rhsMat", ",", "mat", ",", "sols", 
       ",", "goodSols", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eq", "=", 
       RowBox[{"ChemicalEquationParser", "[", "eqStr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"eq", "===", "$Failed"}], ",", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eq", "=", 
       RowBox[{"First", "[", "eq", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eqElements", "=", 
       RowBox[{"Union", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"eq", ",", "_String", ",", "\[Infinity]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lhsElements", "=", 
       RowBox[{"MoleculeToAtoms", "/@", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhsElements", "=", 
       RowBox[{"MoleculeToAtoms", "/@", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", 
          RowBox[{
          "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lhsElements", "=", 
       RowBox[{"lhsElements", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"eqElements", "\[Rule]", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"rhsElements", "=", 
       RowBox[{"rhsElements", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"eqElements", "\[Rule]", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"zeroVector", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "eqElements", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lhsMat", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{"zeroVector", ",", 
            RowBox[{"Rule", "@@@", "#"}]}], "]"}], "&"}], ",", 
         "lhsElements"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhsMat", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{"zeroVector", ",", 
            RowBox[{"Rule", "@@@", "#"}]}], "]"}], "&"}], ",", 
         "rhsElements"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mat", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Join", "[", 
         RowBox[{"lhsMat", ",", 
          RowBox[{"-", "rhsMat"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"PRINT", "[", 
       RowBox[{"MatrixForm", "[", "mat", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sols", "=", 
       RowBox[{"NullSpace", "[", "mat", "]"}]}], ";", 
      RowBox[{"PRINT", "[", "sols", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sols", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Length", "[", "sols", "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"FormBalancedEquation", "[", 
          RowBox[{
           RowBox[{
           "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "eq"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sols", "]"}], ">", "1"}], "&&", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"sols", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"_", "?", "Negative"}], "|", "0"}], ")"}]}], "]"}]}], 
        ",", 
        RowBox[{
         RowBox[{
          RowBox[{"FormBalancedEquation", "[", 
           RowBox[{"#", ",", "eq"}], "]"}], "&"}], "/@", "sols"}], ",", 
        "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"goodSols", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"sols", ",", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"#", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"_", "?", "Negative"}], "|", "0"}], ")"}]}], "]"}], 
             "&"}]}], "]"}]}], ";", 
         RowBox[{"PRINT", "[", 
          RowBox[{"\"\<goodSols=\>\"", ",", "goodSols"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"goodSols", "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"res", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"FormBalancedEquation", "[", 
               RowBox[{"#", ",", "eq"}], "]"}], "&"}], "/@", "goodSols"}]}], 
           ",", 
           RowBox[{"res", "=", 
            RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"sols", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"sols", ",", "goodSols"}], "]"}]}], ";", 
         RowBox[{"PRINT", "[", 
          RowBox[{"\"\<sols=\>\"", ",", "sols"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "sols", "]"}], "\[Equal]", "1"}], "&&", 
            RowBox[{
             RowBox[{"Length", "[", "goodSols", "]"}], ">", "0"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sols", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"sols", ",", 
               RowBox[{"First", "[", "goodSols", "]"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"mat", "=", 
          RowBox[{"Transpose", "[", "sols", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sols", "=", 
          RowBox[{"LinearProgramming", "[", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
               "mat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}]}], "]"}], ",", "mat", ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "mat", "]"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"VectorQ", "[", 
            RowBox[{"sols", ",", "NumberQ"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sols", "=", 
             RowBox[{"mat", ".", "sols"}]}], ";", 
            RowBox[{"PRINT", "[", "sols", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Join", "[", 
             RowBox[{"res", ",", 
              RowBox[{"{", 
               RowBox[{"FormBalancedEquation", "[", 
                RowBox[{"sols", ",", "eq"}], "]"}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzFsoQwEAxvGzIastKXkaskmMbDSkqCVtI6RYKYTdXGaRS2E5am1ta2Ei
2h5MWi4lkkmStTwoDzqmvIiNtlJbyCUlpZzvPHz9+l7+As1Iq55NEEQuPdj0
2fQo5yVqI2OeKMxb+khV4F+6uFCencOH+2oyG3p7N4VQN5WZD6koWwltIlIF
G2qiavgqIgxQRB3a4XapygFjNyovPLoyb0GWX7sHTydNx/BTPcZS0g7udrDh
vqpdXZJO9/vrxuFZZ2Aa8icCJGyZHFiE1LCT8ZJjcsNy/fMaNCR67uGcdTYC
L4rMCfgi0bzAeNvdFzT/3hJi2mi8y1JBK1bybLD+pnkHTq1I/XDhN0jBrsbQ
NXTLZHHI1xnfYCRDklJJezJk5MNVAacA/vmoZviw/N0BdSFTNzR0T+sgR7De
BwsLw0NwhxckYZK92gK17jQrlPqTHbD0553RNlrsgjFnmQfOeLhr8CCWyzjv
9G3AmuswY9aTRlhFe67QF8B/3Wnb7w==
  "]],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.496096467103195*^9, 3.496096474419446*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<C3H8 + O2 \[Rule] CO2 + H2O\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}}],

Cell[BoxData[
 RowBox[{"{", "\<\"C3H8+5O2 \[Rule] 3CO2+4H2O\"\>", "}"}]], "Output",
 CellChangeTimes->{
  3.49609650457718*^9, {3.49609658022738*^9, 3.496096597096369*^9}, 
   3.4960967656115503`*^9, 3.496097209372184*^9, 3.4960978150947237`*^9, 
   3.4966004087752542`*^9, {3.4981426505606937`*^9, 3.49814270430914*^9}, {
   3.498142855882194*^9, 3.498142856933053*^9}, 3.498142961508222*^9, 
   3.4981437525429707`*^9, 3.498159307680107*^9, 3.4981596559037647`*^9, 
   3.498161791786298*^9, 3.4981645422256393`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<HCl + CaCO3 \[Rule] CaCl2 + H2CO3\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}, 
   3.496096622809504*^9, {3.496096691320332*^9, 3.496096733869132*^9}}],

Cell[BoxData[
 RowBox[{"{", "\<\"2HCl+CaCO3 \[Rule] CaCl2+H2CO3\"\>", "}"}]], "Output",
 CellChangeTimes->{{3.4960967383914843`*^9, 3.4960967667158537`*^9}, 
   3.4960968373514767`*^9, 3.496097080250703*^9, 3.4960971262343597`*^9, 
   3.496097205579286*^9, 3.4960978139305573`*^9, 3.496600408838656*^9, 
   3.498142657131517*^9, {3.498142687137664*^9, 3.498142711615987*^9}, 
   3.498142969981493*^9, 3.4981437546126547`*^9, 3.498159311363941*^9, 
   3.4981617898341007`*^9, 3.498164543171371*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<C6H12O6 \[Rule] CO2 + C2H5OH\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}, 
   3.496096622809504*^9, {3.496096691320332*^9, 3.496096733869132*^9}, 
   3.4960976497132607`*^9, {3.4960976909062147`*^9, 3.496097728677278*^9}}],

Cell[BoxData[
 RowBox[{"{", "\<\"C6H12O6 \[Rule] 2CO2+2C2H5OH\"\>", "}"}]], "Output",
 CellChangeTimes->{3.496097729128039*^9, 3.496097816853401*^9, 
  3.4966004089049587`*^9, 3.4981429722106123`*^9, 3.4981437564749823`*^9, 
  3.498161787419167*^9, 3.498164544103986*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hard cases", "Subsubsection",
 CellChangeTimes->{{3.4981625780292892`*^9, 3.49816258214249*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<H20+C2O4+MnO4=MnO2+CO2+OH\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.496096475971054*^9, 3.496096503821725*^9}, 
   3.496096622809504*^9, {3.496096691320332*^9, 3.496096733869132*^9}, 
   3.4960976497132607`*^9, {3.4960976909062147`*^9, 3.496097728677278*^9}, {
   3.498143767197516*^9, 3.498143770100554*^9}, {3.498161362379715*^9, 
   3.4981613697969646`*^9}, {3.498161811457151*^9, 3.498161812072095*^9}}],

Cell[BoxData[
 RowBox[{"{", "\<\"H20+C2O4+10MnO4 \[Rule] 10MnO2+2CO2+20OH\"\>", 
  "}"}]], "Output",
 CellChangeTimes->{
  3.498160953810936*^9, {3.498160999163237*^9, 3.498161025164032*^9}, {
   3.498161070905033*^9, 3.498161188354484*^9}, 3.498161219458918*^9, {
   3.498161275948311*^9, 3.498161316687622*^9}, {3.498161370471265*^9, 
   3.498161452728449*^9}, 3.498161782257071*^9, 3.4981645492699966`*^9, 
   3.498169965607924*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BalanceEquation", "[", "\"\<SiH4 + O2 + H2 -> SiO2 + H2O\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.498144044655321*^9, 3.498144047217968*^9}, {
   3.498161470796812*^9, 3.498161473897534*^9}, 3.498161665201048*^9, {
   3.498161808876973*^9, 3.498161809567862*^9}}],

Cell[BoxData[
 RowBox[{"{", "\<\"2SiH4+5O2+2H2 \[Rule] 2SiO2+6H2O\"\>", "}"}]], "Output",
 CellChangeTimes->{
  3.498144049660124*^9, 3.49815974708882*^9, {3.49816145533838*^9, 
   3.4981614767819242`*^9}, 3.498161539619947*^9, {3.498161585200551*^9, 
   3.4981616309200077`*^9}, {3.4981616663410797`*^9, 3.49816172494141*^9}, {
   3.498161768271109*^9, 3.498161781266062*^9}, 3.498164551074449*^9, 
   3.49816996684765*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PRINT", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BalanceEquation", "[", 
  "\"\<NH4ClO4 + HNO3 + HCl + H2O \[Rule] HClO4(H2O)2 + N2O + NO + NO2 + \
Cl2\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.498144044655321*^9, 3.498144047217968*^9}, {
   3.498161470796812*^9, 3.498161473897534*^9}, 3.498161665201048*^9, {
   3.498161808876973*^9, 3.498161809567862*^9}, {3.498162598774983*^9, 
   3.49816261463238*^9}, {3.498162681606461*^9, 3.4981628017498493`*^9}, {
   3.498163227991818*^9, 3.498163263584175*^9}, {3.498163564889286*^9, 
   3.498163578731469*^9}, {3.498164585536808*^9, 3.498164585911869*^9}, {
   3.498164937547517*^9, 3.498164966680049*^9}, 3.498169963738401*^9}],

Cell[BoxData[
 RowBox[{"{", "\<\"NH4ClO4+13HNO3+6HCl+H2O \[Rule] \
5HClO4(H2O)2+N2O+11NO+NO2+Cl2\"\>", "}"}]], "Output",
 CellChangeTimes->{{3.49816356887569*^9, 3.498163579174758*^9}, 
   3.498164546926746*^9, 3.498164586873268*^9, {3.498164935666191*^9, 
   3.49816493845019*^9}, 3.498164969809935*^9, {3.4981699641607513`*^9, 
   3.4981699681504097`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Study", "Subsubsection",
 CellChangeTimes->{{3.498162591206856*^9, 3.49816259310996*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmat", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", " ", "1", ",", " ", "2", ",", " ", "0", ",", " ", "2"}], 
       "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "1", ",", " ", 
        RowBox[{"-", "2"}], ",", " ", "1", ",", " ", "0"}], "}"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"nmat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.498144290873225*^9, 3.498144315363865*^9}, {
  3.4981443869344053`*^9, 3.4981443876767597`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {"1", "1"},
     {"2", 
      RowBox[{"-", "2"}]},
     {"0", "1"},
     {"2", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.498144307650197*^9, 3.498144315926877*^9}, 
   3.498144387987173*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nsol", "=", 
   RowBox[{"LinearProgramming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", "nmat", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "nmat", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nmat", ".", "nsol"}]}], "Input",
 CellChangeTimes->{{3.498143863100519*^9, 3.498143869602264*^9}, {
  3.4981442866231833`*^9, 3.498144286747237*^9}, {3.498144333814322*^9, 
  3.49814442578743*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["5", "2"], ",", "1", ",", "1", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.4981443536027317`*^9, 3.498144426216858*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "10", ",", "10", ",", "0", ",", "20"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "2", ",", "0"}], 
      "}"}]}], "}"}], "]"}], ".", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.4981439761924477`*^9, 3.498144010435668*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", "y", ",", 
   RowBox[{"10", " ", "x"}], ",", 
   RowBox[{"10", " ", "x"}], ",", 
   RowBox[{"2", " ", "y"}], ",", 
   RowBox[{"20", " ", "x"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.498143990016658*^9, 3.498144011384927*^9}, 
   3.498144392514926*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "1", ",", " ", "2", ",", " ", "0", ",", " ", "2"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1", ",", " ", 
       RowBox[{"-", "2"}], ",", " ", "1", ",", " ", "0"}], "}"}]}], "}"}], 
   "]"}], ".", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.4981440597484922`*^9, 3.498144072357861*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"y", ",", 
   RowBox[{"x", "+", "y"}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x"}], "-", 
    RowBox[{"2", " ", "y"}]}], ",", "y", ",", 
   RowBox[{"2", " ", "x"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.498144070132464*^9, 3.498144072698614*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Odd cases", "Section",
 CellChangeTimes->{{3.494366528732423*^9, 3.494366531588024*^9}}],

Cell["Multiple solutions", "Subsection",
 CellChangeTimes->{{3.4943674830287533`*^9, 3.494367487689296*^9}, 
   3.494367773490226*^9}],

Cell["Infinite number of solutions", "Subsection",
 CellChangeTimes->{{3.494367496979124*^9, 3.494367503449252*^9}, 
   3.494367774890131*^9}],

Cell["Simultaneous adjustment of all elements is impossible", "Subsection",
 CellChangeTimes->{3.494367597430028*^9}],

Cell["\<\
The number of chemical compounds is greater by one than the number of \
chemical elements\
\>", "Subsection",
 CellChangeTimes->{{3.494367631459696*^9, 3.494367631682509*^9}}],

Cell["Chemical compounds are repeated", "Subsection",
 CellChangeTimes->{{3.494367635066627*^9, 3.494367644649251*^9}, 
   3.494367778706164*^9}],

Cell["\<\
The molecular formula for a compound is a multiple of the molecular formula \
of another compound\
\>", "Subsection",
 CellChangeTimes->{{3.494367693541047*^9, 3.494367694677124*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Existence of solutions", "Section",
 CellChangeTimes->{{3.495838639521722*^9, 3.495838647087055*^9}}],

Cell["\<\
A question that should be answered is under what conditions we have solutions \
of the balancing problem. We showed already how to find the solutions.\
\>", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, {3.496643264187997*^9, 
   3.496643264264138*^9}, 3.496708620209783*^9, {3.4970531456811647`*^9, 
   3.497053173792494*^9}, {3.497053551389126*^9, 3.497053586792392*^9}, {
   3.6900376753708572`*^9, 3.690037683388668*^9}}],

Cell["Mathematically, this question translates to: ", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, 3.496643264187997*^9, {
   3.496703358680395*^9, 3.4967033973804703`*^9}, {3.4967086306475687`*^9, 
   3.496708762566242*^9}, {3.496708885741457*^9, 3.496708962103063*^9}, {
   3.4967090083181543`*^9, 3.496709040549336*^9}, {3.4967090725892897`*^9, 
   3.496709353941852*^9}, {3.49705282977634*^9, 3.4970528318181543`*^9}}],

Cell["\<\
Under what conditions a homogeneous System of Linear Diophantine Equations \
(SLDE) has a solution?\
\>", "Definition",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, 3.496643264187997*^9, {
   3.496703358680395*^9, 3.4967033973804703`*^9}, {3.4967086306475687`*^9, 
   3.496708762566242*^9}, {3.496708885741457*^9, 3.496708962103063*^9}, {
   3.4967090083181543`*^9, 3.496709040549336*^9}, {3.4967090725892897`*^9, 
   3.496709353941852*^9}, {3.49705282977634*^9, 3.497052833712389*^9}, {
   3.497053047479456*^9, 3.4970530582733307`*^9}, {3.497053132572382*^9, 
   3.497053134112158*^9}, {3.49705318126941*^9, 3.497053181673386*^9}, {
   3.497053466635767*^9, 3.497053471103826*^9}}],

Cell["\<\
We are going to answer this question two different ways. The first is direct \
and more intuitive, and it is applied in our implementation of the balancer \
above. The second way to find when a SLDE has solutions involves the so \
called Smith Normal Form (SNF) of an integer matrix that has application in \
areas like Operations research and Combinatorics. Both answers give methods \
how to find solutions of a SLDE.\
\>", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, 3.496643264187997*^9, {
   3.496703358680395*^9, 3.4967033973804703`*^9}, {3.4967086306475687`*^9, 
   3.496708762566242*^9}, {3.496708885741457*^9, 3.496708962103063*^9}, {
   3.4967090083181543`*^9, 3.496709040549336*^9}, {3.4967090725892897`*^9, 
   3.496709353941852*^9}, 3.49705282977634*^9, {3.4970531922885113`*^9, 
   3.497053265809043*^9}}],

Cell[CellGroupData[{

Cell["Intuitive reasoning", "Subsection",
 CellChangeTimes->{{3.49670877522248*^9, 3.496708785997529*^9}}],

Cell["\<\
Given a SLDE there is always an associated System of Linear Equations (SLE) \
that is obtained by removing the restriction the solutions to be integer. \
Therefore, there is a matrix associated with any SLDE. For example, from the \
SLDE\
\>", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.49664107686412*^9}, {
   3.4967088430436087`*^9, 3.4967088724007587`*^9}, {3.4967093950036917`*^9, 
   3.496709541325387*^9}, {3.49677422528563*^9, 3.49677425811236*^9}, {
   3.496776591011956*^9, 3.496776621733761*^9}, {3.496776725237145*^9, 
   3.49677672705363*^9}, {3.496776800534259*^9, 3.4967768015522633`*^9}}],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"3", " ", "x1"}], "\[LongEqual]", "y1"}]},
     {
      RowBox[{
       RowBox[{"8", " ", "x1"}], "\[LongEqual]", 
       RowBox[{"2", " ", "y2"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "x2"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"2", " ", "y1"}], "+", "y2"}]}]},
     {
      RowBox[{"x1", ">", "0"}]},
     {
      RowBox[{"x2", ">", "0"}]},
     {
      RowBox[{"y1", ">", "0"}]},
     {
      RowBox[{"y2", ">", "0"}]},
     {
      RowBox[{"x1", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"x2", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"y1", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]},
     {
      RowBox[{"y2", "\[Element]", 
       TagBox["\[DoubleStruckCapitalZ]",
        Function[{}, Integers]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{3.496600857454558*^9}],

Cell["we can derive the SLE", "Text",
 CellChangeTimes->{{3.4967742650490427`*^9, 3.496774270294115*^9}}],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"3", " ", "x1"}], "\[LongEqual]", "y1"}]},
     {
      RowBox[{
       RowBox[{"8", " ", "x1"}], "\[LongEqual]", 
       RowBox[{"2", " ", "y2"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "x2"}], "\[LongEqual]", 
       RowBox[{
        RowBox[{"2", " ", "y1"}], "+", "y2"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{3.496600857454558*^9, 3.496774541929975*^9}],

Cell["which can be re-written as", "Text",
 CellChangeTimes->{{3.4967745440308313`*^9, 3.496774556949028*^9}}],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"3", " ", "x1"}], "-", "y1"}], "\[LongEqual]", "0"}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"8", " ", "x1"}], "-", 
        RowBox[{"2", " ", "y2"}]}], "\[LongEqual]", "0"}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"2", " ", "x2"}], "-", 
        RowBox[{"2", " ", "y1"}], "-", "y2"}], "\[LongEqual]", "0"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{
  3.496600857454558*^9, {3.496774280391512*^9, 3.4967743103601017`*^9}, {
   3.496774463928652*^9, 3.496774485689286*^9}, 3.4967745291137123`*^9}],

Cell["and in matrix form as", "Text",
 CellChangeTimes->{{3.496774562015469*^9, 3.496774568485174*^9}}],

Cell[BoxData[
 FormBox[
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"3", "0", 
         RowBox[{"-", "1"}], "0"},
        {"8", "0", "0", 
         RowBox[{"-", "2"}]},
        {"0", "2", 
         RowBox[{"-", "2"}], 
         RowBox[{"-", "1"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"x1"},
        {"x2"},
        {"y1"},
        {"y1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
    "\[LongEqual]", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], " ", 
     "."}]}],
   FontWeight->"Plain"], TraditionalForm]], "Equation", "Input",
 CellChangeTimes->{{3.496774662199497*^9, 3.4967746650153427`*^9}, {
  3.496787298450448*^9, 3.4967872984952097`*^9}}],

Cell[TextData[{
 "A homogeneous SLE, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"L", " ", "x"}], " ", "=", " ", "0"}], TraditionalForm]]],
 ", would have multiple non-trivial solutions if determinant of the matrix \
associated with it is ",
 Cell[BoxData[
  FormBox["0", TraditionalForm]]],
 ". Or in other words if the kernel of the matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"ker", "(", "L", ")"}], TraditionalForm]]],
 " has dimensionality higher or equal to one. Any matrix can be transformed \
to an equivalent matrix in a reduced row echelon form through the \
Gauss-Jordan algorithm. (See Appendix \"Mathematical concepts\" Section \
\"Matrices and vectors\".) The operations needed by the Gauss-Jordan \
algorithm when applied to an integer matrix are (i) summing a row with a \
rational number mutiple of another row, or (ii) row exchange (i.e. partial \
pivoting). For example, for the integer matrix"
}], "Text",
 CellChangeTimes->{{3.49677525927*^9, 3.4967753010625687`*^9}, {
   3.496775500221919*^9, 3.496775535683813*^9}, {3.4967768202013187`*^9, 
   3.49677693834603*^9}, {3.4967769832121077`*^9, 3.496777044655251*^9}, {
   3.4969284459878397`*^9, 3.49692850206199*^9}, {3.496928729540782*^9, 
   3.496928770096072*^9}, {3.4969317104941*^9, 3.496931718366609*^9}, {
   3.4969317950829487`*^9, 3.496931849695366*^9}, {3.496932381284421*^9, 
   3.496932440023409*^9}, {3.49693270176283*^9, 3.496932778087648*^9}, {
   3.496934281909647*^9, 3.496934321038722*^9}, {3.496934361352221*^9, 
   3.4969343657427893`*^9}, 3.496935220708069*^9, {3.49693861718407*^9, 
   3.496938662344121*^9}, {3.496938694040639*^9, 3.4969387114082727`*^9}, {
   3.496970048938492*^9, 3.496970114171979*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "b", "c"},
     {"d", "e", "f"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Equation",
 CellChangeTimes->{{3.496934322885666*^9, 3.49693435304957*^9}, {
  3.4969343861490917`*^9, 3.496934464065218*^9}, {3.4969347243251343`*^9, 
  3.496934728993257*^9}, {3.496935275151835*^9, 3.496935305619025*^9}, {
  3.496935357547503*^9, 3.496935379418519*^9}, {3.4969354302302732`*^9, 
  3.496935467930604*^9}, {3.496936440270431*^9, 3.496936525496687*^9}, {
  3.496936624339033*^9, 3.49693663804069*^9}, {3.496937304970496*^9, 
  3.4969373053611794`*^9}, {3.496937387595133*^9, 3.496937389320418*^9}, {
  3.4969386784436817`*^9, 3.496938690034149*^9}, {3.4969543615702057`*^9, 
  3.496954365175675*^9}, {3.496961794931057*^9, 3.496961795579117*^9}, {
  3.496962014136219*^9, 3.496962034881398*^9}, {3.496962775292254*^9, 
  3.496962788587117*^9}, {3.496962823986085*^9, 3.496962826722301*^9}}],

Cell["can be transformed to ", "Text",
 CellChangeTimes->{{3.4969374048358*^9, 3.496937411503316*^9}, {
  3.49693864214074*^9, 3.496938666183855*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "b", "c"},
     {"0", 
      RowBox[{"e", "-", 
       FractionBox[
        RowBox[{"b", " ", "d"}], "a"]}], 
      RowBox[{"f", "-", 
       FractionBox[
        RowBox[{"c", " ", "d"}], "a"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Equation",
 CellChangeTimes->{{3.4969543838415527`*^9, 3.49695438710435*^9}, {
  3.496962041701221*^9, 3.496962046546113*^9}, {3.4969627905973263`*^9, 
  3.4969627960064383`*^9}, {3.496962833547019*^9, 3.4969628361709213`*^9}}],

Cell[TextData[{
 "by adding the to the second row the first row multiplied by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "d"}], "/", "a"}], TraditionalForm]]],
 ". The last matrix can be transformed into"
}], "Text",
 CellChangeTimes->{{3.496937451450314*^9, 3.496937519847328*^9}, {
  3.4969375729673033`*^9, 3.4969375895350027`*^9}, {3.4969628120228033`*^9, 
  3.4969628168774023`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "0", 
      FractionBox[
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "e"}], "-", 
          RowBox[{"b", " ", "f"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"a", " ", "e"}], "-", 
        RowBox[{"b", " ", "d"}]}]]},
     {"0", 
      RowBox[{"e", "-", 
       FractionBox[
        RowBox[{"b", " ", "d"}], "a"]}], 
      RowBox[{"f", "-", 
       FractionBox[
        RowBox[{"c", " ", "d"}], "a"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Equation",
 CellChangeTimes->{{3.496937545596785*^9, 3.49693756917726*^9}, {
   3.496954400107049*^9, 3.4969544039529877`*^9}, {3.496962055955599*^9, 
   3.496962056195443*^9}, 3.496962844592166*^9, {3.496962876836795*^9, 
   3.496962882555036*^9}}],

Cell[TextData[{
 "by adding to the first row the second row multiplied by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "b"}], "/", 
    RowBox[{"(", 
     RowBox[{"e", "-", 
      FractionBox[
       RowBox[{"b", " ", "d"}], "a"]}], ")"}]}], TraditionalForm]]],
 ". The last matrix can be transformed into reduced row echelon form by \
multiplying the first row by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", "a"}], TraditionalForm]]],
 " and the second row by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"e", "-", 
      FractionBox[
       RowBox[{"b", " ", "d"}], "a"]}], ")"}]}], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.49693759381666*^9, 3.496937719425946*^9}, {
  3.4969628964175463`*^9, 3.496962999190229*^9}}],

Cell[BoxData[
 RowBox[{
  FormBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", 
       FractionBox[
        RowBox[{
         RowBox[{"c", " ", "e"}], "-", 
         RowBox[{"b", " ", "f"}]}], 
        RowBox[{
         RowBox[{"a", " ", "e"}], "-", 
         RowBox[{"b", " ", "d"}]}]]},
      {"0", "1", 
       FractionBox[
        RowBox[{
         RowBox[{"c", " ", "d"}], "-", 
         RowBox[{"a", " ", "f"}]}], 
        RowBox[{
         RowBox[{"b", " ", "d"}], "-", 
         RowBox[{"a", " ", "e"}]}]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   TraditionalForm], "."}]], "Equation",
 CellChangeTimes->{
  3.496937356212978*^9, 3.496937728890339*^9, {3.496938567601708*^9, 
   3.496938572041175*^9}, {3.496954409915065*^9, 3.496954412705187*^9}, {
   3.496962064272328*^9, 3.4969620658294487`*^9}, {3.496963003056882*^9, 
   3.496963023812667*^9}}],

Cell["\<\
This last matrix has rational numbers in its last column. The solution of its \
matrix equation is (see Appendix \"Mathematical concepts\" Section \"Systems \
of linear equations\") \
\>", "Text",
 CellChangeTimes->{{3.496938582920455*^9, 3.4969385913035088`*^9}, {
  3.4969387234545794`*^9, 3.496938747720525*^9}, {3.496961755636615*^9, 
  3.49696175725753*^9}, {3.496964556950076*^9, 3.496964585785412*^9}, {
  3.4969650208604183`*^9, 3.4969650292973633`*^9}, {3.4969651245398817`*^9, 
  3.496965124993569*^9}, {3.496968256604622*^9, 3.496968267618595*^9}, {
  3.496968479559958*^9, 3.496968551489786*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"z", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "e"}], "-", 
          RowBox[{"b", " ", "f"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"a", " ", "e"}], "-", 
        RowBox[{"b", " ", "d"}]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"z", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "-", 
          RowBox[{"a", " ", "f"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"b", " ", "d"}], "-", 
        RowBox[{"a", " ", "e"}]}]]}], ",", "z"}], "}"}], "."}], 
  TraditionalForm]], "Equation",
 CellChangeTimes->{{3.496965147198984*^9, 3.496965184531129*^9}, {
   3.4969652891488037`*^9, 3.4969652900284777`*^9}, 3.496965358234866*^9}],

Cell[TextData[{
 "Which if ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]]],
 " is an integer that solution can be always made integer by multiplying ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"b", " ", "d"}], "-", 
    RowBox[{"a", " ", "e"}]}], TraditionalForm]]],
 ", i.e."
}], "Text",
 CellChangeTimes->{{3.496967544544655*^9, 3.496967662890437*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "e"}], "-", 
        RowBox[{"b", " ", "f"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", "z"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "-", 
        RowBox[{"a", " ", "f"}]}], ")"}]}], ",", 
     RowBox[{"z", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", " ", "d"}], "-", 
        RowBox[{"a", " ", "e"}]}], ")"}]}]}], "}"}], "."}], 
  TraditionalForm]], "Equation",
 CellChangeTimes->{{3.496965147198984*^9, 3.496965184531129*^9}, {
   3.4969652891488037`*^9, 3.4969652900284777`*^9}, 3.496965358234866*^9, {
   3.496967672587942*^9, 3.496967692533401*^9}}],

Cell["\<\
From this example we can see that for any integer matrix that comes from a \
balancing problem we can derive an integer solution using the reduced row \
echelon form.\
\>", "Text",
 CellChangeTimes->{{3.49696774597786*^9, 3.496967759025682*^9}, {
   3.496967823199032*^9, 3.496967855865963*^9}, {3.4969681434766817`*^9, 
   3.4969681752903957`*^9}, {3.4969682279379263`*^9, 3.496968239890457*^9}, {
   3.496968761908939*^9, 3.496968782818883*^9}, {3.496968849700437*^9, 
   3.496968896202174*^9}, {3.496968936791922*^9, 3.4969689637140636`*^9}, {
   3.496969071954352*^9, 3.496969073602921*^9}, 3.4969695426907988`*^9, {
   3.496969589638516*^9, 3.49696964648803*^9}, {3.4969697442764*^9, 
   3.496969750970243*^9}, {3.496969784347068*^9, 3.4969697875319347`*^9}, {
   3.496970541426588*^9, 3.496970586156795*^9}, {3.496970690491555*^9, 
   3.496970708448365*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Using Smith normal form", "Subsection",
 CellChangeTimes->{{3.4969703293061657`*^9, 3.496970344602112*^9}}],

Cell[TextData[{
 "First we are going to define ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["SL",
      FontSlant->"Italic"], "k"], "(", "\[DoubleStruckCapitalZ]", ")"}], 
   TraditionalForm]]],
 " as the set of all ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "\[Times]", "k"}], TraditionalForm]]],
 " square matrices with integer entries and determinant ",
 Cell[BoxData[
  FormBox["1", TraditionalForm]]],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", "1"}], TraditionalForm]]],
 ". Let ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", 
     RowBox[{"m", ",", "n"}]], "(", "\[DoubleStruckCapitalZ]", ")"}], 
   TraditionalForm]]],
 " be the set of all ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]]],
 " matrices with integer entries. We also impose the condition ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "\[LessEqual]", "m", "\[LessEqual]", "n"}], TraditionalForm]]],
 " on ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", 
     RowBox[{"m", ",", "n"}]], "(", "\[DoubleStruckCapitalZ]", ")"}], 
   TraditionalForm]]],
 ". With ",
 Cell[BoxData[
  FormBox[
   RowBox[{"D", "=", 
    RowBox[{
     RowBox[{"diag", "(", 
      RowBox[{
       SubscriptBox["d", "1"], ",", 
       SubscriptBox["d", "2"], ",", "\[Ellipsis]", ",", 
       SubscriptBox["d", "m"]}], ")"}], "\[Element]", 
     RowBox[{
      SubscriptBox["M", 
       RowBox[{"m", ",", "n"}]], "(", "\[DoubleStruckCapitalZ]", ")"}]}]}], 
   TraditionalForm]]],
 " we denote the diagonal matrix which has the integer ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["d", "i"], TraditionalForm]]],
 " at its entry ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"i", ",", "i"}], ")"}], TraditionalForm]]],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", "\[Element]", 
    RowBox[{"[", 
     RowBox[{"1", ",", "m"}], "]"}]}], TraditionalForm]]],
 " and all other entries are zero."
}], "Text",
 CellChangeTimes->{{3.496973511880369*^9, 3.49697354740217*^9}, {
  3.497047598017927*^9, 3.497047607231164*^9}, {3.4970476810927153`*^9, 
  3.497047716992898*^9}, {3.497047783115842*^9, 3.497047846160795*^9}, {
  3.497047905803516*^9, 3.497048227353327*^9}, {3.497048270818707*^9, 
  3.497048319432447*^9}, {3.497048468143772*^9, 3.497048625847684*^9}}],

Cell[TextData[{
 StyleBox["Theorem",
  FontWeight->"Bold"],
 ": Let ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "\[Element]", 
    RowBox[{
     SubscriptBox["M", 
      RowBox[{"m", ",", "n"}]], "(", "\[DoubleStruckCapitalZ]", ")"}]}], 
   TraditionalForm]]],
 ". Then there exist the matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{"L", "\[Element]", 
    RowBox[{
     SubscriptBox[
      StyleBox["SL",
       FontSlant->"Italic"], "m"], "(", "\[DoubleStruckCapitalZ]", ")"}]}], 
   TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"R", "\[Element]", 
    RowBox[{
     SubscriptBox[
      StyleBox["SL",
       FontSlant->"Italic"], "n"], "(", "\[DoubleStruckCapitalZ]", ")"}]}], 
   TraditionalForm]]],
 " such that  "
}], "Theorem",
 CellChangeTimes->{{3.4970495644879627`*^9, 3.497049719016959*^9}, {
  3.4970499748809433`*^9, 3.497049979520865*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"L", " ", "A", " ", "R"}], "=", 
    RowBox[{"D", "=", 
     RowBox[{"diag", "(", 
      RowBox[{
       SubscriptBox["d", "1"], ",", 
       SubscriptBox["d", "2"], ",", "\[Ellipsis]", ",", 
       SubscriptBox["d", "s"], ",", "0", ",", "\[Ellipsis]", ",", "0"}], 
      ")"}]}]}], ","}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.4970497351477537`*^9, 3.4970498087231617`*^9}}],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["d", "i"], ">", "0"}], ",", 
    RowBox[{"i", "\[Element]", 
     RowBox[{"[", 
      RowBox[{"1", ",", "s"}], "]"}]}]}], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["d", "i"], TraditionalForm]]],
 " divides ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["d", 
    RowBox[{"i", "+", "1"}]], TraditionalForm]]],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", "\[Element]", 
    RowBox[{"[", 
     RowBox[{"1", ",", 
      RowBox[{"s", "-", "1"}]}], "]"}]}], TraditionalForm]]],
 "."
}], "Theorem",
 CellChangeTimes->{{3.497049810139598*^9, 3.497049923424739*^9}, {
  3.497050153818039*^9, 3.497050166416691*^9}}],

Cell[TextData[{
 "The matrix ",
 Cell[BoxData[
  FormBox["D", TraditionalForm]]],
 " is called the Smith normal form of ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.497050255772545*^9, 3.497050324848048*^9}}],

Cell[TextData[{
 "This theorem can be proved constructively, by giving an algorithm that \
computes the matrices ",
 Cell[BoxData[
  FormBox["L", TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]]],
 ", and ",
 Cell[BoxData[
  FormBox["D", TraditionalForm]]],
 " given a matrix ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]]],
 ". Before giving the algorithm for the proof, let us see how this theorem \
can be used to answer the question  "
}], "Text",
 CellChangeTimes->{{3.497050222671574*^9, 3.497050251871954*^9}, {
  3.497050332290305*^9, 3.4970503823045053`*^9}, {3.497050413038892*^9, 
  3.497050414192205*^9}, {3.497052348266705*^9, 3.4970523601523743`*^9}, {
  3.497052532090869*^9, 3.4970525652881107`*^9}, {3.497052783059305*^9, 
  3.497052805586123*^9}}],

Cell["We have the equation equivalence", "Text",
 CellChangeTimes->{{3.497054319388833*^9, 3.49705431996847*^9}, {
  3.4970774528841763`*^9, 3.4970774627241697`*^9}, {3.497077660702806*^9, 
  3.4970776630440693`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"A", " ", "x"}], "=", " ", 
   RowBox[{
    RowBox[{"0", "\[DoubleLeftRightArrow]", 
     RowBox[{"L", " ", "A", " ", "x"}]}], "=", 
    RowBox[{
     RowBox[{"0", "\[DoubleLeftRightArrow]", 
      RowBox[{"L", " ", "A", " ", "R", " ", "y"}]}], " ", "=", 
     RowBox[{
      RowBox[{"0", "\[DoubleLeftRightArrow]", 
       RowBox[{"D", " ", "y"}]}], "=", "0."}]}]}]}], 
  TraditionalForm]], "Equation",
 CellChangeTimes->{{3.49705432536967*^9, 3.497054351563055*^9}, {
  3.497077407762055*^9, 3.497077469373192*^9}, {3.497077586174941*^9, 
  3.497077586958047*^9}}],

Cell[TextData[{
 "Multiplying the solution of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"D", " ", "y"}], "=", "0"}], TraditionalForm]]],
 " with ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]]],
 " we can find the solution of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "x"}], "=", "0"}], TraditionalForm]]],
 ", i.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    RowBox[{"R", " ", "y"}]}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.497077482223206*^9, 3.4970775240525093`*^9}, {
  3.4970775580843067`*^9, 3.497077653853485*^9}}],

Cell["Definition", "Subsubsection",
 CellChangeTimes->{{3.4969769207330112`*^9, 3.496976935354972*^9}}],

Cell["Examples", "Subsubsection",
 CellChangeTimes->{{3.496977110111141*^9, 3.496977112187179*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Intuitive example (ok, it is not)",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.495838650457703*^9, 3.4958386600755157`*^9}, {
  3.4969703013394957`*^9, 3.496970309434102*^9}, {3.496973939723476*^9, 
  3.4969739432985888`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"(", GridBox[{
      {"3", "0", 
       RowBox[{"-", "1"}], "0"},
      {"8", "0", "0", 
       RowBox[{"-", "2"}]},
      {"0", "2", 
       RowBox[{"-", "2"}], 
       RowBox[{"-", "1"}]}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.495838693647643*^9, 3.4958387048799877`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]2", "[", 
    RowBox[{"3", ",", "1", ",", "2"}], "]"}], ".", 
   RowBox[{"\[Rho]2", "[", 
    RowBox[{"3", ",", "3", ",", "2"}], "]"}], ".", "m", ".", 
   RowBox[{"\[Gamma]2", "[", 
    RowBox[{"4", ",", "1", ",", "2"}], "]"}]}], "//", "MatrixForm"}]], "Input",\

 CellChangeTimes->{{3.495838751833906*^9, 3.495838872592959*^9}, {
   3.495838953041582*^9, 3.4958389532846823`*^9}, 3.495839007471327*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", "0", 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "1"}]},
     {"0", "3", 
      RowBox[{"-", "1"}], "0"},
     {"0", "8", "0", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.495838785106703*^9, 3.4958387946273127`*^9}, 
   3.495838836223324*^9, 3.495838873486455*^9, 3.495838953547147*^9, 
   3.4958390076019077`*^9, 3.4958394447393827`*^9, 3.495839492570321*^9, {
   3.49585183698695*^9, 3.4958518711703043`*^9}, 3.4958519133865023`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]1", "[", 
    RowBox[{"3", ",", "3", ",", "2", ",", 
     RowBox[{"-", "8"}]}], "]"}], ".", 
   RowBox[{"\[Rho]1", "[", 
    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "]"}], ".", "%"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.495838892416288*^9, {3.495839360957964*^9, 3.495839361242997*^9}, {
   3.4958394010922203`*^9, 3.495839489977961*^9}, {3.495851827825564*^9, 
   3.495851831112472*^9}, {3.4958518665809803`*^9, 3.495851866816259*^9}, {
   3.495851906201335*^9, 3.495851906448266*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", "0", 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "1"}]},
     {"0", "3", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "8", 
      RowBox[{"-", "6"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.49583936281548*^9, 3.4958393662810307`*^9}, {
  3.495839414896434*^9, 3.495839418721949*^9}, {3.495839451463491*^9, 
  3.495839493632125*^9}, {3.495851838853869*^9, 3.4958518720680943`*^9}, {
  3.495851907161729*^9, 3.495851914453062*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]2", "[", 
    RowBox[{"3", ",", "1", ",", "3"}], "]"}], ".", 
   RowBox[{"(", 
    RowBox[{"m", ".", 
     RowBox[{"\[Gamma]2", "[", 
      RowBox[{"4", ",", "1", ",", "4"}], "]"}]}], ")"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.495838751833906*^9, 3.495838872592959*^9}, {
   3.495838953041582*^9, 3.4958389532846823`*^9}, 3.495839007471327*^9, {
   3.495839816705674*^9, 3.495839829064962*^9}, {3.495839883732749*^9, 
   3.495839947145605*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "2", 
      RowBox[{"-", "2"}], "0"},
     {
      RowBox[{"-", "2"}], "0", "0", "8"},
     {"0", "0", 
      RowBox[{"-", "1"}], "3"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.495838785106703*^9, 3.4958387946273127`*^9}, 
   3.495838836223324*^9, 3.495838873486455*^9, 3.495838953547147*^9, 
   3.4958390076019077`*^9, 3.4958394447393827`*^9, 3.495839492570321*^9, {
   3.49583981806382*^9, 3.4958398481985493`*^9}, {3.49583988718228*^9, 
   3.495839947281893*^9}, {3.4958400104020967`*^9, 3.4958400243844852`*^9}, {
   3.495840358952897*^9, 3.495840431918358*^9}, {3.4958404694933443`*^9, 
   3.4958404813671923`*^9}, 3.495840529780085*^9, 3.495841039613461*^9, 
   3.495851918168331*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]1", "[", 
    RowBox[{"3", ",", "2", ",", "1", ",", 
     RowBox[{"-", "2"}]}], "]"}], ".", "%"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.495838892416288*^9, {3.495839360957964*^9, 3.495839361242997*^9}, {
   3.4958394010922203`*^9, 3.495839489977961*^9}, {3.495839997466633*^9, 
   3.495840014833107*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "2", 
      RowBox[{"-", "2"}], "0"},
     {"0", 
      RowBox[{"-", "4"}], "4", "8"},
     {"0", "0", 
      RowBox[{"-", "1"}], "3"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.49583936281548*^9, 3.4958393662810307`*^9}, {
   3.495839414896434*^9, 3.495839418721949*^9}, {3.495839451463491*^9, 
   3.495839493632125*^9}, {3.495840008027689*^9, 3.495840025377036*^9}, {
   3.495840360107593*^9, 3.495840432968505*^9}, {3.495840470483831*^9, 
   3.495840482639267*^9}, 3.495840530600025*^9, 3.495841040836158*^9, 
   3.495851919553383*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", ".", 
   RowBox[{"\[Gamma]1", "[", 
    RowBox[{"4", ",", "2", ",", "1", ",", "2"}], "]"}], ".", 
   RowBox[{"\[Gamma]1", "[", 
    RowBox[{"4", ",", "3", ",", "1", ",", 
     RowBox[{"-", "2"}]}], "]"}], ".", 
   RowBox[{"\[Gamma]1", "[", 
    RowBox[{"4", ",", "3", ",", "2", ",", "1"}], "]"}], ".", 
   RowBox[{"\[Gamma]1", "[", 
    RowBox[{"4", ",", "4", ",", "2", ",", "2"}], "]"}], ".", 
   RowBox[{"\[Gamma]1", "[", 
    RowBox[{"4", ",", "4", ",", "3", ",", "3"}], "]"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.495838892416288*^9, {3.495839360957964*^9, 3.495839361242997*^9}, {
   3.4958394010922203`*^9, 3.495839489977961*^9}, {3.495839997466633*^9, 
   3.495840014833107*^9}, {3.495840211050124*^9, 3.4958402245563183`*^9}, {
   3.495840333142819*^9, 3.495840527995595*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", 
      RowBox[{"-", "4"}], "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.4958403551235437`*^9, 3.495840434664427*^9}, {
   3.495840471471014*^9, 3.49584049538101*^9}, 3.4958405315641403`*^9, 
   3.495841042803172*^9, 3.495851921557034*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Rho]2", "[", 
      RowBox[{"3", ",", "2", ",", "3"}], "]"}], ".", "%"}], ")"}], ".", 
   RowBox[{"\[Gamma]2", "[", 
    RowBox[{"4", ",", "3", ",", "2"}], "]"}], ".", 
   RowBox[{"\[Gamma]3", "[", 
    RowBox[{"4", ",", "1"}], "]"}], ".", 
   RowBox[{"\[Gamma]3", "[", 
    RowBox[{"4", ",", "2"}], "]"}], ".", 
   RowBox[{"\[Gamma]3", "[", 
    RowBox[{"4", ",", "3"}], "]"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.495838892416288*^9, {3.495839360957964*^9, 3.495839361242997*^9}, {
   3.4958394010922203`*^9, 3.495839489977961*^9}, {3.495839997466633*^9, 
   3.495840014833107*^9}, {3.495840211050124*^9, 3.4958402245563183`*^9}, {
   3.495840333142819*^9, 3.495840527995595*^9}, {3.4958406972685223`*^9, 
   3.4958407730420113`*^9}, {3.4958410012381763`*^9, 3.495841036346877*^9}, {
   3.495851772329981*^9, 3.4958517795769577`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "4", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4958407747027197`*^9, 3.4958410438321867`*^9, 
  3.4958519228752832`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{
    RowBox[{"\[Rho]2", "[", 
     RowBox[{"3", ",", "2", ",", "3"}], "]"}], ".", 
    RowBox[{"\[Rho]1", "[", 
     RowBox[{"3", ",", "2", ",", "1", ",", 
      RowBox[{"-", "2"}]}], "]"}], ".", 
    RowBox[{"\[Rho]2", "[", 
     RowBox[{"3", ",", "1", ",", "3"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"A", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.4958410684397697`*^9, 3.495841125688878*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1"},
     {"1", "0", "0"},
     {"0", "1", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.49584111830224*^9, 3.495841126326222*^9}, 
   3.495851923801506*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{
    RowBox[{"\[Gamma]2", "[", 
     RowBox[{"4", ",", "1", ",", "4"}], "]"}], ".", 
    RowBox[{"\[Gamma]1", "[", 
     RowBox[{"4", ",", "2", ",", "1", ",", "2"}], "]"}], ".", 
    RowBox[{"\[Gamma]1", "[", 
     RowBox[{"4", ",", "3", ",", "1", ",", 
      RowBox[{"-", "2"}]}], "]"}], ".", 
    RowBox[{"\[Gamma]1", "[", 
     RowBox[{"4", ",", "3", ",", "2", ",", "1"}], "]"}], ".", 
    RowBox[{"\[Gamma]1", "[", 
     RowBox[{"4", ",", "4", ",", "2", ",", "2"}], "]"}], ".", 
    RowBox[{"\[Gamma]1", "[", 
     RowBox[{"4", ",", "4", ",", "3", ",", "3"}], "]"}], ".", 
    RowBox[{"\[Gamma]2", "[", 
     RowBox[{"4", ",", "3", ",", "2"}], "]"}], ".", 
    RowBox[{"\[Gamma]3", "[", 
     RowBox[{"4", ",", "1"}], "]"}], ".", 
    RowBox[{"\[Gamma]3", "[", 
     RowBox[{"4", ",", "2"}], "]"}], ".", 
    RowBox[{"\[Gamma]3", "[", 
     RowBox[{"4", ",", "3"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"B", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.495841131571014*^9, 3.495841172433065*^9}, {
  3.495851762430729*^9, 3.4958517667055883`*^9}, {3.495851932851918*^9, 
  3.495851933306801*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "1"},
     {"0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "5"},
     {"0", 
      RowBox[{"-", "1"}], "0", "3"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "2"}], "4"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.4958411540070477`*^9, 3.495841173187932*^9}, {
  3.495851925643567*^9, 3.495851934018237*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"A", ".", "m", ".", "B"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.495841189778853*^9, 3.49584121273076*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "4", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.495841194272562*^9, 3.495841213166379*^9}, 
   3.49585193613743*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", ".", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "x"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.495856749003105*^9, 3.4958567720496483`*^9}, {
  3.495856812698408*^9, 3.4958568470815687`*^9}, {3.495856898757391*^9, 
  3.495856901449394*^9}, {3.495857003062235*^9, 3.495857005273447*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", 
   RowBox[{"5", " ", "x"}], ",", 
   RowBox[{"3", " ", "x"}], ",", 
   RowBox[{"4", " ", "x"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4958568180321608`*^9, 3.495856847548046*^9}, 
   3.495856901941411*^9, 3.495857006847583*^9}]
}, Open  ]],

Cell[BoxData[
 FormBox["", TraditionalForm]], "Equation"]
}, Closed]],

Cell[CellGroupData[{

Cell["Other formulations", "Subsection",
 CellChangeTimes->{{3.496704587339046*^9, 3.496704590198565*^9}},
 FontSlant->"Italic"],

Cell["\<\
A question that should be answered is under what conditions we have solutions \
of the balancing problem. This question can be answered using each of the \
methods for balancing presented above. \
\>", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, {3.496643264187997*^9, 
   3.496643264264138*^9}}],

Cell["\<\
So, it can be reformulated as (i) under what conditions a System of Linear \
Diophantine Equations (SLDE) has a solution, (ii) under what conditions a \
homogeneous system of linear equations has multiple solutions.\
\>", "Text",
 CellChangeTimes->{{3.496564990077716*^9, 3.4965650723883257`*^9}, {
   3.4965994986622763`*^9, 3.4965995030249977`*^9}, {3.4965999062238083`*^9, 
   3.4965999191369133`*^9}, 3.4966008940869827`*^9, {3.4966406881919622`*^9, 
   3.496640698161242*^9}, {3.49664098132364*^9, 3.496641184064816*^9}, {
   3.496642016964505*^9, 3.496642055040689*^9}, 3.496643264187997*^9, {
   3.496703358680395*^9, 3.4967033973804703`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Code",
 FontSlant->"Italic"]], "Subsection",
 CellChangeTimes->{{3.496937422247843*^9, 3.496937423671081*^9}}],

Cell[CellGroupData[{

Cell["Numeric / Symbolic", "Subsubsection",
 CellChangeTimes->{{3.49696217884359*^9, 3.4969621792491827`*^9}, {
  3.496962212291333*^9, 3.496962220881301*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]1", "[", 
    RowBox[{"2", ",", "2", ",", "1", ",", 
     RowBox[{"-", "2"}]}], "]"}], ".", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "3", "a"},
       {"2", "0", "b"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496934322885666*^9, 3.49693435304957*^9}, {
   3.4969343861490917`*^9, 3.496934464065218*^9}, {3.4969347243251343`*^9, 
   3.496934728993257*^9}, {3.496935275151835*^9, 3.496935305619025*^9}, {
   3.496935357547503*^9, 3.496935379418519*^9}, {3.4969354302302732`*^9, 
   3.496935467930604*^9}, {3.496936440270431*^9, 3.4969365052654667`*^9}, {
   3.4969366428406143`*^9, 3.4969366486481657`*^9}, 3.496937313843198*^9, {
   3.496961901932371*^9, 3.4969619103866158`*^9}, 3.49696196325385*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "3", "a"},
     {"0", 
      RowBox[{"-", "6"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "a"}], "+", "b"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.49693650573041*^9, 3.496936648898156*^9, 3.4969373139811783`*^9, 
   3.496954326097177*^9, {3.4969619111052303`*^9, 3.496961963938654*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]1", "[", 
     RowBox[{"2", ",", "1", ",", "2", ",", 
      RowBox[{"1", "/", "2"}]}], "]"}], ".", "%"}], "//", "MatrixForm"}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.496934322885666*^9, 3.49693435304957*^9}, {
  3.4969343861490917`*^9, 3.496934464065218*^9}, {3.4969347243251343`*^9, 
  3.496934728993257*^9}, {3.496935275151835*^9, 3.496935305619025*^9}, {
  3.496935357547503*^9, 3.496935379418519*^9}, {3.4969354302302732`*^9, 
  3.4969355150243587`*^9}, {3.496935595273752*^9, 3.4969355959776993`*^9}, {
  3.4969619178051558`*^9, 3.496961920906393*^9}, {3.4969619553086987`*^9, 
  3.496961970308013*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", 
      FractionBox["b", "2"]},
     {"0", 
      RowBox[{"-", "6"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "a"}], "+", "b"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.4969354969983387`*^9, 3.496935518330514*^9}, {
   3.4969355746292477`*^9, 3.496935624796317*^9}, 3.496937331230227*^9, 
   3.496954328414557*^9, 3.496954370731696*^9, 3.496961802188335*^9, {
   3.496961914020206*^9, 3.496961970520708*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]3", "[", 
    RowBox[{"2", ",", "2", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "6"}]}], "]"}], ".", "%"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496934322885666*^9, 3.49693435304957*^9}, {
  3.4969343861490917`*^9, 3.496934464065218*^9}, {3.4969347243251343`*^9, 
  3.496934728993257*^9}, {3.496935275151835*^9, 3.496935305619025*^9}, {
  3.496935357547503*^9, 3.496935379418519*^9}, {3.4969354302302732`*^9, 
  3.4969355150243587`*^9}, {3.496935595273752*^9, 3.4969355959776993`*^9}, {
  3.4969373394683447`*^9, 3.496937354752556*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", 
      FractionBox["b", "2"]},
     {"0", "1", 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "a"}], "-", "b"}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.496937356212978*^9, 3.4969543293984823`*^9, 
  3.4969543719149227`*^9, 3.496961931286867*^9, 3.4969619728388033`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "z"}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.496941053650896*^9, 3.4969411068256397`*^9}, {
   3.4969412805750103`*^9, 3.4969413608973618`*^9}, 3.496941404975171*^9, {
   3.496954334166704*^9, 3.49695433565762*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"b", " ", "z"}], "2"], ",", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "a"}], "-", "b"}], ")"}], " ", "z"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.496941059429274*^9, 3.496941107248247*^9}, {
   3.49694128404778*^9, 3.4969413098317137`*^9}, 3.4969413425485764`*^9, {
   3.496941372898877*^9, 3.496941405314891*^9}, 3.496954336245496*^9, 
   3.496954373612808*^9, 3.496961976286837*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%%", ".", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"-", "%"}], ",", "z"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.496941053650896*^9, 3.4969411068256397`*^9}, {
  3.4969412805750103`*^9, 3.496941411392036*^9}, {3.496954341333702*^9, 
  3.496954341595298*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.496941368114143*^9, 3.496941413596499*^9}, 
   3.496954342348949*^9, 3.4969619777864313`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Symbolic", "Subsubsection",
 CellChangeTimes->{{3.496962228096923*^9, 3.4969622293135233`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RowReduce", "[", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"a", "b", "c"},
      {"d", "e", "f"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], "]"}]], "Input",
 CellChangeTimes->{{3.496962103794929*^9, 3.496962153482885*^9}, {
  3.496962235020132*^9, 3.496962249202828*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"c", " ", "e"}], "-", 
       RowBox[{"b", " ", "f"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "b"}], " ", "d"}], "+", 
       RowBox[{"a", " ", "e"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"c", " ", "d"}], "-", 
       RowBox[{"a", " ", "f"}]}], 
      RowBox[{
       RowBox[{"b", " ", "d"}], "-", 
       RowBox[{"a", " ", "e"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.496962126570064*^9, 3.496962153986867*^9}, 
   3.496962367937495*^9, 3.496963208787662*^9, 3.496965222156702*^9, 
   3.49696526679326*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]1", "[", 
    RowBox[{"2", ",", "2", ",", "1", ",", 
     RowBox[{
      RowBox[{"-", "d"}], "/", "a"}]}], "]"}], ".", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "b", "c"},
       {"d", "e", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496962103794929*^9, 3.496962153482885*^9}, {
   3.496962235020132*^9, 3.496962267407762*^9}, {3.49696232844352*^9, 
   3.4969623361072397`*^9}, 3.496962551391591*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "b", "c"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"b", " ", "d"}], "a"]}], "+", "e"}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"c", " ", "d"}], "a"]}], "+", "f"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.49696249035454*^9, {3.49696254147174*^9, 3.4969625707850437`*^9}, {
   3.496962862476273*^9, 3.496962870165341*^9}, 3.496963209006198*^9, 
   3.49696522237283*^9, 3.4969652670232153`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]1", "[", 
     RowBox[{"2", ",", "1", ",", "2", ",", 
      RowBox[{
       RowBox[{"-", "b"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"b", " ", "d"}], "a"]}], "+", "e"}], ")"}]}]}], "]"}], ".", 
    TagBox["%",
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496962376259346*^9, 3.496962448260076*^9}, {
  3.496962852132306*^9, 3.496962860594541*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"a", "0", 
      FractionBox[
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "e"}], "-", 
          RowBox[{"b", " ", "f"}]}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "b"}], " ", "d"}], "+", 
        RowBox[{"a", " ", "e"}]}]]},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"b", " ", "d"}], "a"]}], "+", "e"}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"c", " ", "d"}], "a"]}], "+", "f"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.4969624500579643`*^9, 3.496962494787912*^9, {3.4969625581386213`*^9, 
   3.496962571389324*^9}, {3.4969628633545227`*^9, 3.496962871256918*^9}, 
   3.496963209072934*^9, 3.496965222443266*^9, 3.496965267085396*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]3", "[", 
     RowBox[{"2", ",", "1", ",", 
      RowBox[{"1", "/", "a"}]}], "]"}], ".", 
    TagBox["%",
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496962376259346*^9, 3.496962488086728*^9}, {
  3.496962531803772*^9, 3.4969625657544193`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "e"}], "-", 
        RowBox[{"b", " ", "f"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "b"}], " ", "d"}], "+", 
        RowBox[{"a", " ", "e"}]}]]},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"b", " ", "d"}], "a"]}], "+", "e"}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"c", " ", "d"}], "a"]}], "+", "f"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.496962480778721*^9, 3.496962496069643*^9}, {
   3.49696255922685*^9, 3.496962572739088*^9}, 3.4969632091719522`*^9, 
   3.496965222510899*^9, 3.496965267162842*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]3", "[", 
     RowBox[{"2", ",", "2", ",", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"b", " ", "d"}], "a"]}], "+", "e"}], ")"}]}]}], "]"}], ".", 
    TagBox["%",
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.496962376259346*^9, 3.496962488086728*^9}, 
   3.496962529271698*^9, {3.4969625790935383`*^9, 3.496962581530835*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "e"}], "-", 
        RowBox[{"b", " ", "f"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "b"}], " ", "d"}], "+", 
        RowBox[{"a", " ", "e"}]}]]},
     {"0", "1", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "d"}], "-", 
        RowBox[{"a", " ", "f"}]}], 
       RowBox[{
        RowBox[{"b", " ", "d"}], "-", 
        RowBox[{"a", " ", "e"}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.496962560528318*^9, 3.4969625822049007`*^9}, 
   3.4969632092409487`*^9, 3.4969652225869617`*^9, 3.4969652672276506`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v2", "=", 
  RowBox[{"%", ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "z"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"v", "=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"-", "v2"}], ",", "z"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.496963144709073*^9, 3.49696315110716*^9}, {
  3.496965192388255*^9, 3.496965212989448*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "e"}], "-", 
       RowBox[{"b", " ", "f"}]}], ")"}], " ", "z"}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "b"}], " ", "d"}], "+", 
     RowBox[{"a", " ", "e"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "-", 
       RowBox[{"a", " ", "f"}]}], ")"}], " ", "z"}], 
    RowBox[{
     RowBox[{"b", " ", "d"}], "-", 
     RowBox[{"a", " ", "e"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.4969631524139*^9, 3.496963209322075*^9, 
  3.496965222683735*^9, 3.4969652672988234`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "e"}], "-", 
        RowBox[{"b", " ", "f"}]}], ")"}], " ", "z"}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "b"}], " ", "d"}], "+", 
      RowBox[{"a", " ", "e"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "-", 
        RowBox[{"a", " ", "f"}]}], ")"}], " ", "z"}], 
     RowBox[{
      RowBox[{"b", " ", "d"}], "-", 
      RowBox[{"a", " ", "e"}]}]]}], ",", "z"}], "}"}]], "Output",
 CellChangeTimes->{3.4969631524139*^9, 3.496963209322075*^9, 
  3.496965222683735*^9, 3.496965267344796*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%%%", ".", "v"}], " ", "//", " ", "Simplify"}]], "Input",
 CellChangeTimes->{3.496965217315683*^9, 3.49696526330724*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.4969632093972797`*^9, 3.4969652229180117`*^9, 
  3.4969652674385033`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Det", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "e"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.496964828058463*^9, 3.49696484508317*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "b"}], " ", "d"}], "+", 
  RowBox[{"a", " ", "e"}]}]], "Output",
 CellChangeTimes->{3.4969648459710217`*^9, 3.496965223043648*^9, 
  3.496965267535007*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exercises", "Section",
 CellChangeTimes->{{3.4969682991641808`*^9, 3.4969683047940807`*^9}}],

Cell[CellGroupData[{

Cell["Exercise 1", "Subsection",
 CellChangeTimes->{{3.49696838464402*^9, 3.4969683960186653`*^9}}],

Cell["Show that from the reduced row echelon form", "Text",
 CellChangeTimes->{{3.496968402526688*^9, 3.496968423450523*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["References", "Section",
 CellChangeTimes->{{3.488071372106266*^9, 3.488071377522324*^9}}],

Cell["\<\
[1] Crocker, \"Application of Diophantine Equations to Problems in \
Chemistry\", J. Chem. Educ., 1968, 45 (11), p 731.\
\>", "Text",
 CellChangeTimes->{{3.49436803147502*^9, 3.4943681241230516`*^9}, {
   3.4943681820677233`*^9, 3.494368198086286*^9}, 3.497049537021809*^9}],

Cell["\<\
[2] Campanario, J. M. (1995), \"Automatic 'Balancing' of Chemical \
Equations\", Computers Chem.,19, 85-90.\
\>", "Text",
 CellChangeTimes->{{3.4943678980310097`*^9, 3.494367902851012*^9}, {
  3.494368126610832*^9, 3.49436812689012*^9}}],

Cell["\<\
[*] Software for Chemical Reaction Stoichiometry (CRS), \
http://www.chemical-stoichiometry.net/software.htm .\
\>", "Text",
 CellChangeTimes->{{3.4943679283421373`*^9, 3.494367930834272*^9}, {
  3.4943681534505987`*^9, 3.494368177626903*^9}, {3.497049539567452*^9, 
  3.4970495399356203`*^9}}],

Cell["\<\
[3] Lezebnik, On systems of linear Diophantine equations, (1996).\
\>", "Text",
 CellChangeTimes->{{3.497049137032634*^9, 3.4970491430635147`*^9}, {
  3.4970494989702168`*^9, 3.497049533535409*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Section hyperlinks", "Section",
 CellChangeTimes->{{3.485353070347357*^9, 3.485353083727057*^9}, {
   3.485355500308876*^9, 3.485355503983049*^9}, 3.492904600191969*^9},
 FontSlant->"Italic"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hyperlink", "[", 
  RowBox[{
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Everything is an expression\>\"", ",", "\"\<Text\>\"", ",", 
     RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
   "\"\<paclet:tutorial/EverythingIsAnExpression\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.485352095929475*^9, 3.4853521259369373`*^9}, {
   3.485352163650888*^9, 3.485352210541203*^9}, {3.485352948054144*^9, 
   3.48535299108145*^9}, 3.492904600192778*^9}],

Cell[BoxData[
 TagBox[
  ButtonBox[
   PaneSelectorBox[{False->
    StyleBox["\<\"Everything is an expression\"\>", "Text",
     StripOnInput->False,
     FontSize->12], True->
    StyleBox[
     StyleBox["\<\"Everything is an expression\"\>", "Text",
      StripOnInput->False,
      FontSize->12], "HyperlinkActive"]}, Dynamic[
     CurrentValue["MouseOver"]],
    BaseStyle->{"Hyperlink"},
    BaselinePosition->Baseline,
    FrameMargins->0,
    ImageSize->Automatic],
   BaseStyle->"Link",
   ButtonData->"paclet:tutorial/EverythingIsAnExpression",
   ButtonNote->"paclet:tutorial/EverythingIsAnExpression"],
  Annotation[#, "paclet:tutorial/EverythingIsAnExpression", 
   "Hyperlink"]& ]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.485352090131234*^9, 3.485352126492825*^9}, {
   3.485352165196126*^9, 3.485352210944434*^9}, {3.4853529597516937`*^9, 
   3.485352991262547*^9}, 3.492904600195362*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hyperlink", "[", 
  RowBox[{
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Expressions\>\"", ",", "\"\<Text\>\"", ",", 
     RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
   "\"\<paclet:guide/Expressions\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.485352095929475*^9, 3.4853521259369373`*^9}, {
   3.485352163650888*^9, 3.485352210541203*^9}, {3.485352494551867*^9, 
   3.4853525141209784`*^9}, {3.48535302612949*^9, 3.4853530418168993`*^9}, 
   3.492904600196742*^9}],

Cell[BoxData[
 TagBox[
  ButtonBox[
   PaneSelectorBox[{False->
    StyleBox["\<\"Expressions\"\>", "Text",
     StripOnInput->False,
     FontSize->12], True->
    StyleBox[
     StyleBox["\<\"Expressions\"\>", "Text",
      StripOnInput->False,
      FontSize->12], "HyperlinkActive"]}, Dynamic[
     CurrentValue["MouseOver"]],
    BaseStyle->{"Hyperlink"},
    BaselinePosition->Baseline,
    FrameMargins->0,
    ImageSize->Automatic],
   BaseStyle->"Link",
   ButtonData->"paclet:guide/Expressions",
   ButtonNote->"paclet:guide/Expressions"],
  Annotation[#, "paclet:guide/Expressions", "Hyperlink"]& ]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.485352509925057*^9, 3.485352514443326*^9}, 
   3.485353042296403*^9, 3.492904600197295*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hyperlink", "[", 
  RowBox[{
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Tally\>\"", ",", "\"\<Program\>\""}], "]"}], ",", 
   "\"\<paclet:ref/Tally\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.485352095929475*^9, 3.4853521259369373`*^9}, {
   3.485352163650888*^9, 3.485352210541203*^9}, {3.485352494551867*^9, 
   3.4853525141209784`*^9}, {3.48535302612949*^9, 3.4853530418168993`*^9}, {
   3.485353640381893*^9, 3.485353661874166*^9}, {3.485354034705617*^9, 
   3.4853540593255653`*^9}, {3.48535409811581*^9, 3.485354116666267*^9}, {
   3.492904336418384*^9, 3.492904377272974*^9}, {3.492904448105538*^9, 
   3.492904484588662*^9}, 3.4929046002022457`*^9}],

Cell[BoxData[
 TagBox[
  ButtonBox[
   PaneSelectorBox[{False->
    StyleBox["\<\"Tally\"\>", "Program",
     StripOnInput->False], True->
    StyleBox[
     StyleBox["\<\"Tally\"\>", "Program",
      StripOnInput->False], "HyperlinkActive"]}, Dynamic[
     CurrentValue["MouseOver"]],
    BaseStyle->{"Hyperlink"},
    BaselinePosition->Baseline,
    FrameMargins->0,
    ImageSize->Automatic],
   BaseStyle->"Link",
   ButtonData->"paclet:ref/Tally",
   ButtonNote->"paclet:ref/Tally"],
  Annotation[#, "paclet:ref/Tally", "Hyperlink"]& ]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.48535411704497*^9, {3.4929043452899227`*^9, 3.492904377775836*^9}, {
   3.4929044496532516`*^9, 3.49290448502775*^9}, 3.4929046002058477`*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1265, 1143},
WindowMargins->{{Automatic, 525}, {Automatic, 0}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.5, 1.5 Inherited],
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 14, \
2016)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "BookStylesheet.nb"]], 
   Cell[
    StyleData["Theorem"], MenuSortingValue -> 10000, FontSize -> 16], 
   Cell[
    StyleData["TheoremContinuation"], MenuSortingValue -> 10000, FontSize -> 
    16], 
   Cell[
    StyleData["Equation"], MenuSortingValue -> 10000, FontSize -> 16], 
   Cell[
    StyleData["EquationNumbered"], MenuSortingValue -> 10000, FontSize -> 16], 
   Cell[
    StyleData["Definition"], FontSize -> 16], 
   Cell[
    StyleData["DefinitionContinuation"], FontSize -> 16]}, Visible -> False, 
  FrontEndVersion -> 
  "11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 14, 2016)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 455, 6, 115, "Title"],
Cell[CellGroupData[{
Cell[1047, 32, 99, 1, 55, "Author"],
Cell[1149, 35, 161, 2, 19, "Institution"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1347, 42, 121, 2, 100, "Section"],
Cell[1471, 46, 707, 11, 102, "Text"],
Cell[2181, 59, 763, 11, 102, "Text"],
Cell[2947, 72, 149, 2, 45, "Text"],
Cell[3099, 76, 678, 10, 131, "Text"],
Cell[3780, 88, 151, 2, 45, "Text"],
Cell[3934, 92, 326, 6, 74, "Text"],
Cell[4263, 100, 1076, 16, 188, "Text"],
Cell[5342, 118, 374, 12, 114, "Input"],
Cell[CellGroupData[{
Cell[5741, 134, 163, 2, 37, "Subsubsection"],
Cell[5907, 138, 796, 15, 74, "Text"],
Cell[6706, 155, 1500, 38, 106, "Text"],
Cell[8209, 195, 1253, 37, 78, "Text"],
Cell[9465, 234, 1583, 26, 127, "Equation"],
Cell[11051, 262, 1780, 63, 106, "Text"],
Cell[12834, 327, 484, 14, 41, "Equation"],
Cell[13321, 343, 570, 9, 102, "Text"],
Cell[13894, 354, 112, 1, 45, "Text"],
Cell[14009, 357, 285, 7, 36, "Equation"],
Cell[14297, 366, 710, 13, 106, "Text"],
Cell[15010, 381, 815, 30, 90, "Input"],
Cell[15828, 413, 133, 1, 45, "Text"],
Cell[15964, 416, 2069, 58, 110, "Input"],
Cell[18036, 476, 436, 7, 74, "Text"],
Cell[CellGroupData[{
Cell[18497, 487, 862, 24, 90, "Input"],
Cell[19362, 513, 236, 6, 46, "Output"]
}, Open  ]],
Cell[19613, 522, 292, 5, 74, "Text"],
Cell[19908, 529, 314, 4, 45, "Text"],
Cell[20225, 535, 1523, 46, 90, "Input"],
Cell[21751, 583, 119, 1, 45, "Text"],
Cell[21873, 586, 586, 20, 46, "Output"],
Cell[22462, 608, 377, 9, 81, "Text"],
Cell[CellGroupData[{
Cell[22864, 621, 1889, 52, 90, "Input"],
Cell[24756, 675, 458, 15, 46, "Output"]
}, Open  ]],
Cell[25229, 693, 234, 6, 52, "Text"],
Cell[CellGroupData[{
Cell[25488, 703, 706, 20, 46, "Input"],
Cell[26197, 725, 447, 14, 63, "Output"]
}, Open  ]],
Cell[26659, 742, 140, 5, 52, "Text"],
Cell[CellGroupData[{
Cell[26824, 751, 708, 20, 46, "Input"],
Cell[27535, 773, 362, 9, 46, "Output"]
}, Open  ]],
Cell[27912, 785, 213, 5, 52, "Text"],
Cell[28128, 792, 233, 7, 46, "Output"],
Cell[28364, 801, 254, 5, 45, "Text"],
Cell[CellGroupData[{
Cell[28643, 810, 1019, 26, 76, "Input"],
Cell[29665, 838, 630, 18, 46, "Output"]
}, Open  ]],
Cell[30310, 859, 224, 6, 52, "Text"],
Cell[CellGroupData[{
Cell[30559, 869, 254, 4, 46, "Input"],
Cell[30816, 875, 946, 34, 40, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31811, 915, 109, 1, 37, "Subsubsection"],
Cell[31923, 918, 354, 7, 373, "Text"],
Cell[CellGroupData[{
Cell[32302, 929, 373, 7, 202, "Input"],
Cell[32678, 938, 908, 27, 648, "Output"]
}, Open  ]],
Cell[33601, 968, 133, 2, 225, "Text"],
Cell[33737, 972, 956, 28, 667, "Input"],
Cell[34696, 1002, 245, 3, 225, "Text"],
Cell[34944, 1007, 549, 19, 297, "Text"],
Cell[35496, 1028, 240, 5, 225, "Text"],
Cell[35739, 1035, 241, 6, 225, "Text"],
Cell[CellGroupData[{
Cell[36005, 1045, 622, 19, 202, "Input"],
Cell[36630, 1066, 305, 8, 202, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36972, 1079, 334, 11, 433, "Input"],
Cell[37309, 1092, 159, 4, 202, "Output"]
}, Open  ]],
Cell[37483, 1099, 286, 5, 373, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[37806, 1109, 136, 2, 38, "Subsection"],
Cell[37945, 1113, 673, 17, 76, "Input"],
Cell[CellGroupData[{
Cell[38643, 1134, 597, 17, 46, "Input"],
Cell[39243, 1153, 1360, 19, 134, "Output"]
}, Open  ]],
Cell[40618, 1175, 2215, 61, 110, "Input"],
Cell[CellGroupData[{
Cell[42858, 1240, 550, 17, 46, "Input"],
Cell[43411, 1259, 970, 30, 90, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44442, 1296, 183, 2, 100, "Section"],
Cell[44628, 1300, 231, 4, 45, "Text"],
Cell[CellGroupData[{
Cell[44884, 1308, 334, 8, 46, "Input"],
Cell[45221, 1318, 1086, 28, 76, "Output"]
}, Open  ]],
Cell[46322, 1349, 585, 10, 109, "Text"],
Cell[46910, 1361, 203, 4, 45, "Text"],
Cell[CellGroupData[{
Cell[47138, 1369, 238, 5, 46, "Input"],
Cell[47379, 1376, 251, 5, 46, "Output"]
}, Open  ]],
Cell[47645, 1384, 302, 7, 81, "Text"],
Cell[CellGroupData[{
Cell[47972, 1395, 349, 8, 46, "Input"],
Cell[48324, 1405, 534, 14, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48895, 1424, 351, 8, 46, "Input"],
Cell[49249, 1434, 575, 17, 46, "Output"]
}, Open  ]],
Cell[49839, 1454, 460, 10, 81, "Text"],
Cell[CellGroupData[{
Cell[50324, 1468, 543, 13, 46, "Input"],
Cell[50870, 1483, 341, 6, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51248, 1494, 545, 13, 46, "Input"],
Cell[51796, 1509, 141, 3, 46, "Output"]
}, Open  ]],
Cell[51952, 1515, 175, 4, 45, "Text"],
Cell[CellGroupData[{
Cell[52152, 1523, 762, 18, 46, "Input"],
Cell[52917, 1543, 652, 18, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53606, 1566, 792, 19, 46, "Input"],
Cell[54401, 1587, 684, 20, 46, "Output"]
}, Open  ]],
Cell[55100, 1610, 282, 5, 74, "Text"],
Cell[CellGroupData[{
Cell[55407, 1619, 1056, 25, 134, "Input"],
Cell[56466, 1646, 549, 15, 46, "Output"]
}, Open  ]],
Cell[57030, 1664, 178, 4, 45, "Text"],
Cell[CellGroupData[{
Cell[57233, 1672, 428, 10, 76, "Input"],
Cell[57664, 1684, 356, 9, 46, "Output"]
}, Open  ]],
Cell[58035, 1696, 143, 1, 45, "Text"],
Cell[CellGroupData[{
Cell[58203, 1701, 388, 9, 76, "Input"],
Cell[58594, 1712, 378, 9, 46, "Output"]
}, Open  ]],
Cell[58987, 1724, 261, 3, 45, "Text"],
Cell[59251, 1729, 398, 9, 46, "Input"],
Cell[59652, 1740, 1229, 43, 366, "EquationNumbered"],
Cell[60884, 1785, 313, 7, 52, "Text"],
Cell[CellGroupData[{
Cell[61222, 1796, 449, 11, 46, "Input"],
Cell[61674, 1809, 734, 20, 46, "Output"]
}, Open  ]],
Cell[62423, 1832, 335, 7, 81, "Text"],
Cell[CellGroupData[{
Cell[62783, 1843, 556, 13, 76, "Input"],
Cell[63342, 1858, 405, 10, 46, "Output"]
}, Open  ]],
Cell[63762, 1871, 171, 4, 45, "Text"],
Cell[CellGroupData[{
Cell[63958, 1879, 615, 17, 76, "Input"],
Cell[64576, 1898, 230, 3, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64843, 1906, 615, 17, 76, "Input"],
Cell[65461, 1925, 154, 2, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65652, 1932, 174, 3, 46, "Input"],
Cell[65829, 1937, 167, 2, 46, "Output"]
}, Open  ]],
Cell[66011, 1942, 200, 4, 45, "Text"],
Cell[CellGroupData[{
Cell[66236, 1950, 117, 1, 52, "Subsection"],
Cell[66356, 1953, 508, 9, 74, "Text"],
Cell[66867, 1964, 2342, 60, 279, "Input"],
Cell[69212, 2026, 6764, 161, 656, "Input"],
Cell[CellGroupData[{
Cell[76001, 2191, 95, 1, 37, "Subsubsection"],
Cell[CellGroupData[{
Cell[76121, 2196, 171, 3, 46, "Input"],
Cell[76295, 2201, 278, 4, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76610, 2210, 249, 4, 46, "Input"],
Cell[76862, 2216, 285, 3, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77184, 2224, 320, 5, 46, "Input"],
Cell[77507, 2231, 156, 2, 46, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77736, 2241, 98, 1, 100, "Section"],
Cell[77837, 2244, 255, 5, 45, "Text"],
Cell[CellGroupData[{
Cell[78117, 2253, 334, 8, 46, "Input"],
Cell[78454, 2263, 1089, 28, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79580, 2296, 210, 6, 46, "Input"],
Cell[79793, 2304, 1148, 31, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80978, 2340, 236, 6, 46, "Input"],
Cell[81217, 2348, 950, 26, 105, "Output"]
}, Open  ]],
Cell[82182, 2377, 556, 9, 109, "Text"],
Cell[82741, 2388, 203, 4, 45, "Text"],
Cell[CellGroupData[{
Cell[82969, 2396, 238, 5, 46, "Input"],
Cell[83210, 2403, 249, 5, 46, "Output"]
}, Open  ]],
Cell[83474, 2411, 302, 7, 81, "Text"],
Cell[CellGroupData[{
Cell[83801, 2422, 349, 8, 46, "Input"],
Cell[84153, 2432, 585, 15, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84775, 2452, 302, 7, 46, "Input"],
Cell[85080, 2461, 549, 16, 46, "Output"]
}, Open  ]],
Cell[85644, 2480, 107, 1, 45, "Text"],
Cell[CellGroupData[{
Cell[85776, 2485, 398, 10, 46, "Input"],
Cell[86177, 2497, 495, 14, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86709, 2516, 449, 11, 46, "Input"],
Cell[87161, 2529, 524, 17, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87722, 2551, 813, 24, 105, "Input"],
Cell[88538, 2577, 403, 9, 46, "Output"],
Cell[88944, 2588, 403, 9, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89384, 2602, 327, 8, 76, "Input"],
Cell[89714, 2612, 859, 24, 90, "Output"]
}, Open  ]],
Cell[90588, 2639, 181, 5, 52, "Text"],
Cell[CellGroupData[{
Cell[90794, 2648, 209, 4, 46, "Input"],
Cell[91006, 2654, 305, 7, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91348, 2666, 759, 21, 46, "Input"],
Cell[92110, 2689, 288, 6, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92435, 2700, 214, 4, 46, "Input"],
Cell[92652, 2706, 675, 17, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93364, 2728, 1096, 29, 105, "Input"],
Cell[94463, 2759, 260, 3, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94760, 2767, 1126, 30, 105, "Input"],
Cell[95889, 2799, 158, 2, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96084, 2806, 139, 2, 46, "Input"],
Cell[96226, 2810, 169, 2, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96432, 2817, 117, 1, 52, "Subsection"],
Cell[96552, 2820, 3505, 88, 366, "Input"],
Cell[100060, 2910, 8430, 207, 1120, "Input"],
Cell[CellGroupData[{
Cell[108515, 3121, 95, 1, 37, "Subsubsection"],
Cell[CellGroupData[{
Cell[108635, 3126, 171, 3, 46, "Input"],
Cell[108809, 3131, 517, 8, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109363, 3144, 249, 4, 46, "Input"],
Cell[109615, 3150, 497, 7, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110149, 3162, 320, 5, 46, "Input"],
Cell[110472, 3169, 271, 4, 46, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[110792, 3179, 102, 1, 37, "Subsubsection"],
Cell[CellGroupData[{
Cell[110919, 3184, 465, 7, 46, "Input"],
Cell[111387, 3193, 435, 8, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111859, 3206, 294, 5, 46, "Input"],
Cell[112156, 3213, 424, 7, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112617, 3225, 722, 12, 76, "Input"],
Cell[113342, 3239, 358, 6, 46, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113749, 3251, 95, 1, 37, "Subsubsection"],
Cell[CellGroupData[{
Cell[113869, 3256, 602, 16, 76, "Input"],
Cell[114474, 3274, 750, 23, 138, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115261, 3302, 543, 14, 76, "Input"],
Cell[115807, 3318, 193, 4, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116037, 3327, 452, 13, 46, "Input"],
Cell[116492, 3342, 304, 8, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116833, 3355, 501, 15, 46, "Input"],
Cell[117337, 3372, 291, 8, 46, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[117701, 3388, 94, 1, 100, "Section"],
Cell[117798, 3391, 134, 2, 52, "Subsection"],
Cell[117935, 3395, 142, 2, 38, "Subsection"],
Cell[118080, 3399, 117, 1, 38, "Subsection"],
Cell[118200, 3402, 185, 4, 38, "Subsection"],
Cell[118388, 3408, 145, 2, 38, "Subsection"],
Cell[118536, 3412, 193, 4, 38, "Subsection"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118766, 3421, 107, 1, 100, "Section"],
Cell[118876, 3424, 743, 11, 74, "Text"],
Cell[119622, 3437, 731, 9, 45, "Text"],
Cell[120356, 3448, 994, 15, 45, "Definition"],
Cell[121353, 3465, 1139, 17, 131, "Text"],
Cell[CellGroupData[{
Cell[122517, 3486, 106, 1, 52, "Subsection"],
Cell[122626, 3489, 854, 13, 1156, "Text"],
Cell[123483, 3504, 1229, 43, 4173, "EquationNumbered"],
Cell[124715, 3549, 105, 1, 505, "Text"],
Cell[124823, 3552, 615, 19, 1167, "EquationNumbered"],
Cell[125441, 3573, 110, 1, 505, "Text"],
Cell[125554, 3576, 788, 23, 1167, "EquationNumbered"],
Cell[126345, 3601, 103, 1, 505, "Text"],
Cell[126451, 3604, 2109, 60, 1669, "Equation"],
Cell[128563, 3666, 1713, 32, 2139, "Text"],
Cell[130279, 3700, 1362, 27, 802, "Equation"],
Cell[131644, 3729, 150, 2, 505, "Text"],
Cell[131797, 3733, 947, 25, 931, "Equation"],
Cell[132747, 3760, 403, 10, 505, "Text"],
Cell[133153, 3772, 1229, 35, 1075, "Equation"],
Cell[134385, 3809, 793, 26, 1113, "Text"],
Cell[135181, 3837, 1271, 36, 985, "Equation"],
Cell[136455, 3875, 618, 10, 838, "Text"],
Cell[137076, 3887, 842, 27, 748, "Equation"],
Cell[137921, 3916, 367, 12, 505, "Text"],
Cell[138291, 3930, 769, 24, 406, "Equation"],
Cell[139063, 3956, 874, 14, 838, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[139974, 3975, 113, 1, 38, "Subsection"],
Cell[140090, 3978, 2320, 77, 135, "Text"],
Cell[142413, 4057, 878, 32, 47, "Theorem"],
Cell[143294, 4091, 457, 12, 36, "EquationNumbered"],
Cell[143754, 4105, 738, 29, 45, "Theorem"],
Cell[144495, 4136, 255, 9, 45, "Text"],
Cell[144753, 4147, 795, 21, 102, "Text"],
Cell[145551, 4170, 217, 3, 45, "Text"],
Cell[145771, 4175, 612, 16, 36, "Equation"],
Cell[146386, 4193, 588, 22, 45, "Text"],
Cell[146977, 4217, 103, 1, 37, "Subsubsection"],
Cell[147083, 4220, 99, 1, 26, "Subsubsection"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147219, 4226, 267, 4, 52, "Subsection"],
Cell[147489, 4232, 348, 12, 3282, "Input"],
Cell[CellGroupData[{
Cell[147862, 4248, 456, 11, 1531, "Input"],
Cell[148321, 4261, 1007, 26, 3282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149365, 4292, 567, 13, 1531, "Input"],
Cell[149935, 4307, 982, 26, 3282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150954, 4338, 520, 13, 1531, "Input"],
Cell[151477, 4353, 1256, 30, 3282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152770, 4388, 376, 9, 1531, "Input"],
Cell[153149, 4399, 1103, 28, 3282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154289, 4432, 847, 19, 1531, "Input"],
Cell[155139, 4453, 887, 24, 3282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156063, 4482, 938, 21, 1531, "Input"],
Cell[157004, 4505, 727, 20, 3282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157768, 4530, 482, 13, 2458, "Input"],
Cell[158253, 4545, 730, 21, 3282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159020, 4571, 1181, 28, 3322, "Input"],
Cell[160204, 4601, 886, 26, 4212, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161127, 4632, 157, 3, 1531, "Input"],
Cell[161287, 4637, 723, 20, 3282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162047, 4662, 330, 6, 1531, "Input"],
Cell[162380, 4670, 281, 7, 1531, "Output"]
}, Open  ]],
Cell[162676, 4680, 57, 1, 1135, "Equation"]
}, Closed]],
Cell[CellGroupData[{
Cell[162770, 4686, 128, 2, 38, "Subsection"],
Cell[162901, 4690, 616, 10, 1257, "Text"],
Cell[163520, 4702, 660, 10, 1257, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[164217, 4717, 134, 2, 38, "Subsection"],
Cell[CellGroupData[{
Cell[164376, 4723, 159, 2, 37, "Subsubsection"],
Cell[CellGroupData[{
Cell[164560, 4729, 1298, 29, 1093, "Input"],
Cell[165861, 4760, 860, 24, 1365, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166758, 4789, 691, 14, 681, "Input"],
Cell[167452, 4805, 983, 26, 1567, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168472, 4836, 617, 13, 681, "Input"],
Cell[169092, 4851, 899, 25, 1774, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170028, 4881, 332, 7, 681, "Input"],
Cell[170363, 4890, 519, 14, 1093, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170919, 4909, 329, 8, 681, "Input"],
Cell[171251, 4919, 189, 4, 681, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[171489, 4929, 101, 1, 26, "Subsubsection"],
Cell[CellGroupData[{
Cell[171615, 4934, 761, 20, 1093, "Input"],
Cell[172379, 4956, 756, 24, 1093, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173172, 4985, 1000, 26, 1093, "Input"],
Cell[174175, 5013, 1021, 29, 1567, "Output"]
}, Open  ]],
Cell[175211, 5045, 578, 18, 1156, "Input"],
Cell[175792, 5065, 1333, 39, 1804, "Output"],
Cell[177128, 5106, 404, 12, 681, "Input"],
Cell[177535, 5120, 1218, 36, 1804, "Output"],
Cell[178756, 5158, 570, 17, 1156, "Input"],
Cell[179329, 5177, 1158, 34, 1804, "Output"],
Cell[CellGroupData[{
Cell[180512, 5215, 376, 10, 1093, "Input"],
Cell[180891, 5227, 672, 23, 1093, "Output"],
Cell[181566, 5252, 737, 25, 1093, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182340, 5282, 155, 3, 681, "Input"],
Cell[182498, 5287, 168, 4, 681, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182703, 5296, 270, 8, 681, "Input"],
Cell[182976, 5306, 206, 6, 681, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183255, 5320, 98, 1, 100, "Section"],
Cell[CellGroupData[{
Cell[183378, 5325, 99, 1, 252, "Subsection"],
Cell[183480, 5328, 125, 1, 150, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183654, 5335, 95, 1, 352, "Section"],
Cell[183752, 5338, 284, 5, 150, "Text"],
Cell[184039, 5345, 247, 5, 337, "Text"],
Cell[184289, 5352, 304, 6, 337, "Text"],
Cell[184596, 5360, 208, 4, 337, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184841, 5369, 197, 3, 792, "Section"],
Cell[CellGroupData[{
Cell[185063, 5376, 478, 9, 55356, "Input"],
Cell[185544, 5387, 945, 25, 33927, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186526, 5417, 500, 10, 33927, "Input"],
Cell[187029, 5429, 785, 23, 33927, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187851, 5457, 684, 12, 33927, "Input"],
Cell[188538, 5471, 769, 22, 33927, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

